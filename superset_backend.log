Loaded your LOCAL configuration at [/Users/stephocay/projects/hispuganda/superset/superset_config.py]
2025-12-07 00:08:40,736:INFO:alembic.runtime.migration:Context impl SQLiteImpl.
2025-12-07 00:08:40,737:INFO:alembic.runtime.migration:Will assume non-transactional DDL.
2025-12-07 00:08:40,858:INFO:superset.app:Syncing configuration to database...
2025-12-07 00:08:40,862:INFO:superset.app:Configuration sync to database completed successfully
 * Serving Flask app 'superset'
 * Debug mode: on
2025-12-07 00:08:41,196:INFO:werkzeug:[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:8088
2025-12-07 00:08:41,196:INFO:werkzeug:[33mPress CTRL+C to quit[0m
2025-12-07 00:08:41,261:INFO:werkzeug: * Restarting with watchdog (fsevents)
Loaded your LOCAL configuration at [/Users/stephocay/projects/hispuganda/superset/superset_config.py]
2025-12-07 00:08:42,393:INFO:alembic.runtime.migration:Context impl SQLiteImpl.
2025-12-07 00:08:42,393:INFO:alembic.runtime.migration:Will assume non-transactional DDL.
2025-12-07 00:08:42,494:INFO:superset.app:Syncing configuration to database...
2025-12-07 00:08:42,499:INFO:superset.app:Configuration sync to database completed successfully
2025-12-07 00:08:42,785:WARNING:werkzeug: * Debugger is active!
2025-12-07 00:08:42,792:INFO:werkzeug: * Debugger PIN: 114-810-287
2025-12-07 00:08:42,873:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:08:42] "GET /health HTTP/1.1" 200 -
2025-12-07 00:09:54,130:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:09:54] "[32mGET / HTTP/1.1[0m" 302 -
2025-12-07 00:09:54,741:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:09:54] "GET /superset/welcome/ HTTP/1.1" 200 -
2025-12-07 00:09:54,847:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1458, in dispatch_request
    self.raise_routing_exception(req)
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1440, in raise_routing_exception
    raise request.routing_exception  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/ctx.py", line 353, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/werkzeug/routing/map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-12-07 00:09:54,850:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:09:54] "[33mGET /ws HTTP/1.1[0m" 404 -
2025-12-07 00:09:55,369:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:09:55] "GET /api/v1/dashboard/?q=(filters:!((col:owners,opr:rel_m_m,value:'1')),order_column:changed_on_delta_humanized,order_direction:desc,page:0,page_size:5) HTTP/1.1" 200 -
2025-12-07 00:09:55,373:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:09:55] "GET /api/v1/log/recent_activity/?q=(distinct:!f,page_size:24) HTTP/1.1" 200 -
2025-12-07 00:09:55,502:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:09:55] "GET /api/v1/database/?q=(filters:!((col:database_name,opr:neq,value:examples))) HTTP/1.1" 200 -
2025-12-07 00:09:55,516:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:09:55] "GET /api/v1/saved_query/?q=(filters:!((col:created_by,opr:rel_o_m,value:'1')),order_column:changed_on_delta_humanized,order_direction:desc,page:0,page_size:5) HTTP/1.1" 200 -
2025-12-07 00:09:55,566:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:09:55] "GET /api/v1/database/?q=(filters:!((col:allow_file_upload,opr:upload_is_enabled,value:!t))) HTTP/1.1" 200 -
2025-12-07 00:09:55,571:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:09:55] "GET /api/v1/chart/?q=(filters:!((col:owners,opr:rel_m_m,value:'1')),order_column:changed_on_delta_humanized,order_direction:desc,page:0,page_size:5) HTTP/1.1" 200 -
2025-12-07 00:09:55,590:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:09:55] "GET /api/v1/dashboard/?q=(filters:!(),order_column:changed_on_delta_humanized,order_direction:desc,page:0,page_size:5) HTTP/1.1" 200 -
2025-12-07 00:09:55,593:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:09:55] "GET /api/v1/chart/?q=(filters:!(),order_column:changed_on_delta_humanized,order_direction:desc,page:0,page_size:5) HTTP/1.1" 200 -
2025-12-07 00:09:55,666:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:09:55] "GET /api/v1/chart/favorite_status/?q=!(1) HTTP/1.1" 200 -
2025-12-07 00:09:55,667:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:09:55] "GET /api/v1/dashboard/_info?q=(keys:!(permissions)) HTTP/1.1" 200 -
2025-12-07 00:09:55,670:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:09:55] "GET /api/v1/chart/_info?q=(keys:!(permissions)) HTTP/1.1" 200 -
2025-12-07 00:09:56,224:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:09:56] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-07 00:09:56,357:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1458, in dispatch_request
    self.raise_routing_exception(req)
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1440, in raise_routing_exception
    raise request.routing_exception  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/ctx.py", line 353, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/werkzeug/routing/map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-12-07 00:09:56,358:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:09:56] "[33mGET /ws HTTP/1.1[0m" 404 -
2025-12-07 00:09:58,447:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1458, in dispatch_request
    self.raise_routing_exception(req)
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1440, in raise_routing_exception
    raise request.routing_exception  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/ctx.py", line 353, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/werkzeug/routing/map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-12-07 00:09:58,448:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:09:58] "[33mGET /ws HTTP/1.1[0m" 404 -
2025-12-07 00:10:02,466:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1458, in dispatch_request
    self.raise_routing_exception(req)
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1440, in raise_routing_exception
    raise request.routing_exception  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/ctx.py", line 353, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/werkzeug/routing/map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-12-07 00:10:02,472:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:10:02] "[33mGET /ws HTTP/1.1[0m" 404 -
2025-12-07 00:10:02,475:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:10:02] "GET /api/v1/dataset/_info?q=(keys:!(permissions)) HTTP/1.1" 200 -
2025-12-07 00:10:02,476:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:10:02] "GET /api/v1/dataset/?q=(order_column:changed_on_delta_humanized,order_direction:desc,page:0,page_size:25) HTTP/1.1" 200 -
2025-12-07 00:10:03,387:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:10:03] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-07 00:10:05,030:INFO:superset.db_engine_specs.dhis2:[DHIS2] get_parameters_from_uri called
2025-12-07 00:10:05,030:ERROR:superset.db_engine_specs.dhis2:[DHIS2] Failed to extract parameters from URI: 'URL' object has no attribute 'decode'
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/superset/db_engine_specs/dhis2.py", line 361, in get_parameters_from_uri
    parsed = urlparse(uri)
             ^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/urllib/parse.py", line 394, in urlparse
    url, scheme, _coerce_result = _coerce_args(url, scheme)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/urllib/parse.py", line 133, in _coerce_args
    return _decode_args(args) + (_encode_result,)
           ^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/urllib/parse.py", line 117, in _decode_args
    return tuple(x.decode(encoding, errors) if x else '' for x in args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/urllib/parse.py", line 117, in <genexpr>
    return tuple(x.decode(encoding, errors) if x else '' for x in args)
                 ^^^^^^^^
AttributeError: 'URL' object has no attribute 'decode'
2025-12-07 00:10:05,037:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:10:05] "GET /api/v1/explore/?datasource_type=table&datasource_id=1 HTTP/1.1" 200 -
2025-12-07 00:10:06,181:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:10:06] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-07 00:10:06,232:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:10:06] "[35m[1mPOST /api/v1/explore/form_data?tab_id=14 HTTP/1.1[0m" 201 -
2025-12-07 00:10:10,494:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1458, in dispatch_request
    self.raise_routing_exception(req)
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1440, in raise_routing_exception
    raise request.routing_exception  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/ctx.py", line 353, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/werkzeug/routing/map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-12-07 00:10:10,495:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:10:10] "[33mGET /ws HTTP/1.1[0m" 404 -
2025-12-07 00:10:24,372:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:10:24] "[32mGET / HTTP/1.1[0m" 302 -
2025-12-07 00:10:24,436:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:10:24] "GET /superset/welcome/ HTTP/1.1" 200 -
2025-12-07 00:10:24,464:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:10:24] "GET /static/appbuilder/css/flags/flags16.css HTTP/1.1" 200 -
2025-12-07 00:10:24,468:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:10:24] "GET /static/assets/theme.0d705af4.entry.js HTTP/1.1" 200 -
2025-12-07 00:10:24,472:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:10:24] "GET /static/assets/thumbnail.0759d391.entry.js HTTP/1.1" 200 -
2025-12-07 00:10:24,493:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:10:24] "GET /static/assets/vendors-node_modules_rc-component_color-picker_es_index_js-node_modules_rc-component_mutate-o-700049.6a9d3af6.entry.js HTTP/1.1" 200 -
2025-12-07 00:10:24,518:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:10:24] "GET /static/assets/vendors-node_modules_reduxjs_toolkit_dist_query_react_rtk-query-react_esm_js-node_modules_ans-dafe32.9cbde694.entry.js HTTP/1.1" 200 -
2025-12-07 00:10:24,533:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:10:24] "GET /static/assets/vendors.ba32905a.entry.js HTTP/1.1" 200 -
2025-12-07 00:10:25,292:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:10:25] "GET /api/v1/database/?q=(filters:!((col:allow_file_upload,opr:upload_is_enabled,value:!t))) HTTP/1.1" 200 -
2025-12-07 00:10:25,339:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:10:25] "GET /api/v1/saved_query/?q=(filters:!((col:created_by,opr:rel_o_m,value:'1')),order_column:changed_on_delta_humanized,order_direction:desc,page:0,page_size:5) HTTP/1.1" 200 -
2025-12-07 00:10:25,343:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:10:25] "GET /api/v1/database/?q=(filters:!((col:database_name,opr:neq,value:examples))) HTTP/1.1" 200 -
2025-12-07 00:10:25,352:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:10:25] "GET /api/v1/log/recent_activity/?q=(distinct:!f,page_size:24) HTTP/1.1" 200 -
2025-12-07 00:10:25,360:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:10:25] "GET /api/v1/dashboard/?q=(filters:!((col:owners,opr:rel_m_m,value:'1')),order_column:changed_on_delta_humanized,order_direction:desc,page:0,page_size:5) HTTP/1.1" 200 -
2025-12-07 00:10:25,364:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:10:25] "GET /api/v1/chart/?q=(filters:!((col:owners,opr:rel_m_m,value:'1')),order_column:changed_on_delta_humanized,order_direction:desc,page:0,page_size:5) HTTP/1.1" 200 -
2025-12-07 00:10:25,386:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:10:25] "GET /api/v1/dashboard/?q=(filters:!(),order_column:changed_on_delta_humanized,order_direction:desc,page:0,page_size:5) HTTP/1.1" 200 -
2025-12-07 00:10:25,389:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:10:25] "GET /api/v1/chart/?q=(filters:!(),order_column:changed_on_delta_humanized,order_direction:desc,page:0,page_size:5) HTTP/1.1" 200 -
2025-12-07 00:10:25,458:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:10:25] "GET /api/v1/chart/favorite_status/?q=!(1) HTTP/1.1" 200 -
2025-12-07 00:10:25,461:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:10:25] "GET /api/v1/chart/_info?q=(keys:!(permissions)) HTTP/1.1" 200 -
2025-12-07 00:10:25,467:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:10:25] "GET /api/v1/dashboard/_info?q=(keys:!(permissions)) HTTP/1.1" 200 -
2025-12-07 00:10:25,682:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1458, in dispatch_request
    self.raise_routing_exception(req)
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1440, in raise_routing_exception
    raise request.routing_exception  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/ctx.py", line 353, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/werkzeug/routing/map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-12-07 00:10:25,683:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:10:25] "[33mGET /ws HTTP/1.1[0m" 404 -
2025-12-07 00:10:25,684:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:10:25] "GET /api/v1/me/ HTTP/1.1" 200 -
2025-12-07 00:10:26,193:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:10:26] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-07 00:10:26,814:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1458, in dispatch_request
    self.raise_routing_exception(req)
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1440, in raise_routing_exception
    raise request.routing_exception  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/ctx.py", line 353, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/werkzeug/routing/map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-12-07 00:10:26,817:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:10:26] "[33mGET /ws HTTP/1.1[0m" 404 -
2025-12-07 00:10:27,479:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1458, in dispatch_request
    self.raise_routing_exception(req)
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1440, in raise_routing_exception
    raise request.routing_exception  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/ctx.py", line 353, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/werkzeug/routing/map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-12-07 00:10:27,480:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:10:27] "[33mGET /ws HTTP/1.1[0m" 404 -
2025-12-07 00:10:28,208:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:10:28] "GET /api/v1/dataset/?q=(order_column:changed_on_delta_humanized,order_direction:desc,page:0,page_size:25) HTTP/1.1" 200 -
2025-12-07 00:10:28,211:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:10:28] "GET /api/v1/dataset/_info?q=(keys:!(permissions)) HTTP/1.1" 200 -
2025-12-07 00:10:28,842:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1458, in dispatch_request
    self.raise_routing_exception(req)
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1440, in raise_routing_exception
    raise request.routing_exception  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/ctx.py", line 353, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/werkzeug/routing/map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-12-07 00:10:28,844:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:10:28] "[33mGET /ws HTTP/1.1[0m" 404 -
2025-12-07 00:10:29,125:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:10:29] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-07 00:10:30,792:INFO:superset.db_engine_specs.dhis2:[DHIS2] get_parameters_from_uri called
2025-12-07 00:10:30,792:ERROR:superset.db_engine_specs.dhis2:[DHIS2] Failed to extract parameters from URI: 'URL' object has no attribute 'decode'
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/superset/db_engine_specs/dhis2.py", line 361, in get_parameters_from_uri
    parsed = urlparse(uri)
             ^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/urllib/parse.py", line 394, in urlparse
    url, scheme, _coerce_result = _coerce_args(url, scheme)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/urllib/parse.py", line 133, in _coerce_args
    return _decode_args(args) + (_encode_result,)
           ^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/urllib/parse.py", line 117, in _decode_args
    return tuple(x.decode(encoding, errors) if x else '' for x in args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/urllib/parse.py", line 117, in <genexpr>
    return tuple(x.decode(encoding, errors) if x else '' for x in args)
                 ^^^^^^^^
AttributeError: 'URL' object has no attribute 'decode'
2025-12-07 00:10:30,796:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:10:30] "GET /api/v1/explore/?datasource_type=table&datasource_id=1 HTTP/1.1" 200 -
2025-12-07 00:10:31,965:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:10:31] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-07 00:10:32,014:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:10:32] "[35m[1mPOST /api/v1/explore/form_data?tab_id=7 HTTP/1.1[0m" 201 -
2025-12-07 00:10:32,858:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1458, in dispatch_request
    self.raise_routing_exception(req)
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1440, in raise_routing_exception
    raise request.routing_exception  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/ctx.py", line 353, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/werkzeug/routing/map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-12-07 00:10:32,859:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:10:32] "[33mGET /ws HTTP/1.1[0m" 404 -
2025-12-07 00:10:38,947:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:10:38] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-07 00:10:40,924:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1458, in dispatch_request
    self.raise_routing_exception(req)
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1440, in raise_routing_exception
    raise request.routing_exception  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/ctx.py", line 353, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/werkzeug/routing/map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-12-07 00:10:40,926:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:10:40] "[33mGET /ws HTTP/1.1[0m" 404 -
2025-12-07 00:10:43,046:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:10:43] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-07 00:10:45,635:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:10:45] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-07 00:10:49,846:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:10:49] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-07 00:10:52,725:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:10:52] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-07 00:10:53,289:ERROR:superset.models.helpers:[METRICS-TRACE] Processing 0 metrics
2025-12-07 00:10:53,289:ERROR:superset.models.helpers:[METRICS-TRACE] Total metrics added: 0
2025-12-07 00:10:53,292:ERROR:superset.models.helpers:[METRICS-TRACE] Before dedup: 4 select_exprs + 0 metrics_exprs
2025-12-07 00:10:53,292:ERROR:superset.models.helpers:[METRICS-TRACE] After dedup: 4 total select_exprs
2025-12-07 00:10:53,292:INFO:superset.models.helpers:[COLUMN_TRACE] SQL Query Building:
2025-12-07 00:10:53,292:INFO:superset.models.helpers:[COLUMN_TRACE]   columns: ['105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period']
2025-12-07 00:10:53,292:INFO:superset.models.helpers:[COLUMN_TRACE]   metrics: []
2025-12-07 00:10:53,292:INFO:superset.models.helpers:[COLUMN_TRACE]   groupby: []
2025-12-07 00:10:53,292:INFO:superset.models.helpers:[COLUMN_TRACE]   labels_expected: ['105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period']
2025-12-07 00:10:53,292:INFO:superset.models.helpers:[COLUMN_TRACE]   select_exprs count: 4
2025-12-07 00:10:53,292:INFO:superset.models.helpers:[COLUMN_TRACE]     [0] key=105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive, name=105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-07 00:10:53,292:INFO:superset.models.helpers:[COLUMN_TRACE]     [1] key=105_EP01d_Malaria_cases_treated, name=105_EP01d_Malaria_cases_treated, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-07 00:10:53,292:INFO:superset.models.helpers:[COLUMN_TRACE]     [2] key=OrgUnit, name=OrgUnit, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-07 00:10:53,292:INFO:superset.models.helpers:[COLUMN_TRACE]     [3] key=Period, name=Period, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-07 00:10:53,293:INFO:superset.connectors.sqla.models:[DHIS2] get_from_clause for virtual dataset 1: analytics_LAST_YEAR_20251206
2025-12-07 00:10:53,293:INFO:superset.connectors.sqla.models:[DHIS2] Full SQL stored: SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
2025-12-07 00:10:53,293:INFO:superset.connectors.sqla.models:[DHIS2] Loaded params from extra field: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayPropert
2025-12-07 00:10:53,294:INFO:superset.connectors.sqla.models:[DHIS2] Cached params with key: dhis2_params_1_analytics
2025-12-07 00:10:53,294:INFO:superset.connectors.sqla.models:[DHIS2] Stored params in Flask g for DHIS2 table: analytics
2025-12-07 00:10:53,296:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Query execution in connectors/sqla/models.py:
2025-12-07 00:10:53,296:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   SQL (first 500 chars): SELECT "105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive", "105_EP01d_Malaria_cases_treated", "OrgUnit", "Period" 
FROM (SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
) AS virtual_table
 LIMIT 10000
2025-12-07 00:10:53,296:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   labels_expected: ['105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period']
2025-12-07 00:10:53,297:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 connection initialized: https://tests.dhis2.hispuganda.org/hmis/api
2025-12-07 00:10:53,297:INFO:superset.db_engine_specs.dhis2_dialect:Executing DHIS2 query: SELECT
  "105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive",
  "105_EP01d_Malaria_cases_treated",
  "OrgUnit",
  "Period"
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
LIMIT 10000
2025-12-07 00:10:53,298:INFO:superset.db_engine_specs.dhis2_dialect:Parsed endpoint: analytics
2025-12-07 00:10:53,298:INFO:superset.db_engine_specs.dhis2_dialect:Using stored parameters from Flask g for table: analytics
2025-12-07 00:10:53,298:INFO:superset.db_engine_specs.dhis2_dialect:Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
2025-12-07 00:10:53,298:INFO:superset.db_engine_specs.dhis2_dialect:Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
2025-12-07 00:10:53,298:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API request: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
2025-12-07 00:10:54,252:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:10:54] "PUT /api/v1/explore/form_data/8IOeEEvQ8x4?tab_id=7 HTTP/1.1" 200 -
2025-12-07 00:10:56,968:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1458, in dispatch_request
    self.raise_routing_exception(req)
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1440, in raise_routing_exception
    raise request.routing_exception  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/ctx.py", line 353, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/werkzeug/routing/map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-12-07 00:10:56,969:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:10:56] "[33mGET /ws HTTP/1.1[0m" 404 -
2025-12-07 00:10:58,359:INFO:superset.db_engine_specs.dhis2_dialect:Using wide/pivoted format for analytics
2025-12-07 00:10:58,360:INFO:superset.db_engine_specs.dhis2_dialect:normalize_analytics called with pivot=True, returning WIDE format
2025-12-07 00:10:58,360:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column construction - data_elements: ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
2025-12-07 00:10:58,360:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column names constructed (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-07 00:10:58,360:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] FIRST ROW CONSTRUCTION:
2025-12-07 00:10:58,360:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   Period (index 0): 2020
2025-12-07 00:10:58,360:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   OrgUnit (index 1): MOH - Uganda
2025-12-07 00:10:58,360:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01b. Malaria Total (index 2): 14479324
2025-12-07 00:10:58,360:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01a. Suspected fever (index 3): 22994823
2025-12-07 00:10:58,360:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01d. Malaria cases treated (index 4): 15266488
2025-12-07 00:10:58,360:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01c. Malaria Confirmed (B/s and RDT Positive) (index 5): 13326277
2025-12-07 00:10:58,360:INFO:superset.db_engine_specs.dhis2_dialect:First pivoted row - Period: '2020', OrgUnit: 'MOH - Uganda'
2025-12-07 00:10:58,360:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total pivoted rows: 4, columns: 6
2025-12-07 00:10:58,360:INFO:superset.db_engine_specs.dhis2_dialect:Normalized 4 rows with 6 columns for endpoint analytics
2025-12-07 00:10:58,360:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API returned 4 rows
2025-12-07 00:10:58,366:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() - Row count: 4
2025-12-07 00:10:58,366:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-07 00:10:58,366:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names length: 6
2025-12-07 00:10:58,366:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values count: 6
2025-12-07 00:10:58,366:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-07 00:10:58,366:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 0 (Period): 2020 -> 2020 (STRING)
2025-12-07 00:10:58,366:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (OrgUnit): MOH - Uganda -> MOH - Uganda (STRING)
2025-12-07 00:10:58,366:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (105_EP01b_Malaria_Total): 14479324 (PROCESSED)
2025-12-07 00:10:58,366:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (105_EP01a_Suspected_fever): 22994823 (PROCESSED)
2025-12-07 00:10:58,366:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (105_EP01d_Malaria_cases_treated): 15266488 (PROCESSED)
2025-12-07 00:10:58,366:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() returning 4 rows with 6 columns each
2025-12-07 00:10:58,366:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Got 4 rows from cursor
2025-12-07 00:10:58,366:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-07 00:10:58,366:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-07 00:10:58,366:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Types from cursor: ['String', 'String', 'String', 'String', 'String', 'String']
2025-12-07 00:10:58,372:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: DataFrame created with 4 rows, 6 columns
2025-12-07 00:10:58,372:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-07 00:10:58,372:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes BEFORE fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-07 00:10:58,372:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Period' to object dtype (dimension)
2025-12-07 00:10:58,373:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'OrgUnit' to object dtype (dimension)
2025-12-07 00:10:58,373:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes AFTER fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-07 00:10:58,373:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: First row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-07 00:10:58,376:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] BEFORE assign_column_label:
2025-12-07 00:10:58,376:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 6)
2025-12-07 00:10:58,376:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-07 00:10:58,376:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period']
2025-12-07 00:10:58,376:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: False
2025-12-07 00:10:58,376:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-07 00:10:58,376:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Column truncation needed: df has 6 columns, expected 4
2025-12-07 00:10:58,376:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   DataFrame actual columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-07 00:10:58,376:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Expected columns: ['105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period']
2025-12-07 00:10:58,376:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] âœ“ Selecting columns BY NAME (matched all expected columns)
2025-12-07 00:10:58,376:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Column mapping: {'105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', '105_EP01d_Malaria_cases_treated': '105_EP01d_Malaria_cases_treated', 'OrgUnit': 'OrgUnit', 'Period': 'Period'}
2025-12-07 00:10:58,377:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] Column Selection âœ“ SUCCESS - method=BY_NAME, datasource=analytics_LAST_YEAR_20251206
2025-12-07 00:10:58,377:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period']
2025-12-07 00:10:58,377:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   tried_by_name=True, success=True, fallback=False
2025-12-07 00:10:58,377:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Assigning column labels: ['105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period']
2025-12-07 00:10:58,377:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] AFTER assign_column_label:
2025-12-07 00:10:58,377:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 4)
2025-12-07 00:10:58,377:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period']
2025-12-07 00:10:58,377:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period']
2025-12-07 00:10:58,377:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: True
2025-12-07 00:10:58,377:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277, '105_EP01d_Malaria_cases_treated': 15266488, 'OrgUnit': 'MOH - Uganda', 'Period': '2020'}
2025-12-07 00:10:58,386:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:10:58] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-07 00:10:58,410:ERROR:superset.models.helpers:[METRICS-TRACE] Processing 0 metrics
2025-12-07 00:10:58,410:ERROR:superset.models.helpers:[METRICS-TRACE] Total metrics added: 0
2025-12-07 00:10:58,412:ERROR:superset.models.helpers:[METRICS-TRACE] Before dedup: 4 select_exprs + 0 metrics_exprs
2025-12-07 00:10:58,412:ERROR:superset.models.helpers:[METRICS-TRACE] After dedup: 4 total select_exprs
2025-12-07 00:10:58,412:INFO:superset.models.helpers:[COLUMN_TRACE] SQL Query Building:
2025-12-07 00:10:58,412:INFO:superset.models.helpers:[COLUMN_TRACE]   columns: ['105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period']
2025-12-07 00:10:58,412:INFO:superset.models.helpers:[COLUMN_TRACE]   metrics: []
2025-12-07 00:10:58,412:INFO:superset.models.helpers:[COLUMN_TRACE]   groupby: []
2025-12-07 00:10:58,412:INFO:superset.models.helpers:[COLUMN_TRACE]   labels_expected: ['105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period']
2025-12-07 00:10:58,412:INFO:superset.models.helpers:[COLUMN_TRACE]   select_exprs count: 4
2025-12-07 00:10:58,412:INFO:superset.models.helpers:[COLUMN_TRACE]     [0] key=105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive, name=105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-07 00:10:58,412:INFO:superset.models.helpers:[COLUMN_TRACE]     [1] key=105_EP01d_Malaria_cases_treated, name=105_EP01d_Malaria_cases_treated, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-07 00:10:58,412:INFO:superset.models.helpers:[COLUMN_TRACE]     [2] key=OrgUnit, name=OrgUnit, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-07 00:10:58,412:INFO:superset.models.helpers:[COLUMN_TRACE]     [3] key=Period, name=Period, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-07 00:10:58,412:INFO:superset.connectors.sqla.models:[DHIS2] get_from_clause for virtual dataset 1: analytics_LAST_YEAR_20251206
2025-12-07 00:10:58,412:INFO:superset.connectors.sqla.models:[DHIS2] Full SQL stored: SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
2025-12-07 00:10:58,412:INFO:superset.connectors.sqla.models:[DHIS2] Loaded params from extra field: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayPropert
2025-12-07 00:10:58,413:INFO:superset.connectors.sqla.models:[DHIS2] Cached params with key: dhis2_params_1_analytics
2025-12-07 00:10:58,413:INFO:superset.connectors.sqla.models:[DHIS2] Stored params in Flask g for DHIS2 table: analytics
2025-12-07 00:10:58,414:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Query execution in connectors/sqla/models.py:
2025-12-07 00:10:58,414:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   SQL (first 500 chars): SELECT "105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive", "105_EP01d_Malaria_cases_treated", "OrgUnit", "Period" 
FROM (SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
) AS virtual_table
 LIMIT 10000
2025-12-07 00:10:58,414:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   labels_expected: ['105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period']
2025-12-07 00:10:58,415:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 connection initialized: https://tests.dhis2.hispuganda.org/hmis/api
2025-12-07 00:10:58,415:INFO:superset.db_engine_specs.dhis2_dialect:Executing DHIS2 query: SELECT
  "105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive",
  "105_EP01d_Malaria_cases_treated",
  "OrgUnit",
  "Period"
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
LIMIT 10000
2025-12-07 00:10:58,415:INFO:superset.db_engine_specs.dhis2_dialect:Parsed endpoint: analytics
2025-12-07 00:10:58,415:INFO:superset.db_engine_specs.dhis2_dialect:Using stored parameters from Flask g for table: analytics
2025-12-07 00:10:58,415:INFO:superset.db_engine_specs.dhis2_dialect:Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
2025-12-07 00:10:58,415:INFO:superset.db_engine_specs.dhis2_dialect:Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
2025-12-07 00:10:58,415:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API request: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
2025-12-07 00:10:59,402:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:10:59] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-07 00:10:59,997:INFO:superset.db_engine_specs.dhis2_dialect:Using wide/pivoted format for analytics
2025-12-07 00:10:59,997:INFO:superset.db_engine_specs.dhis2_dialect:normalize_analytics called with pivot=True, returning WIDE format
2025-12-07 00:10:59,998:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column construction - data_elements: ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
2025-12-07 00:10:59,998:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column names constructed (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-07 00:10:59,998:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] FIRST ROW CONSTRUCTION:
2025-12-07 00:10:59,998:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   Period (index 0): 2020
2025-12-07 00:10:59,998:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   OrgUnit (index 1): MOH - Uganda
2025-12-07 00:10:59,998:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01b. Malaria Total (index 2): 14479324
2025-12-07 00:10:59,998:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01a. Suspected fever (index 3): 22994823
2025-12-07 00:10:59,998:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01d. Malaria cases treated (index 4): 15266488
2025-12-07 00:10:59,998:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01c. Malaria Confirmed (B/s and RDT Positive) (index 5): 13326277
2025-12-07 00:10:59,998:INFO:superset.db_engine_specs.dhis2_dialect:First pivoted row - Period: '2020', OrgUnit: 'MOH - Uganda'
2025-12-07 00:10:59,998:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total pivoted rows: 4, columns: 6
2025-12-07 00:10:59,998:INFO:superset.db_engine_specs.dhis2_dialect:Normalized 4 rows with 6 columns for endpoint analytics
2025-12-07 00:10:59,998:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API returned 4 rows
2025-12-07 00:11:00,007:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() - Row count: 4
2025-12-07 00:11:00,007:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-07 00:11:00,007:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names length: 6
2025-12-07 00:11:00,007:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values count: 6
2025-12-07 00:11:00,007:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-07 00:11:00,007:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 0 (Period): 2020 -> 2020 (STRING)
2025-12-07 00:11:00,007:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (OrgUnit): MOH - Uganda -> MOH - Uganda (STRING)
2025-12-07 00:11:00,007:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (105_EP01b_Malaria_Total): 14479324 (PROCESSED)
2025-12-07 00:11:00,007:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (105_EP01a_Suspected_fever): 22994823 (PROCESSED)
2025-12-07 00:11:00,007:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (105_EP01d_Malaria_cases_treated): 15266488 (PROCESSED)
2025-12-07 00:11:00,007:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() returning 4 rows with 6 columns each
2025-12-07 00:11:00,007:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Got 4 rows from cursor
2025-12-07 00:11:00,007:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-07 00:11:00,007:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-07 00:11:00,007:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Types from cursor: ['String', 'String', 'String', 'String', 'String', 'String']
2025-12-07 00:11:00,008:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: DataFrame created with 4 rows, 6 columns
2025-12-07 00:11:00,008:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-07 00:11:00,008:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes BEFORE fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-07 00:11:00,009:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Period' to object dtype (dimension)
2025-12-07 00:11:00,009:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'OrgUnit' to object dtype (dimension)
2025-12-07 00:11:00,009:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes AFTER fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-07 00:11:00,009:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: First row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-07 00:11:00,012:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] BEFORE assign_column_label:
2025-12-07 00:11:00,012:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 6)
2025-12-07 00:11:00,012:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-07 00:11:00,012:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period']
2025-12-07 00:11:00,012:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: False
2025-12-07 00:11:00,012:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-07 00:11:00,012:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Column truncation needed: df has 6 columns, expected 4
2025-12-07 00:11:00,012:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   DataFrame actual columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-07 00:11:00,012:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Expected columns: ['105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period']
2025-12-07 00:11:00,012:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] âœ“ Selecting columns BY NAME (matched all expected columns)
2025-12-07 00:11:00,012:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Column mapping: {'105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', '105_EP01d_Malaria_cases_treated': '105_EP01d_Malaria_cases_treated', 'OrgUnit': 'OrgUnit', 'Period': 'Period'}
2025-12-07 00:11:00,012:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] Column Selection âœ“ SUCCESS - method=BY_NAME, datasource=analytics_LAST_YEAR_20251206
2025-12-07 00:11:00,012:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period']
2025-12-07 00:11:00,012:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   tried_by_name=True, success=True, fallback=False
2025-12-07 00:11:00,012:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Assigning column labels: ['105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period']
2025-12-07 00:11:00,012:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] AFTER assign_column_label:
2025-12-07 00:11:00,012:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 4)
2025-12-07 00:11:00,012:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period']
2025-12-07 00:11:00,012:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period']
2025-12-07 00:11:00,012:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: True
2025-12-07 00:11:00,012:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277, '105_EP01d_Malaria_cases_treated': 15266488, 'OrgUnit': 'MOH - Uganda', 'Period': '2020'}
2025-12-07 00:11:00,021:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:11:00] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-07 00:11:00,485:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1458, in dispatch_request
    self.raise_routing_exception(req)
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1440, in raise_routing_exception
    raise request.routing_exception  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/ctx.py", line 353, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/werkzeug/routing/map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-12-07 00:11:00,486:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:11:00] "[33mGET /ws HTTP/1.1[0m" 404 -
2025-12-07 00:11:13,294:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:11:13] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-07 00:11:14,221:ERROR:superset.models.helpers:[METRICS-TRACE] Processing 0 metrics
2025-12-07 00:11:14,221:ERROR:superset.models.helpers:[METRICS-TRACE] Total metrics added: 0
2025-12-07 00:11:14,222:ERROR:superset.models.helpers:[METRICS-TRACE] Processing 0 metrics
2025-12-07 00:11:14,224:ERROR:superset.models.helpers:[METRICS-TRACE] Before dedup: 5 select_exprs + 0 metrics_exprs
2025-12-07 00:11:14,224:ERROR:superset.models.helpers:[METRICS-TRACE] Total metrics added: 0
2025-12-07 00:11:14,224:ERROR:superset.models.helpers:[METRICS-TRACE] After dedup: 5 total select_exprs
2025-12-07 00:11:14,225:ERROR:superset.models.helpers:[METRICS-TRACE] Before dedup: 5 select_exprs + 0 metrics_exprs
2025-12-07 00:11:14,225:INFO:superset.models.helpers:[COLUMN_TRACE] SQL Query Building:
2025-12-07 00:11:14,225:ERROR:superset.models.helpers:[METRICS-TRACE] After dedup: 5 total select_exprs
2025-12-07 00:11:14,225:INFO:superset.models.helpers:[COLUMN_TRACE]   columns: ['105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period', '105_EP01b_Malaria_Total']
2025-12-07 00:11:14,225:INFO:superset.models.helpers:[COLUMN_TRACE] SQL Query Building:
2025-12-07 00:11:14,225:INFO:superset.models.helpers:[COLUMN_TRACE]   metrics: []
2025-12-07 00:11:14,226:INFO:superset.models.helpers:[COLUMN_TRACE]   columns: ['105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period', '105_EP01b_Malaria_Total']
2025-12-07 00:11:14,226:INFO:superset.models.helpers:[COLUMN_TRACE]   groupby: []
2025-12-07 00:11:14,226:INFO:superset.models.helpers:[COLUMN_TRACE]   metrics: []
2025-12-07 00:11:14,226:INFO:superset.models.helpers:[COLUMN_TRACE]   labels_expected: ['105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period', '105_EP01b_Malaria_Total']
2025-12-07 00:11:14,226:INFO:superset.models.helpers:[COLUMN_TRACE]   groupby: []
2025-12-07 00:11:14,226:INFO:superset.models.helpers:[COLUMN_TRACE]   select_exprs count: 5
2025-12-07 00:11:14,226:INFO:superset.models.helpers:[COLUMN_TRACE]   labels_expected: ['105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period', '105_EP01b_Malaria_Total']
2025-12-07 00:11:14,226:INFO:superset.models.helpers:[COLUMN_TRACE]     [0] key=105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive, name=105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-07 00:11:14,226:INFO:superset.models.helpers:[COLUMN_TRACE]   select_exprs count: 5
2025-12-07 00:11:14,226:INFO:superset.models.helpers:[COLUMN_TRACE]     [1] key=105_EP01d_Malaria_cases_treated, name=105_EP01d_Malaria_cases_treated, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-07 00:11:14,226:INFO:superset.models.helpers:[COLUMN_TRACE]     [0] key=105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive, name=105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-07 00:11:14,226:INFO:superset.models.helpers:[COLUMN_TRACE]     [2] key=OrgUnit, name=OrgUnit, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-07 00:11:14,226:INFO:superset.models.helpers:[COLUMN_TRACE]     [1] key=105_EP01d_Malaria_cases_treated, name=105_EP01d_Malaria_cases_treated, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-07 00:11:14,226:INFO:superset.models.helpers:[COLUMN_TRACE]     [3] key=Period, name=Period, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-07 00:11:14,226:INFO:superset.models.helpers:[COLUMN_TRACE]     [2] key=OrgUnit, name=OrgUnit, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-07 00:11:14,226:INFO:superset.models.helpers:[COLUMN_TRACE]     [4] key=105_EP01b_Malaria_Total, name=105_EP01b_Malaria_Total, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-07 00:11:14,226:INFO:superset.models.helpers:[COLUMN_TRACE]     [3] key=Period, name=Period, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-07 00:11:14,226:INFO:superset.connectors.sqla.models:[DHIS2] get_from_clause for virtual dataset 1: analytics_LAST_YEAR_20251206
2025-12-07 00:11:14,226:INFO:superset.models.helpers:[COLUMN_TRACE]     [4] key=105_EP01b_Malaria_Total, name=105_EP01b_Malaria_Total, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-07 00:11:14,226:INFO:superset.connectors.sqla.models:[DHIS2] Full SQL stored: SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
2025-12-07 00:11:14,226:INFO:superset.connectors.sqla.models:[DHIS2] get_from_clause for virtual dataset 1: analytics_LAST_YEAR_20251206
2025-12-07 00:11:14,226:INFO:superset.connectors.sqla.models:[DHIS2] Loaded params from extra field: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayPropert
2025-12-07 00:11:14,226:INFO:superset.connectors.sqla.models:[DHIS2] Full SQL stored: SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
2025-12-07 00:11:14,226:INFO:superset.connectors.sqla.models:[DHIS2] Loaded params from extra field: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayPropert
2025-12-07 00:11:14,227:INFO:superset.connectors.sqla.models:[DHIS2] Cached params with key: dhis2_params_1_analytics
2025-12-07 00:11:14,227:INFO:superset.connectors.sqla.models:[DHIS2] Stored params in Flask g for DHIS2 table: analytics
2025-12-07 00:11:14,227:INFO:superset.connectors.sqla.models:[DHIS2] Cached params with key: dhis2_params_1_analytics
2025-12-07 00:11:14,228:INFO:superset.connectors.sqla.models:[DHIS2] Stored params in Flask g for DHIS2 table: analytics
2025-12-07 00:11:14,230:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Query execution in connectors/sqla/models.py:
2025-12-07 00:11:14,230:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Query execution in connectors/sqla/models.py:
2025-12-07 00:11:14,230:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   SQL (first 500 chars): SELECT "105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive", "105_EP01d_Malaria_cases_treated", "OrgUnit", "Period", "105_EP01b_Malaria_Total" 
FROM (SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
) AS virtual_table
 LIMIT 10000
2025-12-07 00:11:14,230:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   SQL (first 500 chars): SELECT "105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive", "105_EP01d_Malaria_cases_treated", "OrgUnit", "Period", "105_EP01b_Malaria_Total" 
FROM (SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
) AS virtual_table
 LIMIT 10000
2025-12-07 00:11:14,230:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   labels_expected: ['105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period', '105_EP01b_Malaria_Total']
2025-12-07 00:11:14,231:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   labels_expected: ['105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period', '105_EP01b_Malaria_Total']
2025-12-07 00:11:14,232:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 connection initialized: https://tests.dhis2.hispuganda.org/hmis/api
2025-12-07 00:11:14,233:INFO:superset.db_engine_specs.dhis2_dialect:Executing DHIS2 query: SELECT
  "105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive",
  "105_EP01d_Malaria_cases_treated",
  "OrgUnit",
  "Period",
  "105_EP01b_Malaria_Total"
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
LIMIT 10000
2025-12-07 00:11:14,233:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 connection initialized: https://tests.dhis2.hispuganda.org/hmis/api
2025-12-07 00:11:14,233:INFO:superset.db_engine_specs.dhis2_dialect:Parsed endpoint: analytics
2025-12-07 00:11:14,233:INFO:superset.db_engine_specs.dhis2_dialect:Executing DHIS2 query: SELECT
  "105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive",
  "105_EP01d_Malaria_cases_treated",
  "OrgUnit",
  "Period",
  "105_EP01b_Malaria_Total"
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
LIMIT 10000
[DHIS2] Executing query: SELECT
  "105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive",
  "105_EP01d_Malaria_cases_treated",
  "OrgUnit",
  "Period"
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
LIMIT 10000
[DHIS2] Parsed endpoint: analytics
[DHIS2] Found params in Flask g for analytics: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;
[DHIS2] Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
[DHIS2] Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
[DHIS2] API request URL: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
[DHIS2] Raw API response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Raw DHIS2 rows count: 16
[DHIS2] First raw row: ['QHnwKs2OUZv', '2020', 'akV6429SUqu', '15266488']
[DHIS2] Parsing response for endpoint: analytics
[DHIS2] Response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Response sample: {'headers': [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}], 'metaDat
[DHIS2] Using WIDE/PIVOTED format (Period, OrgUnit, DX1, DX2, ...) for analytics
[DHIS2] normalize_analytics: pivot=True, using WIDE/PIVOTED format
[DHIS2] PIVOT CONSTRUCTION:
[DHIS2]   data_elements (UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   data_element_list (sorted UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   col_names (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized row count: 4
[DHIS2] First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] _set_description: columns=['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], types=['String', 'String', 'String', 'String', 'String', 'String']
[DHIS2] Transformed rows count: 4
[DHIS2] First transformed row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] Fetched 4 rows
[DHIS2] fetchall() called - returning 4 rows
[DHIS2] fetchall() - First row type: <class 'tuple'>
[DHIS2] fetchall() - First row (original): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Column count from description: 6
[DHIS2] fetchall() - First row (fixed types): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Type enforcement: dimensions=STRING, measures=FLOAT
[DHIS2] Executing query: SELECT
  "105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive",
  "105_EP01d_Malaria_cases_treated",
  "OrgUnit",
  "Period"
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
LIMIT 10000
[DHIS2] Parsed endpoint: analytics
[DHIS2] Found params in Flask g for analytics: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;
[DHIS2] Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
[DHIS2] Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
[DHIS2] API request URL: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
[DHIS2] Raw API response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Raw DHIS2 rows count: 16
[DHIS2] First raw row: ['QHnwKs2OUZv', '2020', 'akV6429SUqu', '15266488']
[DHIS2] Parsing response for endpoint: analytics
[DHIS2] Response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Response sample: {'headers': [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}], 'metaDat
[DHIS2] Using WIDE/PIVOTED format (Period, OrgUnit, DX1, DX2, ...) for analytics
[DHIS2] normalize_analytics: pivot=True, using WIDE/PIVOTED format
[DHIS2] PIVOT CONSTRUCTION:
[DHIS2]   data_elements (UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   data_element_list (sorted UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   col_names (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized row count: 4
[DHIS2] First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] _set_description: columns=['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], types=['String', 'String', 'String', 'String', 'String', 'String']
[DHIS2] Transformed rows count: 4
[DHIS2] First transformed row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] Fetched 4 rows
[DHIS2] fetchall() called - returning 4 rows
[DHIS2] fetchall() - First row type: <class 'tuple'>
[DHIS2] fetchall() - First row (original): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Column count from description: 6
[DHIS2] fetchall() - First row (fixed types): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Type enforcement: dimensions=STRING, measures=FLOAT
[DHIS2] Executing query: SELECT
  "105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive",
  "105_EP01d_Malaria_cases_treated",
  "OrgUnit",
  "Period",
  "105_EP01b_Malaria_Total"
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
LIMIT 10000
[DHIS2] Parsed endpoint: analytics
[DHIS2] Executing query: SELECT
  "105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive",
  "105_EP01d_Malaria_cases_treated",
  "OrgUnit",
  "Period",
  "105_EP01b_Malaria_Total"
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
LIMIT 10000
[DHIS2] Found params in Flask g for analytics: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;
[DHIS2] Parsed endpoint: analytics2025-12-07 00:11:14,234:INFO:superset.db_engine_specs.dhis2_dialect:Using stored parameters from Flask g for table: analytics
2025-12-07 00:11:14,234:INFO:superset.db_engine_specs.dhis2_dialect:Parsed endpoint: analytics
2025-12-07 00:11:14,234:INFO:superset.db_engine_specs.dhis2_dialect:Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
2025-12-07 00:11:14,234:INFO:superset.db_engine_specs.dhis2_dialect:Using stored parameters from Flask g for table: analytics
2025-12-07 00:11:14,234:INFO:superset.db_engine_specs.dhis2_dialect:Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
2025-12-07 00:11:14,234:INFO:superset.db_engine_specs.dhis2_dialect:Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
2025-12-07 00:11:14,234:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API request: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
2025-12-07 00:11:14,234:INFO:superset.db_engine_specs.dhis2_dialect:Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
2025-12-07 00:11:14,234:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API request: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
2025-12-07 00:11:15,179:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:11:15] "PUT /api/v1/explore/form_data/8IOeEEvQ8x4?tab_id=7 HTTP/1.1" 200 -
2025-12-07 00:11:15,198:INFO:superset.db_engine_specs.dhis2_dialect:Using wide/pivoted format for analytics
2025-12-07 00:11:15,198:INFO:superset.db_engine_specs.dhis2_dialect:normalize_analytics called with pivot=True, returning WIDE format
2025-12-07 00:11:15,198:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column construction - data_elements: ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
2025-12-07 00:11:15,198:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column names constructed (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-07 00:11:15,198:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] FIRST ROW CONSTRUCTION:
2025-12-07 00:11:15,198:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   Period (index 0): 2020
2025-12-07 00:11:15,198:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   OrgUnit (index 1): MOH - Uganda
2025-12-07 00:11:15,198:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01b. Malaria Total (index 2): 14479324
2025-12-07 00:11:15,198:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01a. Suspected fever (index 3): 22994823
2025-12-07 00:11:15,198:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01d. Malaria cases treated (index 4): 15266488
2025-12-07 00:11:15,198:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01c. Malaria Confirmed (B/s and RDT Positive) (index 5): 13326277
2025-12-07 00:11:15,198:INFO:superset.db_engine_specs.dhis2_dialect:First pivoted row - Period: '2020', OrgUnit: 'MOH - Uganda'
2025-12-07 00:11:15,198:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total pivoted rows: 4, columns: 6
2025-12-07 00:11:15,198:INFO:superset.db_engine_specs.dhis2_dialect:Normalized 4 rows with 6 columns for endpoint analytics
2025-12-07 00:11:15,198:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API returned 4 rows
2025-12-07 00:11:15,200:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() - Row count: 4
2025-12-07 00:11:15,200:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-07 00:11:15,200:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names length: 6
2025-12-07 00:11:15,200:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values count: 6
2025-12-07 00:11:15,200:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-07 00:11:15,200:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 0 (Period): 2020 -> 2020 (STRING)
2025-12-07 00:11:15,200:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (OrgUnit): MOH - Uganda -> MOH - Uganda (STRING)
2025-12-07 00:11:15,200:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (105_EP01b_Malaria_Total): 14479324 (PROCESSED)
2025-12-07 00:11:15,200:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (105_EP01a_Suspected_fever): 22994823 (PROCESSED)
2025-12-07 00:11:15,200:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (105_EP01d_Malaria_cases_treated): 15266488 (PROCESSED)
2025-12-07 00:11:15,200:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() returning 4 rows with 6 columns each
2025-12-07 00:11:15,200:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Got 4 rows from cursor
2025-12-07 00:11:15,200:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-07 00:11:15,200:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-07 00:11:15,200:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Types from cursor: ['String', 'String', 'String', 'String', 'String', 'String']
2025-12-07 00:11:15,201:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: DataFrame created with 4 rows, 6 columns
2025-12-07 00:11:15,201:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-07 00:11:15,201:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes BEFORE fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-07 00:11:15,201:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Period' to object dtype (dimension)
2025-12-07 00:11:15,201:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'OrgUnit' to object dtype (dimension)
2025-12-07 00:11:15,201:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes AFTER fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-07 00:11:15,201:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: First row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-07 00:11:15,203:INFO:superset.db_engine_specs.dhis2_dialect:Using wide/pivoted format for analytics
2025-12-07 00:11:15,203:INFO:superset.db_engine_specs.dhis2_dialect:normalize_analytics called with pivot=True, returning WIDE format
2025-12-07 00:11:15,203:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column construction - data_elements: ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
2025-12-07 00:11:15,203:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column names constructed (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-07 00:11:15,203:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] FIRST ROW CONSTRUCTION:
2025-12-07 00:11:15,203:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   Period (index 0): 2020
2025-12-07 00:11:15,203:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   OrgUnit (index 1): MOH - Uganda
2025-12-07 00:11:15,203:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01b. Malaria Total (index 2): 14479324
2025-12-07 00:11:15,203:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] BEFORE assign_column_label:
2025-12-07 00:11:15,203:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01a. Suspected fever (index 3): 22994823
2025-12-07 00:11:15,203:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 6)
2025-12-07 00:11:15,203:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01d. Malaria cases treated (index 4): 15266488
2025-12-07 00:11:15,203:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01c. Malaria Confirmed (B/s and RDT Positive) (index 5): 13326277
2025-12-07 00:11:15,203:INFO:superset.db_engine_specs.dhis2_dialect:First pivoted row - Period: '2020', OrgUnit: 'MOH - Uganda'
2025-12-07 00:11:15,203:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total pivoted rows: 4, columns: 6
2025-12-07 00:11:15,203:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-07 00:11:15,203:INFO:superset.db_engine_specs.dhis2_dialect:Normalized 4 rows with 6 columns for endpoint analytics
2025-12-07 00:11:15,203:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period', '105_EP01b_Malaria_Total']
2025-12-07 00:11:15,203:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API returned 4 rows
2025-12-07 00:11:15,203:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: False
2025-12-07 00:11:15,204:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-07 00:11:15,204:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Column truncation needed: df has 6 columns, expected 5
2025-12-07 00:11:15,204:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   DataFrame actual columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-07 00:11:15,204:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Expected columns: ['105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period', '105_EP01b_Malaria_Total']
2025-12-07 00:11:15,204:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] âœ“ Selecting columns BY NAME (matched all expected columns)
2025-12-07 00:11:15,204:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Column mapping: {'105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', '105_EP01d_Malaria_cases_treated': '105_EP01d_Malaria_cases_treated', 'OrgUnit': 'OrgUnit', 'Period': 'Period', '105_EP01b_Malaria_Total': '105_EP01b_Malaria_Total'}
2025-12-07 00:11:15,204:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] Column Selection âœ“ SUCCESS - method=BY_NAME, datasource=analytics_LAST_YEAR_20251206
2025-12-07 00:11:15,205:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period', '105_EP01b_Malaria_Total']
2025-12-07 00:11:15,205:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   tried_by_name=True, success=True, fallback=False
2025-12-07 00:11:15,205:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Assigning column labels: ['105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period', '105_EP01b_Malaria_Total']
2025-12-07 00:11:15,205:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] AFTER assign_column_label:
2025-12-07 00:11:15,205:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 5)
2025-12-07 00:11:15,205:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period', '105_EP01b_Malaria_Total']
2025-12-07 00:11:15,205:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period', '105_EP01b_Malaria_Total']
2025-12-07 00:11:15,205:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: True
2025-12-07 00:11:15,205:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277, '105_EP01d_Malaria_cases_treated': 15266488, 'OrgUnit': 'MOH - Uganda', 'Period': '2020', '105_EP01b_Malaria_Total': 14479324}
2025-12-07 00:11:15,206:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() - Row count: 4
2025-12-07 00:11:15,206:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-07 00:11:15,206:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names length: 6
2025-12-07 00:11:15,206:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values count: 6
2025-12-07 00:11:15,206:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-07 00:11:15,206:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 0 (Period): 2020 -> 2020 (STRING)
2025-12-07 00:11:15,206:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (OrgUnit): MOH - Uganda -> MOH - Uganda (STRING)
2025-12-07 00:11:15,206:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (105_EP01b_Malaria_Total): 14479324 (PROCESSED)
2025-12-07 00:11:15,206:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (105_EP01a_Suspected_fever): 22994823 (PROCESSED)
2025-12-07 00:11:15,206:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (105_EP01d_Malaria_cases_treated): 15266488 (PROCESSED)
2025-12-07 00:11:15,206:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() returning 4 rows with 6 columns each
2025-12-07 00:11:15,206:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Got 4 rows from cursor
2025-12-07 00:11:15,206:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-07 00:11:15,206:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-07 00:11:15,206:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Types from cursor: ['String', 'String', 'String', 'String', 'String', 'String']
2025-12-07 00:11:15,207:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: DataFrame created with 4 rows, 6 columns
2025-12-07 00:11:15,207:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-07 00:11:15,207:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes BEFORE fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-07 00:11:15,207:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Period' to object dtype (dimension)
2025-12-07 00:11:15,207:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'OrgUnit' to object dtype (dimension)
2025-12-07 00:11:15,208:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes AFTER fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-07 00:11:15,208:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: First row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-07 00:11:15,211:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] BEFORE assign_column_label:
2025-12-07 00:11:15,211:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 6)
2025-12-07 00:11:15,211:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-07 00:11:15,211:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period', '105_EP01b_Malaria_Total']
2025-12-07 00:11:15,211:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: False
2025-12-07 00:11:15,211:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-07 00:11:15,211:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Column truncation needed: df has 6 columns, expected 5
2025-12-07 00:11:15,211:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   DataFrame actual columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-07 00:11:15,211:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Expected columns: ['105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period', '105_EP01b_Malaria_Total']
2025-12-07 00:11:15,211:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] âœ“ Selecting columns BY NAME (matched all expected columns)
2025-12-07 00:11:15,211:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Column mapping: {'105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', '105_EP01d_Malaria_cases_treated': '105_EP01d_Malaria_cases_treated', 'OrgUnit': 'OrgUnit', 'Period': 'Period', '105_EP01b_Malaria_Total': '105_EP01b_Malaria_Total'}
2025-12-07 00:11:15,211:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] Column Selection âœ“ SUCCESS - method=BY_NAME, datasource=analytics_LAST_YEAR_20251206
2025-12-07 00:11:15,211:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period', '105_EP01b_Malaria_Total']
2025-12-07 00:11:15,211:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   tried_by_name=True, success=True, fallback=False
2025-12-07 00:11:15,211:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Assigning column labels: ['105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period', '105_EP01b_Malaria_Total']
2025-12-07 00:11:15,211:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] AFTER assign_column_label:
2025-12-07 00:11:15,211:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 5)
2025-12-07 00:11:15,211:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period', '105_EP01b_Malaria_Total']
2025-12-07 00:11:15,211:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period', '105_EP01b_Malaria_Total']
2025-12-07 00:11:15,211:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: True
2025-12-07 00:11:15,211:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277, '105_EP01d_Malaria_cases_treated': 15266488, 'OrgUnit': 'MOH - Uganda', 'Period': '2020', '105_EP01b_Malaria_Total': 14479324}
2025-12-07 00:11:15,218:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:11:15] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-07 00:11:15,223:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:11:15] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-07 00:11:16,234:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:11:16] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-07 00:11:29,000:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1458, in dispatch_request
    self.raise_routing_exception(req)
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1440, in raise_routing_exception
    raise request.routing_exception  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/ctx.py", line 353, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/werkzeug/routing/map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-12-07 00:11:29,002:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:11:29] "[33mGET /ws HTTP/1.1[0m" 404 -
2025-12-07 00:11:32,791:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:11:32] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-07 00:11:38,826:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:11:38] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-07 00:11:42,885:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:11:42] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-07 00:11:47,696:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:11:47] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-07 00:11:51,806:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:11:51] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-07 00:11:56,521:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:11:56] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-07 00:11:57,272:ERROR:superset.models.helpers:[METRICS-TRACE] Processing 3 metrics
2025-12-07 00:11:57,273:ERROR:superset.models.helpers:[METRICS-TRACE] Processing 3 metrics
2025-12-07 00:11:57,273:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 0: adhoc - SUM(105_EP01b_Malaria_Total)
2025-12-07 00:11:57,273:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 0: adhoc - SUM(105_EP01b_Malaria_Total)
2025-12-07 00:11:57,273:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105_EP01b_Malaria_Total)
2025-12-07 00:11:57,273:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105_EP01b_Malaria_Total)
2025-12-07 00:11:57,273:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 1: adhoc - SUM(105_EP01a_Suspected_fever)
2025-12-07 00:11:57,273:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 1: adhoc - SUM(105_EP01a_Suspected_fever)
2025-12-07 00:11:57,273:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105_EP01a_Suspected_fever)
2025-12-07 00:11:57,274:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105_EP01a_Suspected_fever)
2025-12-07 00:11:57,274:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 2: adhoc - SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)
2025-12-07 00:11:57,274:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 2: adhoc - SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)
2025-12-07 00:11:57,274:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)
2025-12-07 00:11:57,274:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)
2025-12-07 00:11:57,274:ERROR:superset.models.helpers:[METRICS-TRACE] Total metrics added: 3
2025-12-07 00:11:57,274:ERROR:superset.models.helpers:[METRICS-TRACE] Total metrics added: 3
2025-12-07 00:11:57,275:ERROR:superset.models.helpers:[METRICS-TRACE] Before dedup: 2 select_exprs + 3 metrics_exprs
2025-12-07 00:11:57,276:ERROR:superset.models.helpers:[METRICS-TRACE] Before dedup: 2 select_exprs + 3 metrics_exprs
2025-12-07 00:11:57,276:ERROR:superset.models.helpers:[METRICS-TRACE] After dedup: 5 total select_exprs
2025-12-07 00:11:57,276:ERROR:superset.models.helpers:[METRICS-TRACE] After dedup: 5 total select_exprs
2025-12-07 00:11:57,276:INFO:superset.models.helpers:[COLUMN_TRACE] SQL Query Building:
2025-12-07 00:11:57,276:INFO:superset.models.helpers:[COLUMN_TRACE] SQL Query Building:
2025-12-07 00:11:57,276:INFO:superset.models.helpers:[COLUMN_TRACE]   columns: [{'columnType': 'BASE_AXIS', 'sqlExpression': 'Period', 'label': 'Period', 'expressionType': 'SQL'}, 'OrgUnit']
2025-12-07 00:11:57,276:INFO:superset.models.helpers:[COLUMN_TRACE]   columns: [{'columnType': 'BASE_AXIS', 'sqlExpression': 'Period', 'label': 'Period', 'expressionType': 'SQL'}, 'OrgUnit']
2025-12-07 00:11:57,276:INFO:superset.models.helpers:[COLUMN_TRACE]   metrics: [{'expressionType': 'SIMPLE', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01b_Malaria_Total', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 3, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'INT', 'type_generic': 0, 'uuid': '959bffaa-826b-4d13-8b7b-6d9c4ea25e50', 'verbose_name': None, 'warning_markdown': None}, 'aggregate': 'SUM', 'sqlExpression': None, 'datasourceWarning': False, 'hasCustomLabel': False, 'label': 'SUM(105_EP01b_Malaria_Total)', 'optionName': 'metric_rijuz4v684b_kbbrt3pcls'}, {'expressionType': 'SIMPLE', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01a_Suspected_fever', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 4, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'INT', 'type_generic': 0, 'uuid': '530216fe-7198-4b8e-b688-a479bcf67426', 'verbose_name': None, 'warning_markdown': None}, 'aggregate': 'SUM', 'sqlExpression': None, 'datasourceWarning': False, 'hasCustomLabel': False, 'label': 'SUM(105_EP01a_Suspected_fever)', 'optionName': 'metric_5gtlefdsr9c_djmh28d3f6t'}, {'expressionType': 'SIMPLE', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 6, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'column', 'type_generic': 0, 'uuid': '928946a1-6cea-4202-b8d6-0683414af79e', 'verbose_name': None, 'warning_markdown': None}, 'aggregate': 'SUM', 'sqlExpression': None, 'datasourceWarning': False, 'hasCustomLabel': False, 'label': 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', 'optionName': 'metric_rdoppiznv9_9n74otcax28'}]
2025-12-07 00:11:57,276:INFO:superset.models.helpers:[COLUMN_TRACE]   metrics: [{'expressionType': 'SIMPLE', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01b_Malaria_Total', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 3, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'INT', 'type_generic': 0, 'uuid': '959bffaa-826b-4d13-8b7b-6d9c4ea25e50', 'verbose_name': None, 'warning_markdown': None}, 'aggregate': 'SUM', 'sqlExpression': None, 'datasourceWarning': False, 'hasCustomLabel': False, 'label': 'SUM(105_EP01b_Malaria_Total)', 'optionName': 'metric_rijuz4v684b_kbbrt3pcls'}, {'expressionType': 'SIMPLE', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01a_Suspected_fever', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 4, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'INT', 'type_generic': 0, 'uuid': '530216fe-7198-4b8e-b688-a479bcf67426', 'verbose_name': None, 'warning_markdown': None}, 'aggregate': 'SUM', 'sqlExpression': None, 'datasourceWarning': False, 'hasCustomLabel': False, 'label': 'SUM(105_EP01a_Suspected_fever)', 'optionName': 'metric_5gtlefdsr9c_djmh28d3f6t'}, {'expressionType': 'SIMPLE', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 6, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'column', 'type_generic': 0, 'uuid': '928946a1-6cea-4202-b8d6-0683414af79e', 'verbose_name': None, 'warning_markdown': None}, 'aggregate': 'SUM', 'sqlExpression': None, 'datasourceWarning': False, 'hasCustomLabel': False, 'label': 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', 'optionName': 'metric_rdoppiznv9_9n74otcax28'}]
2025-12-07 00:11:57,276:INFO:superset.models.helpers:[COLUMN_TRACE]   groupby: []
2025-12-07 00:11:57,276:INFO:superset.models.helpers:[COLUMN_TRACE]   groupby: []
2025-12-07 00:11:57,276:INFO:superset.models.helpers:[COLUMN_TRACE]   labels_expected: ['Period', 'OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)']
2025-12-07 00:11:57,276:INFO:superset.models.helpers:[COLUMN_TRACE]   labels_expected: ['Period', 'OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)']
2025-12-07 00:11:57,276:INFO:superset.models.helpers:[COLUMN_TRACE]   select_exprs count: 5
2025-12-07 00:11:57,276:INFO:superset.models.helpers:[COLUMN_TRACE]   select_exprs count: 5
2025-12-07 00:11:57,276:INFO:superset.models.helpers:[COLUMN_TRACE]     [0] key=Period, name=Period, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-07 00:11:57,276:INFO:superset.models.helpers:[COLUMN_TRACE]     [0] key=Period, name=Period, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-07 00:11:57,276:INFO:superset.models.helpers:[COLUMN_TRACE]     [1] key=OrgUnit, name=OrgUnit, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-07 00:11:57,277:INFO:superset.models.helpers:[COLUMN_TRACE]     [1] key=OrgUnit, name=OrgUnit, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-07 00:11:57,277:INFO:superset.models.helpers:[COLUMN_TRACE]     [2] key=SUM(105_EP01b_Malaria_Total), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-07 00:11:57,277:INFO:superset.models.helpers:[COLUMN_TRACE]     [2] key=SUM(105_EP01b_Malaria_Total), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-07 00:11:57,277:INFO:superset.models.helpers:[COLUMN_TRACE]     [3] key=SUM(105_EP01a_Suspected_fever), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-07 00:11:57,277:INFO:superset.models.helpers:[COLUMN_TRACE]     [3] key=SUM(105_EP01a_Suspected_fever), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-07 00:11:57,277:INFO:superset.models.helpers:[COLUMN_TRACE]     [4] key=SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-07 00:11:57,277:INFO:superset.models.helpers:[COLUMN_TRACE]     [4] key=SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-07 00:11:57,277:INFO:superset.connectors.sqla.models:[DHIS2] get_from_clause for virtual dataset 1: analytics_LAST_YEAR_20251206
2025-12-07 00:11:57,277:INFO:superset.connectors.sqla.models:[DHIS2] get_from_clause for virtual dataset 1: analytics_LAST_YEAR_20251206
2025-12-07 00:11:57,277:INFO:superset.connectors.sqla.models:[DHIS2] Full SQL stored: SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
2025-12-07 00:11:57,277:INFO:superset.connectors.sqla.models:[DHIS2] Full SQL stored: SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
2025-12-07 00:11:57,277:INFO:superset.connectors.sqla.models:[DHIS2] Loaded params from extra field: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayPropert
2025-12-07 00:11:57,277:INFO:superset.connectors.sqla.models:[DHIS2] Loaded params from extra field: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayPropert
2025-12-07 00:11:57,278:INFO:superset.connectors.sqla.models:[DHIS2] Cached params with key: dhis2_params_1_analytics
2025-12-07 00:11:57,278:INFO:superset.connectors.sqla.models:[DHIS2] Stored params in Flask g for DHIS2 table: analytics
2025-12-07 00:11:57,278:INFO:superset.connectors.sqla.models:[DHIS2] Cached params with key: dhis2_params_1_analytics
2025-12-07 00:11:57,279:INFO:superset.connectors.sqla.models:[DHIS2] Stored params in Flask g for DHIS2 table: analytics
2025-12-07 00:11:57,280:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Query execution in connectors/sqla/models.py:
2025-12-07 00:11:57,281:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   SQL (first 500 chars): SELECT "Period", "OrgUnit", sum("105_EP01b_Malaria_Total") AS sum_1, sum("105_EP01a_Suspected_fever") AS sum_2, sum("105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive") AS sum_3 
FROM (SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
) AS virtual_table GROUP BY "Period", "OrgUnit" ORDER BY sum("105_EP01b_Malaria_Total") DESC
 LIMIT 10000
2025-12-07 00:11:57,281:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Query execution in connectors/sqla/models.py:
2025-12-07 00:11:57,281:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   labels_expected: ['Period', 'OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)']
2025-12-07 00:11:57,281:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   SQL (first 500 chars): SELECT "Period", "OrgUnit", sum("105_EP01b_Malaria_Total") AS sum_1, sum("105_EP01a_Suspected_fever") AS sum_2, sum("105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive") AS sum_3 
FROM (SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
) AS virtual_table GROUP BY "Period", "OrgUnit" ORDER BY sum("105_EP01b_Malaria_Total") DESC
 LIMIT 10000
2025-12-07 00:11:57,282:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   labels_expected: ['Period', 'OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)']
2025-12-07 00:11:57,282:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 connection initialized: https://tests.dhis2.hispuganda.org/hmis/api
2025-12-07 00:11:57,284:INFO:superset.db_engine_specs.dhis2_dialect:Executing DHIS2 query: SELECT
  "Period",
  "OrgUnit",
  SUM("105_EP01b_Malaria_Total") AS sum_1,
  SUM("105_EP01a_Suspected_fever") AS sum_2,
  SUM("105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive") AS sum_3
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "Period",
  "OrgUnit"
ORDER BY
  SUM("105_EP01b_Malaria_Total") DESC
LIMIT 10000
2025-12-07 00:11:57,284:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 connection initialized: https://tests.dhis2.hispuganda.org/hmis/api
2025-12-07 00:11:57,284:INFO:superset.db_engine_specs.dhis2_dialect:Parsed endpoint: analytics
2025-12-07 00:11:57,284:INFO:superset.db_engine_specs.dhis2_dialect:Executing DHIS2 query: SELECT
  "Period",
  "OrgUnit",
  SUM("105_EP01b_Malaria_Total") AS sum_1,
  SUM("105_EP01a_Suspected_fever") AS sum_2,
  SUM("105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive") AS sum_3
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "Period",
  "OrgUnit"
ORDER BY
  SUM("105_EP01b_Malaria_Total") DESC
LIMIT 10000
2025-12-07 00:11:57,285:INFO:superset.db_engine_specs.dhis2_dialect:Using stored parameters from Flask g for table: analytics
2025-12-07 00:11:57,285:INFO:superset.db_engine_specs.dhis2_dialect:Parsed endpoint: analytics
2025-12-07 00:11:57,285:INFO:superset.db_engine_specs.dhis2_dialect:Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}

[DHIS2] Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
[DHIS2] Found params in Flask g for analytics: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;
[DHIS2] Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
[DHIS2] Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
[DHIS2] API request URL: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
[DHIS2] Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
[DHIS2] API request URL: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
[DHIS2] Raw API response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Raw DHIS2 rows count: 16
[DHIS2] First raw row: ['QHnwKs2OUZv', '2020', 'akV6429SUqu', '15266488']
[DHIS2] Parsing response for endpoint: analytics
[DHIS2] Response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Response sample: {'headers': [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}], 'metaDat
[DHIS2] Using WIDE/PIVOTED format (Period, OrgUnit, DX1, DX2, ...) for analytics
[DHIS2] normalize_analytics: pivot=True, using WIDE/PIVOTED format
[DHIS2] PIVOT CONSTRUCTION:
[DHIS2]   data_elements (UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   data_element_list (sorted UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   col_names (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized row count: 4
[DHIS2] First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] _set_description: columns=['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], types=['String', 'String', 'String', 'String', 'String', 'String']
[DHIS2] Transformed rows count: 4
[DHIS2] First transformed row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] Fetched 4 rows
[DHIS2] fetchall() called - returning 4 rows
[DHIS2] fetchall() - First row type: <class 'tuple'>
[DHIS2] fetchall() - First row (original): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Column count from description: 6
[DHIS2] fetchall() - First row (fixed types): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Type enforcement: dimensions=STRING, measures=FLOAT
[DHIS2] Raw API response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Raw DHIS2 rows count: 16
[DHIS2] First raw row: ['QHnwKs2OUZv', '2020', 'akV6429SUqu', '15266488']
[DHIS2] Parsing response for endpoint: analytics
[DHIS2] Response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Response sample: {'headers': [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}], 'metaDat
[DHIS2] Using WIDE/PIVOTED format (Period, OrgUnit, DX1, DX2, ...) for analytics
[DHIS2] normalize_analytics: pivot=True, using WIDE/PIVOTED format
[DHIS2] PIVOT CONSTRUCTION:
[DHIS2]   data_elements (UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   data_element_list (sorted UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   col_names (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized row count: 4
[DHIS2] First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] _set_description: columns=['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], types=['String', 'String', 'String', 'String', 'String', 'String']
[DHIS2] Transformed rows count: 4
[DHIS2] First transformed row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] Fetched 4 rows
[DHIS2] fetchall() called - returning 4 rows
[DHIS2] fetchall() - First row type: <class 'tuple'>
[DHIS2] fetchall() - First row (original): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Column count from description: 6
[DHIS2] fetchall() - First row (fixed types): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Type enforcement: dimensions=STRING, measures=FLOAT
[DHIS2] Executing query: SELECT
  "Period",
  "OrgUnit",
  SUM("105_EP01b_Malaria_Total") AS sum_1,
  SUM("105_EP01a_Suspected_fever") AS sum_2,
  SUM("105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive") AS sum_3
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "Period",
  "OrgUnit"
ORDER BY
  SUM("105_EP01b_Malaria_Total") DESC
LIMIT 10000
[DHIS2] Parsed endpoint: analytics
[DHIS2] Executing query: SELECT
  "Period",
  "OrgUnit",
  SUM("105_EP01b_Malaria_Total") AS sum_1,
  SUM("105_EP01a_Suspected_fever") AS sum_2,
  SUM("105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive") AS sum_3
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "Period",
  "OrgUnit"
ORDER BY
  SUM("105_EP01b_Malaria_Total") DESC
LIMIT 10000
[DHIS2] Found params in Flask g for analytics: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;
[DHIS2] Parsed endpoint: analytics
[DHIS2] Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
[DHIS2] Found params in Flask g for analytics: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;
[DHIS2] Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}2025-12-07 00:11:57,285:INFO:superset.db_engine_specs.dhis2_dialect:Using stored parameters from Flask g for table: analytics
2025-12-07 00:11:57,285:INFO:superset.db_engine_specs.dhis2_dialect:Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
2025-12-07 00:11:57,285:INFO:superset.db_engine_specs.dhis2_dialect:Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
2025-12-07 00:11:57,285:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API request: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
2025-12-07 00:11:57,285:INFO:superset.db_engine_specs.dhis2_dialect:Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
2025-12-07 00:11:57,285:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API request: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
2025-12-07 00:11:58,184:INFO:superset.db_engine_specs.dhis2_dialect:Using wide/pivoted format for analytics
2025-12-07 00:11:58,184:INFO:superset.db_engine_specs.dhis2_dialect:normalize_analytics called with pivot=True, returning WIDE format
2025-12-07 00:11:58,184:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column construction - data_elements: ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
2025-12-07 00:11:58,184:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column names constructed (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-07 00:11:58,184:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] FIRST ROW CONSTRUCTION:
2025-12-07 00:11:58,184:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   Period (index 0): 2020
2025-12-07 00:11:58,184:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   OrgUnit (index 1): MOH - Uganda
2025-12-07 00:11:58,184:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01b. Malaria Total (index 2): 14479324
2025-12-07 00:11:58,184:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01a. Suspected fever (index 3): 22994823
2025-12-07 00:11:58,184:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01d. Malaria cases treated (index 4): 15266488
2025-12-07 00:11:58,184:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01c. Malaria Confirmed (B/s and RDT Positive) (index 5): 13326277
2025-12-07 00:11:58,184:INFO:superset.db_engine_specs.dhis2_dialect:First pivoted row - Period: '2020', OrgUnit: 'MOH - Uganda'
2025-12-07 00:11:58,184:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total pivoted rows: 4, columns: 6
2025-12-07 00:11:58,185:INFO:superset.db_engine_specs.dhis2_dialect:Normalized 4 rows with 6 columns for endpoint analytics
2025-12-07 00:11:58,185:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API returned 4 rows
2025-12-07 00:11:58,191:INFO:superset.db_engine_specs.dhis2_dialect:Using wide/pivoted format for analytics
2025-12-07 00:11:58,191:INFO:superset.db_engine_specs.dhis2_dialect:normalize_analytics called with pivot=True, returning WIDE format
2025-12-07 00:11:58,191:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() - Row count: 4
2025-12-07 00:11:58,191:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column construction - data_elements: ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
2025-12-07 00:11:58,191:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-07 00:11:58,191:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column names constructed (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-07 00:11:58,191:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names length: 6
2025-12-07 00:11:58,191:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] FIRST ROW CONSTRUCTION:
2025-12-07 00:11:58,192:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values count: 6
2025-12-07 00:11:58,192:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   Period (index 0): 2020
2025-12-07 00:11:58,192:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-07 00:11:58,192:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   OrgUnit (index 1): MOH - Uganda
2025-12-07 00:11:58,192:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 0 (Period): 2020 -> 2020 (STRING)
2025-12-07 00:11:58,192:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01b. Malaria Total (index 2): 14479324
2025-12-07 00:11:58,192:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (OrgUnit): MOH - Uganda -> MOH - Uganda (STRING)
2025-12-07 00:11:58,192:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01a. Suspected fever (index 3): 22994823
2025-12-07 00:11:58,192:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (105_EP01b_Malaria_Total): 14479324 (PROCESSED)
2025-12-07 00:11:58,192:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01d. Malaria cases treated (index 4): 15266488
2025-12-07 00:11:58,192:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (105_EP01a_Suspected_fever): 22994823 (PROCESSED)
2025-12-07 00:11:58,192:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01c. Malaria Confirmed (B/s and RDT Positive) (index 5): 13326277
2025-12-07 00:11:58,192:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (105_EP01d_Malaria_cases_treated): 15266488 (PROCESSED)
2025-12-07 00:11:58,192:INFO:superset.db_engine_specs.dhis2_dialect:First pivoted row - Period: '2020', OrgUnit: 'MOH - Uganda'
2025-12-07 00:11:58,192:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() returning 4 rows with 6 columns each
2025-12-07 00:11:58,192:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total pivoted rows: 4, columns: 6
2025-12-07 00:11:58,192:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Got 4 rows from cursor
2025-12-07 00:11:58,192:INFO:superset.db_engine_specs.dhis2_dialect:Normalized 4 rows with 6 columns for endpoint analytics
2025-12-07 00:11:58,192:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-07 00:11:58,192:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API returned 4 rows
2025-12-07 00:11:58,192:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-07 00:11:58,192:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Types from cursor: ['String', 'String', 'String', 'String', 'String', 'String']
2025-12-07 00:11:58,193:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: DataFrame created with 4 rows, 6 columns
2025-12-07 00:11:58,193:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-07 00:11:58,194:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes BEFORE fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-07 00:11:58,194:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Period' to object dtype (dimension)
2025-12-07 00:11:58,194:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'OrgUnit' to object dtype (dimension)
2025-12-07 00:11:58,194:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes AFTER fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-07 00:11:58,194:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: First row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-07 00:11:58,197:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() - Row count: 4
2025-12-07 00:11:58,197:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-07 00:11:58,197:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names length: 6
2025-12-07 00:11:58,197:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values count: 6
2025-12-07 00:11:58,197:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-07 00:11:58,197:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 0 (Period): 2020 -> 2020 (STRING)
2025-12-07 00:11:58,197:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (OrgUnit): MOH - Uganda -> MOH - Uganda (STRING)
2025-12-07 00:11:58,197:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (105_EP01b_Malaria_Total): 14479324 (PROCESSED)
2025-12-07 00:11:58,197:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (105_EP01a_Suspected_fever): 22994823 (PROCESSED)
2025-12-07 00:11:58,197:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (105_EP01d_Malaria_cases_treated): 15266488 (PROCESSED)
2025-12-07 00:11:58,197:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() returning 4 rows with 6 columns each
2025-12-07 00:11:58,197:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Got 4 rows from cursor
2025-12-07 00:11:58,197:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-07 00:11:58,197:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-07 00:11:58,197:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Types from cursor: ['String', 'String', 'String', 'String', 'String', 'String']
2025-12-07 00:11:58,198:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] BEFORE assign_column_label:
2025-12-07 00:11:58,198:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 6)
2025-12-07 00:11:58,198:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-07 00:11:58,198:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: DataFrame created with 4 rows, 6 columns
2025-12-07 00:11:58,198:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['Period', 'OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)']
2025-12-07 00:11:58,198:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-07 00:11:58,198:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: False
2025-12-07 00:11:58,198:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes BEFORE fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-07 00:11:58,198:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-07 00:11:58,198:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Period' to object dtype (dimension)
2025-12-07 00:11:58,198:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Column truncation needed: df has 6 columns, expected 5
2025-12-07 00:11:58,199:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'OrgUnit' to object dtype (dimension)
2025-12-07 00:11:58,199:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   DataFrame actual columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-07 00:11:58,199:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes AFTER fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-07 00:11:58,199:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Expected columns: ['Period', 'OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)']
2025-12-07 00:11:58,199:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: First row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-07 00:11:58,199:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] âœ“ Selecting columns BY NAME (matched all expected columns)
2025-12-07 00:11:58,199:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Column mapping: {'Period': 'Period', 'OrgUnit': 'OrgUnit', 'SUM(105_EP01b_Malaria_Total)': '105_EP01b_Malaria_Total', 'SUM(105_EP01a_Suspected_fever)': '105_EP01a_Suspected_fever', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)': '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'}
2025-12-07 00:11:58,199:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] Column Selection âœ“ SUCCESS - method=BY_NAME, datasource=analytics_LAST_YEAR_20251206
2025-12-07 00:11:58,200:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)']
2025-12-07 00:11:58,200:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   tried_by_name=True, success=True, fallback=False
2025-12-07 00:11:58,200:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Assigning column labels: ['Period', 'OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)']
2025-12-07 00:11:58,200:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] AFTER assign_column_label:
2025-12-07 00:11:58,200:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 5)
2025-12-07 00:11:58,200:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)']
2025-12-07 00:11:58,200:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['Period', 'OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)']
2025-12-07 00:11:58,200:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: True
2025-12-07 00:11:58,200:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', 'SUM(105_EP01b_Malaria_Total)': 14479324, 'SUM(105_EP01a_Suspected_fever)': 22994823, 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)': 13326277}
2025-12-07 00:11:58,202:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] DataFrame columns: ['Period', 'OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)']
2025-12-07 00:11:58,203:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Aggregates: {'SUM(105_EP01b_Malaria_Total)': {'operator': 'mean'}, 'SUM(105_EP01a_Suspected_fever)': {'operator': 'mean'}, 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)': {'operator': 'mean'}}
2025-12-07 00:11:58,203:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105_EP01b_Malaria_Total)', column='SUM(105_EP01b_Malaria_Total)'
2025-12-07 00:11:58,203:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105_EP01a_Suspected_fever)', column='SUM(105_EP01a_Suspected_fever)'
2025-12-07 00:11:58,204:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] BEFORE assign_column_label:
2025-12-07 00:11:58,204:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', column='SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)'
2025-12-07 00:11:58,204:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 6)
2025-12-07 00:11:58,207:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-07 00:11:58,207:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['Period', 'OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)']
2025-12-07 00:11:58,207:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: False
2025-12-07 00:11:58,207:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-07 00:11:58,208:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Column truncation needed: df has 6 columns, expected 5
2025-12-07 00:11:58,210:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   DataFrame actual columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-07 00:11:58,210:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Expected columns: ['Period', 'OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)']
2025-12-07 00:11:58,210:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] âœ“ Selecting columns BY NAME (matched all expected columns)
2025-12-07 00:11:58,210:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Column mapping: {'Period': 'Period', 'OrgUnit': 'OrgUnit', 'SUM(105_EP01b_Malaria_Total)': '105_EP01b_Malaria_Total', 'SUM(105_EP01a_Suspected_fever)': '105_EP01a_Suspected_fever', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)': '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'}
2025-12-07 00:11:58,211:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] Column Selection âœ“ SUCCESS - method=BY_NAME, datasource=analytics_LAST_YEAR_20251206
2025-12-07 00:11:58,211:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)']
2025-12-07 00:11:58,211:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   tried_by_name=True, success=True, fallback=False
2025-12-07 00:11:58,211:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Assigning column labels: ['Period', 'OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)']
2025-12-07 00:11:58,211:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] AFTER assign_column_label:
2025-12-07 00:11:58,211:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 5)
2025-12-07 00:11:58,211:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)']
2025-12-07 00:11:58,211:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['Period', 'OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)']
2025-12-07 00:11:58,211:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: True
2025-12-07 00:11:58,211:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', 'SUM(105_EP01b_Malaria_Total)': 14479324, 'SUM(105_EP01a_Suspected_fever)': 22994823, 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)': 13326277}
2025-12-07 00:11:58,213:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] DataFrame columns: ['Period', 'OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)']
2025-12-07 00:11:58,214:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Aggregates: {'SUM(105_EP01b_Malaria_Total)': {'operator': 'mean'}, 'SUM(105_EP01a_Suspected_fever)': {'operator': 'mean'}, 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)': {'operator': 'mean'}}
2025-12-07 00:11:58,214:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105_EP01b_Malaria_Total)', column='SUM(105_EP01b_Malaria_Total)'
2025-12-07 00:11:58,214:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105_EP01a_Suspected_fever)', column='SUM(105_EP01a_Suspected_fever)'
2025-12-07 00:11:58,214:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', column='SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)'
2025-12-07 00:11:58,236:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:11:58] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-07 00:11:58,239:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:11:58] "PUT /api/v1/explore/form_data/8IOeEEvQ8x4?tab_id=7 HTTP/1.1" 200 -
2025-12-07 00:11:58,241:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:11:58] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-07 00:11:59,248:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:11:59] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-07 00:12:05,477:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1458, in dispatch_request
    self.raise_routing_exception(req)
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1440, in raise_routing_exception
    raise request.routing_exception  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/ctx.py", line 353, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/werkzeug/routing/map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-12-07 00:12:05,478:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:12:05] "[33mGET /ws HTTP/1.1[0m" 404 -
2025-12-07 00:12:33,091:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1458, in dispatch_request
    self.raise_routing_exception(req)
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1440, in raise_routing_exception
    raise request.routing_exception  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/ctx.py", line 353, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/werkzeug/routing/map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-12-07 00:12:33,093:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:12:33] "[33mGET /ws HTTP/1.1[0m" 404 -
2025-12-07 00:14:11,430:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:14:11] "GET /api/v1/me/ HTTP/1.1" 200 -
2025-12-07 00:14:14,477:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1458, in dispatch_request
    self.raise_routing_exception(req)
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1440, in raise_routing_exception
    raise request.routing_exception  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/ctx.py", line 353, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/werkzeug/routing/map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-12-07 00:14:14,478:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:14:14] "[33mGET /ws HTTP/1.1[0m" 404 -
2025-12-07 00:14:23,099:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:14:23] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-07 00:14:29,559:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:14:29] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-07 00:14:33,678:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:14:33] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-07 00:14:34,715:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:14:34] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-07 00:14:35,127:ERROR:superset.models.helpers:[METRICS-TRACE] Processing 3 metrics
2025-12-07 00:14:35,127:ERROR:superset.models.helpers:[METRICS-TRACE] Processing 3 metrics
2025-12-07 00:14:35,127:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 0: adhoc - SUM(105_EP01b_Malaria_Total)
2025-12-07 00:14:35,128:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 0: adhoc - SUM(105_EP01b_Malaria_Total)
2025-12-07 00:14:35,128:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105_EP01b_Malaria_Total)
2025-12-07 00:14:35,128:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105_EP01b_Malaria_Total)
2025-12-07 00:14:35,128:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 1: adhoc - SUM(105_EP01a_Suspected_fever)
2025-12-07 00:14:35,128:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 1: adhoc - SUM(105_EP01a_Suspected_fever)
2025-12-07 00:14:35,128:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105_EP01a_Suspected_fever)
2025-12-07 00:14:35,129:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105_EP01a_Suspected_fever)
2025-12-07 00:14:35,129:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 2: adhoc - SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)
2025-12-07 00:14:35,129:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 2: adhoc - SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)
2025-12-07 00:14:35,129:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)
2025-12-07 00:14:35,129:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)
2025-12-07 00:14:35,129:ERROR:superset.models.helpers:[METRICS-TRACE] Total metrics added: 3
2025-12-07 00:14:35,129:ERROR:superset.models.helpers:[METRICS-TRACE] Total metrics added: 3
2025-12-07 00:14:35,132:ERROR:superset.models.helpers:[METRICS-TRACE] Before dedup: 2 select_exprs + 3 metrics_exprs
2025-12-07 00:14:35,133:ERROR:superset.models.helpers:[METRICS-TRACE] Before dedup: 2 select_exprs + 3 metrics_exprs
2025-12-07 00:14:35,133:ERROR:superset.models.helpers:[METRICS-TRACE] After dedup: 5 total select_exprs
2025-12-07 00:14:35,133:ERROR:superset.models.helpers:[METRICS-TRACE] After dedup: 5 total select_exprs
2025-12-07 00:14:35,133:INFO:superset.models.helpers:[COLUMN_TRACE] SQL Query Building:
2025-12-07 00:14:35,133:INFO:superset.models.helpers:[COLUMN_TRACE] SQL Query Building:
2025-12-07 00:14:35,133:INFO:superset.models.helpers:[COLUMN_TRACE]   columns: [{'columnType': 'BASE_AXIS', 'sqlExpression': 'OrgUnit', 'label': 'OrgUnit', 'expressionType': 'SQL'}, 'Period']
2025-12-07 00:14:35,133:INFO:superset.models.helpers:[COLUMN_TRACE]   columns: [{'columnType': 'BASE_AXIS', 'sqlExpression': 'OrgUnit', 'label': 'OrgUnit', 'expressionType': 'SQL'}, 'Period']
2025-12-07 00:14:35,133:INFO:superset.models.helpers:[COLUMN_TRACE]   metrics: [{'expressionType': 'SIMPLE', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01b_Malaria_Total', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 3, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'INT', 'type_generic': 0, 'uuid': '959bffaa-826b-4d13-8b7b-6d9c4ea25e50', 'verbose_name': None, 'warning_markdown': None}, 'aggregate': 'SUM', 'sqlExpression': None, 'datasourceWarning': False, 'hasCustomLabel': False, 'label': 'SUM(105_EP01b_Malaria_Total)', 'optionName': 'metric_rijuz4v684b_kbbrt3pcls'}, {'expressionType': 'SIMPLE', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01a_Suspected_fever', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 4, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'INT', 'type_generic': 0, 'uuid': '530216fe-7198-4b8e-b688-a479bcf67426', 'verbose_name': None, 'warning_markdown': None}, 'aggregate': 'SUM', 'sqlExpression': None, 'datasourceWarning': False, 'hasCustomLabel': False, 'label': 'SUM(105_EP01a_Suspected_fever)', 'optionName': 'metric_5gtlefdsr9c_djmh28d3f6t'}, {'expressionType': 'SIMPLE', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 6, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'column', 'type_generic': 0, 'uuid': '928946a1-6cea-4202-b8d6-0683414af79e', 'verbose_name': None, 'warning_markdown': None}, 'aggregate': 'SUM', 'sqlExpression': None, 'datasourceWarning': False, 'hasCustomLabel': False, 'label': 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', 'optionName': 'metric_rdoppiznv9_9n74otcax28'}]
2025-12-07 00:14:35,133:INFO:superset.models.helpers:[COLUMN_TRACE]   metrics: [{'expressionType': 'SIMPLE', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01b_Malaria_Total', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 3, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'INT', 'type_generic': 0, 'uuid': '959bffaa-826b-4d13-8b7b-6d9c4ea25e50', 'verbose_name': None, 'warning_markdown': None}, 'aggregate': 'SUM', 'sqlExpression': None, 'datasourceWarning': False, 'hasCustomLabel': False, 'label': 'SUM(105_EP01b_Malaria_Total)', 'optionName': 'metric_rijuz4v684b_kbbrt3pcls'}, {'expressionType': 'SIMPLE', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01a_Suspected_fever', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 4, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'INT', 'type_generic': 0, 'uuid': '530216fe-7198-4b8e-b688-a479bcf67426', 'verbose_name': None, 'warning_markdown': None}, 'aggregate': 'SUM', 'sqlExpression': None, 'datasourceWarning': False, 'hasCustomLabel': False, 'label': 'SUM(105_EP01a_Suspected_fever)', 'optionName': 'metric_5gtlefdsr9c_djmh28d3f6t'}, {'expressionType': 'SIMPLE', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 6, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'column', 'type_generic': 0, 'uuid': '928946a1-6cea-4202-b8d6-0683414af79e', 'verbose_name': None, 'warning_markdown': None}, 'aggregate': 'SUM', 'sqlExpression': None, 'datasourceWarning': False, 'hasCustomLabel': False, 'label': 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', 'optionName': 'metric_rdoppiznv9_9n74otcax28'}]
2025-12-07 00:14:35,133:INFO:superset.models.helpers:[COLUMN_TRACE]   groupby: []
2025-12-07 00:14:35,133:INFO:superset.models.helpers:[COLUMN_TRACE]   groupby: []
2025-12-07 00:14:35,133:INFO:superset.models.helpers:[COLUMN_TRACE]   labels_expected: ['OrgUnit', 'Period', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)']
2025-12-07 00:14:35,133:INFO:superset.models.helpers:[COLUMN_TRACE]   labels_expected: ['OrgUnit', 'Period', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)']
2025-12-07 00:14:35,133:INFO:superset.models.helpers:[COLUMN_TRACE]   select_exprs count: 5
2025-12-07 00:14:35,133:INFO:superset.models.helpers:[COLUMN_TRACE]   select_exprs count: 5
2025-12-07 00:14:35,133:INFO:superset.models.helpers:[COLUMN_TRACE]     [0] key=OrgUnit, name=OrgUnit, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-07 00:14:35,133:INFO:superset.models.helpers:[COLUMN_TRACE]     [0] key=OrgUnit, name=OrgUnit, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-07 00:14:35,133:INFO:superset.models.helpers:[COLUMN_TRACE]     [1] key=Period, name=Period, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-07 00:14:35,133:INFO:superset.models.helpers:[COLUMN_TRACE]     [1] key=Period, name=Period, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-07 00:14:35,133:INFO:superset.models.helpers:[COLUMN_TRACE]     [2] key=SUM(105_EP01b_Malaria_Total), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-07 00:14:35,133:INFO:superset.models.helpers:[COLUMN_TRACE]     [2] key=SUM(105_EP01b_Malaria_Total), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-07 00:14:35,133:INFO:superset.models.helpers:[COLUMN_TRACE]     [3] key=SUM(105_EP01a_Suspected_fever), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-07 00:14:35,134:INFO:superset.models.helpers:[COLUMN_TRACE]     [4] key=SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-07 00:14:35,134:INFO:superset.connectors.sqla.models:[DHIS2] get_from_clause for virtual dataset 1: analytics_LAST_YEAR_20251206
2025-12-07 00:14:35,133:INFO:superset.models.helpers:[COLUMN_TRACE]     [3] key=SUM(105_EP01a_Suspected_fever), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-07 00:14:35,134:INFO:superset.connectors.sqla.models:[DHIS2] Full SQL stored: SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
2025-12-07 00:14:35,134:INFO:superset.models.helpers:[COLUMN_TRACE]     [4] key=SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-07 00:14:35,134:INFO:superset.connectors.sqla.models:[DHIS2] Loaded params from extra field: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayPropert
2025-12-07 00:14:35,134:INFO:superset.connectors.sqla.models:[DHIS2] get_from_clause for virtual dataset 1: analytics_LAST_YEAR_20251206
2025-12-07 00:14:35,134:INFO:superset.connectors.sqla.models:[DHIS2] Full SQL stored: SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
2025-12-07 00:14:35,134:INFO:superset.connectors.sqla.models:[DHIS2] Loaded params from extra field: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayPropert
2025-12-07 00:14:35,135:INFO:superset.connectors.sqla.models:[DHIS2] Cached params with key: dhis2_params_1_analytics
2025-12-07 00:14:35,135:INFO:superset.connectors.sqla.models:[DHIS2] Stored params in Flask g for DHIS2 table: analytics
2025-12-07 00:14:35,138:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Query execution in connectors/sqla/models.py:
2025-12-07 00:14:35,138:INFO:superset.connectors.sqla.models:[DHIS2] Cached params with key: dhis2_params_1_analytics
2025-12-07 00:14:35,138:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   SQL (first 500 chars): SELECT "OrgUnit", "Period", sum("105_EP01b_Malaria_Total") AS sum_1, sum("105_EP01a_Suspected_fever") AS sum_2, sum("105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive") AS sum_3 
FROM (SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
) AS virtual_table GROUP BY "OrgUnit", "Period" ORDER BY sum("105_EP01b_Malaria_Total") DESC
 LIMIT 10000
2025-12-07 00:14:35,139:INFO:superset.connectors.sqla.models:[DHIS2] Stored params in Flask g for DHIS2 table: analytics
2025-12-07 00:14:35,139:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   labels_expected: ['OrgUnit', 'Period', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)']
2025-12-07 00:14:35,141:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Query execution in connectors/sqla/models.py:
2025-12-07 00:14:35,141:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   SQL (first 500 chars): SELECT "OrgUnit", "Period", sum("105_EP01b_Malaria_Total") AS sum_1, sum("105_EP01a_Suspected_fever") AS sum_2, sum("105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive") AS sum_3 
FROM (SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
) AS virtual_table GROUP BY "OrgUnit", "Period" ORDER BY sum("105_EP01b_Malaria_Total") DESC
 LIMIT 10000
2025-12-07 00:14:35,141:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   labels_expected: ['OrgUnit', 'Period', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)']
2025-12-07 00:14:35,143:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 connection initialized: https://tests.dhis2.hispuganda.org/hmis/api
2025-12-07 00:14:35,144:INFO:superset.db_engine_specs.dhis2_dialect:Executing DHIS2 query: SELECT
  "OrgUnit",
  "Period",
  SUM("105_EP01b_Malaria_Total") AS sum_1,
  SUM("105_EP01a_Suspected_fever") AS sum_2,
  SUM("105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive") AS sum_3
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "OrgUnit",
  "Period"
ORDER BY
  SUM("105_EP01b_Malaria_Total") DESC
LIMIT 10000
2025-12-07 00:14:35,144:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 connection initialized: https://tests.dhis2.hispuganda.org/hmis/api
2025-12-07 00:14:35,144:INFO:superset.db_engine_specs.dhis2_dialect:Parsed endpoint: analytics
2025-12-07 00:14:35,145:INFO:superset.db_engine_specs.dhis2_dialect:Executing DHIS2 query: SELECT
  "OrgUnit",
  "Period",
  SUM("105_EP01b_Malaria_Total") AS sum_1,
  SUM("105_EP01a_Suspected_fever") AS sum_2,
  SUM("105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive") AS sum_3
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "OrgUnit",
  "Period"
ORDER BY
  SUM("105_EP01b_Malaria_Total") DESC
LIMIT 10000
2025-12-07 00:14:35,145:INFO:superset.db_engine_specs.dhis2_dialect:Using stored parameters from Flask g for table: analytics
2025-12-07 00:14:35,145:INFO:superset.db_engine_specs.dhis2_dialect:Parsed endpoint: analytics
2025-12-07 00:14:35,145:INFO:superset.db_engine_specs.dhis2_dialect:Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
2025-12-07 00:14:35,145:INFO:superset.db_engine_specs.dhis2_dialect:Using stored parameters from Flask g for table: analytics
2025-12-07 00:14:35,145:INFO:superset.db_engine_specs.dhis2_dialect:Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}

[DHIS2] Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
[DHIS2] API request URL: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
[DHIS2] Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
[DHIS2] API request URL: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
[DHIS2] Raw API response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Raw DHIS2 rows count: 16
[DHIS2] First raw row: ['QHnwKs2OUZv', '2020', 'akV6429SUqu', '15266488']
[DHIS2] Parsing response for endpoint: analytics
[DHIS2] Response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Response sample: {'headers': [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}], 'metaDat
[DHIS2] Using WIDE/PIVOTED format (Period, OrgUnit, DX1, DX2, ...) for analytics
[DHIS2] normalize_analytics: pivot=True, using WIDE/PIVOTED format
[DHIS2] PIVOT CONSTRUCTION:
[DHIS2]   data_elements (UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   data_element_list (sorted UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   col_names (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized row count: 4
[DHIS2] First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] _set_description: columns=['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], types=['String', 'String', 'String', 'String', 'String', 'String']
[DHIS2] Transformed rows count: 4
[DHIS2] First transformed row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] Fetched 4 rows
[DHIS2] Raw API response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Raw DHIS2 rows count: 16
[DHIS2] First raw row: ['QHnwKs2OUZv', '2020', 'akV6429SUqu', '15266488']
[DHIS2] Parsing response for endpoint: analytics
[DHIS2] Response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Response sample: {'headers': [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}], 'metaDat
[DHIS2] Using WIDE/PIVOTED format (Period, OrgUnit, DX1, DX2, ...) for analytics
[DHIS2] normalize_analytics: pivot=True, using WIDE/PIVOTED format
[DHIS2] fetchall() called - returning 4 rows
[DHIS2] PIVOT CONSTRUCTION:
[DHIS2]   data_elements (UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   data_element_list (sorted UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   col_names (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] fetchall() - First row type: <class 'tuple'>
[DHIS2] fetchall() - First row (original): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Column count from description: 6
[DHIS2] fetchall() - First row (fixed types): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Type enforcement: dimensions=STRING, measures=FLOAT
[DHIS2] Normalized columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized row count: 4
[DHIS2] First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] _set_description: columns=['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], types=['String', 'String', 'String', 'String', 'String', 'String']
[DHIS2] Transformed rows count: 4
[DHIS2] First transformed row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] Fetched 4 rows
[DHIS2] fetchall() called - returning 4 rows
[DHIS2] fetchall() - First row type: <class 'tuple'>
[DHIS2] fetchall() - First row (original): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Column count from description: 6
[DHIS2] fetchall() - First row (fixed types): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Type enforcement: dimensions=STRING, measures=FLOAT
[DHIS2] Executing query: SELECT
  "OrgUnit",
  "Period",
  SUM("105_EP01b_Malaria_Total") AS sum_1,
  SUM("105_EP01a_Suspected_fever") AS sum_2,
  SUM("105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive") AS sum_3
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "OrgUnit",
  "Period"
ORDER BY
  SUM("105_EP01b_Malaria_Total") DESC
LIMIT 10000
[DHIS2] Parsed endpoint: analytics
[DHIS2] Executing query: SELECT
  "OrgUnit",
  "Period",
  SUM("105_EP01b_Malaria_Total") AS sum_1,
  SUM("105_EP01a_Suspected_fever") AS sum_2,
  SUM("105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive") AS sum_3
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "OrgUnit",
  "Period"
ORDER BY
  SUM("105_EP01b_Malaria_Total") DESC
LIMIT 10000
[DHIS2] Found params in Flask g for analytics: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;
[DHIS2] Parsed endpoint: analytics
[DHIS2] Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
[DHIS2] Found params in Flask g for analytics: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;
[DHIS2] Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
[DHIS2] Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
[DHIS2] API request URL: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT2025-12-07 00:14:35,145:INFO:superset.db_engine_specs.dhis2_dialect:Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
2025-12-07 00:14:35,145:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API request: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
2025-12-07 00:14:35,145:INFO:superset.db_engine_specs.dhis2_dialect:Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
2025-12-07 00:14:35,146:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API request: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
2025-12-07 00:14:36,072:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:14:36] "PUT /api/v1/explore/form_data/8IOeEEvQ8x4?tab_id=7 HTTP/1.1" 200 -
2025-12-07 00:14:39,448:INFO:superset.db_engine_specs.dhis2_dialect:Using wide/pivoted format for analytics
2025-12-07 00:14:39,448:INFO:superset.db_engine_specs.dhis2_dialect:normalize_analytics called with pivot=True, returning WIDE format
2025-12-07 00:14:39,448:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column construction - data_elements: ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
2025-12-07 00:14:39,448:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column names constructed (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-07 00:14:39,448:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] FIRST ROW CONSTRUCTION:
2025-12-07 00:14:39,448:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   Period (index 0): 2020
2025-12-07 00:14:39,448:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   OrgUnit (index 1): MOH - Uganda
2025-12-07 00:14:39,448:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01b. Malaria Total (index 2): 14479324
2025-12-07 00:14:39,448:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01a. Suspected fever (index 3): 22994823
2025-12-07 00:14:39,448:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01d. Malaria cases treated (index 4): 15266488
2025-12-07 00:14:39,448:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01c. Malaria Confirmed (B/s and RDT Positive) (index 5): 13326277
2025-12-07 00:14:39,448:INFO:superset.db_engine_specs.dhis2_dialect:First pivoted row - Period: '2020', OrgUnit: 'MOH - Uganda'
2025-12-07 00:14:39,448:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total pivoted rows: 4, columns: 6
2025-12-07 00:14:39,448:INFO:superset.db_engine_specs.dhis2_dialect:Normalized 4 rows with 6 columns for endpoint analytics
2025-12-07 00:14:39,448:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API returned 4 rows
2025-12-07 00:14:39,451:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() - Row count: 4
2025-12-07 00:14:39,451:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-07 00:14:39,451:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names length: 6
2025-12-07 00:14:39,451:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values count: 6
2025-12-07 00:14:39,451:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-07 00:14:39,451:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 0 (Period): 2020 -> 2020 (STRING)
2025-12-07 00:14:39,451:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (OrgUnit): MOH - Uganda -> MOH - Uganda (STRING)
2025-12-07 00:14:39,451:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (105_EP01b_Malaria_Total): 14479324 (PROCESSED)
2025-12-07 00:14:39,451:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (105_EP01a_Suspected_fever): 22994823 (PROCESSED)
2025-12-07 00:14:39,451:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (105_EP01d_Malaria_cases_treated): 15266488 (PROCESSED)
2025-12-07 00:14:39,451:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() returning 4 rows with 6 columns each
2025-12-07 00:14:39,451:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Got 4 rows from cursor
2025-12-07 00:14:39,451:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-07 00:14:39,451:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-07 00:14:39,451:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Types from cursor: ['String', 'String', 'String', 'String', 'String', 'String']
2025-12-07 00:14:39,452:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: DataFrame created with 4 rows, 6 columns
2025-12-07 00:14:39,452:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-07 00:14:39,452:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes BEFORE fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-07 00:14:39,453:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Period' to object dtype (dimension)
2025-12-07 00:14:39,453:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'OrgUnit' to object dtype (dimension)
2025-12-07 00:14:39,453:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes AFTER fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-07 00:14:39,453:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: First row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-07 00:14:39,454:INFO:superset.db_engine_specs.dhis2_dialect:Using wide/pivoted format for analytics
2025-12-07 00:14:39,454:INFO:superset.db_engine_specs.dhis2_dialect:normalize_analytics called with pivot=True, returning WIDE format
2025-12-07 00:14:39,454:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column construction - data_elements: ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
2025-12-07 00:14:39,454:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column names constructed (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-07 00:14:39,454:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] FIRST ROW CONSTRUCTION:
2025-12-07 00:14:39,454:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   Period (index 0): 2020
2025-12-07 00:14:39,454:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   OrgUnit (index 1): MOH - Uganda
2025-12-07 00:14:39,454:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01b. Malaria Total (index 2): 14479324
2025-12-07 00:14:39,454:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01a. Suspected fever (index 3): 22994823
2025-12-07 00:14:39,454:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01d. Malaria cases treated (index 4): 15266488
2025-12-07 00:14:39,454:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01c. Malaria Confirmed (B/s and RDT Positive) (index 5): 13326277
2025-12-07 00:14:39,454:INFO:superset.db_engine_specs.dhis2_dialect:First pivoted row - Period: '2020', OrgUnit: 'MOH - Uganda'
2025-12-07 00:14:39,454:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total pivoted rows: 4, columns: 6
2025-12-07 00:14:39,454:INFO:superset.db_engine_specs.dhis2_dialect:Normalized 4 rows with 6 columns for endpoint analytics
2025-12-07 00:14:39,454:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API returned 4 rows
2025-12-07 00:14:39,457:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] BEFORE assign_column_label:
2025-12-07 00:14:39,457:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 6)
2025-12-07 00:14:39,457:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-07 00:14:39,457:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['OrgUnit', 'Period', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)']
2025-12-07 00:14:39,457:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: False
2025-12-07 00:14:39,457:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-07 00:14:39,457:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Column truncation needed: df has 6 columns, expected 5
2025-12-07 00:14:39,457:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   DataFrame actual columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-07 00:14:39,457:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Expected columns: ['OrgUnit', 'Period', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)']
2025-12-07 00:14:39,457:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] âœ“ Selecting columns BY NAME (matched all expected columns)
2025-12-07 00:14:39,457:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Column mapping: {'OrgUnit': 'OrgUnit', 'Period': 'Period', 'SUM(105_EP01b_Malaria_Total)': '105_EP01b_Malaria_Total', 'SUM(105_EP01a_Suspected_fever)': '105_EP01a_Suspected_fever', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)': '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'}
2025-12-07 00:14:39,458:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] Column Selection âœ“ SUCCESS - method=BY_NAME, datasource=analytics_LAST_YEAR_20251206
2025-12-07 00:14:39,458:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['OrgUnit', 'Period', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)']
2025-12-07 00:14:39,458:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   tried_by_name=True, success=True, fallback=False
2025-12-07 00:14:39,458:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Assigning column labels: ['OrgUnit', 'Period', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)']
2025-12-07 00:14:39,458:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] AFTER assign_column_label:
2025-12-07 00:14:39,458:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 5)
2025-12-07 00:14:39,458:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['OrgUnit', 'Period', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)']
2025-12-07 00:14:39,458:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['OrgUnit', 'Period', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)']
2025-12-07 00:14:39,458:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: True
2025-12-07 00:14:39,458:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'OrgUnit': 'MOH - Uganda', 'Period': '2020', 'SUM(105_EP01b_Malaria_Total)': 14479324, 'SUM(105_EP01a_Suspected_fever)': 22994823, 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)': 13326277}
2025-12-07 00:14:39,459:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() - Row count: 4
2025-12-07 00:14:39,460:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-07 00:14:39,460:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names length: 6
2025-12-07 00:14:39,460:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values count: 6
2025-12-07 00:14:39,460:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-07 00:14:39,461:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] DataFrame columns: ['OrgUnit', 'Period', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)']
2025-12-07 00:14:39,461:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 0 (Period): 2020 -> 2020 (STRING)
2025-12-07 00:14:39,461:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Aggregates: {'SUM(105_EP01b_Malaria_Total)': {'operator': 'mean'}, 'SUM(105_EP01a_Suspected_fever)': {'operator': 'mean'}, 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)': {'operator': 'mean'}}
2025-12-07 00:14:39,461:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (OrgUnit): MOH - Uganda -> MOH - Uganda (STRING)
2025-12-07 00:14:39,461:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105_EP01b_Malaria_Total)', column='SUM(105_EP01b_Malaria_Total)'
2025-12-07 00:14:39,461:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (105_EP01b_Malaria_Total): 14479324 (PROCESSED)
2025-12-07 00:14:39,461:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105_EP01a_Suspected_fever)', column='SUM(105_EP01a_Suspected_fever)'
2025-12-07 00:14:39,461:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (105_EP01a_Suspected_fever): 22994823 (PROCESSED)
2025-12-07 00:14:39,461:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', column='SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)'
2025-12-07 00:14:39,461:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (105_EP01d_Malaria_cases_treated): 15266488 (PROCESSED)
2025-12-07 00:14:39,464:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() returning 4 rows with 6 columns each
2025-12-07 00:14:39,465:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Got 4 rows from cursor
2025-12-07 00:14:39,465:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-07 00:14:39,465:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-07 00:14:39,465:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Types from cursor: ['String', 'String', 'String', 'String', 'String', 'String']
2025-12-07 00:14:39,466:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: DataFrame created with 4 rows, 6 columns
2025-12-07 00:14:39,466:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-07 00:14:39,466:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes BEFORE fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-07 00:14:39,466:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Period' to object dtype (dimension)
2025-12-07 00:14:39,466:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'OrgUnit' to object dtype (dimension)
2025-12-07 00:14:39,466:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes AFTER fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-07 00:14:39,466:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: First row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-07 00:14:39,469:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] BEFORE assign_column_label:
2025-12-07 00:14:39,469:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 6)
2025-12-07 00:14:39,469:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-07 00:14:39,469:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['OrgUnit', 'Period', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)']
2025-12-07 00:14:39,469:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: False
2025-12-07 00:14:39,469:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-07 00:14:39,469:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Column truncation needed: df has 6 columns, expected 5
2025-12-07 00:14:39,469:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   DataFrame actual columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-07 00:14:39,470:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Expected columns: ['OrgUnit', 'Period', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)']
2025-12-07 00:14:39,470:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] âœ“ Selecting columns BY NAME (matched all expected columns)
2025-12-07 00:14:39,470:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Column mapping: {'OrgUnit': 'OrgUnit', 'Period': 'Period', 'SUM(105_EP01b_Malaria_Total)': '105_EP01b_Malaria_Total', 'SUM(105_EP01a_Suspected_fever)': '105_EP01a_Suspected_fever', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)': '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'}
2025-12-07 00:14:39,470:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] Column Selection âœ“ SUCCESS - method=BY_NAME, datasource=analytics_LAST_YEAR_20251206
2025-12-07 00:14:39,470:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['OrgUnit', 'Period', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)']
2025-12-07 00:14:39,470:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   tried_by_name=True, success=True, fallback=False
2025-12-07 00:14:39,470:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Assigning column labels: ['OrgUnit', 'Period', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)']
2025-12-07 00:14:39,470:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] AFTER assign_column_label:
2025-12-07 00:14:39,470:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 5)
2025-12-07 00:14:39,470:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['OrgUnit', 'Period', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)']
2025-12-07 00:14:39,470:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['OrgUnit', 'Period', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)']
2025-12-07 00:14:39,470:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: True
2025-12-07 00:14:39,470:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'OrgUnit': 'MOH - Uganda', 'Period': '2020', 'SUM(105_EP01b_Malaria_Total)': 14479324, 'SUM(105_EP01a_Suspected_fever)': 22994823, 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)': 13326277}
2025-12-07 00:14:39,471:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] DataFrame columns: ['OrgUnit', 'Period', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)']
2025-12-07 00:14:39,472:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Aggregates: {'SUM(105_EP01b_Malaria_Total)': {'operator': 'mean'}, 'SUM(105_EP01a_Suspected_fever)': {'operator': 'mean'}, 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)': {'operator': 'mean'}}
2025-12-07 00:14:39,472:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105_EP01b_Malaria_Total)', column='SUM(105_EP01b_Malaria_Total)'
2025-12-07 00:14:39,473:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105_EP01a_Suspected_fever)', column='SUM(105_EP01a_Suspected_fever)'
2025-12-07 00:14:39,473:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', column='SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)'
2025-12-07 00:14:39,482:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:14:39] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-07 00:14:39,486:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:14:39] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-07 00:14:40,490:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:14:40] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-07 00:14:41,116:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1458, in dispatch_request
    self.raise_routing_exception(req)
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1440, in raise_routing_exception
    raise request.routing_exception  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/ctx.py", line 353, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/werkzeug/routing/map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-12-07 00:14:41,117:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:14:41] "[33mGET /ws HTTP/1.1[0m" 404 -
2025-12-07 00:14:54,239:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:14:54] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-07 00:14:54,938:ERROR:superset.models.helpers:[METRICS-TRACE] Processing 3 metrics
2025-12-07 00:14:54,938:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 0: adhoc - SUM(105_EP01b_Malaria_Total)
2025-12-07 00:14:54,938:ERROR:superset.models.helpers:[METRICS-TRACE] Processing 3 metrics
2025-12-07 00:14:54,938:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105_EP01b_Malaria_Total)
2025-12-07 00:14:54,938:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 0: adhoc - SUM(105_EP01b_Malaria_Total)
2025-12-07 00:14:54,938:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 1: adhoc - SUM(105_EP01a_Suspected_fever)
2025-12-07 00:14:54,939:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105_EP01b_Malaria_Total)
2025-12-07 00:14:54,939:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105_EP01a_Suspected_fever)
2025-12-07 00:14:54,939:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 1: adhoc - SUM(105_EP01a_Suspected_fever)
2025-12-07 00:14:54,939:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 2: adhoc - SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)
2025-12-07 00:14:54,939:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105_EP01a_Suspected_fever)
2025-12-07 00:14:54,939:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)
2025-12-07 00:14:54,939:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 2: adhoc - SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)
2025-12-07 00:14:54,939:ERROR:superset.models.helpers:[METRICS-TRACE] Total metrics added: 3
2025-12-07 00:14:54,939:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)
2025-12-07 00:14:54,941:ERROR:superset.models.helpers:[METRICS-TRACE] Before dedup: 1 select_exprs + 3 metrics_exprs
2025-12-07 00:14:54,941:ERROR:superset.models.helpers:[METRICS-TRACE] Total metrics added: 3
2025-12-07 00:14:54,941:ERROR:superset.models.helpers:[METRICS-TRACE] After dedup: 4 total select_exprs
2025-12-07 00:14:54,941:ERROR:superset.models.helpers:[METRICS-TRACE] Before dedup: 1 select_exprs + 3 metrics_exprs
2025-12-07 00:14:54,941:INFO:superset.models.helpers:[COLUMN_TRACE] SQL Query Building:
2025-12-07 00:14:54,941:ERROR:superset.models.helpers:[METRICS-TRACE] After dedup: 4 total select_exprs
2025-12-07 00:14:54,942:INFO:superset.models.helpers:[COLUMN_TRACE]   columns: [{'columnType': 'BASE_AXIS', 'sqlExpression': 'OrgUnit', 'label': 'OrgUnit', 'expressionType': 'SQL'}]
2025-12-07 00:14:54,942:INFO:superset.models.helpers:[COLUMN_TRACE] SQL Query Building:
2025-12-07 00:14:54,942:INFO:superset.models.helpers:[COLUMN_TRACE]   metrics: [{'expressionType': 'SIMPLE', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01b_Malaria_Total', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 3, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'INT', 'type_generic': 0, 'uuid': '959bffaa-826b-4d13-8b7b-6d9c4ea25e50', 'verbose_name': None, 'warning_markdown': None}, 'aggregate': 'SUM', 'sqlExpression': None, 'datasourceWarning': False, 'hasCustomLabel': False, 'label': 'SUM(105_EP01b_Malaria_Total)', 'optionName': 'metric_rijuz4v684b_kbbrt3pcls'}, {'expressionType': 'SIMPLE', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01a_Suspected_fever', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 4, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'INT', 'type_generic': 0, 'uuid': '530216fe-7198-4b8e-b688-a479bcf67426', 'verbose_name': None, 'warning_markdown': None}, 'aggregate': 'SUM', 'sqlExpression': None, 'datasourceWarning': False, 'hasCustomLabel': False, 'label': 'SUM(105_EP01a_Suspected_fever)', 'optionName': 'metric_5gtlefdsr9c_djmh28d3f6t'}, {'expressionType': 'SIMPLE', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 6, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'column', 'type_generic': 0, 'uuid': '928946a1-6cea-4202-b8d6-0683414af79e', 'verbose_name': None, 'warning_markdown': None}, 'aggregate': 'SUM', 'sqlExpression': None, 'datasourceWarning': False, 'hasCustomLabel': False, 'label': 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', 'optionName': 'metric_rdoppiznv9_9n74otcax28'}]
2025-12-07 00:14:54,942:INFO:superset.models.helpers:[COLUMN_TRACE]   columns: [{'columnType': 'BASE_AXIS', 'sqlExpression': 'OrgUnit', 'label': 'OrgUnit', 'expressionType': 'SQL'}]
2025-12-07 00:14:54,942:INFO:superset.models.helpers:[COLUMN_TRACE]   groupby: []
2025-12-07 00:14:54,942:INFO:superset.models.helpers:[COLUMN_TRACE]   metrics: [{'expressionType': 'SIMPLE', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01b_Malaria_Total', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 3, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'INT', 'type_generic': 0, 'uuid': '959bffaa-826b-4d13-8b7b-6d9c4ea25e50', 'verbose_name': None, 'warning_markdown': None}, 'aggregate': 'SUM', 'sqlExpression': None, 'datasourceWarning': False, 'hasCustomLabel': False, 'label': 'SUM(105_EP01b_Malaria_Total)', 'optionName': 'metric_rijuz4v684b_kbbrt3pcls'}, {'expressionType': 'SIMPLE', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01a_Suspected_fever', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 4, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'INT', 'type_generic': 0, 'uuid': '530216fe-7198-4b8e-b688-a479bcf67426', 'verbose_name': None, 'warning_markdown': None}, 'aggregate': 'SUM', 'sqlExpression': None, 'datasourceWarning': False, 'hasCustomLabel': False, 'label': 'SUM(105_EP01a_Suspected_fever)', 'optionName': 'metric_5gtlefdsr9c_djmh28d3f6t'}, {'expressionType': 'SIMPLE', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 6, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'column', 'type_generic': 0, 'uuid': '928946a1-6cea-4202-b8d6-0683414af79e', 'verbose_name': None, 'warning_markdown': None}, 'aggregate': 'SUM', 'sqlExpression': None, 'datasourceWarning': False, 'hasCustomLabel': False, 'label': 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', 'optionName': 'metric_rdoppiznv9_9n74otcax28'}]
2025-12-07 00:14:54,943:INFO:superset.models.helpers:[COLUMN_TRACE]   labels_expected: ['OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)']
2025-12-07 00:14:54,943:INFO:superset.models.helpers:[COLUMN_TRACE]   groupby: []
2025-12-07 00:14:54,943:INFO:superset.models.helpers:[COLUMN_TRACE]   select_exprs count: 4
2025-12-07 00:14:54,943:INFO:superset.models.helpers:[COLUMN_TRACE]     [0] key=OrgUnit, name=OrgUnit, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-07 00:14:54,943:INFO:superset.models.helpers:[COLUMN_TRACE]   labels_expected: ['OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)']
2025-12-07 00:14:54,943:INFO:superset.models.helpers:[COLUMN_TRACE]     [1] key=SUM(105_EP01b_Malaria_Total), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-07 00:14:54,943:INFO:superset.models.helpers:[COLUMN_TRACE]   select_exprs count: 4
2025-12-07 00:14:54,943:INFO:superset.models.helpers:[COLUMN_TRACE]     [2] key=SUM(105_EP01a_Suspected_fever), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-07 00:14:54,943:INFO:superset.models.helpers:[COLUMN_TRACE]     [0] key=OrgUnit, name=OrgUnit, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-07 00:14:54,943:INFO:superset.models.helpers:[COLUMN_TRACE]     [3] key=SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-07 00:14:54,943:INFO:superset.models.helpers:[COLUMN_TRACE]     [1] key=SUM(105_EP01b_Malaria_Total), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-07 00:14:54,943:INFO:superset.connectors.sqla.models:[DHIS2] get_from_clause for virtual dataset 1: analytics_LAST_YEAR_20251206
2025-12-07 00:14:54,943:INFO:superset.models.helpers:[COLUMN_TRACE]     [2] key=SUM(105_EP01a_Suspected_fever), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-07 00:14:54,944:INFO:superset.connectors.sqla.models:[DHIS2] Full SQL stored: SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
2025-12-07 00:14:54,944:INFO:superset.models.helpers:[COLUMN_TRACE]     [3] key=SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-07 00:14:54,944:INFO:superset.connectors.sqla.models:[DHIS2] Loaded params from extra field: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayPropert
2025-12-07 00:14:54,944:INFO:superset.connectors.sqla.models:[DHIS2] get_from_clause for virtual dataset 1: analytics_LAST_YEAR_20251206
2025-12-07 00:14:54,944:INFO:superset.connectors.sqla.models:[DHIS2] Full SQL stored: SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
2025-12-07 00:14:54,944:INFO:superset.connectors.sqla.models:[DHIS2] Loaded params from extra field: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayPropert
2025-12-07 00:14:54,945:INFO:superset.connectors.sqla.models:[DHIS2] Cached params with key: dhis2_params_1_analytics
2025-12-07 00:14:54,945:INFO:superset.connectors.sqla.models:[DHIS2] Stored params in Flask g for DHIS2 table: analytics
2025-12-07 00:14:54,947:INFO:superset.connectors.sqla.models:[DHIS2] Cached params with key: dhis2_params_1_analytics
2025-12-07 00:14:54,948:INFO:superset.connectors.sqla.models:[DHIS2] Stored params in Flask g for DHIS2 table: analytics
2025-12-07 00:14:54,948:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Query execution in connectors/sqla/models.py:
2025-12-07 00:14:54,949:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   SQL (first 500 chars): SELECT "OrgUnit", sum("105_EP01b_Malaria_Total") AS sum_1, sum("105_EP01a_Suspected_fever") AS sum_2, sum("105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive") AS sum_3 
FROM (SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
) AS virtual_table GROUP BY "OrgUnit" ORDER BY sum("105_EP01b_Malaria_Total") DESC
 LIMIT 10000
2025-12-07 00:14:54,950:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   labels_expected: ['OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)']
2025-12-07 00:14:54,950:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Query execution in connectors/sqla/models.py:
2025-12-07 00:14:54,951:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   SQL (first 500 chars): SELECT "OrgUnit", sum("105_EP01b_Malaria_Total") AS sum_1, sum("105_EP01a_Suspected_fever") AS sum_2, sum("105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive") AS sum_3 
FROM (SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
) AS virtual_table GROUP BY "OrgUnit" ORDER BY sum("105_EP01b_Malaria_Total") DESC
 LIMIT 10000
2025-12-07 00:14:54,952:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 connection initialized: https://tests.dhis2.hispuganda.org/hmis/api
2025-12-07 00:14:54,952:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   labels_expected: ['OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)']
2025-12-07 00:14:54,952:INFO:superset.db_engine_specs.dhis2_dialect:Executing DHIS2 query: SELECT
  "OrgUnit",
  SUM("105_EP01b_Malaria_Total") AS sum_1,
  SUM("105_EP01a_Suspected_fever") AS sum_2,
  SUM("105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive") AS sum_3
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "OrgUnit"
ORDER BY
  SUM("105_EP01b_Malaria_Total") DESC
LIMIT 10000
2025-12-07 00:14:54,953:INFO:superset.db_engine_specs.dhis2_dialect:Parsed endpoint: analytics
2025-12-07 00:14:54,954:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 connection initialized: https://tests.dhis2.hispuganda.org/hmis/api
2025-12-07 00:14:54,954:INFO:superset.db_engine_specs.dhis2_dialect:Using stored parameters from Flask g for table: analytics
2025-12-07 00:14:54,954:INFO:superset.db_engine_specs.dhis2_dialect:Executing DHIS2 query: SELECT
  "OrgUnit",
  SUM("105_EP01b_Malaria_Total") AS sum_1,
  SUM("105_EP01a_Suspected_fever") AS sum_2,
  SUM("105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive") AS sum_3
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "OrgUnit"
ORDER BY
  SUM("105_EP01b_Malaria_Total") DESC
LIMIT 10000
2025-12-07 00:14:54,954:INFO:superset.db_engine_specs.dhis2_dialect:Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
2025-12-07 00:14:54,954:INFO:superset.db_engine_specs.dhis2_dialect:Parsed endpoint: analytics
2025-12-07 00:14:54,954:INFO:superset.db_engine_specs.dhis2_dialect:Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
2025-12-07 00:14:54,954:INFO:superset.db_engine_specs.dhis2_dialect:Using stored parameters from Flask g for table: analytics
2025-12-07 00:14:54,954:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API request: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
2025-12-07 00:14:54,954:INFO:superset.db_engine_specs.dhis2_dialect:Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
2025-12-07 00:14:54,955:INFO:superset.db_engine_specs.dhis2_dialect:Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}

[DHIS2] Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
[DHIS2] API request URL: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
[DHIS2] Raw API response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Raw DHIS2 rows count: 16
[DHIS2] First raw row: ['QHnwKs2OUZv', '2020', 'akV6429SUqu', '15266488']
[DHIS2] Parsing response for endpoint: analytics
[DHIS2] Response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Response sample: {'headers': [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}], 'metaDat
[DHIS2] Using WIDE/PIVOTED format (Period, OrgUnit, DX1, DX2, ...) for analytics
[DHIS2] normalize_analytics: pivot=True, using WIDE/PIVOTED format
[DHIS2] PIVOT CONSTRUCTION:
[DHIS2]   data_elements (UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   data_element_list (sorted UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   col_names (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized row count: 4
[DHIS2] First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] _set_description: columns=['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], types=['String', 'String', 'String', 'String', 'String', 'String']
[DHIS2] Transformed rows count: 4
[DHIS2] First transformed row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] Fetched 4 rows
[DHIS2] fetchall() called - returning 4 rows
[DHIS2] fetchall() - First row type: <class 'tuple'>
[DHIS2] fetchall() - First row (original): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Column count from description: 6
[DHIS2] fetchall() - First row (fixed types): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Type enforcement: dimensions=STRING, measures=FLOAT
[DHIS2] Raw API response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Raw DHIS2 rows count: 16
[DHIS2] First raw row: ['QHnwKs2OUZv', '2020', 'akV6429SUqu', '15266488']
[DHIS2] Parsing response for endpoint: analytics
[DHIS2] Response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Response sample: {'headers': [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}], 'metaDat
[DHIS2] Using WIDE/PIVOTED format (Period, OrgUnit, DX1, DX2, ...) for analytics
[DHIS2] normalize_analytics: pivot=True, using WIDE/PIVOTED format
[DHIS2] PIVOT CONSTRUCTION:
[DHIS2]   data_elements (UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   data_element_list (sorted UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   col_names (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized row count: 4
[DHIS2] First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] _set_description: columns=['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], types=['String', 'String', 'String', 'String', 'String', 'String']
[DHIS2] Transformed rows count: 4
[DHIS2] First transformed row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] Fetched 4 rows
[DHIS2] fetchall() called - returning 4 rows
[DHIS2] fetchall() - First row type: <class 'tuple'>
[DHIS2] fetchall() - First row (original): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Column count from description: 6
[DHIS2] fetchall() - First row (fixed types): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Type enforcement: dimensions=STRING, measures=FLOAT
[DHIS2] Executing query: SELECT
  "OrgUnit",
  SUM("105_EP01b_Malaria_Total") AS sum_1,
  SUM("105_EP01a_Suspected_fever") AS sum_2,
  SUM("105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive") AS sum_3
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "OrgUnit"
ORDER BY
  SUM("105_EP01b_Malaria_Total") DESC
LIMIT 10000
[DHIS2] Parsed endpoint: analytics
[DHIS2] Found params in Flask g for analytics: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;
[DHIS2] Executing query: SELECT
  "OrgUnit",
  SUM("105_EP01b_Malaria_Total") AS sum_1,
  SUM("105_EP01a_Suspected_fever") AS sum_2,
  SUM("105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive") AS sum_3
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "OrgUnit"
ORDER BY
  SUM("105_EP01b_Malaria_Total") DESC
LIMIT 10000
[DHIS2] Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
[DHIS2] Parsed endpoint: analytics
[DHIS2] Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
[DHIS2] Found params in Flask g for analytics: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;
[DHIS2] API request URL: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
[DHIS2] Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
[DHIS2] Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
[DHIS2] API request URL: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT2025-12-07 00:14:54,955:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API request: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
2025-12-07 00:14:55,856:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:14:55] "PUT /api/v1/explore/form_data/8IOeEEvQ8x4?tab_id=7 HTTP/1.1" 200 -
2025-12-07 00:14:56,760:INFO:superset.db_engine_specs.dhis2_dialect:Using wide/pivoted format for analytics
2025-12-07 00:14:56,760:INFO:superset.db_engine_specs.dhis2_dialect:normalize_analytics called with pivot=True, returning WIDE format
2025-12-07 00:14:56,760:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column construction - data_elements: ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
2025-12-07 00:14:56,760:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column names constructed (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-07 00:14:56,760:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] FIRST ROW CONSTRUCTION:
2025-12-07 00:14:56,760:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   Period (index 0): 2020
2025-12-07 00:14:56,760:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   OrgUnit (index 1): MOH - Uganda
2025-12-07 00:14:56,760:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01b. Malaria Total (index 2): 14479324
2025-12-07 00:14:56,760:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01a. Suspected fever (index 3): 22994823
2025-12-07 00:14:56,760:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01d. Malaria cases treated (index 4): 15266488
2025-12-07 00:14:56,760:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01c. Malaria Confirmed (B/s and RDT Positive) (index 5): 13326277
2025-12-07 00:14:56,760:INFO:superset.db_engine_specs.dhis2_dialect:First pivoted row - Period: '2020', OrgUnit: 'MOH - Uganda'
2025-12-07 00:14:56,760:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total pivoted rows: 4, columns: 6
2025-12-07 00:14:56,760:INFO:superset.db_engine_specs.dhis2_dialect:Normalized 4 rows with 6 columns for endpoint analytics
2025-12-07 00:14:56,760:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API returned 4 rows
2025-12-07 00:14:56,762:INFO:superset.db_engine_specs.dhis2_dialect:Using wide/pivoted format for analytics
2025-12-07 00:14:56,762:INFO:superset.db_engine_specs.dhis2_dialect:normalize_analytics called with pivot=True, returning WIDE format
2025-12-07 00:14:56,762:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column construction - data_elements: ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
2025-12-07 00:14:56,762:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column names constructed (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-07 00:14:56,762:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] FIRST ROW CONSTRUCTION:
2025-12-07 00:14:56,762:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   Period (index 0): 2020
2025-12-07 00:14:56,762:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   OrgUnit (index 1): MOH - Uganda
2025-12-07 00:14:56,762:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01b. Malaria Total (index 2): 14479324
2025-12-07 00:14:56,762:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01a. Suspected fever (index 3): 22994823
2025-12-07 00:14:56,763:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01d. Malaria cases treated (index 4): 15266488
2025-12-07 00:14:56,763:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01c. Malaria Confirmed (B/s and RDT Positive) (index 5): 13326277
2025-12-07 00:14:56,763:INFO:superset.db_engine_specs.dhis2_dialect:First pivoted row - Period: '2020', OrgUnit: 'MOH - Uganda'
2025-12-07 00:14:56,763:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total pivoted rows: 4, columns: 6
2025-12-07 00:14:56,763:INFO:superset.db_engine_specs.dhis2_dialect:Normalized 4 rows with 6 columns for endpoint analytics
2025-12-07 00:14:56,763:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API returned 4 rows
2025-12-07 00:14:56,766:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() - Row count: 4
2025-12-07 00:14:56,766:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-07 00:14:56,766:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names length: 6
2025-12-07 00:14:56,766:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values count: 6
2025-12-07 00:14:56,766:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-07 00:14:56,766:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 0 (Period): 2020 -> 2020 (STRING)
2025-12-07 00:14:56,766:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (OrgUnit): MOH - Uganda -> MOH - Uganda (STRING)
2025-12-07 00:14:56,766:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (105_EP01b_Malaria_Total): 14479324 (PROCESSED)
2025-12-07 00:14:56,766:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (105_EP01a_Suspected_fever): 22994823 (PROCESSED)
2025-12-07 00:14:56,766:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (105_EP01d_Malaria_cases_treated): 15266488 (PROCESSED)
2025-12-07 00:14:56,767:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() returning 4 rows with 6 columns each
2025-12-07 00:14:56,767:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Got 4 rows from cursor
2025-12-07 00:14:56,767:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-07 00:14:56,767:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-07 00:14:56,767:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Types from cursor: ['String', 'String', 'String', 'String', 'String', 'String']
2025-12-07 00:14:56,773:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: DataFrame created with 4 rows, 6 columns
2025-12-07 00:14:56,773:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-07 00:14:56,774:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes BEFORE fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-07 00:14:56,774:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Period' to object dtype (dimension)
2025-12-07 00:14:56,774:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'OrgUnit' to object dtype (dimension)
2025-12-07 00:14:56,775:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes AFTER fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-07 00:14:56,776:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: First row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-07 00:14:56,778:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() - Row count: 4
2025-12-07 00:14:56,778:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-07 00:14:56,779:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names length: 6
2025-12-07 00:14:56,779:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values count: 6
2025-12-07 00:14:56,779:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-07 00:14:56,779:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 0 (Period): 2020 -> 2020 (STRING)
2025-12-07 00:14:56,779:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (OrgUnit): MOH - Uganda -> MOH - Uganda (STRING)
2025-12-07 00:14:56,779:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (105_EP01b_Malaria_Total): 14479324 (PROCESSED)
2025-12-07 00:14:56,779:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (105_EP01a_Suspected_fever): 22994823 (PROCESSED)
2025-12-07 00:14:56,779:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (105_EP01d_Malaria_cases_treated): 15266488 (PROCESSED)
2025-12-07 00:14:56,780:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() returning 4 rows with 6 columns each
2025-12-07 00:14:56,780:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Got 4 rows from cursor
2025-12-07 00:14:56,780:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-07 00:14:56,780:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-07 00:14:56,780:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Types from cursor: ['String', 'String', 'String', 'String', 'String', 'String']
2025-12-07 00:14:56,781:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: DataFrame created with 4 rows, 6 columns
2025-12-07 00:14:56,781:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-07 00:14:56,781:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes BEFORE fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-07 00:14:56,781:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Period' to object dtype (dimension)
2025-12-07 00:14:56,781:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'OrgUnit' to object dtype (dimension)
2025-12-07 00:14:56,782:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes AFTER fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-07 00:14:56,782:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: First row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-07 00:14:56,782:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] BEFORE assign_column_label:
2025-12-07 00:14:56,782:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 6)
2025-12-07 00:14:56,783:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-07 00:14:56,783:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)']
2025-12-07 00:14:56,783:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: False
2025-12-07 00:14:56,783:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-07 00:14:56,783:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Column truncation needed: df has 6 columns, expected 4
2025-12-07 00:14:56,783:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   DataFrame actual columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-07 00:14:56,783:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Expected columns: ['OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)']
2025-12-07 00:14:56,783:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] âœ“ Selecting columns BY NAME (matched all expected columns)
2025-12-07 00:14:56,783:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Column mapping: {'OrgUnit': 'OrgUnit', 'SUM(105_EP01b_Malaria_Total)': '105_EP01b_Malaria_Total', 'SUM(105_EP01a_Suspected_fever)': '105_EP01a_Suspected_fever', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)': '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'}
2025-12-07 00:14:56,783:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] Column Selection âœ“ SUCCESS - method=BY_NAME, datasource=analytics_LAST_YEAR_20251206
2025-12-07 00:14:56,783:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)']
2025-12-07 00:14:56,783:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   tried_by_name=True, success=True, fallback=False
2025-12-07 00:14:56,783:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Assigning column labels: ['OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)']
2025-12-07 00:14:56,784:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] AFTER assign_column_label:
2025-12-07 00:14:56,784:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 4)
2025-12-07 00:14:56,784:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)']
2025-12-07 00:14:56,784:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)']
2025-12-07 00:14:56,784:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: True
2025-12-07 00:14:56,784:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'OrgUnit': 'MOH - Uganda', 'SUM(105_EP01b_Malaria_Total)': 14479324, 'SUM(105_EP01a_Suspected_fever)': 22994823, 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)': 13326277}
2025-12-07 00:14:56,785:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] DataFrame columns: ['OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)']
2025-12-07 00:14:56,785:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Aggregates: {'SUM(105_EP01b_Malaria_Total)': {'operator': 'mean'}, 'SUM(105_EP01a_Suspected_fever)': {'operator': 'mean'}, 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)': {'operator': 'mean'}}
2025-12-07 00:14:56,785:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105_EP01b_Malaria_Total)', column='SUM(105_EP01b_Malaria_Total)'
2025-12-07 00:14:56,785:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105_EP01a_Suspected_fever)', column='SUM(105_EP01a_Suspected_fever)'
2025-12-07 00:14:56,785:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', column='SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)'
2025-12-07 00:14:56,788:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] BEFORE assign_column_label:
2025-12-07 00:14:56,788:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 6)
2025-12-07 00:14:56,788:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-07 00:14:56,788:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)']
2025-12-07 00:14:56,788:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: False
2025-12-07 00:14:56,788:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-07 00:14:56,788:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Column truncation needed: df has 6 columns, expected 4
2025-12-07 00:14:56,788:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   DataFrame actual columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-07 00:14:56,788:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Expected columns: ['OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)']
2025-12-07 00:14:56,788:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] âœ“ Selecting columns BY NAME (matched all expected columns)
2025-12-07 00:14:56,788:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Column mapping: {'OrgUnit': 'OrgUnit', 'SUM(105_EP01b_Malaria_Total)': '105_EP01b_Malaria_Total', 'SUM(105_EP01a_Suspected_fever)': '105_EP01a_Suspected_fever', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)': '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'}
2025-12-07 00:14:56,789:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] Column Selection âœ“ SUCCESS - method=BY_NAME, datasource=analytics_LAST_YEAR_20251206
2025-12-07 00:14:56,789:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)']
2025-12-07 00:14:56,789:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   tried_by_name=True, success=True, fallback=False
2025-12-07 00:14:56,789:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Assigning column labels: ['OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)']
2025-12-07 00:14:56,789:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] AFTER assign_column_label:
2025-12-07 00:14:56,789:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 4)
2025-12-07 00:14:56,789:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)']
2025-12-07 00:14:56,789:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)']
2025-12-07 00:14:56,789:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: True
2025-12-07 00:14:56,789:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'OrgUnit': 'MOH - Uganda', 'SUM(105_EP01b_Malaria_Total)': 14479324, 'SUM(105_EP01a_Suspected_fever)': 22994823, 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)': 13326277}
2025-12-07 00:14:56,790:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] DataFrame columns: ['OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)']
2025-12-07 00:14:56,790:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Aggregates: {'SUM(105_EP01b_Malaria_Total)': {'operator': 'mean'}, 'SUM(105_EP01a_Suspected_fever)': {'operator': 'mean'}, 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)': {'operator': 'mean'}}
2025-12-07 00:14:56,790:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105_EP01b_Malaria_Total)', column='SUM(105_EP01b_Malaria_Total)'
2025-12-07 00:14:56,790:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105_EP01a_Suspected_fever)', column='SUM(105_EP01a_Suspected_fever)'
2025-12-07 00:14:56,790:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', column='SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)'
2025-12-07 00:14:56,806:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:14:56] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-07 00:14:56,809:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:14:56] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-07 00:14:57,871:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:14:57] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-07 00:18:31,490:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1458, in dispatch_request
    self.raise_routing_exception(req)
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1440, in raise_routing_exception
    raise request.routing_exception  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/ctx.py", line 353, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/werkzeug/routing/map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-12-07 00:18:31,494:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:18:31] "[33mGET /ws HTTP/1.1[0m" 404 -
2025-12-07 00:18:57,483:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1458, in dispatch_request
    self.raise_routing_exception(req)
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1440, in raise_routing_exception
    raise request.routing_exception  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/ctx.py", line 353, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/werkzeug/routing/map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-12-07 00:18:57,485:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:18:57] "[33mGET /ws HTTP/1.1[0m" 404 -
2025-12-07 00:27:04,346:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1458, in dispatch_request
    self.raise_routing_exception(req)
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1440, in raise_routing_exception
    raise request.routing_exception  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/ctx.py", line 353, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/werkzeug/routing/map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-12-07 00:27:04,350:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:27:04] "[33mGET /ws HTTP/1.1[0m" 404 -
2025-12-07 00:27:30,349:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1458, in dispatch_request
    self.raise_routing_exception(req)
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1440, in raise_routing_exception
    raise request.routing_exception  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/ctx.py", line 353, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/werkzeug/routing/map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-12-07 00:27:30,352:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:27:30] "[33mGET /ws HTTP/1.1[0m" 404 -
2025-12-07 00:27:40,413:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:27:40] "GET /api/v1/me/ HTTP/1.1" 200 -
2025-12-07 00:31:00,552:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:31:00] "GET /api/v1/me/ HTTP/1.1" 200 -
2025-12-07 00:38:55,851:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 00:38:55] "GET /api/v1/me/ HTTP/1.1" 200 -
2025-12-07 03:54:42,068:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 03:54:42] "GET /api/v1/me/ HTTP/1.1" 200 -
2025-12-07 03:59:42,140:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 03:59:42] "GET /api/v1/me/ HTTP/1.1" 200 -
2025-12-07 04:13:47,262:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 04:13:47] "GET /api/v1/me/ HTTP/1.1" 200 -
2025-12-07 04:14:03,144:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 04:14:03] "GET /api/v1/me/ HTTP/1.1" 200 -
2025-12-07 04:14:04,841:INFO:werkzeug:127.0.0.1 - - [07/Dec/2025 04:14:04] "GET /api/v1/me/ HTTP/1.1" 200 -
2025-12-07 04:18:19,894:INFO:werkzeug: * Detected change in '/Users/stephocay/projects/hispuganda/superset/superset/utils/cascading_filters.py', reloading
2025-12-07 04:18:19,895:INFO:werkzeug: * Detected change in '/Users/stephocay/projects/hispuganda/superset/superset/utils/cascading_filters.py', reloading

[DHIS2] Raw API response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Raw DHIS2 rows count: 16
[DHIS2] First raw row: ['QHnwKs2OUZv', '2020', 'akV6429SUqu', '15266488']
[DHIS2] Parsing response for endpoint: analytics
[DHIS2] Response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Response sample: {'headers': [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}], 'metaDat
[DHIS2] Using WIDE/PIVOTED format (Period, OrgUnit, DX1, DX2, ...) for analytics
[DHIS2] normalize_analytics: pivot=True, using WIDE/PIVOTED format
[DHIS2] PIVOT CONSTRUCTION:
[DHIS2]   data_elements (UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   data_element_list (sorted UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   col_names (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized row count: 4
[DHIS2] First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] _set_description: columns=['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], types=['String', 'String', 'String', 'String', 'String', 'String']
[DHIS2] Transformed rows count: 4
[DHIS2] First transformed row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] Fetched 4 rows
[DHIS2] Raw API response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Raw DHIS2 rows count: 16
[DHIS2] First raw row: ['QHnwKs2OUZv', '2020', 'akV6429SUqu', '15266488']
[DHIS2] Parsing response for endpoint: analytics
[DHIS2] Response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Response sample: {'headers': [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}], 'metaDat
[DHIS2] Using WIDE/PIVOTED format (Period, OrgUnit, DX1, DX2, ...) for analytics
[DHIS2] normalize_analytics: pivot=True, using WIDE/PIVOTED format
[DHIS2] PIVOT CONSTRUCTION:
[DHIS2]   data_elements (UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   data_element_list (sorted UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   col_names (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized row count: 4
[DHIS2] First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] _set_description: columns=['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], types=['String', 'String', 'String', 'String', 'String', 'String']
[DHIS2] Transformed rows count: 4
[DHIS2] First transformed row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] Fetched 4 rows
[DHIS2] fetchall() called - returning 4 rows
[DHIS2] fetchall() - First row type: <class 'tuple'>
[DHIS2] fetchall() - First row (original): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Column count from description: 6
[DHIS2] fetchall() - First row (fixed types): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Type enforcement: dimensions=STRING, measures=FLOAT
[DHIS2] fetchall() called - returning 4 rows
[DHIS2] fetchall() - First row type: <class 'tuple'>
[DHIS2] fetchall() - First row (original): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Column count from description: 6
[DHIS2] fetchall() - First row (fixed types): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Type enforcement: dimensions=STRING, measures=FLOAT
2025-12-07 04:18:21,094:INFO:werkzeug: * Restarting with watchdog (fsevents)
Loaded your LOCAL configuration at [/Users/stephocay/projects/hispuganda/superset/superset_config.py]
2025-12-07 04:18:22,563:INFO:alembic.runtime.migration:Context impl SQLiteImpl.
2025-12-07 04:18:22,563:INFO:alembic.runtime.migration:Will assume non-transactional DDL.
2025-12-07 04:18:22,676:INFO:superset.app:Syncing configuration to database...
2025-12-07 04:18:22,679:INFO:superset.app:Configuration sync to database completed successfully
2025-12-07 04:18:22,955:WARNING:werkzeug: * Debugger is active!
2025-12-07 04:18:22,962:INFO:werkzeug: * Debugger PIN: 114-810-287
