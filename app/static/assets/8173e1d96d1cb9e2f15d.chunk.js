"use strict";(globalThis.webpackChunksuperset=globalThis.webpackChunksuperset||[]).push([[5458],{91663:(e,t,a)=>{a.r(t),a.d(t,{default:()=>z});var l=a(2445),n=a(24002),s=a(74098),i=a(79378),d=a(58561),o=a.n(d),r=a(86784),c=a(71323),u=a(64457),m=a(20237),p=a(94551),h=a(38961),g=a(9876),_=a(81465),b=a(17437),S=a(51692),y=a(52167),f=a(97163),C=a(29645),v=a(42566);const w=_.I4.div(({theme:e})=>b.AH`
    margin: ${2*e.sizeUnit}px auto ${4*e.sizeUnit}px auto;
  `),D=(0,_.I4)(y.rN)`
  ${({theme:e})=>b.AH`
    border-radius: ${e.borderRadius}px;
    border: 1px solid ${e.colorPrimaryBg};
  `}
`,T=_.I4.div(({theme:e})=>b.AH`
    margin-bottom: ${10*e.sizeUnit}px;

    .control-label {
      margin-bottom: ${2*e.sizeUnit}px;
    }

    .required {
      margin-left: ${e.sizeUnit/2}px;
      color: ${e.colorErrorText};
    }

    input[type='text'] {
      padding: ${1.5*e.sizeUnit}px ${2*e.sizeUnit}px;
      border: 1px solid ${e.colorBorder};
      border-radius: ${e.borderRadius}px;
      width: 50%;
    }
  `),k=(0,u.Ay)(({addDangerToast:e,onCssTemplateAdd:t,onHide:a,show:i,cssTemplate:d=null})=>{const[o,c]=(0,n.useState)(!0),[u,m]=(0,n.useState)(null),[p,h]=(0,n.useState)(!0),g=null!==d,{state:{loading:_,resource:b},fetchResource:y,createResource:k,updateResource:x}=(0,r.fn)("css_template",(0,s.t)("css_template"),e),A=()=>{a(),m(null)};return(0,n.useEffect)(()=>{if(g&&(null==u||!u.id||d&&(null==d?void 0:d.id)!==u.id||p&&i)){if(null!==(null==d?void 0:d.id)&&!_){const e=d.id||0;y(e)}}else!g&&(!u||u.id||p&&i)&&m({template_name:"",css:""})},[d,i]),(0,n.useEffect)(()=>{b&&m(b)},[b]),(0,n.useEffect)(()=>{var e;null!=u&&u.template_name.length&&null!=u&&null!=(e=u.css)&&e.length?c(!1):c(!0)},[u?u.template_name:"",u?u.css:""]),p&&i&&h(!1),(0,l.FD)(f.aF,{disablePrimaryButton:o,onHandledPrimaryAction:()=>{if(g){if(null!=u&&u.id){const e=u.id;delete u.id,delete u.created_by,delete u.changed_by,delete u.changed_on_delta_humanized,x(e,u).then(e=>{e&&(t&&t(),A())})}}else u&&k(u).then(e=>{e&&(t&&t(),A())})},onHide:A,primaryButtonName:g?(0,s.t)("Save"):(0,s.t)("Add"),show:i,width:"55%",title:(0,l.Y)(S.r,{isEditMode:g,title:g?(0,s.t)("Edit CSS template properties"):(0,s.t)("Add CSS template")}),children:[(0,l.Y)(w,{children:(0,l.Y)(v.o.Title,{level:4,children:(0,s.t)("General information")})}),(0,l.FD)(T,{children:[(0,l.FD)("div",{className:"control-label",children:[(0,s.t)("Name"),(0,l.Y)("span",{className:"required",children:"*"})]}),(0,l.Y)(C.Input,{name:"template_name",onChange:e=>{const{target:t}=e,a={...u,template_name:u?u.template_name:"",css:u?u.css:""};a[t.name]=t.value,m(a)},type:"text",value:null==u?void 0:u.template_name})]}),(0,l.FD)(T,{children:[(0,l.FD)("div",{className:"control-label",children:[(0,s.t)("css"),(0,l.Y)("span",{className:"required",children:"*"})]}),(0,l.Y)(D,{onChange:e=>{const t={...u,template_name:u?u.template_name:"",css:e};m(t)},value:null==u?void 0:u.css,width:"100%"})]})]})});var x=a(79605),A=a(8558);const z=(0,u.Ay)(function({addDangerToast:e,addSuccessToast:t,user:a}){const{state:{loading:d,resourceCount:u,resourceCollection:_,bulkSelectEnabled:b},hasPerm:S,fetchData:y,refreshData:f,toggleBulkSelect:C}=(0,r.RU)("css_template",(0,s.t)("CSS templates"),e),[v,w]=(0,n.useState)(!1),[D,T]=(0,n.useState)(null),z=S("can_write"),H=S("can_write"),Y=S("can_write"),[$,F]=(0,n.useState)(null),B=[{id:"template_name",desc:!0}],E=(0,n.useMemo)(()=>[{accessor:"template_name",Header:(0,s.t)("Name"),size:"xxl",id:"template_name"},{Cell:({row:{original:{changed_on_delta_humanized:e,changed_by:t}}})=>(0,l.Y)(g.UW,{date:e,user:t}),Header:(0,s.t)("Last modified"),accessor:"changed_on_delta_humanized",size:"xl",disableSortBy:!0,id:"changed_on_delta_humanized"},{Cell:({row:{original:e}})=>{const t=[H?{label:"edit-action",tooltip:(0,s.t)("Edit template"),placement:"bottom",icon:"EditOutlined",onClick:()=>(T(e),void w(!0))}:null,Y?{label:"delete-action",tooltip:(0,s.t)("Delete template"),placement:"bottom",icon:"DeleteOutlined",onClick:()=>F(e)}:null].filter(e=>!!e);return(0,l.Y)(g.kv,{actions:t})},Header:(0,s.t)("Actions"),id:"actions",disableSortBy:!0,hidden:!H&&!Y,size:"xl"},{accessor:x.H.ChangedBy,hidden:!0,id:x.H.ChangedBy}],[Y,z]),N={name:(0,s.t)("CSS templates")},U=[];Y&&U.push({name:(0,s.t)("Bulk select"),onClick:C,buttonStyle:"secondary"}),z&&U.push({name:(0,s.t)("CSS template"),buttonStyle:"primary",icon:(0,l.Y)(A.F.PlusOutlined,{iconSize:"m"}),onClick:()=>{T(null),w(!0)}}),N.buttons=U;const R=(0,n.useMemo)(()=>[{Header:(0,s.t)("Name"),key:"search",id:"template_name",input:"search",operator:g.c0.Contains},{Header:(0,s.t)("Modified by"),key:"changed_by",id:"changed_by",input:"select",operator:g.c0.RelationOneMany,unfilteredLabel:(0,s.t)("All"),fetchSelects:(0,c.u1)("css_template","changed_by",(0,c.JF)(e=>(0,s.t)("An error occurred while fetching dataset datasource values: %s",e)),a),paginate:!0}],[]);return(0,l.FD)(l.FK,{children:[(0,l.Y)(m.A,{...N}),(0,l.Y)(k,{addDangerToast:e,cssTemplate:D,onCssTemplateAdd:()=>f(),onHide:()=>w(!1),show:v}),$&&(0,l.Y)(p.T,{description:(0,s.t)("This action will permanently delete the template."),onConfirm:()=>{$&&(({id:a,template_name:l})=>{i.A.delete({endpoint:`/api/v1/css_template/${a}`}).then(()=>{f(),F(null),t((0,s.t)("Deleted: %s",l))},(0,c.JF)(t=>e((0,s.t)("There was an issue deleting %s: %s",l,t))))})($)},onHide:()=>F(null),open:!0,title:(0,s.t)("Delete Template?")}),(0,l.Y)(h.h,{title:(0,s.t)("Please confirm"),description:(0,s.t)("Are you sure you want to delete the selected templates?"),onConfirm:a=>{i.A.delete({endpoint:`/api/v1/css_template/?q=${o().encode(a.map(({id:e})=>e))}`}).then(({json:e={}})=>{f(),t(e.message)},(0,c.JF)(t=>e((0,s.t)("There was an issue deleting the selected templates: %s",t))))},children:a=>{const n=Y?[{key:"delete",name:(0,s.t)("Delete"),onSelect:a,type:"danger"}]:[];return(0,l.Y)(g.uO,{className:"css-templates-list-view",columns:E,count:u,data:_,fetchData:y,filters:R,initialSort:B,loading:d,pageSize:25,bulkActions:n,bulkSelectEnabled:b,disableBulkSelect:C,addDangerToast:e,addSuccessToast:t,refreshData:f})}})]})})}}]);