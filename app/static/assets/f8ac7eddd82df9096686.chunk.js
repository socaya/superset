"use strict";(globalThis.webpackChunksuperset=globalThis.webpackChunksuperset||[]).push([[8121],{5504:(e,t,r)=>{r.d(t,{A:()=>s});var o=r(53259),i=r.n(o);const n={onRenderFailure(){},onRenderSuccess(){}};function s(e){const t=i().Map(e);class r extends t{componentDidMount(){this.afterRender()}componentDidUpdate(){this.afterRender()}afterRender(){const{loaded:e,loading:t,error:r}=this.state,{onRenderFailure:o,onRenderSuccess:i}=this.props;t||(r?o(r):e&&Object.keys(e).length>0&&i())}}return r.defaultProps=void 0,r.defaultProps=n,r.preload=t.preload,r}},20033:(e,t,r)=>{r.d(t,{wv:()=>d,x9:()=>p});var o=r(62193),i=r.n(o),n=r(58561),s=r.n(n),a=r(90924),l=r(79378),c=r(59744);const d=" : ",u=(e,t)=>`${e}${d}${t}`,h=(e,t)=>e.replace("T00:00:00","")||(t?"-∞":"∞"),m=(e,t="col")=>{const r=e.split(d);return 1===r.length?e:`${h(r[0],!0)} ≤ ${t} < ${h(r[1])}`},p=async(e,t="col",r)=>{let o,n;if(i()(r))o=s().encode_uri(e),n=`/api/v1/time_range/?q=${o}`;else{const t=(0,a.A)(r).map(t=>({timeRange:e,shift:t}));o=s().encode_uri([{timeRange:e},...t]),n=`/api/v1/time_range/?q=${o}`}try{var p;const e=await l.A.get({endpoint:n});if(i()(r)){var f,g;const r=u((null==e||null==(f=e.json)||null==(f=f.result[0])?void 0:f.since)||"",(null==e||null==(g=e.json)||null==(g=g.result[0])?void 0:g.until)||"");return{value:m(r,t)}}const o=null==e||null==(p=e.json)?void 0:p.result.map(e=>u(e.since,e.until));return{value:o.slice(1).map(e=>((e,t,r="col")=>{const o=e.split(d),i=t.split(d);return`${r}: ${h(o[0],!0)} to ${h(o[1])} vs\n  ${h(i[0],!0)} to ${h(i[1])}`})(o[0],e,t))}}catch(e){const t=await(0,c.h4)(e);return{error:t.message||t.error||e.statusText}}}},24797:(e,t,r)=>{r.d(t,{A:()=>m});var o=r(2445),i=r(24002),n=r(80116),s=r(47309),a=r(56196),l=r(86646),c=r(94122),d=r(18749),u=r(42385),h=r(42152);function m(e){const[t,r]=(0,i.useState)("uninitialized"),[m,p]=(0,i.useState)(),[f,g]=(0,i.useState)(),[v,w]=(0,i.useState)(),y=(0,i.useRef)(),x=(0,i.useRef)();y.current||(y.current=new l.A({client:e.client}));const _=(0,i.useCallback)(async()=>{const{chartId:t,formData:o,formDataOverrides:i,onError:n,onLoad:a,chartType:l,force:u,timeout:h}=e;x.current&&x.current.abort(),x.current=new AbortController,r("loading"),g(void 0);try{var m;let e;if(t&&!o)e=await y.current.loadFormData({sliceId:t},{signal:x.current.signal});else{if(!o)throw new Error("Either chartId or formData must be provided");e=o}i&&(e={...e,...i});const n=e.viz_type||l;if(!n)throw new Error("Chart type (viz_type) must be specified");e.viz_type=n;const{useLegacyApi:f}=(0,d.A)().get(n)||{},g=await(0,c.A)().get(n);let v;v=g?g(e):(0,s.A)(e),f||v.queries||(v={queries:[v]});const _={endpoint:f?"/superset/explore_json/":"/api/v1/chart/data",signal:x.current.signal,...h&&{timeout:1e3*h}};f?_.postPayload={form_data:{...e,...u&&{force:!0}}}:_.jsonPayload={...v,...u&&{force:!0}};const D=await y.current.client.post(_);let b=Array.isArray(D.json)?D.json:[D.json];!f&&null!=(m=b[0])&&m.result&&(b=b[0].result),r("loaded"),p(b),w(e),a&&a(b)}catch(e){if("AbortError"===e.name)return;const t=e;r("error"),g(t),n&&n(t)}},[]),D=(0,i.useRef)();(0,i.useEffect)(()=>{const t=e,r=D.current;if(D.current=t,r&&t.chartId===r.chartId&&t.formDataOverrides===r.formDataOverrides&&t.force===r.force){if(t.formData!==r.formData){var o;const e=(null==(o=t.formData)?void 0:o.viz_type)||t.chartType;!function(e,t,r){if(!e||!t||!r)return!0;if(e.viz_type!==t.viz_type)return!0;try{const o=(0,u.A)().get(r);if(!o||!o.controlPanelSections)return!0;const i=new Set;o.controlPanelSections.forEach(e=>{e.controlSetRows&&e.controlSetRows.forEach(e=>{e.forEach(e=>{if(e&&"object"==typeof e){var t,r;const o=e.name||(null==(t=e.config)?void 0:t.name);o&&!0===(null==(r=e.config)?void 0:r.renderTrigger)&&i.add(o)}})})});const n=Object.keys(t).filter(r=>JSON.stringify(e[r])!==JSON.stringify(t[r]));return 0!==n.length&&!n.every(e=>i.has(e))}catch(e){return!0}}(r.formData,t.formData,e)?w(t.formData):_()}}else _()},[e.chartId,e.formData,e.formDataOverrides,e.force,e.chartType]),(0,i.useEffect)(()=>()=>{x.current&&x.current.abort()},[]);const{width:b="100%",height:S=400,showLoading:$=!0,loadingComponent:P,errorComponent:R,noDataComponent:A,disableErrorBoundary:T,enableNoResults:M=!0,id:C,className:I,onRenderSuccess:E,onRenderFailure:Y,hooks:F}=e;if("loading"===t&&$)return P?(0,o.Y)(P,{}):"100%"===b||"100%"===S?(0,o.Y)("div",{style:{width:b,height:S,position:"relative"},children:(0,o.Y)(a.R,{position:"floating"})}):(0,o.Y)("div",{style:{width:"number"==typeof b?`${b}px`:b,height:"number"==typeof S?`${S}px`:S,position:"relative"},children:(0,o.Y)(a.R,{position:"floating"})});if("error"===t&&f){if(R)return(0,o.Y)(R,{error:f});const e=(0,o.FD)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",width:"100%",color:"var(--danger-color)",fontSize:"14px",padding:"16px",textAlign:"center"},children:["Error: ",f.message]});return"100%"===b||"100%"===S?(0,o.Y)("div",{style:{width:b,height:S},children:e}):(0,o.Y)("div",{style:{width:"number"==typeof b?`${b}px`:b,height:"number"==typeof S?`${S}px`:S},children:e})}if("loaded"===t&&v&&m){const e=(e,t)=>(0,o.Y)(h.A,{id:C,className:I,chartType:v.viz_type,width:e,height:t,formData:v,queriesData:m,disableErrorBoundary:T,enableNoResults:M,noResults:A&&(0,o.Y)(A,{}),onRenderSuccess:E,onRenderFailure:Y,hooks:F});return"100%"===b||"100%"===S?(0,o.Y)("div",{style:{width:"100%",height:"100%"},children:(0,o.Y)(n.A,{children:({width:t,height:r})=>e("100%"===b?t:b,"100%"===S?r:S)})}):e(b,S)}return null}},39242:(e,t,r)=>{r.d(t,{t:()=>p});var o=r(20033);const i=String.raw`\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.\d+)?(?:(?:[+-]\d\d:\d\d)|Z)?`,n=String.raw`(?:TODAY|NOW)`,s=String.raw`[+-]?[1-9][0-9]*`,a=String.raw`YEAR|QUARTER|MONTH|WEEK|DAY|HOUR|MINUTE|SECOND`,l=RegExp(String.raw`^DATEADD\(DATETIME\("(${i}|${n})"\),\s(${s}),\s(${a})\)$`,"i"),c=RegExp(String.raw`^${i}$|^${n}$`,"i"),d=["now","today"],u=new Date;u.setHours(0,0,0,0);const h=new Date;h.setHours(0,0,0,0);const m={sinceDatetime:u.setDate(u.getDate()-7).toString(),sinceMode:"relative",sinceGrain:"day",sinceGrainValue:-7,untilDatetime:h.toString(),untilMode:"specific",untilGrain:"day",untilGrainValue:7,anchorMode:"now",anchorValue:"now"},p=e=>{const t=e.split(o.wv);if(2===t.length){const[e,r]=t;if(c.test(e)&&c.test(r)){const t=d.includes(e)?e:"specific",o=d.includes(r)?r:"specific";return{customRange:{...m,sinceDatetime:e,untilDatetime:r,sinceMode:t,untilMode:o},matchedFlag:!0}}const o=e.match(l);if(o&&c.test(r)&&e.includes(r)){const[e,t,i]=o.slice(1),n=d.includes(r)?r:"specific";return{customRange:{...m,sinceGrain:i,sinceGrainValue:parseInt(t,10),sinceDatetime:e,untilDatetime:e,sinceMode:"relative",untilMode:n},matchedFlag:!0}}const i=r.match(l);if(c.test(e)&&i&&r.includes(e)){const[t,r,o]=[...i.slice(1)],n=d.includes(e)?e:"specific";return{customRange:{...m,untilGrain:o,untilGrainValue:parseInt(r,10),sinceDatetime:t,untilDatetime:t,untilMode:"relative",sinceMode:n},matchedFlag:!0}}if(o&&i){const[e,t,r]=[...o.slice(1)],[n,s,a]=[...i.slice(1)];if(e===n)return{customRange:{...m,sinceGrain:r,sinceGrainValue:parseInt(t,10),sinceDatetime:e,untilGrain:a,untilGrainValue:parseInt(s,10),untilDatetime:n,anchorValue:e,sinceMode:"relative",untilMode:"relative",anchorMode:"now"===e?"now":"specific"},matchedFlag:!0}}}return{customRange:m,matchedFlag:!1}}},39591:(e,t,r)=>{r.d(t,{A:()=>n,P:()=>i});var o=r(24002);const i={name:"l8l8b8",styles:"white-space:nowrap;overflow:hidden;text-overflow:ellipsis"},n=({isVertical:e,isHorizontal:t}={isVertical:!1,isHorizontal:!0})=>{const[r,i]=(0,o.useState)(!0),n=(0,o.useRef)(null),[s,a]=(0,o.useState)(0),[l,c]=(0,o.useState)(0),[d,u]=(0,o.useState)(0),[h,m]=(0,o.useState)(0);return(0,o.useEffect)(()=>{var e,t,r,o,i,s,l,d;a(null!=(e=null==(t=n.current)?void 0:t.offsetWidth)?e:0),c(null!=(r=null==(o=n.current)?void 0:o.scrollWidth)?r:0),u(null!=(i=null==(s=n.current)?void 0:s.offsetHeight)?i:0),m(null!=(l=null==(d=n.current)?void 0:d.scrollHeight)?l:0)}),(0,o.useEffect)(()=>{i(e&&d<h||t&&s<l)},[s,l,d,h,e,t]),[n,r]}},39965:(e,t,r)=>{r.d(t,{A:()=>i});const o={isDynamic:!0,multiplier:1};function i(e){return"auto"===e||"100%"===e?o:"string"==typeof e&&e.length>0&&"%"===e[e.length-1]?{isDynamic:!0,multiplier:parseFloat(e)/100}:{isDynamic:!1,value:"number"==typeof e?e:parseFloat(e)}}},42152:(e,t,r)=>{r.d(t,{A:()=>Q});var o=r(2445),i=r(24002),n=r(94177),s=r(80116),a=r(25508),l=r(98837),c=r(39965),d=r(18749),u=r(74098),h=r(32861),m=r(69376),p=r(59923),f=r(5504);function g(e){return e}const v=()=>null,w={id:"",className:"",preTransformProps:g,overrideTransformProps:void 0,postTransformProps:g,onRenderSuccess(){},onRenderFailure(){}},y=new p.A;class x extends i.PureComponent{constructor(...e){super(...e),this.container=void 0,this.preSelector=(0,a.Mz)([e=>e.chartProps,e=>e.preTransformProps],(e,t=g)=>t(e)),this.transformSelector=(0,a.Mz)([e=>e.chartProps,e=>e.transformProps],(e,t=g)=>t(e)),this.postSelector=(0,a.Mz)([e=>e.chartProps,e=>e.postTransformProps],(e,t=g)=>t(e)),this.processChartProps=({chartProps:e,preTransformProps:t,transformProps:r,postTransformProps:o})=>this.postSelector({chartProps:this.transformSelector({chartProps:this.preSelector({chartProps:e,preTransformProps:t}),transformProps:r}),postTransformProps:o}),this.createLoadableRenderer=(0,a.Mz)([e=>e.chartType,e=>e.overrideTransformProps],(e,t)=>{if(e){const r=(0,f.A)({loader:{Chart:()=>(0,h.A)().getAsPromise(e),transformProps:t?()=>Promise.resolve(t):()=>(0,m.A)().getAsPromise(e)},loading:t=>this.renderLoading(t,e),render:this.renderChart});return r.preload(),r}return v}),this.renderChart=(e,t)=>{const{Chart:r,transformProps:i}=e,{chartProps:n,preTransformProps:s,postTransformProps:a}=t;return(0,o.Y)(r,{...this.processChartProps({chartProps:n,preTransformProps:s,transformProps:i,postTransformProps:a})})},this.renderLoading=(e,t)=>{const{error:r}=e;return r?(0,o.FD)("div",{className:"alert alert-warning",role:"alert",children:[(0,o.Y)("strong",{children:(0,u.t)("ERROR")})," ",(0,o.FD)("code",{children:['chartType="',t,'"']})," —",r.toString()]}):null},this.setRef=e=>{this.container=e}}render(){const{id:e,className:t,preTransformProps:r,postTransformProps:i,chartProps:n=y,onRenderSuccess:s,onRenderFailure:a}=this.props,l=this.createLoadableRenderer(this.props);if(null===n)return null;const c={};return e&&(c.id=e),t&&(c.className=t),(0,o.Y)("div",{...c,ref:this.setRef,children:(0,o.Y)(l,{preTransformProps:r,postTransformProps:i,chartProps:n,onRenderSuccess:s,onRenderFailure:a})})}}x.defaultProps=w;var _=r(81465),D=r(17437);const b={maxWidth:800},S=_.I4.div`
  ${({theme:e,width:t,height:r})=>D.AH`
    align-items: center;
    display: flex;
    flex-direction: column;
    justify-content: center;
    text-align: center;
    height: ${r}px;
    width: ${t}px;
    padding: ${4*e.sizeUnit}px;

    & .no-results-title {
      font-size: ${e.fontSizeLG}px;
      font-weight: ${e.fontWeightStrong};
      padding-bottom: ${2*e.sizeUnit};
    }

    & .no-results-body {
      font-size: ${e.fontSize}px;
    }
  `}
`,$=({className:e,height:t,id:r,width:i})=>{const n="string"==typeof i||i>250,s=(0,u.t)("No results were returned for this query. If you expected results to be returned, ensure any filters are configured properly and the datasource contains data for the selected time range.");return(0,o.Y)(S,{height:t,width:i,className:e,id:r,title:n?void 0:s,children:(0,o.FD)("div",{style:b,children:[(0,o.Y)("div",{className:"no-results-title",children:(0,u.t)("No Results")}),n&&(0,o.Y)("div",{className:"no-results-body",children:s})]})})};var P=r(57749),R=r(97596),A=r.n(R);function T(e,t,r){if(!r)return"";try{return A().compile(r,{noEscape:!0})({row:e,rowLabel:e,column:t,columnLabel:t,col:t,colLabel:t})}catch(e){return console.warn("Failed to compile Handlebars template:",e),""}}function M(e,t){var r;if("metrics"===e.mode){var o;const r=null==(o=e.metrics)?void 0:o[t];return r?"string"==typeof r?r:r.label||"":""}const i=null==(r=e.dimension)?void 0:r.values[t];return(null==i?void 0:i.toString())||""}function C(e,t){return{expressionType:P.JI.ExpressionType.SIMPLE,subject:e,operator:P.JI.Operator.EQUALS,comparator:t,clause:P.JI.Clause.WHERE,isExtra:!1}}function I(e,t,r,o,i){const n={...e};Object.keys(n).forEach(e=>{e.startsWith("matrixify_")&&delete n[e]});Object.assign(n,{slice_name:void 0,slice_id:void 0,header_font_size:void 0,subheader:void 0,show_title:void 0,header_title_text_align:void 0,header_text:void 0});const s=[];if(t&&null!==o&&"dimensions"===t.mode&&t.dimension){const e=t.dimension.values[o];void 0!==e&&s.push(C(t.dimension.dimension,e))}if(r&&null!==i&&"dimensions"===r.mode&&r.dimension){const e=r.dimension.values[i];void 0!==e&&s.push(C(r.dimension.dimension,e))}s.length>0&&(n.adhoc_filters=[...n.adhoc_filters||[],...s]);const a=[];if(t&&null!==o&&"metrics"===t.mode){var l;const e=null==(l=t.metrics)?void 0:l[o];e&&a.push(e)}if(r&&null!==i&&"metrics"===r.mode){var c;const e=null==(c=r.metrics)?void 0:c[i];e&&a.push(e)}return a.length>0&&(n.metrics=a),n}var E=r(24797);const Y=_.I4.div`
  height: 100%;
  display: flex;
  flex-direction: column;
  border: 1px solid ${({theme:e})=>e.colorBorder};
  border-radius: ${({theme:e})=>e.borderRadius}px;
  background-color: ${({theme:e})=>e.colorBgContainer};
  overflow: hidden;
`,F=_.I4.div`
  flex-shrink: 0;
  padding: ${({theme:e})=>e.sizeUnit}px
    ${({theme:e})=>2*e.sizeUnit}px;
  background-color: ${({theme:e})=>e.colorFillAlter};
  border-bottom: 1px solid ${({theme:e})=>e.colorBorder};
  font-size: ${({theme:e})=>e.fontSizeSM}px;
  font-weight: ${({theme:e})=>e.fontWeightStrong};
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
`,z=_.I4.div`
  flex: 1;
  min-height: 0;
  padding: 0;
  position: relative;

  /* Remove any padding/margins that might be causing title height issues */
  & .chart-container {
    padding-top: 0 !important;
  }

  /* Target title elements inside the chart container */
  & .superchart-container .header-title,
  & .superchart-container [class*='title'] {
    display: none !important;
  }
`,N=_.I4.div`
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  color: ${({theme:e})=>e.colorTextQuaternary};
  font-size: ${({theme:e})=>e.fontSizeSM}px;
  text-align: center;
  user-select: none;
`,k=()=>{const e=(0,_.DP)();return(0,o.Y)(N,{theme:e,children:"No data"})},L=(0,i.memo)(({cell:e,rowHeight:t,datasource:r,hooks:n})=>{const s=e.title||"",a=s&&""!==s.trim(),l=(0,i.useMemo)(()=>{if(!n)return;const t={...n};return n.onContextMenu&&(t.onContextMenu=(t,r,o)=>{const i=e.formData.adhoc_filters||[],s={...o,matrixifyContext:{rowLabel:e.rowLabel,colLabel:e.colLabel,row:e.row,col:e.col,cellFilters:i,cellFormData:e.formData}};n.onContextMenu(t,r,s)}),t},[n,e]);return(0,o.FD)(Y,{className:"matrixify-cell","data-row":e.row,"data-col":e.col,"data-row-label":e.rowLabel,"data-col-label":e.colLabel,children:[a&&(0,o.Y)(F,{title:s,children:s}),(0,o.Y)(z,{children:(0,o.Y)(E.A,{id:e.id,formData:e.formData,width:"100%",height:"100%",enableNoResults:!0,noDataComponent:k,showLoading:!0,hooks:l})})]})},(e,t)=>JSON.stringify(e.cell.formData)===JSON.stringify(t.cell.formData)&&e.rowHeight===t.rowHeight&&e.cell.id===t.cell.id&&e.cell.title===t.cell.title);L.displayName="MatrixifyGridCell";const H=L,j=_.I4.div`
  width: 100%;
  ${({height:e})=>e&&`height: ${e}px;`}
  padding: ${({theme:e})=>e.sizeUnit}px; /* Reduced padding for more density */
  box-sizing: border-box;
  display: flex;
  flex-direction: column;
`,O=_.I4.div`
  flex: 1;
  overflow: auto;
  min-height: 0;
`,U=_.I4.div`
  display: grid;
  grid-template-columns: ${({maxColumns:e,hasRowHeaders:t})=>t?`24px repeat(${e}, minmax(0, 1fr))`:`repeat(${e}, minmax(0, 1fr))`};
  ${({hasColumnHeaders:e,rowHeight:t})=>e?`grid-template-rows: 24px; grid-auto-rows: ${t}px;`:`grid-auto-rows: ${t}px;`}
  gap: ${8}px;
  width: 100%;
  min-width: 0;
  min-height: 0;
`,V=_.I4.div`
  margin-bottom: ${({isLast:e})=>e?0:16}px;
`,B=_.I4.div`
  background-color: ${({theme:e})=>e.colorFillAlter};
  padding: ${({theme:e})=>e.sizeUnit/2}px; /* Reduced padding */
  font-weight: ${({theme:e})=>e.fontWeightStrong};
  text-align: center;
  border: 1px solid ${({theme:e})=>e.colorBorder};
  border-radius: ${({theme:e})=>e.borderRadius}px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  font-size: ${({theme:e})=>e.fontSizeSM}px; /* Back to small (readable) font */

  &.matrixify-row-header {
    writing-mode: vertical-rl;
    transform: rotate(-180deg);
    padding: ${({theme:e})=>e.sizeUnit}px
      ${({theme:e})=>e.sizeUnit/4}px; /* Tighter padding */
    min-width: ${20}px;
    max-width: ${24}px;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  &.matrixify-col-header {
    height: ${24}px;
    display: flex;
    align-items: center;
    justify-content: center;
  }
`,q=function({formData:e,datasource:t,width:r,height:n,hooks:s}){var a,l,c;const d=(0,i.useMemo)(()=>function(e){var t,r;const o=(0,P.AU)(e);if(!o)return null;let i=[],n=0;"metrics"===o.rows.mode&&o.rows.metrics?(n=o.rows.metrics.length,i=o.rows.metrics.map((e,t)=>M(o.rows,t))):"dimensions"===o.rows.mode&&null!=(t=o.rows.dimension)&&t.values&&(n=o.rows.dimension.values.length,i=o.rows.dimension.values.map((e,t)=>M(o.rows,t)));let s=[],a=0;"metrics"===o.columns.mode&&o.columns.metrics?(a=o.columns.metrics.length,s=o.columns.metrics.map((e,t)=>M(o.columns,t))):"dimensions"===o.columns.mode&&null!=(r=o.columns.dimension)&&r.values&&(a=o.columns.dimension.values.length,s=o.columns.dimension.values.map((e,t)=>M(o.columns,t))),n>0&&0===a&&(a=1,s=[""]),a>0&&0===n&&(n=1,i=[""]);const l=[];for(let t=0;t<n;t+=1){const r=[];for(let l=0;l<a;l+=1){const c=`cell-${t}-${l}`,d=i[t],u=s[l],h=I(e,n>0?o.rows:null,a>0?o.columns:null,n>0?t:null,a>0?l:null),m=T(d,u,e.matrixify_cell_title_template);r.push({id:c,row:t,col:l,rowLabel:d,colLabel:u,title:m,formData:h})}l.push(r)}return{rowHeaders:i,colHeaders:s,cells:l,baseFormData:e}}(e),[e]),u=!0===e.matrixify_enable_vertical_layout&&(null==(a=e.matrixify_show_row_labels)||a),h=!0===e.matrixify_enable_horizontal_layout&&(null==(l=e.matrixify_show_column_headers)||l),m=e.matrixify_row_height||300,p=null==(c=e.matrixify_fit_columns_dynamically)||c,f=e.matrixify_charts_per_row||3,g=(0,i.useMemo)(()=>{if(!d)return[];const{colHeaders:e}=d,t=e.length,r=p?t:Math.min(f,t),o=[];for(let i=0;i<t;i+=r)o.push({startIdx:i,endIdx:Math.min(i+r,t),headers:e.slice(i,Math.min(i+r,t))});return o},[d,p,f]);if(!d)return null;const{rowHeaders:v,colHeaders:w,cells:y}=d,x=w.length,_=p?x:Math.min(f,x),D=u&&v.length>0,b=h&&w.length>0;return(0,o.Y)(j,{height:n,children:(0,o.Y)(O,{children:y.map((e,r)=>(0,o.Y)("div",{children:g.map((i,n)=>{const a=i.endIdx-i.startIdx,l=_-a,c=n===g.length-1,d=r===y.length-1,u=b&&(g.length>1||0===r);return(0,o.Y)(V,{isLast:c&&d,children:(0,o.FD)(U,{columns:a,maxColumns:_,hasRowHeaders:D,rowHeight:m,hasColumnHeaders:u,children:[u&&D&&(0,o.Y)("div",{}),u&&(0,o.FD)(o.FK,{children:[i.headers.map((e,t)=>(0,o.Y)(B,{className:"matrixify-col-header",title:e,children:e},`col-header-${r}-${n}-${t}`)),Array.from({length:l}).map((e,t)=>(0,o.Y)("div",{},`empty-header-${r}-${n}-${t}`))]}),D&&0===n&&(0,o.Y)(B,{className:"matrixify-row-header",title:v[r],children:v[r]},`row-header-${r}`),D&&n>0&&(0,o.Y)("div",{}),e.slice(i.startIdx,i.endIdx).map((e,r)=>e?(0,o.Y)(H,{cell:e,rowHeight:m,datasource:t,hooks:s},e.id):null),Array.from({length:l}).map((e,t)=>(0,o.Y)("div",{},`empty-cell-${r}-${n}-${t}`))]})},`row-${r}-col-group-${n}`)})},`row-${r}`))})})},G={FallbackComponent:function({error:e,height:t,width:r}){return(0,o.Y)("div",{css:e=>({backgroundColor:e.colorBgContainer,color:e.colorText,overflow:"auto",padding:32}),style:{height:t,width:r},children:(0,o.FD)("div",{children:[(0,o.Y)("div",{children:(0,o.Y)("b",{children:(0,u.t)("Oops! An error occurred!")})}),(0,o.Y)("code",{children:e?e.toString():"Unknown Error"})]})})},height:400,width:"100%",enableNoResults:!0};class W extends i.PureComponent{constructor(...e){super(...e),this.core=void 0,this.createChartProps=p.A.createSelector(),this.parseDimension=(0,a.Mz)([({width:e})=>e,({height:e})=>e],(e,t)=>{const r=(0,c.A)(e),n=(0,c.A)(t),s={height:n.isDynamic?100*n.multiplier+"%":n.value,width:r.isDynamic?100*r.multiplier+"%":r.value};return{BoundingBox:r.isDynamic&&n.isDynamic&&1===r.multiplier&&1===n.multiplier?i.Fragment:({children:e})=>(0,o.Y)("div",{style:s,children:e}),heightInfo:n,widthInfo:r}}),this.setRef=e=>{this.core=e},this.getQueryCount=()=>{var e,t;return null!=(e=null==(t=(0,d.A)().get(this.props.chartType))?void 0:t.queryObjectCount)?e:1}}renderChart(e,t){const{id:r,className:i,chartType:s,preTransformProps:a,overrideTransformProps:l,postTransformProps:c,onRenderSuccess:d,onRenderFailure:u,disableErrorBoundary:h,FallbackComponent:m,onErrorBoundary:p,Wrapper:f,queriesData:g,enableNoResults:v,noResults:w,theme:y,..._}=this.props,D=this.createChartProps({..._,queriesData:g,height:t,width:e,theme:y});if((0,P.L2)(D.rawFormData)){const r=(0,o.Y)(q,{formData:D.rawFormData,datasource:D.datasource,width:e,height:t,hooks:D.hooks}),i=f?(0,o.Y)(f,{width:e,height:t,children:r}):r;return!0===h?i:(0,o.Y)(n.tH,{FallbackComponent:r=>(0,o.Y)(m,{width:e,height:t,...r}),onError:p,children:i})}let b;if(!v||g&&!g.slice(0,this.getQueryCount()).every(({data:e})=>!e||Array.isArray(e)&&0===e.length)){const n=(0,o.Y)(x,{ref:this.setRef,id:r,className:i,chartType:s,chartProps:D,preTransformProps:a,overrideTransformProps:l,postTransformProps:c,onRenderSuccess:d,onRenderFailure:u});b=f?(0,o.Y)(f,{width:e,height:t,children:n}):n}else b=w||(0,o.Y)($,{id:r,className:i,height:t,width:e});return!0===h?b:(0,o.Y)(n.tH,{FallbackComponent:r=>(0,o.Y)(m,{width:e,height:t,...r}),onError:p,children:b})}render(){const{heightInfo:e,widthInfo:t,BoundingBox:r}=this.parseDimension(this.props);if(t.isDynamic||e.isDynamic){const{debounceTime:i}=this.props;return(0,o.Y)(r,{children:(0,o.Y)(s.A,{debounceTime:i,children:({width:r,height:o})=>this.renderChart(t.isDynamic?Math.floor(r):t.value,e.isDynamic?Math.floor(o):e.value)})})}return this.renderChart(t.value,e.value)}}W.defaultProps=G;const Q=(0,l.b)(W)},57749:(e,t,r)=>{r.d(t,{AU:()=>i,IN:()=>s,JI:()=>o,L2:()=>n});const o={ExpressionType:{SIMPLE:"SIMPLE",SQL:"SQL"},Clause:{WHERE:"WHERE",HAVING:"HAVING"},Operator:{EQUALS:"==",NOT_EQUALS:"!=",IN:"IN",NOT_IN:"NOT IN"}};function i(e){const t=e.matrixify_mode_rows,r=e.matrixify_mode_columns;return t||r?{rows:{mode:e.matrixify_mode_rows||"metrics",metrics:e.matrixify_rows,selectionMode:e.matrixify_dimension_selection_mode_rows,dimension:e.matrixify_dimension_rows,topnValue:e.matrixify_topn_value_rows,topnMetric:e.matrixify_topn_metric_rows,topnOrder:e.matrixify_topn_order_rows},columns:{mode:e.matrixify_mode_columns||"metrics",metrics:e.matrixify_columns,selectionMode:e.matrixify_dimension_selection_mode_columns,dimension:e.matrixify_dimension_columns,topnValue:e.matrixify_topn_value_columns,topnMetric:e.matrixify_topn_metric_columns,topnOrder:e.matrixify_topn_order_columns}}:null}function n(e){var t,r;const o=!0===e.matrixify_enable_vertical_layout,n=!0===e.matrixify_enable_horizontal_layout;if(!o&&!n)return!1;const s=i(e);if(!s)return!1;const a="metrics"===s.rows.mode?s.rows.metrics&&s.rows.metrics.length>0:(null==(t=s.rows.dimension)?void 0:t.dimension)&&("topn"===s.rows.selectionMode||s.rows.dimension.values&&s.rows.dimension.values.length>0),l="metrics"===s.columns.mode?s.columns.metrics&&s.columns.metrics.length>0:(null==(r=s.columns.dimension)?void 0:r.dimension)&&("topn"===s.columns.selectionMode||s.columns.dimension.values&&s.columns.dimension.values.length>0);return Boolean(a||l)}function s(e){const t=[],r=!0===e.matrixify_enable_vertical_layout,o=!0===e.matrixify_enable_horizontal_layout;if(!r&&!o)return t;const n=i(e);if(!n)return t.push("Please configure at least one row or column axis"),t;const s=Boolean(e.matrixify_mode_rows);var a;s&&(("metrics"===n.rows.mode?n.rows.metrics&&n.rows.metrics.length>0:(null==(a=n.rows.dimension)?void 0:a.dimension)&&("topn"===n.rows.selectionMode||n.rows.dimension.values&&n.rows.dimension.values.length>0))||("metrics"===n.rows.mode?t.push("Please select at least one metric for rows"):t.push("Please select a dimension and values for rows")));const l=Boolean(e.matrixify_mode_columns);var c;l&&(("metrics"===n.columns.mode?n.columns.metrics&&n.columns.metrics.length>0:(null==(c=n.columns.dimension)?void 0:c.dimension)&&("topn"===n.columns.selectionMode||n.columns.dimension.values&&n.columns.dimension.values.length>0))||("metrics"===n.columns.mode?t.push("Please select at least one metric for columns"):t.push("Please select a dimension and values for columns")));if(s||l){var d,u;const e="metrics"===n.rows.mode?n.rows.metrics&&n.rows.metrics.length>0:(null==(d=n.rows.dimension)?void 0:d.dimension)&&("topn"===n.rows.selectionMode||n.rows.dimension.values&&n.rows.dimension.values.length>0),r="metrics"===n.columns.mode?n.columns.metrics&&n.columns.metrics.length>0:(null==(u=n.columns.dimension)?void 0:u.dimension)&&("topn"===n.columns.selectionMode||n.columns.dimension.values&&n.columns.dimension.values.length>0);e||r||t.push("Configure at least one complete row or column axis")}else t.push("Please configure at least one row or column axis");return t}},59923:(e,t,r)=>{r.d(t,{A:()=>l});var o=r(25508),i=r(69191),n=r(81465);const s=800,a=600;class l{constructor(e={theme:n.TT}){this.annotationData=void 0,this.datasource=void 0,this.rawDatasource=void 0,this.initialValues=void 0,this.formData=void 0,this.rawFormData=void 0,this.height=void 0,this.hooks=void 0,this.ownState=void 0,this.filterState=void 0,this.legendState=void 0,this.legendIndex=void 0,this.queriesData=void 0,this.width=void 0,this.behaviors=void 0,this.displaySettings=void 0,this.appSection=void 0,this.isRefreshing=void 0,this.inputRef=void 0,this.inContextMenu=void 0,this.emitCrossFilters=void 0,this.theme=void 0;const{annotationData:t={},datasource:r={},formData:o={},hooks:l={},ownState:c={},filterState:d={},legendState:u,legendIndex:h,initialValues:m={},queriesData:p=[],behaviors:f=[],displaySettings:g={},width:v=s,height:w=a,appSection:y,isRefreshing:x,inputRef:_,inContextMenu:D=!1,emitCrossFilters:b=!1,theme:S}=e;this.width=v,this.height=w,this.annotationData=t,this.datasource=(0,i.A)(r),this.rawDatasource=r,this.formData=(0,i.A)(o),this.rawFormData=o,this.hooks=l,this.initialValues=m,this.queriesData=p,this.ownState=c,this.filterState=d,this.legendState=u,this.legendIndex=h,this.behaviors=f,this.displaySettings=g,this.appSection=y,this.isRefreshing=x,this.inputRef=_,this.inContextMenu=D,this.emitCrossFilters=b,this.theme=S}}l.createSelector=void 0,l.createSelector=function(){return(0,o.Mz)(e=>e.annotationData,e=>e.datasource,e=>e.formData,e=>e.height,e=>e.hooks,e=>e.initialValues,e=>e.queriesData,e=>e.width,e=>e.ownState,e=>e.filterState,e=>e.legendState,e=>e.legendIndex,e=>e.behaviors,e=>e.displaySettings,e=>e.appSection,e=>e.isRefreshing,e=>e.inputRef,e=>e.inContextMenu,e=>e.emitCrossFilters,e=>e.theme,(e,t,r,o,i,n,s,a,c,d,u,h,m,p,f,g,v,w,y,x)=>new l({annotationData:e,datasource:t,formData:r,height:o,hooks:i,initialValues:n,queriesData:s,ownState:c,filterState:d,legendState:u,legendIndex:h,width:a,behaviors:m,displaySettings:p,appSection:f,isRefreshing:g,inputRef:v,inContextMenu:w,emitCrossFilters:y,theme:x}),{memoize:o.i5,argsMemoize:o.i5,memoizeOptions:{maxSize:10}})}},62053:(e,t,r)=>{r.d(t,{h:()=>n});var o=r(24002),i=r(67413);function n(e,t){const r=(0,i.Z)(e);(0,o.useEffect)(()=>{e!==r&&t(r,e)},[e,r,t])}},86646:(e,t,r)=>{r.d(t,{A:()=>a});var o=r(79378),i=r(74842),n=r(94122),s=r(18749);class a{constructor(e={}){this.client=void 0;const{client:t=o.A}=e;this.client=t}loadFormData(e,t){return"sliceId"in e?this.client.get({endpoint:`/api/v1/form_data/?slice_id=${e.sliceId}`,...t}).then(e=>e.json).then(t=>({...t,...e.formData})):e.formData?Promise.resolve(e.formData):Promise.reject(new Error("At least one of sliceId or formData must be specified"))}async loadQueryData(e,t){const{viz_type:r}=e,o=(0,s.A)(),i=(0,n.A)();if(o.has(r)){var a;const{useLegacyApi:n}=o.get(r),s=null!=(a=await i.get(r))?a:()=>e,l=n?{endpoint:"/superset/explore_json/",postPayload:{form_data:s(e)},...t}:{endpoint:"/api/v1/chart/data",jsonPayload:{query_context:s(e)},...t};return this.client.post(l).then(e=>Array.isArray(e.json)?e.json:[e.json])}return Promise.reject(new Error(`Unknown chart type: ${r}`))}loadDatasource(e,t){return this.client.get({endpoint:`/superset/fetch_datasource_metadata?datasourceKey=${e}`,...t}).then(e=>e.json)}loadAnnotation(e){return(0,i.A)(e.sourceType)?Promise.reject(new Error("This feature is not implemented yet.")):Promise.resolve({})}loadAnnotations(e){return Array.isArray(e)&&e.length>0?Promise.all(e.map(e=>this.loadAnnotation(e))).then(t=>e.reduce((e,r,o)=>{const i=e;return i[r.name]=t[o],i},{})):Promise.resolve({})}loadChartData(e){return this.loadFormData(e).then(e=>Promise.all([this.loadAnnotations(e.annotation_layers),this.loadDatasource(e.datasource),this.loadQueryData(e)]).then(([t,r,o])=>({annotationData:t,datasource:r,formData:e,queriesData:o})))}}}}]);