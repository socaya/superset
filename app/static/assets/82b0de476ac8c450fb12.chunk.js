(globalThis.webpackChunksuperset=globalThis.webpackChunksuperset||[]).push([[3017],{45854:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>j});var l=a(50014),r=a.n(l),i=a(2445),n=a(74098),o=a(79378),s=a(18749),d=a(81465),c=a(99106),u=a(24002),h=a(58561),p=a.n(h),m=a(61225),b=a(71323),y=a(86784),g=a(51304),_=a(29645),f=a(38961),v=a(54569),w=a(40105),S=a(95018),C=a(5250),T=a(56196),k=a(9876),Y=a(20237),x=a(61574),A=a(71519),F=a(24777),z=a(64457),D=a(67314),I=a(8558),H=a(92026),M=a(47068),E=a(57771),O=a(2618),P=a(90886),L=a(79605),B=a(66124);const N=d.I4.div`
  align-items: center;
  display: flex;
  gap: ${({theme:e})=>e.sizeUnit}px;

  a {
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    line-height: 1.2;
  }

  svg {
    margin-right: ${({theme:e})=>e.sizeUnit}px;
  }
`,R=(0,n.t)('The passwords for the databases below are needed in order to import them together with the charts. Please note that the "Secure Extra" and "Certificate" sections of the database configuration are not present in export files, and should be added manually after the import if they are needed.'),W=(0,n.t)("You are importing one or more charts that already exist. Overwriting might cause you to lose some of your work. Are you sure you want to overwrite?"),$=(0,s.A)(),U=async(e="",t,a)=>{var l;const i=e?{filters:[{col:"table_name",opr:"sw",value:e}]}:{},n=p().encode({columns:["datasource_name","datasource_id"],keys:["none"],order_column:"table_name",order_direction:"asc",page:t,page_size:a,...i}),{json:s={}}=await o.A.get({endpoint:`/api/v1/dataset/?q=${n}`}),d=null==s||null==(l=s.result)?void 0:l.map(({table_name:e,id:t})=>({label:e,value:t}));return{data:r()(d,"value"),totalCount:null==s?void 0:s.count}},K=d.I4.div`
  color: ${({theme:e})=>e.colorIcon};
`,j=(0,z.Ay)(function(e){const{addDangerToast:t,addSuccessToast:a,user:{userId:l}}=e,s=(0,x.W6)(),{state:{loading:d,resourceCount:h,resourceCollection:z,bulkSelectEnabled:j},setResourceCollection:q,hasPerm:G,fetchData:V,toggleBulkSelect:J,refreshData:X}=(0,y.RU)("chart",(0,n.t)("chart"),t),Q=(0,u.useMemo)(()=>z.map(e=>e.id),[z]),{roles:Z}=(0,m.d4)(e=>e.user),ee=(0,P.L)("can_read","Tag",Z),[te,ae]=(0,y.oG)("chart",Q,t),{sliceCurrentlyEditing:le,handleChartUpdated:re,openChartEditModal:ie,closeChartEditModal:ne}=(0,y.bR)(q,z),[oe,se]=(0,u.useState)(!1),[de,ce]=(0,u.useState)([]),[ue,he]=(0,u.useState)(!1),[pe,me]=(0,u.useState)([]),[be,ye]=(0,u.useState)([]),[ge,_e]=(0,u.useState)([]),fe=(0,F.SX)(null==l?void 0:l.toString(),null),ve=G("can_write"),we=G("can_write"),Se=G("can_write"),Ce=G("can_export"),Te=[{id:"changed_on_delta_humanized",desc:!0}],ke=async e=>{const a=e.map(({id:e})=>e);he(!0);try{await(0,g.A)("chart",a,()=>{he(!1)})}catch(e){he(!1),t((0,n.t)("There was an issue exporting the selected charts"))}},Ye=async(e="",a,l)=>{var i,s;const d=e?{filters:[{col:"dashboard_title",opr:k.c0.StartsWith,value:e}]}:{},c=p().encode({select_columns:["dashboard_title","id"],keys:["none"],order_column:"dashboard_title",order_direction:"asc",page:a,page_size:l,...d}),u=await o.A.get({endpoint:`/api/v1/dashboard/?q=${c}`}).catch(()=>t((0,n.t)("An error occurred while fetching dashboards"))),h=null==u||null==(i=u.json)||null==(i=i.result)?void 0:i.map(({dashboard_title:e,id:t})=>({label:e,value:t}));return{data:r()(h,"value"),totalCount:null==u||null==(s=u.json)?void 0:s.count}},xe=(0,u.useMemo)(()=>[{Cell:({row:{original:{id:e}}})=>l&&(0,i.Y)(w.$,{itemId:e,saveFaveStar:te,isStarred:ae[e]}),Header:"",id:"id",disableSortBy:!0,size:"xs",hidden:!l},{Cell:({row:{original:{url:e,slice_name:t,certified_by:a,certification_details:l,description:r,is_public:n}}})=>(0,i.FD)(N,{children:[(0,i.FD)(A.N_,{to:e,children:[a&&(0,i.FD)(i.FK,{children:[(0,i.Y)(v.T,{certifiedBy:a,details:l})," "]}),t]}),n&&(0,i.Y)(_.Tag,{color:"green",style:{marginLeft:"8px"},children:"ðŸ”“ PUBLIC"}),r&&(0,i.Y)(C.I,{tooltip:r})]}),Header:(0,n.t)("Name"),accessor:"slice_name",id:"slice_name"},{Cell:({row:{original:{viz_type:e}}})=>{var t;return(null==(t=$.get(e))?void 0:t.name)||e},Header:(0,n.t)("Type"),accessor:"viz_type",id:"viz_type"},{Cell:({row:{original:{datasource_name_text:e,datasource_url:t}}})=>{const a=e?e.includes(".")?e.split(".").slice(1).join("."):e:"";return(0,i.Y)(S.m,{title:e,placement:"top",children:(0,i.Y)(k.Kt,{to:t,children:a})})},Header:(0,n.t)("Dataset"),accessor:"datasource_id",disableSortBy:!0,size:"xl",id:"datasource_id"},{Cell:({row:{original:{dashboards:e}}})=>(0,i.Y)(k.oq,{dashboards:e}),Header:(0,n.t)("On dashboards"),accessor:"dashboards",disableSortBy:!0,size:"xl",id:"dashboards"},{Cell:({row:{original:{tags:e=[]}}})=>(0,i.Y)(k.Sk,{tags:e.filter(e=>!e.type||e.type===M.U.Custom||"TagTypes.custom"===e.type),maxTags:3}),Header:(0,n.t)("Tags"),accessor:"tags",disableSortBy:!0,hidden:!(0,c.G7)(c.TO.TaggingSystem),id:"tags"},{Cell:({row:{original:{owners:e=[]}}})=>(0,i.Y)(k.WM,{users:e}),Header:(0,n.t)("Owners"),accessor:"owners",disableSortBy:!0,size:"xl",id:"owners"},{Cell:({row:{original:{changed_on_delta_humanized:e,changed_by:t}}})=>(0,i.Y)(k.UW,{date:e,user:t}),Header:(0,n.t)("Last modified"),accessor:"last_saved_at",size:"xl",id:"last_saved_at"},{Cell:({row:{original:e}})=>we||Se||Ce?(0,i.FD)(K,{className:"actions",children:[Se&&(0,i.Y)(f.h,{title:(0,n.t)("Please confirm"),description:(0,i.FD)(i.FK,{children:[(0,n.t)("Are you sure you want to delete")," ",(0,i.Y)("b",{children:e.slice_name}),"?"]}),onConfirm:()=>(0,b.GP)(e,a,t,X),children:e=>(0,i.Y)(S.m,{id:"delete-action-tooltip",title:(0,n.t)("Delete"),placement:"bottom",children:(0,i.Y)("span",{role:"button",tabIndex:0,className:"action-button",onClick:e,children:(0,i.Y)(I.F.DeleteOutlined,{iconSize:"l"})})})}),Ce&&(0,i.Y)(S.m,{id:"export-action-tooltip",title:(0,n.t)("Export"),placement:"bottom",children:(0,i.Y)("span",{role:"button",tabIndex:0,className:"action-button",onClick:()=>ke([e]),children:(0,i.Y)(I.F.UploadOutlined,{iconSize:"l"})})}),we&&(0,i.Y)(S.m,{id:"edit-action-tooltip",title:(0,n.t)("Edit"),placement:"bottom",children:(0,i.Y)("span",{role:"button",tabIndex:0,className:"action-button",onClick:()=>ie(e),children:(0,i.Y)(I.F.EditOutlined,{iconSize:"l"})})}),we&&(0,i.Y)(S.m,{id:"public-access-toggle-tooltip",title:e.is_public?(0,n.t)("Public - Click to make private"):(0,n.t)("Private - Click to make public"),placement:"bottom",children:(0,i.Y)("span",{role:"button",tabIndex:0,className:"action-button",onClick:async()=>{const l=!e.is_public;try{await o.A.put({endpoint:`/api/v1/chart/${e.id}`,jsonPayload:{is_public:l}}),a(l?(0,n.t)("Chart is now publicly accessible"):(0,n.t)("Chart is now private")),X()}catch(e){t((0,n.t)("Failed to update chart access"))}},style:{color:e.is_public?"#52c41a":"#8c8c8c",fontSize:"18px",fontWeight:"bold"},children:e.is_public?"ðŸ”“":"ðŸ”’"})})]}):null,Header:(0,n.t)("Actions"),id:"actions",size:"lg",disableSortBy:!0,hidden:!we&&!Se},{accessor:L.H.ChangedBy,hidden:!0,id:L.H.ChangedBy}],[l,we,Se,Ce,te,ae,X,a,t]),Ae=(0,u.useMemo)(()=>({Header:(0,n.t)("Favorite"),key:"favorite",id:"id",urlDisplay:"favorite",input:"select",operator:k.c0.ChartIsFav,unfilteredLabel:(0,n.t)("Any"),selects:[{label:(0,n.t)("Yes"),value:!0},{label:(0,n.t)("No"),value:!1}]}),[]),Fe=(0,u.useMemo)(()=>[{Header:(0,n.t)("Name"),key:"search",id:"slice_name",input:"search",operator:k.c0.ChartAllText},{Header:(0,n.t)("Type"),key:"viz_type",id:"viz_type",input:"select",operator:k.c0.Equals,unfilteredLabel:(0,n.t)("All"),selects:$.keys().filter(e=>{var t;return(0,H.px)((null==(t=$.get(e))?void 0:t.behaviors)||[])}).map(e=>{var t;return{label:(null==(t=$.get(e))?void 0:t.name)||e,value:e}}).sort((e,t)=>e.label&&t.label?e.label>t.label?1:e.label<t.label?-1:0:0)},{Header:(0,n.t)("Dataset"),key:"dataset",id:"datasource_id",input:"select",operator:k.c0.Equals,unfilteredLabel:(0,n.t)("All"),fetchSelects:U,paginate:!0,dropdownStyle:{minWidth:B.f8}},...(0,c.G7)(c.TO.TaggingSystem)&&ee?[{Header:(0,n.t)("Tag"),key:"tags",id:"tags",input:"select",operator:k.c0.ChartTagById,unfilteredLabel:(0,n.t)("All"),fetchSelects:E.m}]:[],{Header:(0,n.t)("Owner"),key:"owner",id:"owners",input:"select",operator:k.c0.RelationManyMany,unfilteredLabel:(0,n.t)("All"),fetchSelects:(0,b.u1)("chart","owners",(0,b.JF)(e=>t((0,n.t)("An error occurred while fetching chart owners values: %s",e))),e.user),paginate:!0,dropdownStyle:{minWidth:B.f8}},{Header:(0,n.t)("Dashboard"),key:"dashboards",id:"dashboards",input:"select",operator:k.c0.RelationManyMany,unfilteredLabel:(0,n.t)("All"),fetchSelects:Ye,paginate:!0,dropdownStyle:{minWidth:B.f8}},...l?[Ae]:[],{Header:(0,n.t)("Certified"),key:"certified",id:"id",urlDisplay:"certified",input:"select",operator:k.c0.ChartIsCertified,unfilteredLabel:(0,n.t)("Any"),selects:[{label:(0,n.t)("Yes"),value:!0},{label:(0,n.t)("No"),value:!1}]},{Header:(0,n.t)("Modified by"),key:"changed_by",id:"changed_by",input:"select",operator:k.c0.RelationOneMany,unfilteredLabel:(0,n.t)("All"),fetchSelects:(0,b.u1)("chart","changed_by",(0,b.JF)(e=>(0,n.t)("An error occurred while fetching dataset datasource values: %s",e)),e.user),paginate:!0,dropdownStyle:{minWidth:B.f8}}],[t,Ae,e.user]),ze=[{desc:!1,id:"slice_name",label:(0,n.t)("Alphabetical"),value:"alphabetical"},{desc:!0,id:"changed_on_delta_humanized",label:(0,n.t)("Recently modified"),value:"recently_modified"},{desc:!1,id:"changed_on_delta_humanized",label:(0,n.t)("Least recently modified"),value:"least_recently_modified"}],De=(0,u.useCallback)(e=>(0,i.Y)(O.A,{chart:e,showThumbnails:fe?fe.thumbnails:(0,c.G7)(c.TO.Thumbnails),hasPerm:G,openChartEditModal:ie,bulkSelectEnabled:j,addDangerToast:t,addSuccessToast:a,refreshData:X,userId:l,loading:d,favoriteStatus:ae[e.id],saveFavoriteStatus:te,handleBulkChartExport:ke}),[t,a,j,ae,G,d]),Ie=[];return ve&&Ie.push({name:(0,i.Y)(S.m,{id:"import-tooltip",title:(0,n.t)("Import charts"),placement:"bottomRight",children:(0,i.Y)(I.F.DownloadOutlined,{iconSize:"l"})}),buttonStyle:"link",onClick:()=>{se(!0)}}),(Se||Ce)&&Ie.push({name:(0,n.t)("Bulk select"),buttonStyle:"secondary",onClick:J}),ve&&Ie.push({icon:(0,i.Y)(I.F.PlusOutlined,{iconSize:"m"}),name:(0,n.t)("Chart"),buttonStyle:"primary",onClick:()=>{s.push("/chart/add")}}),(0,i.FD)(i.FK,{children:[(0,i.Y)(Y.A,{name:(0,n.t)("Charts"),buttons:Ie}),le&&(0,i.Y)(D.A,{onHide:ne,onSave:re,show:!0,slice:le}),(0,i.Y)(f.h,{title:(0,n.t)("Please confirm"),description:(0,n.t)("Are you sure you want to delete the selected charts?"),onConfirm:function(e){o.A.delete({endpoint:`/api/v1/chart/?q=${p().encode(e.map(({id:e})=>e))}`}).then(({json:e={}})=>{X(),a(e.message)},(0,b.JF)(e=>t((0,n.t)("There was an issue deleting the selected charts: %s",e))))},children:e=>{const l=(0,c.G7)(c.TO.TaggingSystem),r=[];return Se&&r.push({key:"delete",name:(0,n.t)("Delete"),type:"danger",onSelect:e}),Ce&&r.push({key:"export",name:(0,n.t)("Export"),type:"primary",onSelect:ke}),(0,i.Y)(k.uO,{bulkActions:r,bulkSelectEnabled:j,cardSortSelectOptions:ze,className:"chart-list-view",columns:xe,count:h,data:z,disableBulkSelect:J,refreshData:X,fetchData:V,filters:Fe,initialSort:Te,loading:d,pageSize:25,renderCard:De,enableBulkTag:l,bulkTagResourceName:"chart",addSuccessToast:a,addDangerToast:t,showThumbnails:fe?fe.thumbnails:(0,c.G7)(c.TO.Thumbnails),defaultViewMode:(0,c.G7)(c.TO.ListviewsDefaultCardView)?"card":"table"})}}),(0,i.Y)(k.zb,{resourceName:"chart",resourceLabel:(0,n.t)("chart"),passwordsNeededMessage:R,confirmOverwriteMessage:W,addDangerToast:t,addSuccessToast:a,onModelImport:()=>{se(!1),X(),a((0,n.t)("Chart imported"))},show:oe,onHide:()=>{se(!1)},passwordFields:de,setPasswordFields:ce,sshTunnelPasswordFields:pe,setSSHTunnelPasswordFields:me,sshTunnelPrivateKeyFields:be,setSSHTunnelPrivateKeyFields:ye,sshTunnelPrivateKeyPasswordFields:ge,setSSHTunnelPrivateKeyPasswordFields:_e}),ue&&(0,i.Y)(T.R,{})]})})},50014:(e,t,a)=>{var l=a(15389),r=a(55765);e.exports=function(e,t){return e&&e.length?r(e,l(t,2)):[]}},92026:(e,t,a)=>{"use strict";a.d(t,{Kg:()=>b,J8:()=>p,Pz:()=>y,tg:()=>u,pY:()=>h,px:()=>m});var l=a(31463),r=a(81115),i=a(74098),n=a(46772);const o=e=>null!=e&&"function"==typeof e[Symbol.iterator];var s=a(29624),d=a(32064);const c=()=>{var e;const t=(0,d.Ay)();return(null==t||null==(e=t.common)||null==(e=e.conf)?void 0:e.NATIVE_FILTER_DEFAULT_ROW_LIMIT)||1e3},u=({datasetId:e,dependencies:t={},groupby:a,defaultDataMask:l,controlValues:r,filterType:i,sortMetric:o,adhoc_filters:s,time_range:d,granularity_sqla:u,type:h,dashboardId:p,id:m,cascade_parent_column:b,cascade_parent_value:y})=>{var g;const _={};e&&(_.datasource=`${e}__table`),a&&(_.groupby=[a]),o&&(_.sortMetric=o);const f={...r,..._,adhoc_filters:null!=s?s:[],extra_filters:[],extra_form_data:t,granularity_sqla:u,metrics:["count"],row_limit:c(),showSearch:!0,defaultValue:null==l||null==(g=l.filterState)?void 0:g.value,time_range:d,url_params:(0,n.A)("regular"),inView:!0,viz_type:i,type:h,dashboardId:p,native_filter_id:m};return b&&void 0!==y&&(f.cascade_parent_column=b,f.cascade_parent_value=y),f};function h(e={},t={}){const a={};return l.t1.forEach(l=>{const r=e[l],i=t[l],n=[...o(r)?r:[],...o(i)?i:[]];n.length&&(a[l]=n)}),l.zk.forEach(l=>{const r=e[l];void 0!==r&&(a[l]=r);const i=t[l];void 0!==i&&(a[l]=i)}),a}function p(e,t){let a={};return t.forEach(t=>{var l,r;a=h(a,null!=(l=null==(r=e[t])?void 0:r.extraFormData)?l:{})}),a}function m(e){return!e.includes(r.nS.NativeFilter)||e.includes(r.nS.InteractiveChart)}const b=(e,t)=>new Set(t.map(t=>{var a;return null==(a=e.find(e=>{var a;return(null==e||null==(a=e.meta)?void 0:a.chartId)===t}))||null==(a=a.parents)?void 0:a.filter(e=>e.startsWith(`${s.B8}-`))}).filter(e=>void 0!==e).flat()),y=e=>null==e?"":"string"==typeof e||"number"==typeof e?`${e}`:Array.isArray(e)?e.join(", "):"object"==typeof e?JSON.stringify(e):(0,i.t)("Unknown value")}}]);