Loaded your LOCAL configuration at [/Users/stephocay/projects/hispuganda/superset/superset_config.py]
2025-12-08 10:08:28,198:INFO:alembic.runtime.migration:Context impl SQLiteImpl.
2025-12-08 10:08:28,198:INFO:alembic.runtime.migration:Will assume non-transactional DDL.
2025-12-08 10:08:28,309:INFO:superset.app:Syncing configuration to database...
2025-12-08 10:08:28,312:INFO:superset.app:Configuration sync to database completed successfully
 * Serving Flask app 'superset'
 * Debug mode: on
2025-12-08 10:08:28,577:INFO:werkzeug:[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:8088
2025-12-08 10:08:28,578:INFO:werkzeug:[33mPress CTRL+C to quit[0m
2025-12-08 10:08:28,638:INFO:werkzeug: * Restarting with watchdog (fsevents)
Loaded your LOCAL configuration at [/Users/stephocay/projects/hispuganda/superset/superset_config.py]
2025-12-08 10:08:29,583:INFO:alembic.runtime.migration:Context impl SQLiteImpl.
2025-12-08 10:08:29,583:INFO:alembic.runtime.migration:Will assume non-transactional DDL.
2025-12-08 10:08:29,656:INFO:superset.app:Syncing configuration to database...
2025-12-08 10:08:29,659:INFO:superset.app:Configuration sync to database completed successfully
2025-12-08 10:08:29,881:WARNING:werkzeug: * Debugger is active!
2025-12-08 10:08:29,891:INFO:werkzeug: * Debugger PIN: 114-810-287
2025-12-08 10:08:29,961:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:08:29] "GET /health HTTP/1.1" 200 -
2025-12-08 10:08:37,402:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:08:37] "[32mGET / HTTP/1.1[0m" 302 -
2025-12-08 10:08:38,259:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:08:38] "GET /superset/welcome/ HTTP/1.1" 200 -
2025-12-08 10:08:38,314:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:08:38] "GET /static/assets/theme.de8cc49a.entry.js HTTP/1.1" 200 -
2025-12-08 10:08:38,383:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:08:38] "GET /static/assets/packages_superset-ui-switchboard_src_index_ts-src_components_MessageToasts_ToastContainer_tsx-622036.ce49c634.entry.js HTTP/1.1" 200 -
2025-12-08 10:08:38,392:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:08:38] "GET /static/assets/packages_superset-ui-core_src_ui-overrides_ExtensionsRegistry_ts-src_components_UiConfigConte-27f319.c47b140b.entry.js HTTP/1.1" 200 -
2025-12-08 10:08:38,394:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:08:38] "GET /static/assets/spa.99b0c350.entry.js HTTP/1.1" 200 -
2025-12-08 10:08:38,433:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1458, in dispatch_request
    self.raise_routing_exception(req)
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1440, in raise_routing_exception
    raise request.routing_exception  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/ctx.py", line 353, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/werkzeug/routing/map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-12-08 10:08:38,435:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:08:38] "[33mGET /ws HTTP/1.1[0m" 404 -
2025-12-08 10:08:38,909:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:08:38] "GET /api/v1/database/?q=(filters:!((col:allow_file_upload,opr:upload_is_enabled,value:!t))) HTTP/1.1" 200 -
2025-12-08 10:08:39,133:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:08:39] "GET /api/v1/saved_query/?q=(filters:!((col:created_by,opr:rel_o_m,value:'1')),order_column:changed_on_delta_humanized,order_direction:desc,page:0,page_size:5) HTTP/1.1" 200 -
2025-12-08 10:08:39,138:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:08:39] "GET /api/v1/database/?q=(filters:!((col:database_name,opr:neq,value:examples))) HTTP/1.1" 200 -
2025-12-08 10:08:39,144:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:08:39] "GET /api/v1/log/recent_activity/?q=(distinct:!f,page_size:24) HTTP/1.1" 200 -
2025-12-08 10:08:39,198:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:08:39] "GET /api/v1/dashboard/?q=(filters:!((col:owners,opr:rel_m_m,value:'1')),order_column:changed_on_delta_humanized,order_direction:desc,page:0,page_size:5) HTTP/1.1" 200 -
2025-12-08 10:08:39,199:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:08:39] "GET /api/v1/chart/?q=(filters:!((col:owners,opr:rel_m_m,value:'1')),order_column:changed_on_delta_humanized,order_direction:desc,page:0,page_size:5) HTTP/1.1" 200 -
2025-12-08 10:08:39,207:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:08:39] "GET /api/v1/dashboard/?q=(filters:!(),order_column:changed_on_delta_humanized,order_direction:desc,page:0,page_size:5) HTTP/1.1" 200 -
2025-12-08 10:08:39,210:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:08:39] "GET /api/v1/chart/?q=(filters:!(),order_column:changed_on_delta_humanized,order_direction:desc,page:0,page_size:5) HTTP/1.1" 200 -
2025-12-08 10:08:39,287:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:08:39] "GET /api/v1/dashboard/favorite_status/?q=!(1) HTTP/1.1" 200 -
2025-12-08 10:08:39,289:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:08:39] "GET /api/v1/chart/_info?q=(keys:!(permissions)) HTTP/1.1" 200 -
2025-12-08 10:08:39,293:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:08:39] "GET /api/v1/dashboard/_info?q=(keys:!(permissions)) HTTP/1.1" 200 -
2025-12-08 10:08:39,294:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:08:39] "GET /api/v1/chart/favorite_status/?q=!(2,1) HTTP/1.1" 200 -
2025-12-08 10:08:39,799:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:08:39] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-08 10:08:39,884:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1458, in dispatch_request
    self.raise_routing_exception(req)
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1440, in raise_routing_exception
    raise request.routing_exception  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/ctx.py", line 353, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/werkzeug/routing/map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-12-08 10:08:39,886:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:08:39] "[33mGET /ws HTTP/1.1[0m" 404 -
2025-12-08 10:08:41,918:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1458, in dispatch_request
    self.raise_routing_exception(req)
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1440, in raise_routing_exception
    raise request.routing_exception  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/ctx.py", line 353, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/werkzeug/routing/map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-12-08 10:08:41,919:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:08:41] "[33mGET /ws HTTP/1.1[0m" 404 -
2025-12-08 10:08:43,199:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:08:43] "GET /static/assets/DashboardContainer.6ac9e479.chunk.js HTTP/1.1" 200 -
2025-12-08 10:08:43,201:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:08:43] "GET /api/v1/dashboard/1/charts HTTP/1.1" 200 -
2025-12-08 10:08:43,222:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:08:43] "GET /api/v1/dashboard/1 HTTP/1.1" 200 -
2025-12-08 10:08:43,230:INFO:superset.db_engine_specs.dhis2:[DHIS2] get_parameters_from_uri called
2025-12-08 10:08:43,230:ERROR:superset.db_engine_specs.dhis2:[DHIS2] Failed to extract parameters from URI: 'URL' object has no attribute 'decode'
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/superset/db_engine_specs/dhis2.py", line 361, in get_parameters_from_uri
    parsed = urlparse(uri)
             ^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/urllib/parse.py", line 394, in urlparse
    url, scheme, _coerce_result = _coerce_args(url, scheme)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/urllib/parse.py", line 133, in _coerce_args
    return _decode_args(args) + (_encode_result,)
           ^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/urllib/parse.py", line 117, in _decode_args
    return tuple(x.decode(encoding, errors) if x else '' for x in args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/urllib/parse.py", line 117, in <genexpr>
    return tuple(x.decode(encoding, errors) if x else '' for x in args)
                 ^^^^^^^^
AttributeError: 'URL' object has no attribute 'decode'
2025-12-08 10:08:43,245:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:08:43] "GET /api/v1/dashboard/1/datasets HTTP/1.1" 200 -
2025-12-08 10:08:43,379:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:08:43] "GET /api/v1/dashboard/favorite_status/?q=!(1) HTTP/1.1" 200 -
2025-12-08 10:08:43,436:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:08:43] "GET /api/v1/dataset/1/drill_info/?q=(dashboard_id:1) HTTP/1.1" 200 -
2025-12-08 10:08:43,438:ERROR:superset.models.helpers:[METRICS-TRACE] Processing 4 metrics
2025-12-08 10:08:43,438:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 0: adhoc - SUM(105_EP01b_Malaria_Total)
2025-12-08 10:08:43,438:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105_EP01b_Malaria_Total)
2025-12-08 10:08:43,438:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 1: adhoc - SUM(105_EP01a_Suspected_fever)
2025-12-08 10:08:43,438:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105_EP01a_Suspected_fever)
2025-12-08 10:08:43,438:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 2: adhoc - SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)
2025-12-08 10:08:43,438:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)
2025-12-08 10:08:43,438:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 3: adhoc - SUM(105_EP01d_Malaria_cases_treated)
2025-12-08 10:08:43,438:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105_EP01d_Malaria_cases_treated)
2025-12-08 10:08:43,438:ERROR:superset.models.helpers:[METRICS-TRACE] Total metrics added: 4
2025-12-08 10:08:43,440:ERROR:superset.models.helpers:[METRICS-TRACE] Before dedup: 1 select_exprs + 4 metrics_exprs
2025-12-08 10:08:43,440:ERROR:superset.models.helpers:[METRICS-TRACE] After dedup: 5 total select_exprs
2025-12-08 10:08:43,440:INFO:superset.models.helpers:[COLUMN_TRACE] SQL Query Building:
2025-12-08 10:08:43,440:INFO:superset.models.helpers:[COLUMN_TRACE]   columns: [{'timeGrain': None, 'columnType': 'BASE_AXIS', 'sqlExpression': 'Period', 'label': 'Period', 'expressionType': 'SQL'}]
2025-12-08 10:08:43,440:INFO:superset.models.helpers:[COLUMN_TRACE]   metrics: [{'aggregate': 'SUM', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01b_Malaria_Total', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 3, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'INT', 'type_generic': 0, 'uuid': '959bffaa-826b-4d13-8b7b-6d9c4ea25e50', 'verbose_name': None, 'warning_markdown': None}, 'datasourceWarning': False, 'expressionType': 'SIMPLE', 'hasCustomLabel': False, 'label': 'SUM(105_EP01b_Malaria_Total)', 'optionName': 'metric_znmagih9lh_z0o3nswr22s', 'sqlExpression': None}, {'aggregate': 'SUM', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01a_Suspected_fever', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 4, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'INT', 'type_generic': 0, 'uuid': '530216fe-7198-4b8e-b688-a479bcf67426', 'verbose_name': None, 'warning_markdown': None}, 'datasourceWarning': False, 'expressionType': 'SIMPLE', 'hasCustomLabel': False, 'label': 'SUM(105_EP01a_Suspected_fever)', 'optionName': 'metric_i2yj88mm5ns_m44ybd4y0kf', 'sqlExpression': None}, {'aggregate': 'SUM', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 6, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'INT', 'type_generic': 0, 'uuid': '928946a1-6cea-4202-b8d6-0683414af79e', 'verbose_name': None, 'warning_markdown': None}, 'datasourceWarning': False, 'expressionType': 'SIMPLE', 'hasCustomLabel': False, 'label': 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', 'optionName': 'metric_3uikxtyu9ub_glmo09kn46e', 'sqlExpression': None}, {'aggregate': 'SUM', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01d_Malaria_cases_treated', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 5, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'INT', 'type_generic': 0, 'uuid': 'ffc52aba-a038-4c22-b6c8-169f3e2b8b97', 'verbose_name': None, 'warning_markdown': None}, 'datasourceWarning': False, 'expressionType': 'SIMPLE', 'hasCustomLabel': False, 'label': 'SUM(105_EP01d_Malaria_cases_treated)', 'optionName': 'metric_220hw0duag7_2181rn37iln', 'sqlExpression': None}]
2025-12-08 10:08:43,440:INFO:superset.models.helpers:[COLUMN_TRACE]   groupby: []
2025-12-08 10:08:43,440:INFO:superset.models.helpers:[COLUMN_TRACE]   labels_expected: ['Period', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-08 10:08:43,440:INFO:superset.models.helpers:[COLUMN_TRACE]   select_exprs count: 5
2025-12-08 10:08:43,440:INFO:superset.models.helpers:[COLUMN_TRACE]     [0] key=Period, name=Period, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-08 10:08:43,440:INFO:superset.models.helpers:[COLUMN_TRACE]     [1] key=SUM(105_EP01b_Malaria_Total), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-08 10:08:43,440:INFO:superset.models.helpers:[COLUMN_TRACE]     [2] key=SUM(105_EP01a_Suspected_fever), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-08 10:08:43,440:INFO:superset.models.helpers:[COLUMN_TRACE]     [3] key=SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-08 10:08:43,440:INFO:superset.models.helpers:[COLUMN_TRACE]     [4] key=SUM(105_EP01d_Malaria_cases_treated), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-08 10:08:43,440:INFO:superset.connectors.sqla.models:[DHIS2] get_from_clause for virtual dataset 1: analytics_LAST_YEAR_20251206
2025-12-08 10:08:43,440:INFO:superset.connectors.sqla.models:[DHIS2] Full SQL stored: SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
2025-12-08 10:08:43,440:INFO:superset.connectors.sqla.models:[DHIS2] Loaded params from extra field: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayPropert
2025-12-08 10:08:43,441:INFO:superset.connectors.sqla.models:[DHIS2] Cached params with key: dhis2_params_1_analytics
2025-12-08 10:08:43,441:INFO:superset.connectors.sqla.models:[DHIS2] Stored params in Flask g for DHIS2 table: analytics
2025-12-08 10:08:43,443:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Query execution in connectors/sqla/models.py:
2025-12-08 10:08:43,443:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   SQL (first 500 chars): SELECT "Period", sum("105_EP01b_Malaria_Total") AS sum_1, sum("105_EP01a_Suspected_fever") AS sum_2, sum("105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive") AS sum_3, sum("105_EP01d_Malaria_cases_treated") AS sum_4 
FROM (SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
) AS virtual_table GROUP BY "Period" ORDER BY sum("105_EP01b_Malaria_
2025-12-08 10:08:43,443:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   labels_expected: ['Period', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-08 10:08:43,444:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 connection initialized: https://tests.dhis2.hispuganda.org/hmis/api
2025-12-08 10:08:43,445:INFO:superset.db_engine_specs.dhis2_dialect:Executing DHIS2 query: SELECT
  "Period",
  SUM("105_EP01b_Malaria_Total") AS sum_1,
  SUM("105_EP01a_Suspected_fever") AS sum_2,
  SUM("105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive") AS sum_3,
  SUM("105_EP01d_Malaria_cases_treated") AS sum_4
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "Period"
ORDER BY
  SUM("105_EP01b_Malaria_Total") DESC
LIMIT 10000
2025-12-08 10:08:43,445:INFO:superset.db_engine_specs.dhis2_dialect:Parsed endpoint: analytics
2025-12-08 10:08:43,445:INFO:superset.db_engine_specs.dhis2_dialect:Using stored parameters from Flask g for table: analytics
2025-12-08 10:08:43,445:INFO:superset.db_engine_specs.dhis2_dialect:Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
2025-12-08 10:08:43,445:INFO:superset.db_engine_specs.dhis2_dialect:Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
2025-12-08 10:08:43,445:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API request: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
2025-12-08 10:08:43,915:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:08:43] "[35m[1mPOST /api/v1/dashboard/1/filter_state?tab_id=21 HTTP/1.1[0m" 201 -
2025-12-08 10:08:44,246:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:08:44] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-08 10:08:44,407:ERROR:superset.models.helpers:[METRICS-TRACE] Processing 0 metrics
2025-12-08 10:08:44,408:ERROR:superset.models.helpers:[METRICS-TRACE] Total metrics added: 0
2025-12-08 10:08:44,408:ERROR:superset.models.helpers:[METRICS-TRACE] Before dedup: 1 select_exprs + 0 metrics_exprs
2025-12-08 10:08:44,408:ERROR:superset.models.helpers:[METRICS-TRACE] After dedup: 1 total select_exprs
2025-12-08 10:08:44,408:INFO:superset.models.helpers:[COLUMN_TRACE] SQL Query Building:
2025-12-08 10:08:44,408:INFO:superset.models.helpers:[COLUMN_TRACE]   columns: ['OrgUnit']
2025-12-08 10:08:44,408:INFO:superset.models.helpers:[COLUMN_TRACE]   metrics: []
2025-12-08 10:08:44,408:INFO:superset.models.helpers:[COLUMN_TRACE]   groupby: []
2025-12-08 10:08:44,408:INFO:superset.models.helpers:[COLUMN_TRACE]   labels_expected: ['OrgUnit']
2025-12-08 10:08:44,408:INFO:superset.models.helpers:[COLUMN_TRACE]   select_exprs count: 1
2025-12-08 10:08:44,408:INFO:superset.models.helpers:[COLUMN_TRACE]     [0] key=OrgUnit, name=OrgUnit, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-08 10:08:44,408:INFO:superset.connectors.sqla.models:[DHIS2] get_from_clause for virtual dataset 1: analytics_LAST_YEAR_20251206
2025-12-08 10:08:44,408:INFO:superset.connectors.sqla.models:[DHIS2] Full SQL stored: SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
2025-12-08 10:08:44,408:INFO:superset.connectors.sqla.models:[DHIS2] Loaded params from extra field: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayPropert
2025-12-08 10:08:44,409:INFO:superset.connectors.sqla.models:[DHIS2] Cached params with key: dhis2_params_1_analytics
2025-12-08 10:08:44,409:INFO:superset.connectors.sqla.models:[DHIS2] Stored params in Flask g for DHIS2 table: analytics
2025-12-08 10:08:44,411:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Query execution in connectors/sqla/models.py:
2025-12-08 10:08:44,411:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   SQL (first 500 chars): SELECT "OrgUnit" 
FROM (SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
) AS virtual_table GROUP BY "OrgUnit" ORDER BY "OrgUnit" ASC
 LIMIT 1000
2025-12-08 10:08:44,411:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   labels_expected: ['OrgUnit']
2025-12-08 10:08:44,412:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 connection initialized: https://tests.dhis2.hispuganda.org/hmis/api
2025-12-08 10:08:44,413:INFO:superset.db_engine_specs.dhis2_dialect:Executing DHIS2 query: SELECT
  "OrgUnit"
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "OrgUnit"
ORDER BY
  "OrgUnit" ASC
LIMIT 1000
2025-12-08 10:08:44,413:INFO:superset.db_engine_specs.dhis2_dialect:Parsed endpoint: analytics
2025-12-08 10:08:44,413:INFO:superset.db_engine_specs.dhis2_dialect:Using stored parameters from Flask g for table: analytics
2025-12-08 10:08:44,413:INFO:superset.db_engine_specs.dhis2_dialect:Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
2025-12-08 10:08:44,413:INFO:superset.db_engine_specs.dhis2_dialect:Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
2025-12-08 10:08:44,413:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API request: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
2025-12-08 10:08:44,728:INFO:superset.db_engine_specs.dhis2_dialect:Using wide/pivoted format for analytics
2025-12-08 10:08:44,728:INFO:superset.db_engine_specs.dhis2_dialect:normalize_analytics called with pivot=True, returning WIDE format
2025-12-08 10:08:44,728:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column construction - data_elements: ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
2025-12-08 10:08:44,728:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column names constructed (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-08 10:08:44,728:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] FIRST ROW CONSTRUCTION:
2025-12-08 10:08:44,728:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   Period (index 0): 2020
2025-12-08 10:08:44,728:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   OrgUnit (index 1): MOH - Uganda
2025-12-08 10:08:44,728:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01b. Malaria Total (index 2): 14479324
2025-12-08 10:08:44,728:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01a. Suspected fever (index 3): 22994823
2025-12-08 10:08:44,728:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01d. Malaria cases treated (index 4): 15266488
2025-12-08 10:08:44,728:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01c. Malaria Confirmed (B/s and RDT Positive) (index 5): 13326277
2025-12-08 10:08:44,728:INFO:superset.db_engine_specs.dhis2_dialect:First pivoted row - Period: '2020', OrgUnit: 'MOH - Uganda'
2025-12-08 10:08:44,728:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total pivoted rows: 4, columns: 6
2025-12-08 10:08:44,728:INFO:superset.db_engine_specs.dhis2_dialect:Normalized 4 rows with 6 columns for endpoint analytics
2025-12-08 10:08:44,728:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API returned 4 rows
2025-12-08 10:08:44,736:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() - Row count: 4
2025-12-08 10:08:44,737:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-08 10:08:44,737:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names length: 6
2025-12-08 10:08:44,737:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values count: 6
2025-12-08 10:08:44,737:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-08 10:08:44,737:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 0 (Period): 2020 -> 2020 (STRING)
2025-12-08 10:08:44,737:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (OrgUnit): MOH - Uganda -> MOH - Uganda (STRING)
2025-12-08 10:08:44,737:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (105_EP01b_Malaria_Total): 14479324 (PROCESSED)
2025-12-08 10:08:44,737:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (105_EP01a_Suspected_fever): 22994823 (PROCESSED)
2025-12-08 10:08:44,737:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (105_EP01d_Malaria_cases_treated): 15266488 (PROCESSED)
2025-12-08 10:08:44,737:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() returning 4 rows with 6 columns each
2025-12-08 10:08:44,737:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Got 4 rows from cursor
2025-12-08 10:08:44,737:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-08 10:08:44,737:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-08 10:08:44,738:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Types from cursor: ['String', 'String', 'String', 'String', 'String', 'String']
2025-12-08 10:08:44,764:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: DataFrame created with 4 rows, 6 columns
2025-12-08 10:08:44,764:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-08 10:08:44,765:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes BEFORE fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-08 10:08:44,767:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Period' to object dtype (dimension)
2025-12-08 10:08:44,767:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'OrgUnit' to object dtype (dimension)
2025-12-08 10:08:44,769:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes AFTER fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-08 10:08:44,769:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: First row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-08 10:08:44,782:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] BEFORE assign_column_label:
2025-12-08 10:08:44,782:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 6)
2025-12-08 10:08:44,782:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-08 10:08:44,782:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['Period', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-08 10:08:44,782:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: False
2025-12-08 10:08:44,782:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-08 10:08:44,782:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Column truncation needed: df has 6 columns, expected 5
2025-12-08 10:08:44,782:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   DataFrame actual columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-08 10:08:44,782:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Expected columns: ['Period', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-08 10:08:44,783:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] âœ“ Selecting columns BY NAME (matched all expected columns)
2025-12-08 10:08:44,783:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Column mapping: {'Period': 'Period', 'SUM(105_EP01b_Malaria_Total)': '105_EP01b_Malaria_Total', 'SUM(105_EP01a_Suspected_fever)': '105_EP01a_Suspected_fever', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)': '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', 'SUM(105_EP01d_Malaria_cases_treated)': '105_EP01d_Malaria_cases_treated'}
2025-12-08 10:08:44,791:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] Column Selection âœ“ SUCCESS - method=BY_NAME, datasource=analytics_LAST_YEAR_20251206
2025-12-08 10:08:44,791:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-08 10:08:44,791:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   tried_by_name=True, success=True, fallback=False
2025-12-08 10:08:44,791:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Assigning column labels: ['Period', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-08 10:08:44,791:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] AFTER assign_column_label:
2025-12-08 10:08:44,791:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 5)
2025-12-08 10:08:44,791:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-08 10:08:44,791:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['Period', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-08 10:08:44,791:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: True
2025-12-08 10:08:44,792:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Period': '2020', 'SUM(105_EP01b_Malaria_Total)': 14479324, 'SUM(105_EP01a_Suspected_fever)': 22994823, 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)': 13326277, 'SUM(105_EP01d_Malaria_cases_treated)': 15266488}
2025-12-08 10:08:44,798:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] DataFrame columns: ['Period', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-08 10:08:44,798:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Aggregates: {'SUM(105_EP01b_Malaria_Total)': {'operator': 'mean'}, 'SUM(105_EP01a_Suspected_fever)': {'operator': 'mean'}, 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)': {'operator': 'mean'}, 'SUM(105_EP01d_Malaria_cases_treated)': {'operator': 'mean'}}
2025-12-08 10:08:44,798:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105_EP01b_Malaria_Total)', column='SUM(105_EP01b_Malaria_Total)'
2025-12-08 10:08:44,798:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105_EP01a_Suspected_fever)', column='SUM(105_EP01a_Suspected_fever)'
2025-12-08 10:08:44,798:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', column='SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)'
2025-12-08 10:08:44,798:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105_EP01d_Malaria_cases_treated)', column='SUM(105_EP01d_Malaria_cases_treated)'
2025-12-08 10:08:44,826:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:08:44] "POST /api/v1/chart/data?form_data={"slice_id":2}&dashboard_id=1 HTTP/1.1" 200 -
2025-12-08 10:08:45,165:INFO:superset.db_engine_specs.dhis2_dialect:Using wide/pivoted format for analytics
2025-12-08 10:08:45,166:INFO:superset.db_engine_specs.dhis2_dialect:normalize_analytics called with pivot=True, returning WIDE format
2025-12-08 10:08:45,166:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column construction - data_elements: ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
2025-12-08 10:08:45,166:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column names constructed (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-08 10:08:45,166:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] FIRST ROW CONSTRUCTION:
2025-12-08 10:08:45,166:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   Period (index 0): 2020
2025-12-08 10:08:45,166:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   OrgUnit (index 1): MOH - Uganda
2025-12-08 10:08:45,166:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01b. Malaria Total (index 2): 14479324
2025-12-08 10:08:45,166:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01a. Suspected fever (index 3): 22994823
2025-12-08 10:08:45,166:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01d. Malaria cases treated (index 4): 15266488
2025-12-08 10:08:45,166:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01c. Malaria Confirmed (B/s and RDT Positive) (index 5): 13326277
2025-12-08 10:08:45,166:INFO:superset.db_engine_specs.dhis2_dialect:First pivoted row - Period: '2020', OrgUnit: 'MOH - Uganda'
2025-12-08 10:08:45,167:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total pivoted rows: 4, columns: 6
2025-12-08 10:08:45,167:INFO:superset.db_engine_specs.dhis2_dialect:Normalized 4 rows with 6 columns for endpoint analytics
2025-12-08 10:08:45,167:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API returned 4 rows
2025-12-08 10:08:45,173:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() - Row count: 4
2025-12-08 10:08:45,174:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-08 10:08:45,174:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names length: 6
2025-12-08 10:08:45,174:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values count: 6
2025-12-08 10:08:45,174:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-08 10:08:45,174:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 0 (Period): 2020 -> 2020 (STRING)
2025-12-08 10:08:45,174:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (OrgUnit): MOH - Uganda -> MOH - Uganda (STRING)
2025-12-08 10:08:45,174:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (105_EP01b_Malaria_Total): 14479324 (PROCESSED)
2025-12-08 10:08:45,174:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (105_EP01a_Suspected_fever): 22994823 (PROCESSED)
2025-12-08 10:08:45,174:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (105_EP01d_Malaria_cases_treated): 15266488 (PROCESSED)
2025-12-08 10:08:45,174:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() returning 4 rows with 6 columns each
2025-12-08 10:08:45,174:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Got 4 rows from cursor
2025-12-08 10:08:45,174:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-08 10:08:45,174:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-08 10:08:45,174:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Types from cursor: ['String', 'String', 'String', 'String', 'String', 'String']
2025-12-08 10:08:45,175:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: DataFrame created with 4 rows, 6 columns
2025-12-08 10:08:45,175:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-08 10:08:45,175:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes BEFORE fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-08 10:08:45,176:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Period' to object dtype (dimension)
2025-12-08 10:08:45,176:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'OrgUnit' to object dtype (dimension)
2025-12-08 10:08:45,176:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes AFTER fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-08 10:08:45,176:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: First row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-08 10:08:45,180:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] BEFORE assign_column_label:
2025-12-08 10:08:45,180:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 6)
2025-12-08 10:08:45,180:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-08 10:08:45,180:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['OrgUnit']
2025-12-08 10:08:45,180:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: False
2025-12-08 10:08:45,180:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-08 10:08:45,180:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Column truncation needed: df has 6 columns, expected 1
2025-12-08 10:08:45,180:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   DataFrame actual columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-08 10:08:45,180:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Expected columns: ['OrgUnit']
2025-12-08 10:08:45,180:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] âœ“ Selecting columns BY NAME (matched all expected columns)
2025-12-08 10:08:45,180:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Column mapping: {'OrgUnit': 'OrgUnit'}
2025-12-08 10:08:45,181:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] Column Selection âœ“ SUCCESS - method=BY_NAME, datasource=analytics_LAST_YEAR_20251206
2025-12-08 10:08:45,181:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['OrgUnit']
2025-12-08 10:08:45,181:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   tried_by_name=True, success=True, fallback=False
2025-12-08 10:08:45,181:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Assigning column labels: ['OrgUnit']
2025-12-08 10:08:45,181:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] AFTER assign_column_label:
2025-12-08 10:08:45,181:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 1)
2025-12-08 10:08:45,181:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['OrgUnit']
2025-12-08 10:08:45,181:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['OrgUnit']
2025-12-08 10:08:45,181:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: True
2025-12-08 10:08:45,181:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'OrgUnit': 'MOH - Uganda'}
2025-12-08 10:08:45,194:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:08:45] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-08 10:08:45,201:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:08:45] "GET /static/assets/src_filters_components_Select_SelectFilterPlugin_tsx.c9c2b90d.chunk.js HTTP/1.1" 200 -
2025-12-08 10:08:45,843:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:08:45] "POST /superset/log/?explode=events&dashboard_id=1 HTTP/1.1" 200 -
2025-12-08 10:08:45,972:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1458, in dispatch_request
    self.raise_routing_exception(req)
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1440, in raise_routing_exception
    raise request.routing_exception  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/ctx.py", line 353, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/werkzeug/routing/map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-12-08 10:08:45,974:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:08:45] "[33mGET /ws HTTP/1.1[0m" 404 -
2025-12-08 10:08:47,340:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:08:47] "GET /api/v1/dataset/1?q=(columns:!(columns.column_name,columns.is_dttm,columns.type_generic,columns.filterable)) HTTP/1.1" 200 -
2025-12-08 10:08:47,348:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:08:47] "GET /api/v1/dataset/1?q=(columns:!(columns.column_name,columns.expression,columns.filterable,columns.is_dttm,columns.type,columns.verbose_name,database.id,database.database_name,datasource_type,filter_select_enabled,id,is_sqllab_view,main_dttm_col,metrics.metric_name,metrics.verbose_name,schema,sql,table_name)) HTTP/1.1" 200 -
2025-12-08 10:08:53,981:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1458, in dispatch_request
    self.raise_routing_exception(req)
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1440, in raise_routing_exception
    raise request.routing_exception  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/ctx.py", line 353, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/werkzeug/routing/map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-12-08 10:08:53,984:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:08:53] "[33mGET /ws HTTP/1.1[0m" 404 -
2025-12-08 10:09:10,042:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1458, in dispatch_request
    self.raise_routing_exception(req)
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1440, in raise_routing_exception
    raise request.routing_exception  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/ctx.py", line 353, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/werkzeug/routing/map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-12-08 10:09:10,046:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:09:10] "[33mGET /ws HTTP/1.1[0m" 404 -
2025-12-08 10:09:20,966:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:09:20] "GET /api/v1/me/ HTTP/1.1" 200 -
2025-12-08 10:09:21,968:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:09:21] "POST /superset/log/?explode=events&dashboard_id=1 HTTP/1.1" 200 -
2025-12-08 10:09:42,654:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1458, in dispatch_request
    self.raise_routing_exception(req)
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1440, in raise_routing_exception
    raise request.routing_exception  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/ctx.py", line 353, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/werkzeug/routing/map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-12-08 10:09:42,657:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:09:42] "[33mGET /ws HTTP/1.1[0m" 404 -
2025-12-08 10:10:11,432:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:10:11] "GET /api/v1/me/ HTTP/1.1" 200 -
2025-12-08 10:10:12,420:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:10:12] "POST /superset/log/?explode=events&dashboard_id=1 HTTP/1.1" 200 -
2025-12-08 10:10:46,746:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1458, in dispatch_request
    self.raise_routing_exception(req)
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1440, in raise_routing_exception
    raise request.routing_exception  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/ctx.py", line 353, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/werkzeug/routing/map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-12-08 10:10:46,748:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:10:46] "[33mGET /ws HTTP/1.1[0m" 404 -
2025-12-08 10:12:55,650:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1458, in dispatch_request
    self.raise_routing_exception(req)
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1440, in raise_routing_exception
    raise request.routing_exception  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/ctx.py", line 353, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/werkzeug/routing/map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-12-08 10:12:55,655:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:12:55] "[33mGET /ws HTTP/1.1[0m" 404 -
2025-12-08 10:17:12,648:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1458, in dispatch_request
    self.raise_routing_exception(req)
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1440, in raise_routing_exception
    raise request.routing_exception  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/ctx.py", line 353, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/werkzeug/routing/map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-12-08 10:17:12,654:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:17:12] "[33mGET /ws HTTP/1.1[0m" 404 -
2025-12-08 10:18:10,578:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:18:10] "GET /api/v1/me/ HTTP/1.1" 200 -
2025-12-08 10:18:11,559:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:18:11] "POST /superset/log/?explode=events&dashboard_id=1 HTTP/1.1" 200 -
2025-12-08 10:24:32,199:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:24:32] "GET /api/v1/me/ HTTP/1.1" 200 -
2025-12-08 10:24:33,205:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:24:33] "POST /superset/log/?explode=events&dashboard_id=1 HTTP/1.1" 200 -
2025-12-08 10:25:44,703:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1458, in dispatch_request
    self.raise_routing_exception(req)
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1440, in raise_routing_exception
    raise request.routing_exception  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/ctx.py", line 353, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/werkzeug/routing/map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-12-08 10:25:44,707:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:25:44] "[33mGET /ws HTTP/1.1[0m" 404 -
2025-12-08 10:25:51,332:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:25:51] "PUT /api/v1/dashboard/1/filters HTTP/1.1" 200 -
2025-12-08 10:25:51,452:ERROR:superset.models.helpers:[METRICS-TRACE] Processing 0 metrics
2025-12-08 10:25:51,453:ERROR:superset.models.helpers:[METRICS-TRACE] Total metrics added: 0
2025-12-08 10:25:51,453:ERROR:superset.models.helpers:[METRICS-TRACE] Before dedup: 1 select_exprs + 0 metrics_exprs
2025-12-08 10:25:51,453:ERROR:superset.models.helpers:[METRICS-TRACE] After dedup: 1 total select_exprs
2025-12-08 10:25:51,453:INFO:superset.models.helpers:[COLUMN_TRACE] SQL Query Building:
2025-12-08 10:25:51,453:INFO:superset.models.helpers:[COLUMN_TRACE]   columns: ['OrgUnit']
2025-12-08 10:25:51,454:ERROR:superset.models.helpers:[METRICS-TRACE] Processing 0 metrics
2025-12-08 10:25:51,454:INFO:superset.models.helpers:[COLUMN_TRACE]   metrics: []
2025-12-08 10:25:51,454:ERROR:superset.models.helpers:[METRICS-TRACE] Total metrics added: 0
2025-12-08 10:25:51,454:INFO:superset.models.helpers:[COLUMN_TRACE]   groupby: []
2025-12-08 10:25:51,455:ERROR:superset.models.helpers:[METRICS-TRACE] Before dedup: 1 select_exprs + 0 metrics_exprs
2025-12-08 10:25:51,455:INFO:superset.models.helpers:[COLUMN_TRACE]   labels_expected: ['OrgUnit']
2025-12-08 10:25:51,455:ERROR:superset.models.helpers:[METRICS-TRACE] After dedup: 1 total select_exprs
2025-12-08 10:25:51,455:INFO:superset.models.helpers:[COLUMN_TRACE]   select_exprs count: 1
2025-12-08 10:25:51,456:INFO:superset.models.helpers:[COLUMN_TRACE] SQL Query Building:
2025-12-08 10:25:51,456:INFO:superset.models.helpers:[COLUMN_TRACE]     [0] key=OrgUnit, name=OrgUnit, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-08 10:25:51,456:INFO:superset.models.helpers:[COLUMN_TRACE]   columns: ['Period']
2025-12-08 10:25:51,456:INFO:superset.connectors.sqla.models:[DHIS2] get_from_clause for virtual dataset 1: analytics_LAST_YEAR_20251206
2025-12-08 10:25:51,456:INFO:superset.models.helpers:[COLUMN_TRACE]   metrics: []
2025-12-08 10:25:51,456:INFO:superset.connectors.sqla.models:[DHIS2] Full SQL stored: SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
2025-12-08 10:25:51,456:INFO:superset.models.helpers:[COLUMN_TRACE]   groupby: []
2025-12-08 10:25:51,456:INFO:superset.connectors.sqla.models:[DHIS2] Loaded params from extra field: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayPropert
2025-12-08 10:25:51,456:INFO:superset.models.helpers:[COLUMN_TRACE]   labels_expected: ['Period']
2025-12-08 10:25:51,456:INFO:superset.models.helpers:[COLUMN_TRACE]   select_exprs count: 1
2025-12-08 10:25:51,456:INFO:superset.models.helpers:[COLUMN_TRACE]     [0] key=Period, name=Period, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-08 10:25:51,456:INFO:superset.connectors.sqla.models:[DHIS2] get_from_clause for virtual dataset 1: analytics_LAST_YEAR_20251206
2025-12-08 10:25:51,456:INFO:superset.connectors.sqla.models:[DHIS2] Full SQL stored: SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
2025-12-08 10:25:51,456:INFO:superset.connectors.sqla.models:[DHIS2] Loaded params from extra field: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayPropert
2025-12-08 10:25:51,456:ERROR:superset.models.helpers:[METRICS-TRACE] Processing 4 metrics
2025-12-08 10:25:51,457:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 0: adhoc - SUM(105_EP01b_Malaria_Total)
2025-12-08 10:25:51,457:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105_EP01b_Malaria_Total)
2025-12-08 10:25:51,457:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 1: adhoc - SUM(105_EP01a_Suspected_fever)
2025-12-08 10:25:51,457:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105_EP01a_Suspected_fever)
2025-12-08 10:25:51,457:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 2: adhoc - SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)
2025-12-08 10:25:51,457:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)
2025-12-08 10:25:51,457:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 3: adhoc - SUM(105_EP01d_Malaria_cases_treated)
2025-12-08 10:25:51,457:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105_EP01d_Malaria_cases_treated)
2025-12-08 10:25:51,457:ERROR:superset.models.helpers:[METRICS-TRACE] Total metrics added: 4
2025-12-08 10:25:51,458:ERROR:superset.models.helpers:[METRICS-TRACE] Before dedup: 1 select_exprs + 4 metrics_exprs
2025-12-08 10:25:51,459:ERROR:superset.models.helpers:[METRICS-TRACE] After dedup: 5 total select_exprs
2025-12-08 10:25:51,459:INFO:superset.models.helpers:[COLUMN_TRACE] SQL Query Building:
2025-12-08 10:25:51,459:INFO:superset.models.helpers:[COLUMN_TRACE]   columns: [{'timeGrain': None, 'columnType': 'BASE_AXIS', 'sqlExpression': 'Period', 'label': 'Period', 'expressionType': 'SQL'}]
2025-12-08 10:25:51,459:INFO:superset.connectors.sqla.models:[DHIS2] Cached params with key: dhis2_params_1_analytics
2025-12-08 10:25:51,459:INFO:superset.connectors.sqla.models:[DHIS2] Cached params with key: dhis2_params_1_analytics
2025-12-08 10:25:51,459:INFO:superset.models.helpers:[COLUMN_TRACE]   metrics: [{'aggregate': 'SUM', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01b_Malaria_Total', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 3, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'INT', 'type_generic': 0, 'uuid': '959bffaa-826b-4d13-8b7b-6d9c4ea25e50', 'verbose_name': None, 'warning_markdown': None}, 'datasourceWarning': False, 'expressionType': 'SIMPLE', 'hasCustomLabel': False, 'label': 'SUM(105_EP01b_Malaria_Total)', 'optionName': 'metric_znmagih9lh_z0o3nswr22s', 'sqlExpression': None}, {'aggregate': 'SUM', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01a_Suspected_fever', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 4, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'INT', 'type_generic': 0, 'uuid': '530216fe-7198-4b8e-b688-a479bcf67426', 'verbose_name': None, 'warning_markdown': None}, 'datasourceWarning': False, 'expressionType': 'SIMPLE', 'hasCustomLabel': False, 'label': 'SUM(105_EP01a_Suspected_fever)', 'optionName': 'metric_i2yj88mm5ns_m44ybd4y0kf', 'sqlExpression': None}, {'aggregate': 'SUM', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 6, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'INT', 'type_generic': 0, 'uuid': '928946a1-6cea-4202-b8d6-0683414af79e', 'verbose_name': None, 'warning_markdown': None}, 'datasourceWarning': False, 'expressionType': 'SIMPLE', 'hasCustomLabel': False, 'label': 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', 'optionName': 'metric_3uikxtyu9ub_glmo09kn46e', 'sqlExpression': None}, {'aggregate': 'SUM', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01d_Malaria_cases_treated', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 5, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'INT', 'type_generic': 0, 'uuid': 'ffc52aba-a038-4c22-b6c8-169f3e2b8b97', 'verbose_name': None, 'warning_markdown': None}, 'datasourceWarning': False, 'expressionType': 'SIMPLE', 'hasCustomLabel': False, 'label': 'SUM(105_EP01d_Malaria_cases_treated)', 'optionName': 'metric_220hw0duag7_2181rn37iln', 'sqlExpression': None}]
2025-12-08 10:25:51,459:INFO:superset.connectors.sqla.models:[DHIS2] Stored params in Flask g for DHIS2 table: analytics
2025-12-08 10:25:51,459:INFO:superset.connectors.sqla.models:[DHIS2] Stored params in Flask g for DHIS2 table: analytics
2025-12-08 10:25:51,459:INFO:superset.models.helpers:[COLUMN_TRACE]   groupby: []
2025-12-08 10:25:51,462:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Query execution in connectors/sqla/models.py:
2025-12-08 10:25:51,462:INFO:superset.models.helpers:[COLUMN_TRACE]   labels_expected: ['Period', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-08 10:25:51,462:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Query execution in connectors/sqla/models.py:
2025-12-08 10:25:51,462:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   SQL (first 500 chars): SELECT "OrgUnit" 
FROM (SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
) AS virtual_table GROUP BY "OrgUnit" ORDER BY "OrgUnit" ASC
 LIMIT 1000
2025-12-08 10:25:51,462:INFO:superset.models.helpers:[COLUMN_TRACE]   select_exprs count: 5
2025-12-08 10:25:51,462:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   SQL (first 500 chars): SELECT "Period" 
FROM (SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
) AS virtual_table GROUP BY "Period" ORDER BY "Period" ASC
 LIMIT 1000
2025-12-08 10:25:51,462:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   labels_expected: ['OrgUnit']
2025-12-08 10:25:51,462:INFO:superset.models.helpers:[COLUMN_TRACE]     [0] key=Period, name=Period, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-08 10:25:51,462:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   labels_expected: ['Period']
2025-12-08 10:25:51,463:INFO:superset.models.helpers:[COLUMN_TRACE]     [1] key=SUM(105_EP01b_Malaria_Total), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-08 10:25:51,463:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 connection initialized: https://tests.dhis2.hispuganda.org/hmis/api
2025-12-08 10:25:51,464:INFO:superset.models.helpers:[COLUMN_TRACE]     [2] key=SUM(105_EP01a_Suspected_fever), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-08 10:25:51,464:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 connection initialized: https://tests.dhis2.hispuganda.org/hmis/api
2025-12-08 10:25:51,464:INFO:superset.db_engine_specs.dhis2_dialect:Executing DHIS2 query: SELECT
  "OrgUnit"
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "OrgUnit"
ORDER BY
  "OrgUnit" ASC
LIMIT 1000
2025-12-08 10:25:51,464:INFO:superset.models.helpers:[COLUMN_TRACE]     [3] key=SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-08 10:25:51,464:INFO:superset.db_engine_specs.dhis2_dialect:Executing DHIS2 query: SELECT
  "Period"
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "Period"
ORDER BY
  "Period" ASC
LIMIT 1000
2025-12-08 10:25:51,464:INFO:superset.db_engine_specs.dhis2_dialect:Parsed endpoint: analytics
2025-12-08 10:25:51,464:INFO:superset.models.helpers:[COLUMN_TRACE]     [4] key=SUM(105_EP01d_Malaria_cases_treated), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-08 10:25:51,464:INFO:superset.db_engine_specs.dhis2_dialect:Parsed endpoint: analytics
[DHIS2] Executing query: SELECT
  "Period",
  SUM("105_EP01b_Malaria_Total") AS sum_1,
  SUM("105_EP01a_Suspected_fever") AS sum_2,
  SUM("105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive") AS sum_3,
  SUM("105_EP01d_Malaria_cases_treated") AS sum_4
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "Period"
ORDER BY
  SUM("105_EP01b_Malaria_Total") DESC
LIMIT 10000
[DHIS2] Parsed endpoint: analytics
[DHIS2] Found params in Flask g for analytics: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;
[DHIS2] Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
[DHIS2] Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
[DHIS2] API request URL: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
[DHIS2] Executing query: SELECT
  "OrgUnit"
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "OrgUnit"
ORDER BY
  "OrgUnit" ASC
LIMIT 1000
[DHIS2] Parsed endpoint: analytics
[DHIS2] Found params in Flask g for analytics: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;
[DHIS2] Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
[DHIS2] Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
[DHIS2] API request URL: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
[DHIS2] Raw API response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Raw DHIS2 rows count: 16
[DHIS2] First raw row: ['QHnwKs2OUZv', '2020', 'akV6429SUqu', '15266488']
[DHIS2] Parsing response for endpoint: analytics
[DHIS2] Response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Response sample: {'headers': [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}], 'metaDat
[DHIS2] Using WIDE/PIVOTED format (Period, OrgUnit, DX1, DX2, ...) for analytics
[DHIS2] normalize_analytics: pivot=True, using WIDE/PIVOTED format
[DHIS2] PIVOT CONSTRUCTION:
[DHIS2]   data_elements (UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   data_element_list (sorted UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   col_names (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized row count: 4
[DHIS2] First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] _set_description: columns=['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], types=['String', 'String', 'String', 'String', 'String', 'String']
[DHIS2] Transformed rows count: 4
[DHIS2] First transformed row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] Fetched 4 rows
[DHIS2] fetchall() called - returning 4 rows
[DHIS2] fetchall() - First row type: <class 'tuple'>
[DHIS2] fetchall() - First row (original): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Column count from description: 6
[DHIS2] fetchall() - First row (fixed types): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Type enforcement: dimensions=STRING, measures=FLOAT
[DHIS2] Raw API response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Raw DHIS2 rows count: 16
[DHIS2] First raw row: ['QHnwKs2OUZv', '2020', 'akV6429SUqu', '15266488']
[DHIS2] Parsing response for endpoint: analytics
[DHIS2] Response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Response sample: {'headers': [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}], 'metaDat
[DHIS2] Using WIDE/PIVOTED format (Period, OrgUnit, DX1, DX2, ...) for analytics
[DHIS2] normalize_analytics: pivot=True, using WIDE/PIVOTED format
[DHIS2] PIVOT CONSTRUCTION:
[DHIS2]   data_elements (UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   data_element_list (sorted UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   col_names (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized row count: 4
[DHIS2] First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] _set_description: columns=['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], types=['String', 'String', 'String', 'String', 'String', 'String']
[DHIS2] Transformed rows count: 4
[DHIS2] First transformed row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] Fetched 4 rows
[DHIS2] fetchall() called - returning 4 rows
[DHIS2] fetchall() - First row type: <class 'tuple'>
[DHIS2] fetchall() - First row (original): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Column count from description: 6
[DHIS2] fetchall() - First row (fixed types): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Type enforcement: dimensions=STRING, measures=FLOAT
[DHIS2] Executing query: SELECT
  "OrgUnit"
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "OrgUnit"
ORDER BY
  "OrgUnit" ASC
LIMIT 1000
[DHIS2] Executing query: SELECT
  "Period"
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "Period"
ORDER BY
  "Period" ASC
LIMIT 1000
[DHIS2] Parsed endpoint: analytics
[DHIS2] Parsed endpoint: analytics
[DHIS2] Found params in Flask g for analytics: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;
[DHIS2] Found params in Flask g for analytics: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2025-12-08 10:25:51,464:INFO:superset.db_engine_specs.dhis2_dialect:Using stored parameters from Flask g for table: analytics
2025-12-08 10:25:51,465:INFO:superset.connectors.sqla.models:[DHIS2] get_from_clause for virtual dataset 1: analytics_LAST_YEAR_20251206
2025-12-08 10:25:51,465:INFO:superset.db_engine_specs.dhis2_dialect:Using stored parameters from Flask g for table: analytics
2025-12-08 10:25:51,465:INFO:superset.db_engine_specs.dhis2_dialect:Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
2025-12-08 10:25:51,465:INFO:superset.connectors.sqla.models:[DHIS2] Full SQL stored: SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
2025-12-08 10:25:51,465:INFO:superset.db_engine_specs.dhis2_dialect:Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
2025-12-08 10:25:51,465:INFO:superset.db_engine_specs.dhis2_dialect:Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
2025-12-08 10:25:51,465:INFO:superset.connectors.sqla.models:[DHIS2] Loaded params from extra field: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayPropert
2025-12-08 10:25:51,465:INFO:superset.db_engine_specs.dhis2_dialect:Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
2025-12-08 10:25:51,465:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API request: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
2025-12-08 10:25:51,465:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API request: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
2025-12-08 10:25:51,467:INFO:superset.connectors.sqla.models:[DHIS2] Cached params with key: dhis2_params_1_analytics
2025-12-08 10:25:51,467:INFO:superset.connectors.sqla.models:[DHIS2] Stored params in Flask g for DHIS2 table: analytics
2025-12-08 10:25:51,468:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Query execution in connectors/sqla/models.py:
2025-12-08 10:25:51,468:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   SQL (first 500 chars): SELECT "Period", sum("105_EP01b_Malaria_Total") AS sum_1, sum("105_EP01a_Suspected_fever") AS sum_2, sum("105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive") AS sum_3, sum("105_EP01d_Malaria_cases_treated") AS sum_4 
FROM (SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
) AS virtual_table GROUP BY "Period" ORDER BY sum("105_EP01b_Malaria_
2025-12-08 10:25:51,468:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   labels_expected: ['Period', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-08 10:25:51,469:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 connection initialized: https://tests.dhis2.hispuganda.org/hmis/api
2025-12-08 10:25:51,469:INFO:superset.db_engine_specs.dhis2_dialect:Executing DHIS2 query: SELECT
  "Period",
  SUM("105_EP01b_Malaria_Total") AS sum_1,
  SUM("105_EP01a_Suspected_fever") AS sum_2,
  SUM("105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive") AS sum_3,
  SUM("105_EP01d_Malaria_cases_treated") AS sum_4
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "Period"
ORDER BY
  SUM("105_EP01b_Malaria_Total") DESC
LIMIT 10000
2025-12-08 10:25:51,469:INFO:superset.db_engine_specs.dhis2_dialect:Parsed endpoint: analytics
2025-12-08 10:25:51,470:INFO:superset.db_engine_specs.dhis2_dialect:Using stored parameters from Flask g for table: analytics
2025-12-08 10:25:51,470:INFO:superset.db_engine_specs.dhis2_dialect:Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
2025-12-08 10:25:51,470:INFO:superset.db_engine_specs.dhis2_dialect:Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
2025-12-08 10:25:51,470:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API request: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
2025-12-08 10:25:51,932:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:25:51] "[35m[1mPOST /api/v1/dashboard/1/filter_state?tab_id=21 HTTP/1.1[0m" 201 -
2025-12-08 10:25:52,224:INFO:superset.db_engine_specs.dhis2_dialect:Using wide/pivoted format for analytics
2025-12-08 10:25:52,224:INFO:superset.db_engine_specs.dhis2_dialect:normalize_analytics called with pivot=True, returning WIDE format
2025-12-08 10:25:52,224:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column construction - data_elements: ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
2025-12-08 10:25:52,224:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column names constructed (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-08 10:25:52,224:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] FIRST ROW CONSTRUCTION:
2025-12-08 10:25:52,224:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   Period (index 0): 2020
2025-12-08 10:25:52,224:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   OrgUnit (index 1): MOH - Uganda
2025-12-08 10:25:52,225:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01b. Malaria Total (index 2): 14479324
2025-12-08 10:25:52,225:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01a. Suspected fever (index 3): 22994823
2025-12-08 10:25:52,225:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01d. Malaria cases treated (index 4): 15266488
2025-12-08 10:25:52,225:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01c. Malaria Confirmed (B/s and RDT Positive) (index 5): 13326277
2025-12-08 10:25:52,225:INFO:superset.db_engine_specs.dhis2_dialect:First pivoted row - Period: '2020', OrgUnit: 'MOH - Uganda'
2025-12-08 10:25:52,225:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total pivoted rows: 4, columns: 6
2025-12-08 10:25:52,225:INFO:superset.db_engine_specs.dhis2_dialect:Normalized 4 rows with 6 columns for endpoint analytics
2025-12-08 10:25:52,225:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API returned 4 rows
2025-12-08 10:25:52,225:INFO:superset.db_engine_specs.dhis2_dialect:Using wide/pivoted format for analytics
2025-12-08 10:25:52,226:INFO:superset.db_engine_specs.dhis2_dialect:normalize_analytics called with pivot=True, returning WIDE format
2025-12-08 10:25:52,226:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column construction - data_elements: ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
2025-12-08 10:25:52,226:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column names constructed (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-08 10:25:52,226:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] FIRST ROW CONSTRUCTION:
2025-12-08 10:25:52,226:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   Period (index 0): 2020
2025-12-08 10:25:52,227:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   OrgUnit (index 1): MOH - Uganda
2025-12-08 10:25:52,227:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01b. Malaria Total (index 2): 14479324
2025-12-08 10:25:52,227:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01a. Suspected fever (index 3): 22994823
2025-12-08 10:25:52,227:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01d. Malaria cases treated (index 4): 15266488
2025-12-08 10:25:52,227:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01c. Malaria Confirmed (B/s and RDT Positive) (index 5): 13326277
2025-12-08 10:25:52,227:INFO:superset.db_engine_specs.dhis2_dialect:First pivoted row - Period: '2020', OrgUnit: 'MOH - Uganda'
2025-12-08 10:25:52,227:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total pivoted rows: 4, columns: 6
2025-12-08 10:25:52,227:INFO:superset.db_engine_specs.dhis2_dialect:Normalized 4 rows with 6 columns for endpoint analytics
2025-12-08 10:25:52,227:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API returned 4 rows
2025-12-08 10:25:52,230:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() - Row count: 4
2025-12-08 10:25:52,230:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-08 10:25:52,230:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names length: 6
2025-12-08 10:25:52,230:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values count: 6
2025-12-08 10:25:52,230:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-08 10:25:52,230:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 0 (Period): 2020 -> 2020 (STRING)
2025-12-08 10:25:52,230:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (OrgUnit): MOH - Uganda -> MOH - Uganda (STRING)
2025-12-08 10:25:52,230:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() - Row count: 4
2025-12-08 10:25:52,230:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (105_EP01b_Malaria_Total): 14479324 (PROCESSED)
2025-12-08 10:25:52,230:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-08 10:25:52,230:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (105_EP01a_Suspected_fever): 22994823 (PROCESSED)
2025-12-08 10:25:52,230:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names length: 6
2025-12-08 10:25:52,230:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (105_EP01d_Malaria_cases_treated): 15266488 (PROCESSED)
2025-12-08 10:25:52,230:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values count: 6
2025-12-08 10:25:52,230:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() returning 4 rows with 6 columns each
2025-12-08 10:25:52,230:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-08 10:25:52,230:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Got 4 rows from cursor
2025-12-08 10:25:52,230:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 0 (Period): 2020 -> 2020 (STRING)
2025-12-08 10:25:52,231:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-08 10:25:52,231:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (OrgUnit): MOH - Uganda -> MOH - Uganda (STRING)
2025-12-08 10:25:52,231:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-08 10:25:52,231:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (105_EP01b_Malaria_Total): 14479324 (PROCESSED)
2025-12-08 10:25:52,231:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Types from cursor: ['String', 'String', 'String', 'String', 'String', 'String']
2025-12-08 10:25:52,231:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (105_EP01a_Suspected_fever): 22994823 (PROCESSED)
2025-12-08 10:25:52,234:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (105_EP01d_Malaria_cases_treated): 15266488 (PROCESSED)
2025-12-08 10:25:52,234:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() returning 4 rows with 6 columns each
2025-12-08 10:25:52,234:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Got 4 rows from cursor
2025-12-08 10:25:52,234:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-08 10:25:52,234:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-08 10:25:52,234:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Types from cursor: ['String', 'String', 'String', 'String', 'String', 'String']
2025-12-08 10:25:52,238:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: DataFrame created with 4 rows, 6 columns
2025-12-08 10:25:52,238:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-08 10:25:52,239:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes BEFORE fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-08 10:25:52,239:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: DataFrame created with 4 rows, 6 columns
2025-12-08 10:25:52,240:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Period' to object dtype (dimension)
2025-12-08 10:25:52,240:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-08 10:25:52,240:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'OrgUnit' to object dtype (dimension)
2025-12-08 10:25:52,240:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes BEFORE fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-08 10:25:52,240:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes AFTER fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-08 10:25:52,240:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Period' to object dtype (dimension)
2025-12-08 10:25:52,240:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: First row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-08 10:25:52,241:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'OrgUnit' to object dtype (dimension)
2025-12-08 10:25:52,241:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes AFTER fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-08 10:25:52,241:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: First row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-08 10:25:52,245:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] BEFORE assign_column_label:
2025-12-08 10:25:52,246:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 6)
2025-12-08 10:25:52,246:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] BEFORE assign_column_label:
2025-12-08 10:25:52,246:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-08 10:25:52,246:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 6)
2025-12-08 10:25:52,246:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['Period']
2025-12-08 10:25:52,246:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-08 10:25:52,246:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: False
2025-12-08 10:25:52,246:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['Period', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-08 10:25:52,246:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-08 10:25:52,246:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: False
2025-12-08 10:25:52,246:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Column truncation needed: df has 6 columns, expected 1
2025-12-08 10:25:52,246:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-08 10:25:52,246:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   DataFrame actual columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-08 10:25:52,246:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Column truncation needed: df has 6 columns, expected 5
2025-12-08 10:25:52,246:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Expected columns: ['Period']
2025-12-08 10:25:52,246:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   DataFrame actual columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-08 10:25:52,246:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] âœ“ Selecting columns BY NAME (matched all expected columns)
2025-12-08 10:25:52,246:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Expected columns: ['Period', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-08 10:25:52,246:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Column mapping: {'Period': 'Period'}
2025-12-08 10:25:52,246:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] âœ“ Selecting columns BY NAME (matched all expected columns)
2025-12-08 10:25:52,247:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] Column Selection âœ“ SUCCESS - method=BY_NAME, datasource=analytics_LAST_YEAR_20251206
2025-12-08 10:25:52,247:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period']
2025-12-08 10:25:52,247:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Column mapping: {'Period': 'Period', 'SUM(105_EP01b_Malaria_Total)': '105_EP01b_Malaria_Total', 'SUM(105_EP01a_Suspected_fever)': '105_EP01a_Suspected_fever', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)': '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', 'SUM(105_EP01d_Malaria_cases_treated)': '105_EP01d_Malaria_cases_treated'}
2025-12-08 10:25:52,247:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   tried_by_name=True, success=True, fallback=False
2025-12-08 10:25:52,247:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Assigning column labels: ['Period']
2025-12-08 10:25:52,247:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] AFTER assign_column_label:
2025-12-08 10:25:52,247:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] Column Selection âœ“ SUCCESS - method=BY_NAME, datasource=analytics_LAST_YEAR_20251206
2025-12-08 10:25:52,247:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 1)
2025-12-08 10:25:52,247:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-08 10:25:52,247:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period']
2025-12-08 10:25:52,247:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   tried_by_name=True, success=True, fallback=False
2025-12-08 10:25:52,247:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['Period']
2025-12-08 10:25:52,247:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Assigning column labels: ['Period', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-08 10:25:52,247:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: True
2025-12-08 10:25:52,247:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] AFTER assign_column_label:
2025-12-08 10:25:52,248:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Period': '2020'}
2025-12-08 10:25:52,248:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 5)
2025-12-08 10:25:52,248:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-08 10:25:52,248:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['Period', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-08 10:25:52,248:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: True
2025-12-08 10:25:52,248:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Period': '2020', 'SUM(105_EP01b_Malaria_Total)': 14479324, 'SUM(105_EP01a_Suspected_fever)': 22994823, 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)': 13326277, 'SUM(105_EP01d_Malaria_cases_treated)': 15266488}
2025-12-08 10:25:52,252:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] DataFrame columns: ['Period', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-08 10:25:52,252:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Aggregates: {'SUM(105_EP01b_Malaria_Total)': {'operator': 'mean'}, 'SUM(105_EP01a_Suspected_fever)': {'operator': 'mean'}, 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)': {'operator': 'mean'}, 'SUM(105_EP01d_Malaria_cases_treated)': {'operator': 'mean'}}
2025-12-08 10:25:52,252:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105_EP01b_Malaria_Total)', column='SUM(105_EP01b_Malaria_Total)'
2025-12-08 10:25:52,252:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105_EP01a_Suspected_fever)', column='SUM(105_EP01a_Suspected_fever)'
2025-12-08 10:25:52,252:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', column='SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)'
2025-12-08 10:25:52,252:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105_EP01d_Malaria_cases_treated)', column='SUM(105_EP01d_Malaria_cases_treated)'
2025-12-08 10:25:52,265:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:25:52] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-08 10:25:52,267:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:25:52] "POST /api/v1/chart/data?form_data={"slice_id":2}&dashboard_id=1 HTTP/1.1" 200 -

[DHIS2] Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
[DHIS2] Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
[DHIS2] Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
[DHIS2] Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
[DHIS2] API request URL: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
[DHIS2] API request URL: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
[DHIS2] Executing query: SELECT
  "Period",
  SUM("105_EP01b_Malaria_Total") AS sum_1,
  SUM("105_EP01a_Suspected_fever") AS sum_2,
  SUM("105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive") AS sum_3,
  SUM("105_EP01d_Malaria_cases_treated") AS sum_4
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "Period"
ORDER BY
  SUM("105_EP01b_Malaria_Total") DESC
LIMIT 10000
[DHIS2] Parsed endpoint: analytics
[DHIS2] Found params in Flask g for analytics: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;
[DHIS2] Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
[DHIS2] Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
[DHIS2] API request URL: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
[DHIS2] Raw API response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Raw DHIS2 rows count: 16
[DHIS2] First raw row: ['QHnwKs2OUZv', '2020', 'akV6429SUqu', '15266488']
[DHIS2] Parsing response for endpoint: analytics
[DHIS2] Response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Response sample: {'headers': [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}], 'metaDat
[DHIS2] Using WIDE/PIVOTED format (Period, OrgUnit, DX1, DX2, ...) for analytics
[DHIS2] normalize_analytics: pivot=True, using WIDE/PIVOTED format
[DHIS2] PIVOT CONSTRUCTION:
[DHIS2]   data_elements (UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   data_element_list (sorted UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   col_names (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized row count: 4
[DHIS2] First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] _set_description: columns=['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], types=['String', 'String', 'String', 'String', 'String', 'String']
[DHIS2] Transformed rows count: 4
[DHIS2] First transformed row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] Raw API response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Raw DHIS2 rows count: 16
[DHIS2] First raw row: ['QHnwKs2OUZv', '2020', 'akV6429SUqu', '15266488']
[DHIS2] Parsing response for endpoint: analytics
[DHIS2] Response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Response sample: {'headers': [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}], 'metaDat
[DHIS2] Using WIDE/PIVOTED format (Period, OrgUnit, DX1, DX2, ...) for analytics
[DHIS2] Fetched 4 rows
[DHIS2] normalize_analytics: pivot=True, using WIDE/PIVOTED format
[DHIS2] PIVOT CONSTRUCTION:
[DHIS2]   data_elements (UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   data_element_list (sorted UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   col_names (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized row count: 4
[DHIS2] First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] _set_description: columns=['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], types=['String', 'String', 'String', 'String', 'String', 'String']
[DHIS2] Transformed rows count: 4
[DHIS2] First transformed row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] Fetched 4 rows
[DHIS2] fetchall() called - returning 4 rows
[DHIS2] fetchall() - First row type: <class 'tuple'>
[DHIS2] fetchall() - First row (original): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Column count from description: 6
[DHIS2] fetchall() called - returning 4 rows
[DHIS2] fetchall() - First row type: <class 'tuple'>
[DHIS2] fetchall() - First row (original): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Column count from description: 6
[DHIS2] fetchall() - First row (fixed types): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Type enforcement: dimensions=STRING, measures=FLOAT
[DHIS2] fetchall() - First row (fixed types): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Type enforcement: dimensions=STRING, measures=FLOAT
[DHIS2] Raw API response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Raw DHIS2 rows count: 16
[DHIS2] First raw row: ['QHnwKs2OUZv', '2020', 'akV6429SUqu', '15266488']2025-12-08 10:25:52,281:INFO:superset.db_engine_specs.dhis2_dialect:Using wide/pivoted format for analytics
2025-12-08 10:25:52,281:INFO:superset.db_engine_specs.dhis2_dialect:normalize_analytics called with pivot=True, returning WIDE format
2025-12-08 10:25:52,281:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column construction - data_elements: ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
2025-12-08 10:25:52,281:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column names constructed (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-08 10:25:52,281:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] FIRST ROW CONSTRUCTION:
2025-12-08 10:25:52,281:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   Period (index 0): 2020
2025-12-08 10:25:52,281:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   OrgUnit (index 1): MOH - Uganda
2025-12-08 10:25:52,281:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01b. Malaria Total (index 2): 14479324
2025-12-08 10:25:52,281:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01a. Suspected fever (index 3): 22994823
2025-12-08 10:25:52,281:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01d. Malaria cases treated (index 4): 15266488
2025-12-08 10:25:52,281:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01c. Malaria Confirmed (B/s and RDT Positive) (index 5): 13326277
2025-12-08 10:25:52,281:INFO:superset.db_engine_specs.dhis2_dialect:First pivoted row - Period: '2020', OrgUnit: 'MOH - Uganda'
2025-12-08 10:25:52,281:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total pivoted rows: 4, columns: 6
2025-12-08 10:25:52,281:INFO:superset.db_engine_specs.dhis2_dialect:Normalized 4 rows with 6 columns for endpoint analytics
2025-12-08 10:25:52,281:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API returned 4 rows
2025-12-08 10:25:52,284:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() - Row count: 4
2025-12-08 10:25:52,284:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-08 10:25:52,284:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names length: 6
2025-12-08 10:25:52,284:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values count: 6
2025-12-08 10:25:52,284:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-08 10:25:52,284:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 0 (Period): 2020 -> 2020 (STRING)
2025-12-08 10:25:52,284:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (OrgUnit): MOH - Uganda -> MOH - Uganda (STRING)
2025-12-08 10:25:52,284:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (105_EP01b_Malaria_Total): 14479324 (PROCESSED)
2025-12-08 10:25:52,284:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (105_EP01a_Suspected_fever): 22994823 (PROCESSED)
2025-12-08 10:25:52,284:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (105_EP01d_Malaria_cases_treated): 15266488 (PROCESSED)
2025-12-08 10:25:52,284:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() returning 4 rows with 6 columns each
2025-12-08 10:25:52,284:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Got 4 rows from cursor
2025-12-08 10:25:52,284:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-08 10:25:52,284:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-08 10:25:52,284:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Types from cursor: ['String', 'String', 'String', 'String', 'String', 'String']
2025-12-08 10:25:52,285:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: DataFrame created with 4 rows, 6 columns
2025-12-08 10:25:52,285:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-08 10:25:52,285:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes BEFORE fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-08 10:25:52,285:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Period' to object dtype (dimension)
2025-12-08 10:25:52,285:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'OrgUnit' to object dtype (dimension)
2025-12-08 10:25:52,285:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes AFTER fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-08 10:25:52,285:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: First row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-08 10:25:52,287:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] BEFORE assign_column_label:
2025-12-08 10:25:52,287:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 6)
2025-12-08 10:25:52,287:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-08 10:25:52,288:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['OrgUnit']
2025-12-08 10:25:52,288:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: False
2025-12-08 10:25:52,288:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-08 10:25:52,288:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Column truncation needed: df has 6 columns, expected 1
2025-12-08 10:25:52,288:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   DataFrame actual columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-08 10:25:52,288:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Expected columns: ['OrgUnit']
2025-12-08 10:25:52,288:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] âœ“ Selecting columns BY NAME (matched all expected columns)
2025-12-08 10:25:52,288:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Column mapping: {'OrgUnit': 'OrgUnit'}
2025-12-08 10:25:52,288:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] Column Selection âœ“ SUCCESS - method=BY_NAME, datasource=analytics_LAST_YEAR_20251206
2025-12-08 10:25:52,288:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['OrgUnit']
2025-12-08 10:25:52,288:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   tried_by_name=True, success=True, fallback=False
2025-12-08 10:25:52,288:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Assigning column labels: ['OrgUnit']
2025-12-08 10:25:52,288:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] AFTER assign_column_label:
2025-12-08 10:25:52,288:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 1)
2025-12-08 10:25:52,288:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['OrgUnit']
2025-12-08 10:25:52,288:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['OrgUnit']
2025-12-08 10:25:52,288:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: True
2025-12-08 10:25:52,288:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'OrgUnit': 'MOH - Uganda'}
2025-12-08 10:25:52,296:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:25:52] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-08 10:25:53,309:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:25:53] "POST /superset/log/?explode=events&dashboard_id=1 HTTP/1.1" 200 -
2025-12-08 10:27:28,152:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:27:28] "GET /api/v1/me/ HTTP/1.1" 200 -
2025-12-08 10:27:30,891:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:27:30] "GET /api/v1/me/ HTTP/1.1" 200 -
2025-12-08 10:27:52,175:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:27:52] "GET /api/v1/me/ HTTP/1.1" 200 -
2025-12-08 10:27:56,259:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:27:56] "[31m[1mPOST /api/v1/chart/data HTTP/1.1[0m" 400 -
2025-12-08 10:27:56,261:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:27:56] "[31m[1mPOST /api/v1/chart/data HTTP/1.1[0m" 400 -
2025-12-08 10:27:56,367:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:27:56] "[33mGET /api/v1/chart/0 HTTP/1.1[0m" 404 -
2025-12-08 10:27:57,060:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:27:57] "PUT /api/v1/explore/form_data/6ZOWpPUiFJc?tab_id=1 HTTP/1.1" 200 -
2025-12-08 10:27:57,314:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:27:57] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-08 10:28:00,265:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:28:00] "GET /api/v1/me/ HTTP/1.1" 200 -
2025-12-08 10:28:03,770:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:28:03] "GET /api/v1/me/ HTTP/1.1" 200 -
2025-12-08 10:28:06,099:ERROR:superset.models.helpers:[METRICS-TRACE] Processing 0 metrics
2025-12-08 10:28:06,099:ERROR:superset.models.helpers:[METRICS-TRACE] Total metrics added: 0
2025-12-08 10:28:06,104:ERROR:superset.models.helpers:[METRICS-TRACE] Before dedup: 2 select_exprs + 0 metrics_exprs
2025-12-08 10:28:06,104:ERROR:superset.models.helpers:[METRICS-TRACE] After dedup: 2 total select_exprs
2025-12-08 10:28:06,104:ERROR:superset.models.helpers:[METRICS-TRACE] Processing 0 metrics
2025-12-08 10:28:06,104:INFO:superset.models.helpers:[COLUMN_TRACE] SQL Query Building:
2025-12-08 10:28:06,104:ERROR:superset.models.helpers:[METRICS-TRACE] Total metrics added: 0
2025-12-08 10:28:06,104:INFO:superset.models.helpers:[COLUMN_TRACE]   columns: ['OrgUnit', 'Period']
2025-12-08 10:28:06,105:ERROR:superset.models.helpers:[METRICS-TRACE] Before dedup: 2 select_exprs + 0 metrics_exprs
2025-12-08 10:28:06,105:INFO:superset.models.helpers:[COLUMN_TRACE]   metrics: []
2025-12-08 10:28:06,105:ERROR:superset.models.helpers:[METRICS-TRACE] After dedup: 2 total select_exprs
2025-12-08 10:28:06,105:INFO:superset.models.helpers:[COLUMN_TRACE]   groupby: []
2025-12-08 10:28:06,105:INFO:superset.models.helpers:[COLUMN_TRACE] SQL Query Building:
2025-12-08 10:28:06,105:INFO:superset.models.helpers:[COLUMN_TRACE]   labels_expected: ['OrgUnit', 'Period']
2025-12-08 10:28:06,105:INFO:superset.models.helpers:[COLUMN_TRACE]   columns: ['OrgUnit', 'Period']
2025-12-08 10:28:06,105:INFO:superset.models.helpers:[COLUMN_TRACE]   select_exprs count: 2
2025-12-08 10:28:06,105:INFO:superset.models.helpers:[COLUMN_TRACE]   metrics: []
2025-12-08 10:28:06,105:INFO:superset.models.helpers:[COLUMN_TRACE]     [0] key=OrgUnit, name=OrgUnit, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-08 10:28:06,105:INFO:superset.models.helpers:[COLUMN_TRACE]   groupby: []
2025-12-08 10:28:06,105:INFO:superset.models.helpers:[COLUMN_TRACE]     [1] key=Period, name=Period, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-08 10:28:06,105:INFO:superset.models.helpers:[COLUMN_TRACE]   labels_expected: ['OrgUnit', 'Period']
2025-12-08 10:28:06,105:INFO:superset.connectors.sqla.models:[DHIS2] get_from_clause for virtual dataset 1: analytics_LAST_YEAR_20251206
2025-12-08 10:28:06,105:INFO:superset.models.helpers:[COLUMN_TRACE]   select_exprs count: 2
2025-12-08 10:28:06,105:INFO:superset.connectors.sqla.models:[DHIS2] Full SQL stored: SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
2025-12-08 10:28:06,105:INFO:superset.models.helpers:[COLUMN_TRACE]     [0] key=OrgUnit, name=OrgUnit, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-08 10:28:06,105:INFO:superset.connectors.sqla.models:[DHIS2] Loaded params from extra field: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayPropert
2025-12-08 10:28:06,105:INFO:superset.models.helpers:[COLUMN_TRACE]     [1] key=Period, name=Period, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-08 10:28:06,106:INFO:superset.connectors.sqla.models:[DHIS2] get_from_clause for virtual dataset 1: analytics_LAST_YEAR_20251206
2025-12-08 10:28:06,106:INFO:superset.connectors.sqla.models:[DHIS2] Full SQL stored: SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
2025-12-08 10:28:06,106:INFO:superset.connectors.sqla.models:[DHIS2] Loaded params from extra field: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayPropert
2025-12-08 10:28:06,108:INFO:superset.connectors.sqla.models:[DHIS2] Cached params with key: dhis2_params_1_analytics
2025-12-08 10:28:06,108:INFO:superset.connectors.sqla.models:[DHIS2] Stored params in Flask g for DHIS2 table: analytics
2025-12-08 10:28:06,111:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Query execution in connectors/sqla/models.py:
2025-12-08 10:28:06,111:INFO:superset.connectors.sqla.models:[DHIS2] Cached params with key: dhis2_params_1_analytics
2025-12-08 10:28:06,111:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   SQL (first 500 chars): SELECT "OrgUnit", "Period" 
FROM (SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
) AS virtual_table
 LIMIT 10000
2025-12-08 10:28:06,111:INFO:superset.connectors.sqla.models:[DHIS2] Stored params in Flask g for DHIS2 table: analytics
2025-12-08 10:28:06,111:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   labels_expected: ['OrgUnit', 'Period']
2025-12-08 10:28:06,115:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Query execution in connectors/sqla/models.py:
2025-12-08 10:28:06,115:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 connection initialized: https://tests.dhis2.hispuganda.org/hmis/api
2025-12-08 10:28:06,115:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   SQL (first 500 chars): SELECT "OrgUnit", "Period" 
FROM (SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
) AS virtual_table
 LIMIT 10000
2025-12-08 10:28:06,115:INFO:superset.db_engine_specs.dhis2_dialect:Executing DHIS2 query: SELECT
  "OrgUnit",
  "Period"
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
LIMIT 10000
2025-12-08 10:28:06,115:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   labels_expected: ['OrgUnit', 'Period']
2025-12-08 10:28:06,115:INFO:superset.db_engine_specs.dhis2_dialect:Parsed endpoint: analytics
2025-12-08 10:28:06,116:INFO:superset.db_engine_specs.dhis2_dialect:Using stored parameters from Flask g for table: analytics
2025-12-08 10:28:06,116:INFO:superset.db_engine_specs.dhis2_dialect:Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
2025-12-08 10:28:06,117:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 connection initialized: https://tests.dhis2.hispuganda.org/hmis/api
2025-12-08 10:28:06,117:INFO:superset.db_engine_specs.dhis2_dialect:Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
2025-12-08 10:28:06,117:INFO:superset.db_engine_specs.dhis2_dialect:Executing DHIS2 query: SELECT
  "OrgUnit",
  "Period"
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
LIMIT 10000
2025-12-08 10:28:06,117:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API request: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
2025-12-08 10:28:06,117:INFO:superset.db_engine_specs.dhis2_dialect:Parsed endpoint: analytics
2025-12-08 10:28:06,118:INFO:superset.db_engine_specs.dhis2_dialect:Using stored parameters from Flask g for table: analytics
2025-12-08 10:28:06,118:INFO:superset.db_engine_specs.dhis2_dialect:Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
2025-12-08 10:28:06,118:INFO:superset.db_engine_specs.dhis2_dialect:Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
2025-12-08 10:28:06,118:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API request: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
2025-12-08 10:28:06,879:INFO:superset.db_engine_specs.dhis2_dialect:Using wide/pivoted format for analytics
2025-12-08 10:28:06,879:INFO:superset.db_engine_specs.dhis2_dialect:normalize_analytics called with pivot=True, returning WIDE format
2025-12-08 10:28:06,879:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column construction - data_elements: ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
2025-12-08 10:28:06,880:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column names constructed (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-08 10:28:06,880:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] FIRST ROW CONSTRUCTION:
2025-12-08 10:28:06,880:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   Period (index 0): 2020
2025-12-08 10:28:06,880:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   OrgUnit (index 1): MOH - Uganda
2025-12-08 10:28:06,880:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01b. Malaria Total (index 2): 14479324
2025-12-08 10:28:06,880:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01a. Suspected fever (index 3): 22994823
2025-12-08 10:28:06,880:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01d. Malaria cases treated (index 4): 15266488
2025-12-08 10:28:06,880:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01c. Malaria Confirmed (B/s and RDT Positive) (index 5): 13326277
2025-12-08 10:28:06,880:INFO:superset.db_engine_specs.dhis2_dialect:First pivoted row - Period: '2020', OrgUnit: 'MOH - Uganda'
2025-12-08 10:28:06,880:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total pivoted rows: 4, columns: 6
2025-12-08 10:28:06,880:INFO:superset.db_engine_specs.dhis2_dialect:Normalized 4 rows with 6 columns for endpoint analytics
2025-12-08 10:28:06,880:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API returned 4 rows
2025-12-08 10:28:06,887:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() - Row count: 4
2025-12-08 10:28:06,887:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-08 10:28:06,887:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names length: 6
2025-12-08 10:28:06,887:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values count: 6
2025-12-08 10:28:06,887:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-08 10:28:06,887:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 0 (Period): 2020 -> 2020 (STRING)
2025-12-08 10:28:06,887:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (OrgUnit): MOH - Uganda -> MOH - Uganda (STRING)
2025-12-08 10:28:06,887:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (105_EP01b_Malaria_Total): 14479324 (PROCESSED)
2025-12-08 10:28:06,887:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (105_EP01a_Suspected_fever): 22994823 (PROCESSED)
2025-12-08 10:28:06,887:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (105_EP01d_Malaria_cases_treated): 15266488 (PROCESSED)
2025-12-08 10:28:06,887:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() returning 4 rows with 6 columns each
2025-12-08 10:28:06,887:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Got 4 rows from cursor
2025-12-08 10:28:06,887:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-08 10:28:06,887:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-08 10:28:06,887:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Types from cursor: ['String', 'String', 'String', 'String', 'String', 'String']
2025-12-08 10:28:06,889:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: DataFrame created with 4 rows, 6 columns
2025-12-08 10:28:06,889:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-08 10:28:06,890:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes BEFORE fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-08 10:28:06,891:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Period' to object dtype (dimension)
2025-12-08 10:28:06,891:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'OrgUnit' to object dtype (dimension)
2025-12-08 10:28:06,891:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes AFTER fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-08 10:28:06,891:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: First row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-08 10:28:06,894:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] BEFORE assign_column_label:
2025-12-08 10:28:06,895:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 6)
2025-12-08 10:28:06,895:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-08 10:28:06,895:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['OrgUnit', 'Period']
2025-12-08 10:28:06,895:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: False
2025-12-08 10:28:06,895:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-08 10:28:06,895:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Column truncation needed: df has 6 columns, expected 2
2025-12-08 10:28:06,895:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   DataFrame actual columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-08 10:28:06,895:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Expected columns: ['OrgUnit', 'Period']
2025-12-08 10:28:06,895:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] âœ“ Selecting columns BY NAME (matched all expected columns)
2025-12-08 10:28:06,895:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Column mapping: {'OrgUnit': 'OrgUnit', 'Period': 'Period'}
2025-12-08 10:28:06,896:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] Column Selection âœ“ SUCCESS - method=BY_NAME, datasource=analytics_LAST_YEAR_20251206
2025-12-08 10:28:06,896:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['OrgUnit', 'Period']
2025-12-08 10:28:06,896:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   tried_by_name=True, success=True, fallback=False
2025-12-08 10:28:06,896:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Assigning column labels: ['OrgUnit', 'Period']
2025-12-08 10:28:06,896:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] AFTER assign_column_label:
2025-12-08 10:28:06,896:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 2)
2025-12-08 10:28:06,896:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['OrgUnit', 'Period']
2025-12-08 10:28:06,896:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['OrgUnit', 'Period']
2025-12-08 10:28:06,896:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: True
2025-12-08 10:28:06,896:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'OrgUnit': 'MOH - Uganda', 'Period': '2020'}
2025-12-08 10:28:06,910:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:28:06] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-08 10:28:06,922:INFO:superset.db_engine_specs.dhis2_dialect:Using wide/pivoted format for analytics
2025-12-08 10:28:06,923:INFO:superset.db_engine_specs.dhis2_dialect:normalize_analytics called with pivot=True, returning WIDE format

[DHIS2] Parsing response for endpoint: analytics
[DHIS2] Response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Response sample: {'headers': [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}], 'metaDat
[DHIS2] Using WIDE/PIVOTED format (Period, OrgUnit, DX1, DX2, ...) for analytics
[DHIS2] normalize_analytics: pivot=True, using WIDE/PIVOTED format
[DHIS2] PIVOT CONSTRUCTION:
[DHIS2]   data_elements (UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   data_element_list (sorted UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   col_names (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized row count: 4
[DHIS2] First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] _set_description: columns=['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], types=['String', 'String', 'String', 'String', 'String', 'String']
[DHIS2] Transformed rows count: 4
[DHIS2] First transformed row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] Fetched 4 rows
[DHIS2] fetchall() called - returning 4 rows
[DHIS2] fetchall() - First row type: <class 'tuple'>
[DHIS2] fetchall() - First row (original): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Column count from description: 6
[DHIS2] fetchall() - First row (fixed types): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Type enforcement: dimensions=STRING, measures=FLOAT
[DHIS2] Executing query: SELECT
  "OrgUnit",
  "Period"
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
LIMIT 10000
[DHIS2] Parsed endpoint: analytics
[DHIS2] Found params in Flask g for analytics: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;
[DHIS2] Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
[DHIS2] Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
[DHIS2] Executing query: SELECT
  "OrgUnit",
  "Period"
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
LIMIT 10000
[DHIS2] API request URL: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
[DHIS2] Parsed endpoint: analytics
[DHIS2] Found params in Flask g for analytics: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;
[DHIS2] Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
[DHIS2] Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
[DHIS2] API request URL: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
[DHIS2] Raw API response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Raw DHIS2 rows count: 16
[DHIS2] First raw row: ['QHnwKs2OUZv', '2020', 'akV6429SUqu', '15266488']
[DHIS2] Parsing response for endpoint: analytics
[DHIS2] Response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Response sample: {'headers': [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}], 'metaDat
[DHIS2] Using WIDE/PIVOTED format (Period, OrgUnit, DX1, DX2, ...) for analytics
[DHIS2] normalize_analytics: pivot=True, using WIDE/PIVOTED format
[DHIS2] PIVOT CONSTRUCTION:
[DHIS2]   data_elements (UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   data_element_list (sorted UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   col_names (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized row count: 4
[DHIS2] First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] _set_description: columns=['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], types=['String', 'String', 'String', 'String', 'String', 'String']
[DHIS2] Transformed rows count: 4
[DHIS2] First transformed row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] Fetched 4 rows
[DHIS2] fetchall() called - returning 4 rows
[DHIS2] fetchall() - First row type: <class 'tuple'>
[DHIS2] fetchall() - First row (original): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Column count from description: 6
[DHIS2] fetchall() - First row (fixed types): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Type enforcement: dimensions=STRING, measures=FLOAT
[DHIS2] Raw API response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Raw DHIS2 rows count: 16
[DHIS2] First raw row: ['QHnwKs2OUZv', '2020', 'akV6429SUqu', '15266488']
[DHIS2] Parsing response for endpoint: analytics
[DHIS2] Response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Response sample: {'headers': [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}], 'metaDat
[DHIS2] Using WIDE/PIVOTED format (Period, OrgUnit, DX1, DX2, ...) for analytics
[DHIS2] normalize_analytics: pivot=True, using WIDE/PIVOTED format
[DHIS2] PIVOT CONSTRUCTION:
[DHIS2]   data_elements (UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']2025-12-08 10:28:06,923:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column construction - data_elements: ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
2025-12-08 10:28:06,923:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column names constructed (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-08 10:28:06,923:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] FIRST ROW CONSTRUCTION:
2025-12-08 10:28:06,923:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   Period (index 0): 2020
2025-12-08 10:28:06,923:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   OrgUnit (index 1): MOH - Uganda
2025-12-08 10:28:06,923:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01b. Malaria Total (index 2): 14479324
2025-12-08 10:28:06,923:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01a. Suspected fever (index 3): 22994823
2025-12-08 10:28:06,923:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01d. Malaria cases treated (index 4): 15266488
2025-12-08 10:28:06,923:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01c. Malaria Confirmed (B/s and RDT Positive) (index 5): 13326277
2025-12-08 10:28:06,923:INFO:superset.db_engine_specs.dhis2_dialect:First pivoted row - Period: '2020', OrgUnit: 'MOH - Uganda'
2025-12-08 10:28:06,923:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total pivoted rows: 4, columns: 6
2025-12-08 10:28:06,923:INFO:superset.db_engine_specs.dhis2_dialect:Normalized 4 rows with 6 columns for endpoint analytics
2025-12-08 10:28:06,923:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API returned 4 rows
2025-12-08 10:28:06,926:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() - Row count: 4
2025-12-08 10:28:06,926:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-08 10:28:06,926:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names length: 6
2025-12-08 10:28:06,926:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values count: 6
2025-12-08 10:28:06,926:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-08 10:28:06,926:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 0 (Period): 2020 -> 2020 (STRING)
2025-12-08 10:28:06,926:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (OrgUnit): MOH - Uganda -> MOH - Uganda (STRING)
2025-12-08 10:28:06,926:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (105_EP01b_Malaria_Total): 14479324 (PROCESSED)
2025-12-08 10:28:06,926:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (105_EP01a_Suspected_fever): 22994823 (PROCESSED)
2025-12-08 10:28:06,926:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (105_EP01d_Malaria_cases_treated): 15266488 (PROCESSED)
2025-12-08 10:28:06,926:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() returning 4 rows with 6 columns each
2025-12-08 10:28:06,926:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Got 4 rows from cursor
2025-12-08 10:28:06,926:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-08 10:28:06,926:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-08 10:28:06,926:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Types from cursor: ['String', 'String', 'String', 'String', 'String', 'String']
2025-12-08 10:28:06,926:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: DataFrame created with 4 rows, 6 columns
2025-12-08 10:28:06,926:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-08 10:28:06,926:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes BEFORE fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-08 10:28:06,927:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Period' to object dtype (dimension)
2025-12-08 10:28:06,927:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'OrgUnit' to object dtype (dimension)
2025-12-08 10:28:06,927:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes AFTER fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-08 10:28:06,927:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: First row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-08 10:28:06,930:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] BEFORE assign_column_label:
2025-12-08 10:28:06,930:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 6)
2025-12-08 10:28:06,930:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-08 10:28:06,930:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['OrgUnit', 'Period']
2025-12-08 10:28:06,930:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: False
2025-12-08 10:28:06,930:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-08 10:28:06,930:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Column truncation needed: df has 6 columns, expected 2
2025-12-08 10:28:06,930:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   DataFrame actual columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-08 10:28:06,930:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Expected columns: ['OrgUnit', 'Period']
2025-12-08 10:28:06,930:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] âœ“ Selecting columns BY NAME (matched all expected columns)
2025-12-08 10:28:06,930:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Column mapping: {'OrgUnit': 'OrgUnit', 'Period': 'Period'}
2025-12-08 10:28:06,930:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] Column Selection âœ“ SUCCESS - method=BY_NAME, datasource=analytics_LAST_YEAR_20251206
2025-12-08 10:28:06,930:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['OrgUnit', 'Period']
2025-12-08 10:28:06,930:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   tried_by_name=True, success=True, fallback=False
2025-12-08 10:28:06,930:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Assigning column labels: ['OrgUnit', 'Period']
2025-12-08 10:28:06,930:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] AFTER assign_column_label:
2025-12-08 10:28:06,930:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 2)
2025-12-08 10:28:06,930:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['OrgUnit', 'Period']
2025-12-08 10:28:06,930:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['OrgUnit', 'Period']
2025-12-08 10:28:06,930:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: True
2025-12-08 10:28:06,930:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'OrgUnit': 'MOH - Uganda', 'Period': '2020'}
2025-12-08 10:28:06,940:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:28:06] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-08 10:28:07,045:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:28:07] "PUT /api/v1/explore/form_data/VwuiZSBz-g0?tab_id=10 HTTP/1.1" 200 -
2025-12-08 10:28:07,976:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:28:07] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-08 10:28:14,810:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:28:14] "GET /api/v1/me/ HTTP/1.1" 200 -
2025-12-08 10:28:19,833:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:28:19] "GET /api/v1/me/ HTTP/1.1" 200 -
2025-12-08 10:28:22,648:ERROR:superset.models.helpers:[METRICS-TRACE] Processing 4 metrics
2025-12-08 10:28:22,649:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 0: adhoc - SUM(105_EP01a_Suspected_fever)
2025-12-08 10:28:22,649:ERROR:superset.models.helpers:[METRICS-TRACE] Processing 4 metrics
2025-12-08 10:28:22,649:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105_EP01a_Suspected_fever)
2025-12-08 10:28:22,649:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 0: adhoc - SUM(105_EP01a_Suspected_fever)
2025-12-08 10:28:22,649:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 1: adhoc - SUM(105_EP01b_Malaria_Total)
2025-12-08 10:28:22,649:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105_EP01a_Suspected_fever)
2025-12-08 10:28:22,649:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105_EP01b_Malaria_Total)
2025-12-08 10:28:22,649:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 1: adhoc - SUM(105_EP01b_Malaria_Total)
2025-12-08 10:28:22,649:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 2: adhoc - SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)
2025-12-08 10:28:22,650:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105_EP01b_Malaria_Total)
2025-12-08 10:28:22,650:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)
2025-12-08 10:28:22,650:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 2: adhoc - SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)
2025-12-08 10:28:22,650:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 3: adhoc - SUM(105_EP01d_Malaria_cases_treated)
2025-12-08 10:28:22,650:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)
2025-12-08 10:28:22,650:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105_EP01d_Malaria_cases_treated)
2025-12-08 10:28:22,650:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 3: adhoc - SUM(105_EP01d_Malaria_cases_treated)
2025-12-08 10:28:22,650:ERROR:superset.models.helpers:[METRICS-TRACE] Total metrics added: 4
2025-12-08 10:28:22,650:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105_EP01d_Malaria_cases_treated)
2025-12-08 10:28:22,652:ERROR:superset.models.helpers:[METRICS-TRACE] Before dedup: 1 select_exprs + 4 metrics_exprs
2025-12-08 10:28:22,652:ERROR:superset.models.helpers:[METRICS-TRACE] Total metrics added: 4
2025-12-08 10:28:22,652:ERROR:superset.models.helpers:[METRICS-TRACE] After dedup: 5 total select_exprs
2025-12-08 10:28:22,653:ERROR:superset.models.helpers:[METRICS-TRACE] Before dedup: 1 select_exprs + 4 metrics_exprs
2025-12-08 10:28:22,653:INFO:superset.models.helpers:[COLUMN_TRACE] SQL Query Building:
2025-12-08 10:28:22,653:ERROR:superset.models.helpers:[METRICS-TRACE] After dedup: 5 total select_exprs
2025-12-08 10:28:22,653:INFO:superset.models.helpers:[COLUMN_TRACE]   columns: [{'columnType': 'BASE_AXIS', 'sqlExpression': 'OrgUnit', 'label': 'OrgUnit', 'expressionType': 'SQL'}]
2025-12-08 10:28:22,653:INFO:superset.models.helpers:[COLUMN_TRACE] SQL Query Building:
2025-12-08 10:28:22,653:INFO:superset.models.helpers:[COLUMN_TRACE]   metrics: [{'expressionType': 'SIMPLE', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01a_Suspected_fever', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 4, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'INT', 'type_generic': 0, 'uuid': '530216fe-7198-4b8e-b688-a479bcf67426', 'verbose_name': None, 'warning_markdown': None}, 'aggregate': 'SUM', 'sqlExpression': None, 'datasourceWarning': False, 'hasCustomLabel': False, 'label': 'SUM(105_EP01a_Suspected_fever)', 'optionName': 'metric_4dm6wzzpssx_evo63ixtdye'}, {'expressionType': 'SIMPLE', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01b_Malaria_Total', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 3, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'INT', 'type_generic': 0, 'uuid': '959bffaa-826b-4d13-8b7b-6d9c4ea25e50', 'verbose_name': None, 'warning_markdown': None}, 'aggregate': 'SUM', 'sqlExpression': None, 'datasourceWarning': False, 'hasCustomLabel': False, 'label': 'SUM(105_EP01b_Malaria_Total)', 'optionName': 'metric_7om94y7wg44_o1syozv7mh'}, {'expressionType': 'SIMPLE', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 6, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'INT', 'type_generic': 0, 'uuid': '928946a1-6cea-4202-b8d6-0683414af79e', 'verbose_name': None, 'warning_markdown': None}, 'aggregate': 'SUM', 'sqlExpression': None, 'datasourceWarning': False, 'hasCustomLabel': False, 'label': 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', 'optionName': 'metric_cy8hjg2pvba_0r6xq6dmz2h'}, {'expressionType': 'SIMPLE', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01d_Malaria_cases_treated', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 5, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'INT', 'type_generic': 0, 'uuid': 'ffc52aba-a038-4c22-b6c8-169f3e2b8b97', 'verbose_name': None, 'warning_markdown': None}, 'aggregate': 'SUM', 'sqlExpression': None, 'datasourceWarning': False, 'hasCustomLabel': False, 'label': 'SUM(105_EP01d_Malaria_cases_treated)', 'optionName': 'metric_igswf88vbz_0hgijhbkfbo6'}]
2025-12-08 10:28:22,653:INFO:superset.models.helpers:[COLUMN_TRACE]   columns: [{'columnType': 'BASE_AXIS', 'sqlExpression': 'OrgUnit', 'label': 'OrgUnit', 'expressionType': 'SQL'}]
2025-12-08 10:28:22,653:INFO:superset.models.helpers:[COLUMN_TRACE]   groupby: []
2025-12-08 10:28:22,653:INFO:superset.models.helpers:[COLUMN_TRACE]   metrics: [{'expressionType': 'SIMPLE', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01a_Suspected_fever', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 4, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'INT', 'type_generic': 0, 'uuid': '530216fe-7198-4b8e-b688-a479bcf67426', 'verbose_name': None, 'warning_markdown': None}, 'aggregate': 'SUM', 'sqlExpression': None, 'datasourceWarning': False, 'hasCustomLabel': False, 'label': 'SUM(105_EP01a_Suspected_fever)', 'optionName': 'metric_4dm6wzzpssx_evo63ixtdye'}, {'expressionType': 'SIMPLE', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01b_Malaria_Total', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 3, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'INT', 'type_generic': 0, 'uuid': '959bffaa-826b-4d13-8b7b-6d9c4ea25e50', 'verbose_name': None, 'warning_markdown': None}, 'aggregate': 'SUM', 'sqlExpression': None, 'datasourceWarning': False, 'hasCustomLabel': False, 'label': 'SUM(105_EP01b_Malaria_Total)', 'optionName': 'metric_7om94y7wg44_o1syozv7mh'}, {'expressionType': 'SIMPLE', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 6, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'INT', 'type_generic': 0, 'uuid': '928946a1-6cea-4202-b8d6-0683414af79e', 'verbose_name': None, 'warning_markdown': None}, 'aggregate': 'SUM', 'sqlExpression': None, 'datasourceWarning': False, 'hasCustomLabel': False, 'label': 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', 'optionName': 'metric_cy8hjg2pvba_0r6xq6dmz2h'}, {'expressionType': 'SIMPLE', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01d_Malaria_cases_treated', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 5, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'INT', 'type_generic': 0, 'uuid': 'ffc52aba-a038-4c22-b6c8-169f3e2b8b97', 'verbose_name': None, 'warning_markdown': None}, 'aggregate': 'SUM', 'sqlExpression': None, 'datasourceWarning': False, 'hasCustomLabel': False, 'label': 'SUM(105_EP01d_Malaria_cases_treated)', 'optionName': 'metric_igswf88vbz_0hgijhbkfbo6'}]
2025-12-08 10:28:22,653:INFO:superset.models.helpers:[COLUMN_TRACE]   labels_expected: ['OrgUnit', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-08 10:28:22,653:INFO:superset.models.helpers:[COLUMN_TRACE]   groupby: []
2025-12-08 10:28:22,653:INFO:superset.models.helpers:[COLUMN_TRACE]   select_exprs count: 5
2025-12-08 10:28:22,653:INFO:superset.models.helpers:[COLUMN_TRACE]   labels_expected: ['OrgUnit', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-08 10:28:22,653:INFO:superset.models.helpers:[COLUMN_TRACE]     [0] key=OrgUnit, name=OrgUnit, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-08 10:28:22,653:INFO:superset.models.helpers:[COLUMN_TRACE]   select_exprs count: 5
2025-12-08 10:28:22,653:INFO:superset.models.helpers:[COLUMN_TRACE]     [1] key=SUM(105_EP01a_Suspected_fever), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-08 10:28:22,653:INFO:superset.models.helpers:[COLUMN_TRACE]     [0] key=OrgUnit, name=OrgUnit, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-08 10:28:22,653:INFO:superset.models.helpers:[COLUMN_TRACE]     [2] key=SUM(105_EP01b_Malaria_Total), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-08 10:28:22,653:INFO:superset.models.helpers:[COLUMN_TRACE]     [1] key=SUM(105_EP01a_Suspected_fever), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-08 10:28:22,653:INFO:superset.models.helpers:[COLUMN_TRACE]     [3] key=SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-08 10:28:22,653:INFO:superset.models.helpers:[COLUMN_TRACE]     [2] key=SUM(105_EP01b_Malaria_Total), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-08 10:28:22,653:INFO:superset.models.helpers:[COLUMN_TRACE]     [4] key=SUM(105_EP01d_Malaria_cases_treated), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-08 10:28:22,653:INFO:superset.models.helpers:[COLUMN_TRACE]     [3] key=SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-08 10:28:22,653:INFO:superset.connectors.sqla.models:[DHIS2] get_from_clause for virtual dataset 1: analytics_LAST_YEAR_20251206
2025-12-08 10:28:22,653:INFO:superset.models.helpers:[COLUMN_TRACE]     [4] key=SUM(105_EP01d_Malaria_cases_treated), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-08 10:28:22,653:INFO:superset.connectors.sqla.models:[DHIS2] Full SQL stored: SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
2025-12-08 10:28:22,653:INFO:superset.connectors.sqla.models:[DHIS2] get_from_clause for virtual dataset 1: analytics_LAST_YEAR_20251206
2025-12-08 10:28:22,653:INFO:superset.connectors.sqla.models:[DHIS2] Full SQL stored: SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
2025-12-08 10:28:22,653:INFO:superset.connectors.sqla.models:[DHIS2] Loaded params from extra field: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayPropert
2025-12-08 10:28:22,653:INFO:superset.connectors.sqla.models:[DHIS2] Loaded params from extra field: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayPropert
2025-12-08 10:28:22,655:INFO:superset.connectors.sqla.models:[DHIS2] Cached params with key: dhis2_params_1_analytics
2025-12-08 10:28:22,655:INFO:superset.connectors.sqla.models:[DHIS2] Stored params in Flask g for DHIS2 table: analytics
2025-12-08 10:28:22,656:INFO:superset.connectors.sqla.models:[DHIS2] Cached params with key: dhis2_params_1_analytics
2025-12-08 10:28:22,656:INFO:superset.connectors.sqla.models:[DHIS2] Stored params in Flask g for DHIS2 table: analytics
2025-12-08 10:28:22,657:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Query execution in connectors/sqla/models.py:
2025-12-08 10:28:22,658:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   SQL (first 500 chars): SELECT "OrgUnit", sum("105_EP01a_Suspected_fever") AS sum_1, sum("105_EP01b_Malaria_Total") AS sum_2, sum("105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive") AS sum_3, sum("105_EP01d_Malaria_cases_treated") AS sum_4 
FROM (SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
) AS virtual_table GROUP BY "OrgUnit" ORDER BY sum("105_EP01a_Suspec
2025-12-08 10:28:22,659:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Query execution in connectors/sqla/models.py:
2025-12-08 10:28:22,659:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   labels_expected: ['OrgUnit', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-08 10:28:22,659:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   SQL (first 500 chars): SELECT "OrgUnit", sum("105_EP01a_Suspected_fever") AS sum_1, sum("105_EP01b_Malaria_Total") AS sum_2, sum("105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive") AS sum_3, sum("105_EP01d_Malaria_cases_treated") AS sum_4 
FROM (SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
) AS virtual_table GROUP BY "OrgUnit" ORDER BY sum("105_EP01a_Suspec
2025-12-08 10:28:22,660:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   labels_expected: ['OrgUnit', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-08 10:28:22,661:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 connection initialized: https://tests.dhis2.hispuganda.org/hmis/api
2025-12-08 10:28:22,662:INFO:superset.db_engine_specs.dhis2_dialect:Executing DHIS2 query: SELECT
  "OrgUnit",
  SUM("105_EP01a_Suspected_fever") AS sum_1,
  SUM("105_EP01b_Malaria_Total") AS sum_2,
  SUM("105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive") AS sum_3,
  SUM("105_EP01d_Malaria_cases_treated") AS sum_4
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "OrgUnit"
ORDER BY
  SUM("105_EP01a_Suspected_fever") DESC
LIMIT 10000
2025-12-08 10:28:22,662:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 connection initialized: https://tests.dhis2.hispuganda.org/hmis/api
2025-12-08 10:28:22,662:INFO:superset.db_engine_specs.dhis2_dialect:Parsed endpoint: analytics
2025-12-08 10:28:22,663:INFO:superset.db_engine_specs.dhis2_dialect:Executing DHIS2 query: SELECT
  "OrgUnit",
  SUM("105_EP01a_Suspected_fever") AS sum_1,
  SUM("105_EP01b_Malaria_Total") AS sum_2,
  SUM("105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive") AS sum_3,
  SUM("105_EP01d_Malaria_cases_treated") AS sum_4
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "OrgUnit"
ORDER BY
  SUM("105_EP01a_Suspected_fever") DESC
LIMIT 10000
2025-12-08 10:28:22,663:INFO:superset.db_engine_specs.dhis2_dialect:Using stored parameters from Flask g for table: analytics
2025-12-08 10:28:22,663:INFO:superset.db_engine_specs.dhis2_dialect:Parsed endpoint: analytics
2025-12-08 10:28:22,663:INFO:superset.db_engine_specs.dhis2_dialect:Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
2025-12-08 10:28:22,663:INFO:superset.db_engine_specs.dhis2_dialect:Using stored parameters from Flask g for table: analytics
2025-12-08 10:28:22,663:INFO:superset.db_engine_specs.dhis2_dialect:Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
2025-12-08 10:28:22,663:INFO:superset.db_engine_specs.dhis2_dialect:Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
2025-12-08 10:28:22,663:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API request: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
2025-12-08 10:28:22,663:INFO:superset.db_engine_specs.dhis2_dialect:Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
2025-12-08 10:28:22,663:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API request: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
2025-12-08 10:28:23,494:INFO:superset.db_engine_specs.dhis2_dialect:Using wide/pivoted format for analytics
2025-12-08 10:28:23,495:INFO:superset.db_engine_specs.dhis2_dialect:Using wide/pivoted format for analytics
2025-12-08 10:28:23,495:INFO:superset.db_engine_specs.dhis2_dialect:normalize_analytics called with pivot=True, returning WIDE format
2025-12-08 10:28:23,495:INFO:superset.db_engine_specs.dhis2_dialect:normalize_analytics called with pivot=True, returning WIDE format
2025-12-08 10:28:23,495:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column construction - data_elements: ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
2025-12-08 10:28:23,495:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column construction - data_elements: ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
2025-12-08 10:28:23,495:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column names constructed (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-08 10:28:23,495:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column names constructed (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-08 10:28:23,495:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] FIRST ROW CONSTRUCTION:
2025-12-08 10:28:23,495:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] FIRST ROW CONSTRUCTION:
2025-12-08 10:28:23,496:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   Period (index 0): 2020
2025-12-08 10:28:23,496:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   Period (index 0): 2020
2025-12-08 10:28:23,496:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   OrgUnit (index 1): MOH - Uganda
2025-12-08 10:28:23,496:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   OrgUnit (index 1): MOH - Uganda
2025-12-08 10:28:23,496:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01b. Malaria Total (index 2): 14479324
2025-12-08 10:28:23,496:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01b. Malaria Total (index 2): 14479324
2025-12-08 10:28:23,496:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01a. Suspected fever (index 3): 22994823
2025-12-08 10:28:23,496:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01a. Suspected fever (index 3): 22994823
2025-12-08 10:28:23,496:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01d. Malaria cases treated (index 4): 15266488
2025-12-08 10:28:23,496:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01d. Malaria cases treated (index 4): 15266488
2025-12-08 10:28:23,496:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01c. Malaria Confirmed (B/s and RDT Positive) (index 5): 13326277
2025-12-08 10:28:23,496:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01c. Malaria Confirmed (B/s and RDT Positive) (index 5): 13326277
2025-12-08 10:28:23,496:INFO:superset.db_engine_specs.dhis2_dialect:First pivoted row - Period: '2020', OrgUnit: 'MOH - Uganda'
2025-12-08 10:28:23,496:INFO:superset.db_engine_specs.dhis2_dialect:First pivoted row - Period: '2020', OrgUnit: 'MOH - Uganda'
2025-12-08 10:28:23,496:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total pivoted rows: 4, columns: 6
2025-12-08 10:28:23,497:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total pivoted rows: 4, columns: 6
2025-12-08 10:28:23,497:INFO:superset.db_engine_specs.dhis2_dialect:Normalized 4 rows with 6 columns for endpoint analytics

[DHIS2]   data_element_list (sorted UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   col_names (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized row count: 4
[DHIS2] First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] _set_description: columns=['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], types=['String', 'String', 'String', 'String', 'String', 'String']
[DHIS2] Transformed rows count: 4
[DHIS2] First transformed row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] Fetched 4 rows
[DHIS2] fetchall() called - returning 4 rows
[DHIS2] fetchall() - First row type: <class 'tuple'>
[DHIS2] fetchall() - First row (original): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Column count from description: 6
[DHIS2] fetchall() - First row (fixed types): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Type enforcement: dimensions=STRING, measures=FLOAT
[DHIS2] Executing query: SELECT
  "OrgUnit",
  SUM("105_EP01a_Suspected_fever") AS sum_1,
  SUM("105_EP01b_Malaria_Total") AS sum_2,
  SUM("105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive") AS sum_3,
  SUM("105_EP01d_Malaria_cases_treated") AS sum_4
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "OrgUnit"
ORDER BY
  SUM("105_EP01a_Suspected_fever") DESC
LIMIT 10000
[DHIS2] Parsed endpoint: analytics
[DHIS2] Executing query: SELECT
  "OrgUnit",
  SUM("105_EP01a_Suspected_fever") AS sum_1,
  SUM("105_EP01b_Malaria_Total") AS sum_2,
  SUM("105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive") AS sum_3,
  SUM("105_EP01d_Malaria_cases_treated") AS sum_4
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "OrgUnit"
ORDER BY
  SUM("105_EP01a_Suspected_fever") DESC
LIMIT 10000
[DHIS2] Found params in Flask g for analytics: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;
[DHIS2] Parsed endpoint: analytics
[DHIS2] Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
[DHIS2] Found params in Flask g for analytics: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;
[DHIS2] Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
[DHIS2] Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
[DHIS2] API request URL: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
[DHIS2] Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
[DHIS2] API request URL: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
[DHIS2] Raw API response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Raw DHIS2 rows count: 16
[DHIS2] First raw row: ['QHnwKs2OUZv', '2020', 'akV6429SUqu', '15266488']
[DHIS2] Parsing response for endpoint: analytics
[DHIS2] Response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Response sample: {'headers': [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}], 'metaDat
[DHIS2] Using WIDE/PIVOTED format (Period, OrgUnit, DX1, DX2, ...) for analytics
[DHIS2] Raw API response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Raw DHIS2 rows count: 16
[DHIS2] First raw row: ['QHnwKs2OUZv', '2020', 'akV6429SUqu', '15266488']
[DHIS2] Parsing response for endpoint: analytics
[DHIS2] Response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Response sample: {'headers': [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}], 'metaDat
[DHIS2] Using WIDE/PIVOTED format (Period, OrgUnit, DX1, DX2, ...) for analytics
[DHIS2] normalize_analytics: pivot=True, using WIDE/PIVOTED format
[DHIS2] normalize_analytics: pivot=True, using WIDE/PIVOTED format
[DHIS2] PIVOT CONSTRUCTION:
[DHIS2]   data_elements (UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   data_element_list (sorted UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   col_names (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] PIVOT CONSTRUCTION:
[DHIS2]   data_elements (UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   data_element_list (sorted UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   col_names (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized row count: 4
[DHIS2] First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] _set_description: columns=['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], types=['String', 'String', 'String', 'String', 'String', 'String']
[DHIS2] Normalized columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized row count: 4
[DHIS2] First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] _set_description: columns=['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], types=['String', 'String', 'String', 'String', 'String', 'String']
[DHIS2] Transformed rows count: 4
[DHIS2] First transformed row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)2025-12-08 10:28:23,497:INFO:superset.db_engine_specs.dhis2_dialect:Normalized 4 rows with 6 columns for endpoint analytics
2025-12-08 10:28:23,497:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API returned 4 rows
2025-12-08 10:28:23,497:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API returned 4 rows
2025-12-08 10:28:23,507:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() - Row count: 4
2025-12-08 10:28:23,507:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-08 10:28:23,507:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() - Row count: 4
2025-12-08 10:28:23,507:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names length: 6
2025-12-08 10:28:23,507:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-08 10:28:23,507:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values count: 6
2025-12-08 10:28:23,507:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names length: 6
2025-12-08 10:28:23,507:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-08 10:28:23,508:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values count: 6
2025-12-08 10:28:23,508:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 0 (Period): 2020 -> 2020 (STRING)
2025-12-08 10:28:23,508:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-08 10:28:23,508:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (OrgUnit): MOH - Uganda -> MOH - Uganda (STRING)
2025-12-08 10:28:23,508:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 0 (Period): 2020 -> 2020 (STRING)
2025-12-08 10:28:23,508:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (105_EP01b_Malaria_Total): 14479324 (PROCESSED)
2025-12-08 10:28:23,508:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (OrgUnit): MOH - Uganda -> MOH - Uganda (STRING)
2025-12-08 10:28:23,508:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (105_EP01a_Suspected_fever): 22994823 (PROCESSED)
2025-12-08 10:28:23,508:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (105_EP01b_Malaria_Total): 14479324 (PROCESSED)
2025-12-08 10:28:23,508:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (105_EP01d_Malaria_cases_treated): 15266488 (PROCESSED)
2025-12-08 10:28:23,508:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (105_EP01a_Suspected_fever): 22994823 (PROCESSED)
2025-12-08 10:28:23,508:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() returning 4 rows with 6 columns each
2025-12-08 10:28:23,508:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (105_EP01d_Malaria_cases_treated): 15266488 (PROCESSED)
2025-12-08 10:28:23,508:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Got 4 rows from cursor
2025-12-08 10:28:23,508:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() returning 4 rows with 6 columns each
2025-12-08 10:28:23,508:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-08 10:28:23,508:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Got 4 rows from cursor
2025-12-08 10:28:23,508:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-08 10:28:23,508:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-08 10:28:23,508:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Types from cursor: ['String', 'String', 'String', 'String', 'String', 'String']
2025-12-08 10:28:23,508:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-08 10:28:23,514:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Types from cursor: ['String', 'String', 'String', 'String', 'String', 'String']
2025-12-08 10:28:23,516:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: DataFrame created with 4 rows, 6 columns
2025-12-08 10:28:23,517:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-08 10:28:23,517:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: DataFrame created with 4 rows, 6 columns
2025-12-08 10:28:23,518:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes BEFORE fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-08 10:28:23,518:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-08 10:28:23,519:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Period' to object dtype (dimension)
2025-12-08 10:28:23,519:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes BEFORE fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-08 10:28:23,519:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'OrgUnit' to object dtype (dimension)
2025-12-08 10:28:23,520:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Period' to object dtype (dimension)
2025-12-08 10:28:23,520:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes AFTER fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-08 10:28:23,520:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'OrgUnit' to object dtype (dimension)
2025-12-08 10:28:23,521:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: First row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-08 10:28:23,521:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes AFTER fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-08 10:28:23,523:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: First row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-08 10:28:23,528:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] BEFORE assign_column_label:
2025-12-08 10:28:23,528:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 6)
2025-12-08 10:28:23,528:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-08 10:28:23,528:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['OrgUnit', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-08 10:28:23,528:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: False
2025-12-08 10:28:23,528:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-08 10:28:23,528:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Column truncation needed: df has 6 columns, expected 5
2025-12-08 10:28:23,528:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   DataFrame actual columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-08 10:28:23,528:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Expected columns: ['OrgUnit', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-08 10:28:23,528:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] âœ“ Selecting columns BY NAME (matched all expected columns)
2025-12-08 10:28:23,528:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Column mapping: {'OrgUnit': 'OrgUnit', 'SUM(105_EP01a_Suspected_fever)': '105_EP01a_Suspected_fever', 'SUM(105_EP01b_Malaria_Total)': '105_EP01b_Malaria_Total', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)': '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', 'SUM(105_EP01d_Malaria_cases_treated)': '105_EP01d_Malaria_cases_treated'}
2025-12-08 10:28:23,529:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] Column Selection âœ“ SUCCESS - method=BY_NAME, datasource=analytics_LAST_YEAR_20251206
2025-12-08 10:28:23,529:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['OrgUnit', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-08 10:28:23,530:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   tried_by_name=True, success=True, fallback=False
2025-12-08 10:28:23,530:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Assigning column labels: ['OrgUnit', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-08 10:28:23,530:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] AFTER assign_column_label:
2025-12-08 10:28:23,530:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 5)
2025-12-08 10:28:23,530:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['OrgUnit', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-08 10:28:23,530:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['OrgUnit', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-08 10:28:23,530:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: True
2025-12-08 10:28:23,530:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'OrgUnit': 'MOH - Uganda', 'SUM(105_EP01a_Suspected_fever)': 22994823, 'SUM(105_EP01b_Malaria_Total)': 14479324, 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)': 13326277, 'SUM(105_EP01d_Malaria_cases_treated)': 15266488}
2025-12-08 10:28:23,532:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] DataFrame columns: ['OrgUnit', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-08 10:28:23,533:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Aggregates: {'SUM(105_EP01a_Suspected_fever)': {'operator': 'mean'}, 'SUM(105_EP01b_Malaria_Total)': {'operator': 'mean'}, 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)': {'operator': 'mean'}, 'SUM(105_EP01d_Malaria_cases_treated)': {'operator': 'mean'}}
2025-12-08 10:28:23,533:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105_EP01a_Suspected_fever)', column='SUM(105_EP01a_Suspected_fever)'
2025-12-08 10:28:23,533:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105_EP01b_Malaria_Total)', column='SUM(105_EP01b_Malaria_Total)'
2025-12-08 10:28:23,534:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', column='SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)'
2025-12-08 10:28:23,534:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] BEFORE assign_column_label:
2025-12-08 10:28:23,534:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105_EP01d_Malaria_cases_treated)', column='SUM(105_EP01d_Malaria_cases_treated)'
2025-12-08 10:28:23,534:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 6)
2025-12-08 10:28:23,537:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-08 10:28:23,537:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['OrgUnit', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-08 10:28:23,537:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: False
2025-12-08 10:28:23,537:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-08 10:28:23,537:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Column truncation needed: df has 6 columns, expected 5
2025-12-08 10:28:23,537:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   DataFrame actual columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-08 10:28:23,537:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Expected columns: ['OrgUnit', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-08 10:28:23,537:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] âœ“ Selecting columns BY NAME (matched all expected columns)
2025-12-08 10:28:23,537:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Column mapping: {'OrgUnit': 'OrgUnit', 'SUM(105_EP01a_Suspected_fever)': '105_EP01a_Suspected_fever', 'SUM(105_EP01b_Malaria_Total)': '105_EP01b_Malaria_Total', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)': '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', 'SUM(105_EP01d_Malaria_cases_treated)': '105_EP01d_Malaria_cases_treated'}
2025-12-08 10:28:23,537:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] Column Selection âœ“ SUCCESS - method=BY_NAME, datasource=analytics_LAST_YEAR_20251206
2025-12-08 10:28:23,537:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['OrgUnit', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-08 10:28:23,537:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   tried_by_name=True, success=True, fallback=False
2025-12-08 10:28:23,537:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Assigning column labels: ['OrgUnit', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-08 10:28:23,537:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] AFTER assign_column_label:
2025-12-08 10:28:23,537:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 5)
2025-12-08 10:28:23,537:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['OrgUnit', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-08 10:28:23,537:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['OrgUnit', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-08 10:28:23,537:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: True
2025-12-08 10:28:23,537:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'OrgUnit': 'MOH - Uganda', 'SUM(105_EP01a_Suspected_fever)': 22994823, 'SUM(105_EP01b_Malaria_Total)': 14479324, 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)': 13326277, 'SUM(105_EP01d_Malaria_cases_treated)': 15266488}
2025-12-08 10:28:23,539:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] DataFrame columns: ['OrgUnit', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-08 10:28:23,539:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Aggregates: {'SUM(105_EP01a_Suspected_fever)': {'operator': 'mean'}, 'SUM(105_EP01b_Malaria_Total)': {'operator': 'mean'}, 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)': {'operator': 'mean'}, 'SUM(105_EP01d_Malaria_cases_treated)': {'operator': 'mean'}}
2025-12-08 10:28:23,539:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105_EP01a_Suspected_fever)', column='SUM(105_EP01a_Suspected_fever)'
2025-12-08 10:28:23,539:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105_EP01b_Malaria_Total)', column='SUM(105_EP01b_Malaria_Total)'
2025-12-08 10:28:23,539:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', column='SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)'
2025-12-08 10:28:23,539:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105_EP01d_Malaria_cases_treated)', column='SUM(105_EP01d_Malaria_cases_treated)'
2025-12-08 10:28:23,542:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:28:23] "PUT /api/v1/explore/form_data/QTQfaaLaQ_A?tab_id=12 HTTP/1.1" 200 -
2025-12-08 10:28:23,564:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:28:23] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-08 10:28:23,567:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:28:23] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-08 10:28:24,581:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:28:24] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-08 10:28:29,206:ERROR:superset.models.helpers:[METRICS-TRACE] Processing 1 metrics
2025-12-08 10:28:29,206:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 0: adhoc - COUNT(*)
2025-12-08 10:28:29,207:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: COUNT(*)
2025-12-08 10:28:29,207:ERROR:superset.models.helpers:[METRICS-TRACE] Total metrics added: 1
2025-12-08 10:28:29,207:ERROR:superset.models.helpers:[METRICS-TRACE] Before dedup: 0 select_exprs + 1 metrics_exprs
2025-12-08 10:28:29,207:ERROR:superset.models.helpers:[METRICS-TRACE] After dedup: 1 total select_exprs
2025-12-08 10:28:29,207:INFO:superset.models.helpers:[COLUMN_TRACE] SQL Query Building:
2025-12-08 10:28:29,207:INFO:superset.models.helpers:[COLUMN_TRACE]   columns: []
2025-12-08 10:28:29,207:INFO:superset.models.helpers:[COLUMN_TRACE]   metrics: [{'expressionType': 'SQL', 'sqlExpression': 'COUNT(*)', 'label': 'COUNT(*)'}]
2025-12-08 10:28:29,207:INFO:superset.models.helpers:[COLUMN_TRACE]   groupby: []
2025-12-08 10:28:29,207:INFO:superset.models.helpers:[COLUMN_TRACE]   labels_expected: ['COUNT(*)']
2025-12-08 10:28:29,207:INFO:superset.models.helpers:[COLUMN_TRACE]   select_exprs count: 1
2025-12-08 10:28:29,207:INFO:superset.models.helpers:[COLUMN_TRACE]     [0] key=COUNT(*), name=COUNT(*), type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-08 10:28:29,207:INFO:superset.connectors.sqla.models:[DHIS2] get_from_clause for virtual dataset 1: analytics_LAST_YEAR_20251206
2025-12-08 10:28:29,207:INFO:superset.connectors.sqla.models:[DHIS2] Full SQL stored: SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
2025-12-08 10:28:29,207:INFO:superset.connectors.sqla.models:[DHIS2] Loaded params from extra field: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayPropert
2025-12-08 10:28:29,208:INFO:superset.connectors.sqla.models:[DHIS2] Cached params with key: dhis2_params_1_analytics
2025-12-08 10:28:29,208:INFO:superset.connectors.sqla.models:[DHIS2] Stored params in Flask g for DHIS2 table: analytics
2025-12-08 10:28:29,211:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Query execution in connectors/sqla/models.py:
2025-12-08 10:28:29,211:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   SQL (first 500 chars): SELECT COUNT(*) 
FROM (SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
) AS virtual_table
 LIMIT 5000
2025-12-08 10:28:29,211:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   labels_expected: ['COUNT(*)']
2025-12-08 10:28:29,212:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 connection initialized: https://tests.dhis2.hispuganda.org/hmis/api
2025-12-08 10:28:29,213:INFO:superset.db_engine_specs.dhis2_dialect:Executing DHIS2 query: SELECT
  COUNT(*)
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
LIMIT 5000
2025-12-08 10:28:29,213:INFO:superset.db_engine_specs.dhis2_dialect:Parsed endpoint: analytics
2025-12-08 10:28:29,213:INFO:superset.db_engine_specs.dhis2_dialect:Using stored parameters from Flask g for table: analytics
2025-12-08 10:28:29,213:INFO:superset.db_engine_specs.dhis2_dialect:Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
2025-12-08 10:28:29,213:INFO:superset.db_engine_specs.dhis2_dialect:Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
2025-12-08 10:28:29,213:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API request: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
2025-12-08 10:28:30,132:INFO:superset.db_engine_specs.dhis2_dialect:Using wide/pivoted format for analytics
2025-12-08 10:28:30,132:INFO:superset.db_engine_specs.dhis2_dialect:normalize_analytics called with pivot=True, returning WIDE format
2025-12-08 10:28:30,132:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column construction - data_elements: ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
2025-12-08 10:28:30,132:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column names constructed (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-08 10:28:30,132:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] FIRST ROW CONSTRUCTION:
2025-12-08 10:28:30,132:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   Period (index 0): 2020
2025-12-08 10:28:30,132:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   OrgUnit (index 1): MOH - Uganda
2025-12-08 10:28:30,132:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01b. Malaria Total (index 2): 14479324
2025-12-08 10:28:30,132:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01a. Suspected fever (index 3): 22994823
2025-12-08 10:28:30,132:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01d. Malaria cases treated (index 4): 15266488
2025-12-08 10:28:30,132:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01c. Malaria Confirmed (B/s and RDT Positive) (index 5): 13326277
2025-12-08 10:28:30,132:INFO:superset.db_engine_specs.dhis2_dialect:First pivoted row - Period: '2020', OrgUnit: 'MOH - Uganda'
2025-12-08 10:28:30,132:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total pivoted rows: 4, columns: 6
2025-12-08 10:28:30,132:INFO:superset.db_engine_specs.dhis2_dialect:Normalized 4 rows with 6 columns for endpoint analytics
2025-12-08 10:28:30,132:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API returned 4 rows
2025-12-08 10:28:30,138:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() - Row count: 4
2025-12-08 10:28:30,138:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-08 10:28:30,138:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names length: 6
2025-12-08 10:28:30,138:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values count: 6
2025-12-08 10:28:30,138:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-08 10:28:30,138:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 0 (Period): 2020 -> 2020 (STRING)
2025-12-08 10:28:30,138:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (OrgUnit): MOH - Uganda -> MOH - Uganda (STRING)
2025-12-08 10:28:30,138:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (105_EP01b_Malaria_Total): 14479324 (PROCESSED)
2025-12-08 10:28:30,138:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (105_EP01a_Suspected_fever): 22994823 (PROCESSED)
2025-12-08 10:28:30,138:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (105_EP01d_Malaria_cases_treated): 15266488 (PROCESSED)
2025-12-08 10:28:30,138:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() returning 4 rows with 6 columns each
2025-12-08 10:28:30,138:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Got 4 rows from cursor
2025-12-08 10:28:30,138:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-08 10:28:30,138:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-08 10:28:30,138:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Types from cursor: ['String', 'String', 'String', 'String', 'String', 'String']
2025-12-08 10:28:30,139:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: DataFrame created with 4 rows, 6 columns
2025-12-08 10:28:30,139:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-08 10:28:30,139:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes BEFORE fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-08 10:28:30,140:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Period' to object dtype (dimension)
2025-12-08 10:28:30,140:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'OrgUnit' to object dtype (dimension)
2025-12-08 10:28:30,141:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes AFTER fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-08 10:28:30,141:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: First row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-08 10:28:30,144:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] BEFORE assign_column_label:
2025-12-08 10:28:30,144:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 6)
2025-12-08 10:28:30,144:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-08 10:28:30,144:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['COUNT(*)']
2025-12-08 10:28:30,144:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: False
2025-12-08 10:28:30,144:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-08 10:28:30,145:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Column truncation needed: df has 6 columns, expected 1
2025-12-08 10:28:30,145:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   DataFrame actual columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-08 10:28:30,145:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Expected columns: ['COUNT(*)']
2025-12-08 10:28:30,145:WARNING:superset.connectors.sqla.models:[COLUMN_TRACE] âš ï¸  Could not match all expected columns. Using POSITION-BASED (INDEX) fallback for 1 columns
2025-12-08 10:28:30,145:WARNING:superset.connectors.sqla.models:[COLUMN_TRACE]   Unmatched columns: ['COUNT(*)']
2025-12-08 10:28:30,145:WARNING:superset.connectors.sqla.models:[COLUMN_TRACE]   Available columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-08 10:28:30,145:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] Column Selection âš ï¸  FALLBACK - method=BY_INDEX, datasource=analytics_LAST_YEAR_20251206
2025-12-08 10:28:30,145:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['COUNT(*)']
2025-12-08 10:28:30,145:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   tried_by_name=True, success=False, fallback=True
2025-12-08 10:28:30,145:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Assigning column labels: ['COUNT(*)']
2025-12-08 10:28:30,145:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] AFTER assign_column_label:
2025-12-08 10:28:30,145:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 1)
2025-12-08 10:28:30,145:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['COUNT(*)']
2025-12-08 10:28:30,145:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['COUNT(*)']
2025-12-08 10:28:30,145:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: True
2025-12-08 10:28:30,145:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'COUNT(*)': '2020'}
2025-12-08 10:28:30,154:ERROR:superset.models.helpers:[METRICS-TRACE] Processing 0 metrics
2025-12-08 10:28:30,154:ERROR:superset.models.helpers:[METRICS-TRACE] Total metrics added: 0
2025-12-08 10:28:30,157:ERROR:superset.models.helpers:[METRICS-TRACE] Before dedup: 6 select_exprs + 0 metrics_exprs
2025-12-08 10:28:30,157:ERROR:superset.models.helpers:[METRICS-TRACE] After dedup: 6 total select_exprs
2025-12-08 10:28:30,157:INFO:superset.models.helpers:[COLUMN_TRACE] SQL Query Building:
2025-12-08 10:28:30,157:INFO:superset.models.helpers:[COLUMN_TRACE]   columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-08 10:28:30,157:INFO:superset.models.helpers:[COLUMN_TRACE]   metrics: []
2025-12-08 10:28:30,157:INFO:superset.models.helpers:[COLUMN_TRACE]   groupby: []
2025-12-08 10:28:30,157:INFO:superset.models.helpers:[COLUMN_TRACE]   labels_expected: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-08 10:28:30,157:INFO:superset.models.helpers:[COLUMN_TRACE]   select_exprs count: 6
2025-12-08 10:28:30,157:INFO:superset.models.helpers:[COLUMN_TRACE]     [0] key=Period, name=Period, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-08 10:28:30,157:INFO:superset.models.helpers:[COLUMN_TRACE]     [1] key=OrgUnit, name=OrgUnit, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-08 10:28:30,157:INFO:superset.models.helpers:[COLUMN_TRACE]     [2] key=105_EP01b_Malaria_Total, name=105_EP01b_Malaria_Total, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-08 10:28:30,157:INFO:superset.models.helpers:[COLUMN_TRACE]     [3] key=105_EP01a_Suspected_fever, name=105_EP01a_Suspected_fever, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-08 10:28:30,157:INFO:superset.models.helpers:[COLUMN_TRACE]     [4] key=105_EP01d_Malaria_cases_treated, name=105_EP01d_Malaria_cases_treated, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-08 10:28:30,157:INFO:superset.models.helpers:[COLUMN_TRACE]     [5] key=105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive, name=105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-08 10:28:30,157:INFO:superset.connectors.sqla.models:[DHIS2] get_from_clause for virtual dataset 1: analytics_LAST_YEAR_20251206
2025-12-08 10:28:30,157:INFO:superset.connectors.sqla.models:[DHIS2] Full SQL stored: SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
2025-12-08 10:28:30,157:INFO:superset.connectors.sqla.models:[DHIS2] Loaded params from extra field: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayPropert
2025-12-08 10:28:30,158:INFO:superset.connectors.sqla.models:[DHIS2] Cached params with key: dhis2_params_1_analytics
2025-12-08 10:28:30,158:INFO:superset.connectors.sqla.models:[DHIS2] Stored params in Flask g for DHIS2 table: analytics
2025-12-08 10:28:30,160:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Query execution in connectors/sqla/models.py:
2025-12-08 10:28:30,160:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   SQL (first 500 chars): SELECT "Period", "OrgUnit", "105_EP01b_Malaria_Total", "105_EP01a_Suspected_fever", "105_EP01d_Malaria_cases_treated", "105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive" 
FROM (SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
) AS virtual_table ORDER BY "Period" ASC
 LIMIT 1000
2025-12-08 10:28:30,160:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   labels_expected: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-08 10:28:30,161:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 connection initialized: https://tests.dhis2.hispuganda.org/hmis/api
2025-12-08 10:28:30,161:INFO:superset.db_engine_specs.dhis2_dialect:Executing DHIS2 query: SELECT
  "Period",
  "OrgUnit",
  "105_EP01b_Malaria_Total",
  "105_EP01a_Suspected_fever",
  "105_EP01d_Malaria_cases_treated",
  "105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive"
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
ORDER BY
  "Period" ASC
LIMIT 1000
2025-12-08 10:28:30,161:INFO:superset.db_engine_specs.dhis2_dialect:Parsed endpoint: analytics
2025-12-08 10:28:30,161:INFO:superset.db_engine_specs.dhis2_dialect:Using stored parameters from Flask g for table: analytics
2025-12-08 10:28:30,161:INFO:superset.db_engine_specs.dhis2_dialect:Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
2025-12-08 10:28:30,161:INFO:superset.db_engine_specs.dhis2_dialect:Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
2025-12-08 10:28:30,161:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API request: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
2025-12-08 10:28:31,665:INFO:superset.db_engine_specs.dhis2_dialect:Using wide/pivoted format for analytics
2025-12-08 10:28:31,665:INFO:superset.db_engine_specs.dhis2_dialect:normalize_analytics called with pivot=True, returning WIDE format
2025-12-08 10:28:31,665:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column construction - data_elements: ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
2025-12-08 10:28:31,665:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column names constructed (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-08 10:28:31,665:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] FIRST ROW CONSTRUCTION:
2025-12-08 10:28:31,665:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   Period (index 0): 2020
2025-12-08 10:28:31,665:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   OrgUnit (index 1): MOH - Uganda
2025-12-08 10:28:31,665:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01b. Malaria Total (index 2): 14479324
2025-12-08 10:28:31,665:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01a. Suspected fever (index 3): 22994823
2025-12-08 10:28:31,665:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01d. Malaria cases treated (index 4): 15266488
2025-12-08 10:28:31,665:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01c. Malaria Confirmed (B/s and RDT Positive) (index 5): 13326277
2025-12-08 10:28:31,665:INFO:superset.db_engine_specs.dhis2_dialect:First pivoted row - Period: '2020', OrgUnit: 'MOH - Uganda'
2025-12-08 10:28:31,665:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total pivoted rows: 4, columns: 6
2025-12-08 10:28:31,666:INFO:superset.db_engine_specs.dhis2_dialect:Normalized 4 rows with 6 columns for endpoint analytics
2025-12-08 10:28:31,666:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API returned 4 rows
2025-12-08 10:28:31,670:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() - Row count: 4

[DHIS2] Transformed rows count: 4
[DHIS2] First transformed row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] Fetched 4 rows
[DHIS2] Fetched 4 rows
[DHIS2] fetchall() called - returning 4 rows
[DHIS2] fetchall() - First row type: <class 'tuple'>
[DHIS2] fetchall() - First row (original): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Column count from description: 6
[DHIS2] fetchall() called - returning 4 rows
[DHIS2] fetchall() - First row type: <class 'tuple'>
[DHIS2] fetchall() - First row (original): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Column count from description: 6
[DHIS2] fetchall() - First row (fixed types): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Type enforcement: dimensions=STRING, measures=FLOAT
[DHIS2] fetchall() - First row (fixed types): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Type enforcement: dimensions=STRING, measures=FLOAT
[DHIS2] Executing query: SELECT
  COUNT(*)
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
LIMIT 5000
[DHIS2] Parsed endpoint: analytics
[DHIS2] Found params in Flask g for analytics: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;
[DHIS2] Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
[DHIS2] Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
[DHIS2] API request URL: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
[DHIS2] Raw API response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Raw DHIS2 rows count: 16
[DHIS2] First raw row: ['QHnwKs2OUZv', '2020', 'akV6429SUqu', '15266488']
[DHIS2] Parsing response for endpoint: analytics
[DHIS2] Response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Response sample: {'headers': [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}], 'metaDat
[DHIS2] Using WIDE/PIVOTED format (Period, OrgUnit, DX1, DX2, ...) for analytics
[DHIS2] normalize_analytics: pivot=True, using WIDE/PIVOTED format
[DHIS2] PIVOT CONSTRUCTION:
[DHIS2]   data_elements (UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   data_element_list (sorted UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   col_names (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized row count: 4
[DHIS2] First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] _set_description: columns=['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], types=['String', 'String', 'String', 'String', 'String', 'String']
[DHIS2] Transformed rows count: 4
[DHIS2] First transformed row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] Fetched 4 rows
[DHIS2] fetchall() called - returning 4 rows
[DHIS2] fetchall() - First row type: <class 'tuple'>
[DHIS2] fetchall() - First row (original): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Column count from description: 6
[DHIS2] fetchall() - First row (fixed types): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Type enforcement: dimensions=STRING, measures=FLOAT
[DHIS2] Executing query: SELECT
  "Period",
  "OrgUnit",
  "105_EP01b_Malaria_Total",
  "105_EP01a_Suspected_fever",
  "105_EP01d_Malaria_cases_treated",
  "105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive"
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
ORDER BY
  "Period" ASC
LIMIT 1000
[DHIS2] Parsed endpoint: analytics
[DHIS2] Found params in Flask g for analytics: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;
[DHIS2] Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
[DHIS2] Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
[DHIS2] API request URL: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
[DHIS2] Raw API response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Raw DHIS2 rows count: 16
[DHIS2] First raw row: ['QHnwKs2OUZv', '2020', 'akV6429SUqu', '15266488']
[DHIS2] Parsing response for endpoint: analytics
[DHIS2] Response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Response sample: {'headers': [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}], 'metaDat
[DHIS2] Using WIDE/PIVOTED format (Period, OrgUnit, DX1, DX2, ...) for analytics
[DHIS2] normalize_analytics: pivot=True, using WIDE/PIVOTED format
[DHIS2] PIVOT CONSTRUCTION:
[DHIS2]   data_elements (UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   data_element_list (sorted UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   col_names (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized row count: 4
[DHIS2] First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] _set_description: columns=['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], types=['String', 'String', 'String', 'String', 'String', 'String']
[DHIS2] Transformed rows count: 4
[DHIS2] First transformed row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] Fetched 4 rows
[DHIS2] fetchall() called - returning 4 rows
[DHIS2] fetchall() - First row type: <class 'tuple'>2025-12-08 10:28:31,670:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-08 10:28:31,670:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names length: 6
2025-12-08 10:28:31,670:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values count: 6
2025-12-08 10:28:31,670:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-08 10:28:31,670:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 0 (Period): 2020 -> 2020 (STRING)
2025-12-08 10:28:31,670:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (OrgUnit): MOH - Uganda -> MOH - Uganda (STRING)
2025-12-08 10:28:31,670:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (105_EP01b_Malaria_Total): 14479324 (PROCESSED)
2025-12-08 10:28:31,670:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (105_EP01a_Suspected_fever): 22994823 (PROCESSED)
2025-12-08 10:28:31,670:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (105_EP01d_Malaria_cases_treated): 15266488 (PROCESSED)
2025-12-08 10:28:31,670:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() returning 4 rows with 6 columns each
2025-12-08 10:28:31,670:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Got 4 rows from cursor
2025-12-08 10:28:31,670:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-08 10:28:31,670:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-08 10:28:31,670:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Types from cursor: ['String', 'String', 'String', 'String', 'String', 'String']
2025-12-08 10:28:31,671:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: DataFrame created with 4 rows, 6 columns
2025-12-08 10:28:31,671:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-08 10:28:31,671:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes BEFORE fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-08 10:28:31,672:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Period' to object dtype (dimension)
2025-12-08 10:28:31,672:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'OrgUnit' to object dtype (dimension)
2025-12-08 10:28:31,672:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes AFTER fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-08 10:28:31,672:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: First row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-08 10:28:31,676:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] BEFORE assign_column_label:
2025-12-08 10:28:31,676:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 6)
2025-12-08 10:28:31,676:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-08 10:28:31,676:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-08 10:28:31,676:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: True
2025-12-08 10:28:31,676:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-08 10:28:31,676:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Assigning column labels: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-08 10:28:31,676:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] AFTER assign_column_label:
2025-12-08 10:28:31,676:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 6)
2025-12-08 10:28:31,676:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-08 10:28:31,676:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-08 10:28:31,676:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: True
2025-12-08 10:28:31,676:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-08 10:28:31,684:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:28:31] "POST /datasource/samples?force=false&datasource_type=table&datasource_id=1 HTTP/1.1" 200 -
2025-12-08 10:29:48,261:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:29:48] "GET /static/assets/example.74513bdf.jpg HTTP/1.1" 200 -
2025-12-08 10:32:18,635:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:32:18] "GET /static/assets/example1.96a009c1.png HTTP/1.1" 200 -
2025-12-08 10:32:18,636:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:32:18] "GET /static/assets/example2.32569ac7.png HTTP/1.1" 200 -
2025-12-08 10:32:22,091:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:32:22] "GET /static/assets/example1.297446aa.jpg HTTP/1.1" 200 -
2025-12-08 10:32:22,091:INFO:werkzeug:127.0.0.1 - - [08/Dec/2025 10:32:22] "GET /static/assets/example2.ef2d1091.jpg HTTP/1.1" 200 -
