"use strict";(globalThis.webpackChunksuperset=globalThis.webpackChunksuperset||[]).push([[23],{9679:(e,t,n)=>{n.d(t,{l:()=>s});var a=n(2445),l=n(74098),i=n(81465),r=n(54295);const o={everyText:(0,l.t)("every"),emptyMonths:(0,l.t)("every month"),emptyMonthDays:(0,l.t)("every day of the month"),emptyMonthDaysShort:(0,l.t)("day of the month"),emptyWeekDays:(0,l.t)("every day of the week"),emptyWeekDaysShort:(0,l.t)("day of the week"),emptyHours:(0,l.t)("every hour"),emptyMinutes:(0,l.t)("every minute"),emptyMinutesForHourPeriod:(0,l.t)("every"),yearOption:(0,l.t)("year"),monthOption:(0,l.t)("month"),weekOption:(0,l.t)("week"),dayOption:(0,l.t)("day"),hourOption:(0,l.t)("hour"),minuteOption:(0,l.t)("minute"),rebootOption:(0,l.t)("reboot"),prefixPeriod:(0,l.t)("Every"),prefixMonths:(0,l.t)("in"),prefixMonthDays:(0,l.t)("on"),prefixWeekDays:(0,l.t)("on"),prefixWeekDaysForMonthAndYearPeriod:(0,l.t)("or"),prefixHours:(0,l.t)("at"),prefixMinutes:(0,l.t)(":"),prefixMinutesForHourPeriod:(0,l.t)("at"),suffixMinutesForHourPeriod:(0,l.t)("minute(s)"),errorInvalidCron:(0,l.t)("Invalid cron expression"),clearButtonText:(0,l.t)("Clear"),weekDays:[(0,l.t)("Sunday"),(0,l.t)("Monday"),(0,l.t)("Tuesday"),(0,l.t)("Wednesday"),(0,l.t)("Thursday"),(0,l.t)("Friday"),(0,l.t)("Saturday")],months:[(0,l.t)("January"),(0,l.t)("February"),(0,l.t)("March"),(0,l.t)("April"),(0,l.t)("May"),(0,l.t)("June"),(0,l.t)("July"),(0,l.t)("August"),(0,l.t)("September"),(0,l.t)("October"),(0,l.t)("November"),(0,l.t)("December")],altWeekDays:[(0,l.t)("SUN"),(0,l.t)("MON"),(0,l.t)("TUE"),(0,l.t)("WED"),(0,l.t)("THU"),(0,l.t)("FRI"),(0,l.t)("SAT")],altMonths:[(0,l.t)("JAN"),(0,l.t)("FEB"),(0,l.t)("MAR"),(0,l.t)("APR"),(0,l.t)("MAY"),(0,l.t)("JUN"),(0,l.t)("JUL"),(0,l.t)("AUG"),(0,l.t)("SEP"),(0,l.t)("OCT"),(0,l.t)("NOV"),(0,l.t)("DEC")]},s=(0,i.I4)(e=>(0,a.Y)(r.Ay,{locale:o,...e}))`
  ${({theme:e})=>`\n\n    /* Boilerplate styling for ReactCronPicker imported explicitly in GlobalStyles.tsx */\n\n    /* When year period is selected */\n\n    :has(.react-js-cron-months) {\n      display: grid !important;\n      grid-template-columns: repeat(2, 50%);\n      column-gap: ${e.sizeUnit}px;\n      row-gap: ${2*e.sizeUnit}px;\n      div:has(.react-js-cron-hours) {\n        grid-column: span 2;\n        display: flex;\n        justify-content: space-between;\n        .react-js-cron-field {\n          width: 50%;\n        }\n      }\n    }\n\n    /* When month period is selected */\n\n    :not(:has(.react-js-cron-months)) {\n      display: grid;\n      grid-template-columns: repeat(2, 50%);\n      column-gap: ${e.sizeUnit}px;\n      row-gap: ${2*e.sizeUnit}px;\n      .react-js-cron-period {\n        grid-column: span 2;\n      }\n      div:has(.react-js-cron-hours) {\n        grid-column: span 2;\n        display: flex;\n        justify-content: space-between;\n        .react-js-cron-field {\n          width: 50%;\n        }\n      }\n    }\n\n    /* When week period is selected */\n\n    :not(:has(.react-js-cron-month-days)) {\n      .react-js-cron-week-days {\n        grid-column: span 2;\n      }\n    }\n\n    /* For proper alignment of inputs and span elements */\n\n    :not(div:has(.react-js-cron-hours)) {\n      display: flex;\n      flex-wrap: nowrap;\n    }\n\n    div:has(.react-js-cron-hours) {\n      width: 100%;\n    }\n\n    .react-js-cron-minutes > span {\n      padding-left: ${e.sizeUnit}px;\n    }\n\n    /* Sizing of select container */\n\n    .react-js-cron-select.ant-select {\n      width: 100%;\n      .ant-select-selector {\n        flex-wrap: nowrap;\n      }\n    }\n\n    .react-js-cron-field {\n      width: 100%;\n      margin-bottom: 0px;\n      > span {\n        margin-left: 0px;\n      }\n    }\n\n    .react-js-cron-custom-select .ant-select-selection-placeholder {\n      flex: auto;\n      border-radius: ${e.borderRadius}px;\n    }\n\n    .react-js-cron-custom-select .ant-select-selection-overflow-item {\n      align-self: center;\n    }\n\n    .react-js-cron-select > div:first-of-type,\n    .react-js-cron-custom-select {\n      border-radius: ${e.borderRadius}px;\n    }\n  `}
`},29027:(e,t,n)=>{n.d(t,{A:()=>u});var a=n(2445),l=n(24002),i=n(74098),r=n(2801),o=n(59674);const s={name:"GMT Standard Time",value:"Africa/Abidjan"},c="400px",d={"-300-240":["Eastern Standard Time","Eastern Daylight Time"],"-360-300":["Central Standard Time","Central Daylight Time"],"-420-360":["Mountain Standard Time","Mountain Daylight Time"],"-420-420":["Mountain Standard Time - Phoenix","Mountain Standard Time - Phoenix"],"-480-420":["Pacific Standard Time","Pacific Daylight Time"],"-540-480":["Alaska Standard Time","Alaska Daylight Time"],"-600-600":["Hawaii Standard Time","Hawaii Daylight Time"],60120:["Central European Time","Central European Daylight Time"],"00":[s.name,s.name],"060":["GMT Standard Time - London","British Summer Time"]};function u({onTimezoneChange:e,timezone:t,minWidth:n=c,...u}){const{TIMEZONE_OPTIONS:h,TIMEZONE_OPTIONS_SORT_COMPARATOR:p,validTimezone:m}=(0,l.useMemo)(()=>{const e=(0,o.XV)(),n=o.XV.tz("2021-01-01"),a=o.XV.tz("2021-07-01"),l=e=>n.tz(e).utcOffset().toString()+a.tz(e).utcOffset().toString(),i=Intl.supportedValuesOf("timeZone"),r=new Set,c=i.map(t=>{const n=`GMT ${o.XV.tz(e,t).format("Z")} (${(t=>{var n,a;const i=l(t);return((0,o._q)(e.tz(t),t)?null==(n=d[i])?void 0:n[1]:null==(a=d[i])?void 0:a[0])||t})(t)})`;return r.has(n)?null:(r.add(n),{label:n,value:t,offsets:l(t),timezoneName:t})}).filter(Boolean),u=(t,n)=>o.XV.tz(e,t.timezoneName).utcOffset()-o.XV.tz(e,n.timezoneName).utcOffset();c.sort(u);const h=(e=>{const t=l(e);let n;for(const a of c){if(a.offsets===t&&a.timezoneName===e)return a.value;n||a.offsets!==t||(n=a.value)}return n||s.value})(t||o.XV.tz.guess());return{TIMEZONE_OPTIONS:c,TIMEZONE_OPTIONS_SORT_COMPARATOR:u,validTimezone:h}},[t]);return(0,l.useEffect)(()=>{m&&t!==m&&e(m)},[m,e,t]),(0,a.Y)(r.A,{ariaLabel:(0,i.t)("Timezone selector"),onChange:t=>e(t),value:m,options:h,sortComparator:p,...u})}},39438:(e,t,n)=>{n.d(t,{A:()=>_});var a=n(38221),l=n.n(a),i=n(24002),r=n(5556),o=n.n(r),s=n(29645),c=n(52167),d=n(88217),u=n(41876),h=n(95018),p=n(74098),m=n(98837),v=(n(15850),n(18865)),b=n(2445);const f={name:o().string,onChange:o().func,initialValue:o().string,height:o().number,minLines:o().number,maxLines:o().number,offerEditInModal:o().bool,language:o().oneOf([null,"json","html","sql","markdown","javascript","handlebars"]),aboveEditorSection:o().node,readOnly:o().bool,resize:o().oneOf([null,"block","both","horizontal","inline","none","vertical"]),textAreaStyles:o().object,tooltipOptions:o().object,hotkeys:o().array,debounceDelay:o().number};class g extends i.Component{constructor(e){super(e),e.debounceDelay&&(this.debouncedOnChange=l()(e.onChange,e.debounceDelay))}componentDidUpdate(e){this.props.onChange!==e.onChange&&this.props.debounceDelay&&(this.debouncedOnChange&&this.debouncedOnChange.cancel(),this.debouncedOnChange=l()(this.props.onChange,this.props.debounceDelay))}handleChange(e){const t="object"==typeof e?e.target.value:e;this.debouncedOnChange?this.debouncedOnChange(t):this.props.onChange(t)}componentWillUnmount(){this.debouncedOnChange&&this.debouncedOnChange.cancel()}renderEditor(e=!1){const t=e?40:this.props.minLines||12;if(this.props.language){const n={border:`1px solid ${this.props.theme.colorBorder}`,minHeight:`${t}em`,width:"auto",...this.props.textAreaStyles};this.props.resize&&(n.resize=this.props.resize),this.props.readOnly&&(n.backgroundColor="#f2f2f2");const a=e=>{this.props.hotkeys.forEach(t=>{e.commands.addCommand({name:t.name,bindKey:{win:t.key,mac:t.key},exec:t.func})})},l=(0,b.Y)("div",{children:(0,b.Y)(c.S9,{mode:this.props.language,style:n,minLines:t,maxLines:e?1e3:this.props.maxLines,editorProps:{$blockScrolling:!0},onLoad:a,defaultValue:this.props.initialValue,readOnly:this.props.readOnly,...this.props,onChange:this.handleChange.bind(this)},this.props.name)});return this.props.tooltipOptions?(0,b.Y)(h.m,{...this.props.tooltipOptions,children:l}):l}const n=(0,b.Y)("div",{children:(0,b.Y)(s.Input.TextArea,{placeholder:(0,p.t)("textarea"),onChange:this.handleChange.bind(this),defaultValue:this.props.initialValue,disabled:this.props.readOnly,style:{height:this.props.height},"aria-required":this.props["aria-required"]})});return this.props.tooltipOptions?(0,b.Y)(h.m,{...this.props.tooltipOptions,children:n}):n}renderModalBody(){return(0,b.FD)(b.FK,{children:[(0,b.Y)("div",{children:this.props.aboveEditorSection}),this.renderEditor(!0)]})}render(){const e=(0,b.Y)(v.A,{...this.props});return(0,b.FD)("div",{children:[e,this.renderEditor(),this.props.offerEditInModal&&(0,b.Y)(u.g,{modalTitle:e,triggerNode:(0,b.Y)(d.$,{buttonSize:"small",style:{marginTop:this.props.theme.sizeUnit},children:(0,p.t)("Edit %s in modal",this.props.language)}),modalBody:this.renderModalBody(!0),responsive:!0})]})}}g.propTypes=f,g.defaultProps={onChange:()=>{},initialValue:"",height:250,minLines:3,maxLines:10,offerEditInModal:!0,readOnly:!1,resize:null,textAreaStyles:{},tooltipOptions:{},hotkeys:[],debounceDelay:null};const _=(0,m.b)(g)},70023:(e,t,n)=>{n.d(t,{tu:()=>ae,b5:()=>oe,Ay:()=>ce});var a=n(2445),l=n(24002),i=n(7741),r=n(81465),o=n(74098),s=n(17437),c=n(99106),d=n(79378),u=n(58561),h=n.n(u),p=n(86784),m=n(64457),v=n(7466),b=n(29645),f=n(2801),g=n(43303),_=n(64917),T=n(49965),E=n(5250),y=n(65729),N=n(29027),S=n(39438),C=n(46720),R=n(96611),O=n(17102),x=n(61225),A=n(50880),I=n(6694),F=n(8558),D=n(50178);function Y({timeUnit:e,min:t,name:n,value:i,placeholder:r,onChange:o,...s}){const[c,d]=(0,l.useState)(!1);return(0,a.Y)(b.Input,{type:"text",min:t,name:n,value:i?`${i}${c?"":` ${e}`}`:"",placeholder:r,onFocus:()=>d(!0),onBlur:()=>d(!1),onChange:o,...s})}var L,k=n(9679);!function(e){e.Picker="picker",e.Input="input"}(L||(L={}));const w=[{label:(0,o.t)("Recurring (every)"),value:L.Picker},{label:(0,o.t)("CRON Schedule"),value:L.Input}],M=({value:e,onChange:t})=>{const n=(0,r.DP)(),[i,s]=(0,l.useState)(L.Picker),c=(0,l.useCallback)(e=>{t(e)},[t]),d=(0,l.useCallback)(e=>{t(e.target.value)},[t]),u=(0,l.useCallback)(()=>{t(e||"")},[t,e]),[h,p]=(0,l.useState)();return(0,a.FD)(a.FK,{children:[(0,a.FD)(ae,{children:[(0,a.FD)("div",{className:"control-label",children:[(0,o.t)("Schedule type"),(0,a.Y)("span",{className:"required",children:"*"})]}),(0,a.Y)("div",{className:"input-container",children:(0,a.Y)(f.A,{ariaLabel:(0,o.t)("Schedule type"),placeholder:(0,o.t)("Schedule type"),onChange:e=>{s(e)},value:i,options:w})})]}),(0,a.FD)(ae,{className:"styled-input",children:[(0,a.FD)("div",{className:"control-label",children:[(0,o.t)("Schedule"),(0,a.Y)("span",{className:"required",children:"*"})]}),i===L.Input&&(0,a.Y)(b.Input,{type:"text",name:"crontab",style:h?{borderColor:n.colorError}:{},placeholder:(0,o.t)("CRON expression"),value:e,onBlur:d,onChange:e=>c(e.target.value),onPressEnter:u}),i===L.Picker&&(0,a.Y)(k.l,{clearButton:!1,value:e,setValue:c,displayError:i===L.Picker,onError:p})]})]})};var z=n(9992);const V=r.I4.div`
  ${({theme:e})=>`\n    margin-bottom: ${3*e.sizeUnit}px;\n\n    .input-container {\n      textarea {\n        height: auto;\n      }\n\n      &.error {\n        input {\n          border-color: ${e.colorError};\n        }\n      }\n\n      .helper {\n        margin-top: ${2*e.sizeUnit}px;\n        font-size: ${e.fontSizeSM}px;\n        color: ${e.colorTextSecondary};\n      }\n    }\n\n    .inline-container {\n      margin-bottom: ${2*e.sizeUnit}px;\n\n      > div {\n        margin: 0px;\n      }\n\n      .delete-button {\n        margin-left: ${2*e.sizeUnit}px;\n        padding-top: ${e.sizeUnit}px;\n      }\n      .anticon {\n        margin-left: ${e.sizeUnit}px;\n      }\n    }\n\n    .ghost-button {\n      color: ${e.colorPrimaryText};\n      display: inline-flex;\n      align-items: center;\n      font-size: ${e.fontSizeSM}px;\n      cursor: pointer;\n\n      .icon {\n        width: ${3*e.sizeUnit}px;\n        height: ${3*e.sizeUnit}px;\n        font-size: ${e.fontSizeSM}px;\n        margin-right: ${e.sizeUnit}px;\n      }\n    }\n\n    .ghost-button + .ghost-button {\n      margin-left: ${4*e.sizeUnit}px;\n    }\n\n    .ghost-button:first-child[style*='none'] + .ghost-button {\n      margin-left: 0px; /* Remove margin when the first button is hidden */\n    }\n  `}
`,$={EMAIL_CC_NAME:(0,o.t)("CC recipients"),EMAIL_BCC_NAME:(0,o.t)("BCC recipients"),EMAIL_SUBJECT_NAME:(0,o.t)("Email subject name (optional)"),EMAIL_SUBJECT_ERROR_TEXT:(0,o.t)("Please enter valid text. Spaces alone are not permitted.")},U=({setting:e=null,index:t,onUpdate:n,onRemove:i,onInputChange:s,email_subject:u,defaultSubject:p,setErrorSubject:m})=>{const{method:v,recipients:g,cc:_,bcc:T,options:E}=e||{},[y,N]=(0,l.useState)(g||""),[S,C]=(0,l.useState)([]),[O,x]=(0,l.useState)(!1),[A,I]=(0,l.useState)(!!_),[D,Y]=(0,l.useState)(!!T),[L,k]=(0,l.useState)(_||""),[w,M]=(0,l.useState)(T||""),U=(0,r.DP)(),[j,P]=(0,l.useState)(!0),[q,G]=(0,l.useState)([{label:"",options:[]}]),[X,B]=(0,l.useState)(!1),[Z,W]=(0,l.useState)(!0),K=async({force:e}={})=>{W(!0),(async({searchString:e="",types:t=[],exactMatch:n=!1,force:a=!1}={})=>{const l=`/api/v1/report/slack_channels/?q=${h().encode({searchString:e,types:t,exactMatch:n,force:a})}`;return d.A.get({endpoint:l})})({types:["public_channel","private_channel"],force:e}).then(({json:e})=>{const{result:t}=e,n=(e=>{const t=[],n=[];return e.forEach(e=>{e.is_private?n.push(e):t.push(e)}),[{label:"Public Channels",options:t.map(e=>({label:`${e.name} ${e.is_member?"":(0,o.t)("(Bot not in channel)")}`,value:e.id,key:e.id})),key:"public"},{label:(0,o.t)("Private Channels (Bot in channel)"),options:n.map(e=>({label:e.name,value:e.id,key:e.id})),key:"private"}]})(t);if(G(n),(0,c.G7)(c.TO.AlertReportSlackV2)){const[e,t]=n;v&&[R.yV.SlackV2,R.yV.Slack].includes(v)&&C((({method:e,recipientValue:t,slackOptions:n})=>{const a=e===R.yV.SlackV2?"value":"label";return t.split(",").map(e=>n.find(t=>t[a].trim().toLowerCase()===e.trim().toLowerCase())).filter(e=>!!e)})({method:v,recipientValue:y,slackOptions:[...e.options,...t.options]}))}}).catch(e=>{B(!0)}).finally(()=>{P(!1),W(!1)})};(0,l.useEffect)(()=>{var e;!(null==E?void 0:E.some(e=>e===R.yV.Slack||e===R.yV.SlackV2))||null!=(e=q[0])&&e.options.length||K()},[]);const H=(0,l.useMemo)(()=>(E||[]).filter(e=>(0,c.G7)(c.TO.AlertReportSlackV2)&&!X&&e===R.yV.SlackV2||(!(0,c.G7)(c.TO.AlertReportSlackV2)||X)&&e===R.yV.Slack||e===R.yV.Email).map(e=>({label:e===R.yV.SlackV2?R.yV.Slack:e,value:e})),[E,X]);return e?(g&&y!==g&&N(g),_&&L!==_&&k(_),T&&w!==T&&M(T),(0,a.FD)(V,{children:[(0,a.Y)("div",{className:"inline-container",children:(0,a.FD)(ae,{children:[(0,a.Y)("div",{className:"control-label",children:(0,o.t)("Notification Method")}),(0,a.FD)("div",{className:"input-container",children:[(0,a.Y)(f.A,{ariaLabel:(0,o.t)("Delivery method"),labelInValue:!0,onChange:a=>{if(N(""),k(""),M(""),n&&e){const l={...e,method:a.value,recipients:"",cc:"",bcc:""};n(t,l)}},placeholder:(0,o.t)("Select Delivery Method"),options:H,showSearch:!0,value:H.find(e=>e.value===v),loading:j}),0!==t&&i?(0,a.Y)("span",{role:"button",tabIndex:0,className:"delete-button",onClick:()=>i(t),children:(0,a.Y)(F.F.DeleteOutlined,{iconSize:"l"})}):null]})]})}),void 0!==v?(0,a.FD)(a.FK,{children:[(0,a.Y)("div",{className:"inline-container",children:(0,a.Y)(ae,{children:v===R.yV.Email?(0,a.FD)(a.FK,{children:[(0,a.Y)("div",{className:"control-label",children:$.EMAIL_SUBJECT_NAME}),(0,a.Y)("div",{className:"input-container "+(O?"error":""),children:(0,a.Y)(b.Input,{type:"text",name:"email_subject",value:u,placeholder:p,onChange:e=>{const{value:t}=e.target;s&&s(e);const n=t.length>0&&0===t.trim().length;x(n),m&&m(n)}})}),O&&(0,a.Y)("div",{style:{color:U.colorError,fontSize:3*U.sizeUnit},children:$.EMAIL_SUBJECT_ERROR_TEXT})]}):null})}),(0,a.Y)("div",{className:"inline-container",children:(0,a.FD)(ae,{children:[(0,a.FD)("div",{className:"control-label",children:[(0,o.t)("%s recipients",v===R.yV.SlackV2?R.yV.Slack:v),(0,a.Y)("span",{className:"required",children:"*"})]}),(0,a.Y)("div",{children:[R.yV.Email,R.yV.Slack].includes(v)?(0,a.FD)(a.FK,{children:[(0,a.Y)("div",{className:"input-container",children:(0,a.Y)(b.Input.TextArea,{name:"To",value:y,onChange:a=>{const{target:l}=a;if(N(l.value),n){const a={...e,recipients:l.value};n(t,a)}}})}),(0,a.Y)("div",{className:"input-container",children:(0,a.Y)("div",{className:"helper",children:(0,o.t)('Recipients are separated by "," or ";"')})})]}):(0,a.FD)("div",{className:"input-container",children:[(0,a.Y)(f.A,{ariaLabel:(0,o.t)("Select channels"),mode:"multiple",name:"recipients",value:S,options:q,onChange:a=>{if(C(a),n){const l={...e,recipients:null==a?void 0:a.map(e=>e.value).join(",")};n(t,l)}},allowClear:!0,loading:Z,allowSelectAll:!1,labelInValue:!0}),(0,a.Y)(z.A,{onClick:()=>K({force:!0}),tooltipContent:(0,o.t)("Force refresh Slack channels list"),disabled:Z})]})})]})}),v===R.yV.Email&&(0,a.FD)(ae,{children:[A&&(0,a.FD)(a.FK,{children:[(0,a.Y)("div",{className:"control-label",children:$.EMAIL_CC_NAME}),(0,a.Y)("div",{className:"input-container",children:(0,a.Y)(b.Input.TextArea,{name:"CC",value:L,onChange:a=>{const{target:l}=a;if(k(l.value),n){const a={...e,cc:l.value};n(t,a)}}})}),(0,a.Y)("div",{className:"input-container",children:(0,a.Y)("div",{className:"helper",children:(0,o.t)('Recipients are separated by "," or ";"')})})]}),D&&(0,a.FD)(a.FK,{children:[(0,a.Y)("div",{className:"control-label",children:$.EMAIL_BCC_NAME}),(0,a.Y)("div",{className:"input-container",children:(0,a.Y)(b.Input.TextArea,{name:"BCC",value:w,onChange:a=>{const{target:l}=a;if(M(l.value),n){const a={...e,bcc:l.value};n(t,a)}}})}),(0,a.Y)("div",{className:"input-container",children:(0,a.Y)("div",{className:"helper",children:(0,o.t)('Recipients are separated by "," or ";"')})})]}),(0,a.FD)("div",{className:"ghost-button",children:[(0,a.FD)("span",{className:"ghost-button",role:"button",tabIndex:0,onClick:()=>I(!0),style:{display:A?"none":"inline-flex"},children:[(0,a.Y)(F.F.MailOutlined,{iconSize:"xs",className:"icon"}),(0,o.t)("Add CC Recipients")]}),(0,a.FD)("span",{className:"ghost-button",role:"button",tabIndex:0,onClick:()=>Y(!0),style:{display:D?"none":"inline-flex"},children:[(0,a.Y)(F.F.MailOutlined,{iconSize:"xs",className:"icon"}),(0,o.t)("Add BCC Recipients")]})]})]})]}):null]})):null};var j=n(19187);const P=[i.Y.PivotTable,"table",i.Y.PairedTTest],q=r.I4.span`
  margin: 0 ${({theme:e})=>3*e.sizeUnit}px;
  color: ${({theme:e})=>e.colorSplit};
  font-weight: ${({theme:e})=>e.fontWeightStrong};
  font-size: ${({theme:e})=>e.fontSize}px;
  align-content: center;
`,G=/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/,X=[R.yV.Email],B="PNG",Z={dashboard:{anchor:""}},W=[{label:(0,o.t)("< (Smaller than)"),value:"<"},{label:(0,o.t)("> (Larger than)"),value:">"},{label:(0,o.t)("<= (Smaller or equal)"),value:"<="},{label:(0,o.t)(">= (Larger or equal)"),value:">="},{label:(0,o.t)("== (Is equal)"),value:"=="},{label:(0,o.t)("!= (Is not equal)"),value:"!="},{label:(0,o.t)("Not null"),value:"not null"}],K=[{label:(0,o.t)("None"),value:0},{label:(0,o.t)("30 days"),value:30},{label:(0,o.t)("60 days"),value:60},{label:(0,o.t)("90 days"),value:90}],H=[{label:(0,o.t)("Dashboard"),value:"dashboard"},{label:(0,o.t)("Chart"),value:"chart"}],J={pdf:{label:(0,o.t)("Send as PDF"),value:"PDF"},png:{label:(0,o.t)("Send as PNG"),value:"PNG"},csv:{label:(0,o.t)("Send as CSV"),value:"CSV"},txt:{label:(0,o.t)("Send as text"),value:"TEXT"}},Q=s.AH`
  margin-bottom: 0;
`,ee=s.AH`
  .inline-container {
    display: flex;
    flex-direction: row;
    align-items: center;

    &.wrap {
      flex-wrap: wrap;
    }

    > div {
      flex: 1 1 auto;
    }
  }
`,te=(0,r.I4)(b.TreeSelect)`
  width: 100%;
`,ne=r.I4.div`
  display: flex;
  align-items: center;
  margin-top: 10px;

  .switch-label {
    margin-left: 10px;
  }
`,ae=r.I4.div`
  ${({theme:e})=>s.AH`
    flex: 1;
    margin-top: 0px;
    margin-bottom: ${4*e.sizeUnit}px;

    .helper {
      display: block;
      color: ${e.colorTextTertiary};
      font-size: ${e.fontSizeSM}px;
      padding: ${e.sizeUnit}px 0;
      text-align: left;
    }

    .required {
      margin-left: ${e.sizeUnit/2}px;
      color: ${e.colorError};
    }

    .control-label {
      margin-bottom: ${2*e.sizeUnit}px;
      color: ${e.colorText};
      font-size: ${e.fontSize}px;
    }

    .input-container {
      display: flex;
      align-items: center;

      > div {
        width: 100%;
      }
    }

    input,
    textarea {
      flex: 1 1 auto;
    }

    input[disabled] {
      color: ${e.colorTextDisabled};
    }

    textarea {
      height: 300px;
      resize: none;
    }

    input::placeholder,
    textarea::placeholder {
      color: ${e.colorTextPlaceholder};
    }

    textarea,
    input[type='text'],
    input[type='number'] {
      padding: ${e.sizeUnit}px ${2*e.sizeUnit}px;
      border-style: none;
      border: 1px solid ${e.colorBorder};
      border-radius: ${e.borderRadius}px;

      &[name='description'] {
        flex: 1 1 auto;
      }
    }

    .input-label {
      margin-left: 10px;
    }

    .filters {
      margin: ${3*e.sizeUnit}px 0;

      .filters-container {
        display: flex;
        margin: ${2*e.sizeUnit}px 0;
      }

      .filters-dash-container {
        display: flex;
        flex-direction: column;
        max-width: 174px;
        flex: 1;
        margin-right: ${4*e.sizeUnit}px;

        .control-label {
          flex: 1;
          margin-bottom: ${2*e.sizeUnit}px;

          .label-with-tooltip {
            margin-right: ${2*e.sizeUnit}px;
          }
        }
      }

      .filters-dash-select {
        flex: 1;
      }

      .filters-dashvalue-container {
        display: flex;
        flex-direction: column;
        flex: 1;
      }

      .filters-delete {
        display: flex;
        margin-top: ${8*e.sizeUnit}px;
        margin-left: ${4*e.sizeUnit}px;
      }

      .filters-trashcan {
        width: ${10*e.sizeUnit}px;
        display: 'flex';
        color: ${e.colorIcon};
      }
      .filters-add-container {
        flex: '.25';
        padding: '${3*e.sizeUnit} 0';

        .filters-add-btn {
          padding: ${2*e.sizeUnit}px;
          color: ${e.colorWhite};
        }
      }
    }
  `}
`,le=r.I4.div`
  ${({theme:e})=>s.AH`
    color: ${e.colorPrimaryText};
    cursor: pointer;

    i {
      margin-right: ${2*e.sizeUnit}px;
    }

    &.disabled {
      color: ${e.colorTextDisabled};
      cursor: default;
    }
  `}
`,ie=r.I4.div`
  .inline-container .input-container {
    margin-left: 0;
  }
`,re=e=>s.AH`
  margin-right: ${3*e.sizeUnit}px;
`,oe={GENERAL_TITLE:(0,o.t)("General information"),ALERT_CONDITION_TITLE:(0,o.t)("Alert condition"),ALERT_CONTENTS_TITLE:(0,o.t)("Alert contents"),REPORT_CONTENTS_TITLE:(0,o.t)("Report contents"),SCHEDULE_TITLE:(0,o.t)("Schedule"),NOTIFICATION_TITLE:(0,o.t)("Notification method"),NAME_ERROR_TEXT:(0,o.t)("name"),OWNERS_ERROR_TEXT:(0,o.t)("owners"),CONTENT_ERROR_TEXT:(0,o.t)("content type"),DATABASE_ERROR_TEXT:(0,o.t)("database"),SQL_ERROR_TEXT:(0,o.t)("sql"),ALERT_CONDITION_ERROR_TEXT:(0,o.t)("alert condition"),CRONTAB_ERROR_TEXT:(0,o.t)("crontab"),WORKING_TIMEOUT_ERROR_TEXT:(0,o.t)("working timeout"),RECIPIENTS_ERROR_TEXT:(0,o.t)("recipients"),EMAIL_SUBJECT_ERROR_TEXT:(0,o.t)("email subject"),EMAIL_VALIDATION_ERROR_TEXT:(0,o.t)("invalid email"),ERROR_TOOLTIP_MESSAGE:(0,o.t)("Not all required fields are complete. Please provide the following:"),NATIVE_FILTER_COLUMN_ERROR_TEXT:(0,o.t)("Native filter column is required"),NATIVE_FILTER_NO_VALUES_ERROR_TEXT:(0,o.t)("Native filter values has no values")},se=({status:e="active",onClick:t})=>"hidden"===e?null:(0,a.FD)(le,{className:e,onClick:()=>{"disabled"!==e&&t()},children:[(0,a.Y)(F.F.PlusOutlined,{iconSize:"m"}),"active"===e?(0,o.t)("Add another notification method"):(0,o.t)("Add delivery method")]}),ce=(0,m.Ay)(({addDangerToast:e,onAdd:t,onHide:n,show:i,alert:u=null,isReport:m=!1,addSuccessToast:L})=>{var k,w,z,V,$,le,ce,de,ue;const he=(0,r.DP)(),pe=(0,x.d4)(e=>e.user),me=(0,C.B)(),ve=(null==me?void 0:me.ALERT_REPORTS_NOTIFICATION_METHODS)||X,[be,fe]=(0,l.useState)(!0),[ge,_e]=(0,l.useState)(),[Te,Ee]=(0,l.useState)(!0),[ye,Ne]=(0,l.useState)("dashboard"),[Se,Ce]=(0,l.useState)(B),[Re,Oe]=(0,l.useState)(!1),[xe,Ae]=(0,l.useState)(!1);(0,l.useEffect)(()=>{Ae("PNG"===Se)},[Se]);const[Ie,Fe]=(0,l.useState)(!1),[De,Ye]=(0,l.useState)([]),[Le,ke]=(0,l.useState)([]),[we,Me]=(0,l.useState)([]),[ze,Ve]=(0,l.useState)([]),[$e,Ue]=(0,l.useState)([]),[je,Pe]=(0,l.useState)({}),[qe,Ge]=(0,l.useState)([{nativeFilterId:null,filterName:"",filterType:"",columnLabel:"",columnName:"",filterValues:[]}]),[Xe,Be]=(0,l.useState)({[R.Z_.General]:{hasErrors:!1,name:oe.GENERAL_TITLE,errors:[]},[R.Z_.Content]:{hasErrors:!1,name:m?oe.REPORT_CONTENTS_TITLE:oe.ALERT_CONTENTS_TITLE,errors:[]},[R.Z_.Alert]:{hasErrors:!1,name:oe.ALERT_CONDITION_TITLE,errors:[]},[R.Z_.Schedule]:{hasErrors:!1,name:oe.SCHEDULE_TITLE,errors:[]},[R.Z_.Notification]:{hasErrors:!1,name:oe.NOTIFICATION_TITLE,errors:[]}}),[Ze,We]=(0,l.useState)(""),Ke=(e,t)=>{Be(n=>({...n,[e]:{hasErrors:t.length>0,name:n[e].name,errors:t}}))},[He,Je]=(0,l.useState)(""),Qe=m?"report":"alert",et=null!==u,tt=(0,c.G7)(c.TO.AlertsAttachReports)||m,nt=(0,c.G7)(c.TO.AlertReportTabs),at=(0,c.G7)(c.TO.AlertReportsFilter),[lt,it]=(0,l.useState)("active"),[rt,ot]=(0,l.useState)([]),[st,ct]=(0,l.useState)(""),[dt,ut]=(0,l.useState)(!1),{ALERT_REPORTS_DEFAULT_WORKING_TIMEOUT:ht,ALERT_REPORTS_DEFAULT_CRON_VALUE:pt,ALERT_REPORTS_DEFAULT_RETENTION:mt}=(0,x.d4)(e=>{var t,n,a,l;const i=null==(t=e.common)?void 0:t.conf;return{ALERT_REPORTS_DEFAULT_WORKING_TIMEOUT:null!=(n=null==i?void 0:i.ALERT_REPORTS_DEFAULT_WORKING_TIMEOUT)?n:3600,ALERT_REPORTS_DEFAULT_CRON_VALUE:null!=(a=null==i?void 0:i.ALERT_REPORTS_DEFAULT_CRON_VALUE)?a:"0 0 * * *",ALERT_REPORTS_DEFAULT_RETENTION:null!=(l=null==i?void 0:i.ALERT_REPORTS_DEFAULT_RETENTION)?l:90}}),vt={active:!0,creation_method:"alerts_reports",crontab:pt,extra:Z,log_retention:mt,working_timeout:ht,name:"",owners:[],recipients:[],sql:"",email_subject:"",validator_config_json:{},validator_type:"",force_screenshot:!1,grace_period:void 0},bt=async(e,t,n,a="filter_select",l=[])=>{if("filter_time"===a)return;const i={formData:{datasource:`${n}__table`,groupby:[t],metrics:["count"],row_limit:1e3,showSearch:!0,viz_type:a,type:"NATIVE_FILTER",dashboardId:e,adhoc_filters:l},force:!1,ownState:{}};return await(0,A.getChartDataRequest)(i).then(e=>{const n=e.json.result[0].data;let l=n;return"filter_timecolumn"===a&&(l=n.filter(e=>2===e.dtype)),l.map(e=>"filter_timegrain"===a?{value:e.duration,label:e.name}:"filter_timecolumn"===a?{value:e.column_name,label:e.verbose_name||e.column_name}:{value:e[t],label:e[t]})})},ft=()=>$e.filter(e=>!qe.some(t=>t.nativeFilterId===e.value)),gt=(e,t)=>{const n=[...rt];n[e]=t,rt[e].method!==t.method?(rt[e]=t,ot(rt.filter((t,n)=>n<=e)),rt.length-1>e&&it("active"),void 0!==t.method&&"hidden"!==lt&&it("active")):ot(n)},_t=e=>{const t=rt.slice();t.splice(e,1),ot(t),it("active")},Tt=e=>{_e(t=>{var n;const a={dashboard:{...null==t||null==(n=t.extra)?void 0:n.dashboard,anchor:e}};return{...t,extra:a}})},{state:{loading:Et,resource:yt,error:Nt},fetchResource:St,createResource:Ct,updateResource:Rt,clearError:Ot}=(0,p.fn)("report",(0,o.t)("report"),e),xt=()=>{Ot(),Ee(!0),n(),ot([]),_e({...vt}),it("active")},At=(0,l.useMemo)(()=>(e="",t,n)=>{const a=h().encode({filter:e,page:t,page_size:n});return d.A.get({endpoint:`/api/v1/report/related/created_by?q=${a}`}).then(e=>({data:e.json.result.map(e=>({value:e.value,label:e.text})),totalCount:e.json.count}))},[]),It=(0,l.useCallback)(e=>{const t=e||(null==ge?void 0:ge.database);if(!t||t.label)return null;let n;return De.forEach(e=>{e.value!==t.value&&e.value!==t.id||(n=e)}),n},[null==ge?void 0:ge.database,De]),Ft=(e,t)=>{_e(n=>({...n,[e]:t}))},Dt=(0,l.useMemo)(()=>(e="",t,n)=>{const a=h().encode({filter:e,page:t,page_size:n});return d.A.get({endpoint:`/api/v1/report/related/database?q=${a}`}).then(e=>{const t=e.json.result.map(e=>({value:e.value,label:e.text}));return Ye(t),{data:t,totalCount:e.json.count}})},[]),Yt=null==ge?void 0:ge.dashboard;(0,l.useEffect)(()=>{nt&&null!=Yt&&Yt.value&&d.A.get({endpoint:`/api/v1/dashboard/${Yt.value}/tabs`}).then(e=>{var t;const{tab_tree:n,all_tabs:a,native_filters:l}=e.json.result,i=n.map(e=>e.value);i.length>1&&n.push({title:"All Tabs",value:JSON.stringify(i)}),Ve(n),Pe(l),et&&l.all&&((e=>{qe.map(t=>{var n,a;if(!t.nativeFilterId)return;const l=e.filter(e=>e.id===t.nativeFilterId)[0],{datasetId:i}=l.targets[0],r=l.name,o=(null==(n=l.targets[0].column)?void 0:n.name)||r,s=null==ge||null==(a=ge.dashboard)?void 0:a.value,{filterType:c}=l;return"filter_time"!==c?bt(s,o,i,c).then(e=>{Ge(n=>n.map(n=>n.nativeFilterId===t.nativeFilterId?{...n,filterType:c,filterName:r,optionFilterValues:e}:n))}):void 0})})(l.all),Ue(l.all.map(e=>({value:e.id,label:e.name}))));const r=null==ge||null==(t=ge.extra)||null==(t=t.dashboard)?void 0:t.anchor;if(r)try{const e=JSON.parse(r);if(Array.isArray(e)||Ue(l[r].map(e=>({value:e.id,label:e.name}))),!Array.isArray(e))throw new Error("Parsed value is not an array");e.every(e=>e in a)||Tt(void 0)}catch(e){r in a||Tt(void 0)}else l.all&&Ue(l.all.map(e=>({value:e.id,label:e.name})))}).catch(t=>{e((0,o.t)("There was an error retrieving dashboard tabs."))})},[Yt,nt,null==ge?void 0:ge.extra,e]);const Lt=(null==ge?void 0:ge.database)&&!ge.database.label;(0,l.useEffect)(()=>{Lt&&Ft("database",It())},[Lt,It]);const kt=(0,l.useMemo)(()=>(e="",t,n)=>{const a=h().encode_uri({filter:e,page:t,page_size:n});return d.A.get({endpoint:`/api/v1/report/related/dashboard?q=${a}`}).then(e=>{const t=e.json.result.map(e=>({value:e.value,label:e.text}));return ke(t),{data:t,totalCount:e.json.count}})},[]),wt=e=>{const t=e||(null==ge?void 0:ge.dashboard);if(!t||t.label)return null;let n;return Le.forEach(e=>{e.value!==t.value&&e.value!==t.id||(n=e)}),n},Mt=(0,l.useCallback)(e=>{const t=e||(null==ge?void 0:ge.chart);if(!t||t.label)return null;let n;return we.forEach(e=>{e.value!==t.value&&e.value!==t.id||(n=e)}),n},[we,null==ge?void 0:ge.chart]),zt=(null==ge?void 0:ge.chart)&&!(null!=ge&&ge.chart.label);(0,l.useEffect)(()=>{zt&&Ft("chart",Mt())},[Mt,zt]);const Vt=(0,l.useMemo)(()=>(e="",t,n)=>{const a=h().encode_uri({filter:e,page:t,page_size:n});return d.A.get({endpoint:`/api/v1/report/related/chart?q=${a}`}).then(e=>{const t=e.json.result.map(e=>({value:e.value,label:e.text}));return Me(t),{data:t,totalCount:e.json.count}})},[]),$t=()=>{var e,t;const n=null==ge||null==(e=ge.chart)?void 0:e.label,a=null==ge||null==(t=ge.dashboard)?void 0:t.label;if(null!=ge&&ge.name)switch(ye){case R.cM.Chart:ct(`${null==ge?void 0:ge.name}: ${n||""}`);break;case R.cM.Dashboard:ct(`${null==ge?void 0:ge.name}: ${a||""}`);break;default:ct("")}else ct("")},Ut=e=>{const{target:{type:t,value:n,name:a}}=e,l="number"===t?parseInt(n,10)||null:n;Ft(a,l),"name"===a&&$t()},jt=()=>{Ge([...qe,{nativeFilterId:null,columnLabel:"",columnName:"",filterValues:[]}])},Pt=e=>{const{target:t}=e,n=+t.value;Ft(t.name,0===n?void 0:n?Math.max(n,1):n)},qt=(e,t)=>{let n;n="string"==typeof t?[t]:t,Ge(qe.map((t,a)=>a===e?{...t,filterValues:n}:t))},Gt=(e,t)=>{if(!e)return null;const{filterType:n,filterValues:l}=e;let i="multiple";if("filter_time"===n)return(0,a.Y)(I.Ay,{name:"time_range",onChange:t=>{Ge(qe.map(n=>e.nativeFilterId===n.nativeFilterId?{...n,filterValues:[t]}:n))},value:null==l?void 0:l[0]});if("filter_range"===n){const t=null==l?void 0:l[0],n=null==l?void 0:l[1];return(0,a.FD)("div",{children:[(0,a.FD)("div",{className:"inline-container",children:[(0,a.Y)(b.InputNumber,{value:t,onChange:t=>{Ge(qe.map(n=>n.nativeFilterId===e.nativeFilterId?{...n,filterValues:[t,null==l?void 0:l[1]]}:n))}}),(0,a.Y)(q,{children:"-"}),(0,a.Y)(b.InputNumber,{value:n,onChange:t=>{Ge(qe.map(n=>n.nativeFilterId===e.nativeFilterId?{...n,filterValues:[null==l?void 0:l[0],t]}:n))}})]}),(0,a.Y)(O.Mo,{status:"help",children:(0,o.t)("Enter minimum and maximum values for the range filter")})]})}return"filter_timegrain"!==n&&"filter_timecolumn"!==n||(i="single"),(0,a.Y)(f.A,{ariaLabel:(0,o.t)("Select Value"),placeholder:(0,o.t)("Select Value"),disabled:!(null!=e&&e.optionFilterValues),value:null==e?void 0:e.filterValues,options:(null==e?void 0:e.optionFilterValues)||[],onChange:e=>qt(t,e),mode:i,onClear:()=>{qt(t,[])},allowClear:!0})},Xt=()=>{(()=>{var e,t;const n=[];null!=ge&&null!=(e=ge.name)&&e.length||n.push(oe.NAME_ERROR_TEXT),null!=ge&&null!=(t=ge.owners)&&t.length||n.push(oe.OWNERS_ERROR_TEXT),Ke(R.Z_.General,n)})(),(()=>{const e=[];ye===R.cM.Dashboard&&null!=ge&&ge.dashboard||ye===R.cM.Chart&&null!=ge&&ge.chart||e.push(oe.CONTENT_ERROR_TEXT),qe.forEach(t=>{const n=!t.columnName||""===t.columnName,a=!t.filterValues||0===t.filterValues.length;n&&a||(n&&e.push(oe.NATIVE_FILTER_COLUMN_ERROR_TEXT),a&&e.push(oe.NATIVE_FILTER_NO_VALUES_ERROR_TEXT))}),Ke(R.Z_.Content,e)})(),m||(()=>{var e,t,n;const a=[];null!=ge&&ge.database||a.push(oe.DATABASE_ERROR_TEXT),null!=ge&&null!=(e=ge.sql)&&e.length||a.push(oe.SQL_ERROR_TEXT),(Ie||null!=ge&&null!=(t=ge.validator_config_json)&&t.op)&&(Ie||void 0!==(null==ge||null==(n=ge.validator_config_json)?void 0:n.threshold))||a.push(oe.ALERT_CONDITION_ERROR_TEXT),Ke(R.Z_.Alert,a)})(),(()=>{var e;const t=[];null!=ge&&null!=(e=ge.crontab)&&e.length||t.push(oe.CRONTAB_ERROR_TEXT),null!=ge&&ge.working_timeout||t.push(oe.WORKING_TIMEOUT_ERROR_TEXT),Ke(R.Z_.Schedule,t)})(),(()=>{const e=[];(()=>{if(!rt.length)return!1;let e=!1;return rt.forEach(t=>{var n;t.method&&null!=(n=t.recipients)&&n.length&&(e=!0)}),e})()?!(()=>{if(!rt.length)return!0;const e=e=>!e||e.split(/[,;]/).every(e=>G.test(e.trim()));return rt.every(t=>{var n;return!t.method||"Email"!==t.method||(!(null!=(n=t.recipients)&&n.length)||e(t.recipients))&&(!t.cc||e(t.cc))&&(!t.bcc||e(t.bcc))})})()&&e.push(oe.EMAIL_VALIDATION_ERROR_TEXT):e.push(oe.RECIPIENTS_ERROR_TEXT),dt&&e.push(oe.EMAIL_SUBJECT_ERROR_TEXT),Ke(R.Z_.Notification,e)})()};(0,l.useEffect)(()=>{if(et&&(null==ge||!ge.id||(null==u?void 0:u.id)!==ge.id||Te&&i)){if(null!==(null==u?void 0:u.id)&&!Et&&!Nt){const e=u.id||0;St(e)}}else!et&&(!ge||ge.id||Te&&i)&&(_e({...vt,owners:pe?[{value:pe.userId,label:`${pe.firstName} ${pe.lastName}`}]:[]}),ot([{recipients:"",cc:"",bcc:"",options:ve,method:R.yV.Email}]),it("active"))},[u]),(0,l.useEffect)(()=>{if(yt){var e;if(null!=(e=yt.extra)&&null!=(e=e.dashboard)&&e.nativeFilters){const e=yt.extra.dashboard.nativeFilters;Ge(e)}const t=(yt.recipients||[]).map(e=>{const t="string"==typeof e.recipient_config_json?JSON.parse(e.recipient_config_json):{};return{method:e.type,recipients:t.target||e.recipient_config_json,options:ve,cc:t.ccTarget||"",bcc:t.bccTarget||""}});ot(t),it(t.length===ve.length?"hidden":"active"),Ne(yt.chart?R.cM.Chart:R.cM.Dashboard),Ce(yt.report_format||B);const n="string"==typeof yt.validator_config_json?JSON.parse(yt.validator_config_json):yt.validator_config_json;Fe("not null"===yt.validator_type),yt.chart&&Je(yt.chart.viz_type),Oe(yt.force_screenshot),_e({...yt,chart:yt.chart?Mt(yt.chart)||{value:yt.chart.id,label:yt.chart.slice_name}:void 0,dashboard:yt.dashboard?wt(yt.dashboard)||{value:yt.dashboard.id,label:yt.dashboard.dashboard_title}:void 0,database:yt.database?It(yt.database)||{value:yt.database.id,label:yt.database.database_name}:void 0,owners:((null==u?void 0:u.owners)||[]).map(e=>({value:e.value||e.id,label:e.label||`${e.first_name} ${e.last_name}`})),validator_config_json:"not null"===yt.validator_type?{op:"not null"}:n})}},[yt]);const Bt=ge||{};(0,l.useEffect)(()=>{Xt(),$t()},[Bt.name,Bt.owners,Bt.database,Bt.sql,Bt.validator_config_json,Bt.crontab,Bt.working_timeout,Bt.dashboard,Bt.chart,ye,qe,rt,Ie,dt]),(0,l.useEffect)(()=>{(()=>{const e=[R.Z_.General,R.Z_.Content,m?void 0:R.Z_.Alert,R.Z_.Schedule,R.Z_.Notification].some(e=>e&&Xe[e].hasErrors),t=e?(e=>{const t=[];return Object.values(e).forEach(e=>{if(e.hasErrors){const n=`${e.name}: `;t.push(n+e.errors.join(", "))}}),(0,a.FD)("div",{children:[oe.ERROR_TOOLTIP_MESSAGE,(0,a.Y)(j.B,{dataSource:t,renderItem:e=>(0,a.FD)(j.B.Item,{css:e=>s.AH`
              &&& {
                color: ${e.colorWhite};
              }
            `,compact:!0,children:["â€¢ ",e]}),size:"small",split:!1})]})})(Xe):"";We(t),fe(e)})()},[Xe]);const Zt=(0,l.useMemo)(()=>ve.reduce((e,t)=>e.some(e=>e.includes("slack"))&&t.toLowerCase().includes("slack")?e:[...e,t.toLowerCase()],[]).length,[ve]);Te&&i&&Ee(!1);const Wt=e=>{ut(e)};return(0,a.Y)(D.xQ,{show:i,onHide:xt,onSave:()=>{var e,n,a,l;const i=[];rt.forEach(e=>{e.method&&e.recipients.length&&i.push({recipient_config_json:{target:e.recipients,ccTarget:e.cc,bccTarget:e.bcc},type:e.method})});const r=ye===R.cM.Chart&&!m;if(null!=ge&&null!=(e=ge.extra)&&e.dashboard){const e=qe.filter(e=>{const t=e.filterName&&""!==e.filterName.trim(),n=e.filterValues&&e.filterValues.length>0;return t||n});ge.extra.dashboard.nativeFilters=e.map(({columnName:e,columnLabel:t,nativeFilterId:n,filterValues:a,filterType:l,filterName:i})=>({filterName:i,filterType:l,columnName:e,columnLabel:t,nativeFilterId:n,filterValues:a}))}const s={...ge,type:m?"Report":"Alert",force_screenshot:r||Re,validator_type:Ie?"not null":"operator",validator_config_json:Ie?{}:null==ge?void 0:ge.validator_config_json,chart:ye===R.cM.Chart?null==ge||null==(n=ge.chart)?void 0:n.value:null,dashboard:ye===R.cM.Dashboard?null==ge||null==(a=ge.dashboard)?void 0:a.value:null,custom_width:xe?null==ge?void 0:ge.custom_width:void 0,database:null==ge||null==(l=ge.database)?void 0:l.value,owners:((null==ge?void 0:ge.owners)||[]).map(e=>e.value||e.id),recipients:i,report_format:Se||B,extra:ye===R.cM.Dashboard?null==ge?void 0:ge.extra:{}};if(s.recipients&&!s.recipients.length&&delete s.recipients,s.context_markdown="string",et){if(null!=ge&&ge.id){const e=ge.id;delete s.id,delete s.created_by,delete s.last_eval_dttm,delete s.last_state,delete s.last_value,delete s.last_value_row_json,Rt(e,s).then(e=>{e&&(L((0,o.t)("%s updated",s.type)),t&&t(),xt())})}}else ge&&Ct(s).then(e=>{e&&(L((0,o.t)("%s updated",s.type)),t&&t(e),xt())})},saveDisabled:be,saveText:et?(0,o.t)("Save"):(0,o.t)("Add"),errorTooltip:Ze,title:(()=>{let e;switch(!0){case et&&m:e=(0,o.t)("Edit report");break;case et:e=(0,o.t)("Edit alert");break;case m:e=(0,o.t)("Add report");break;default:e=(0,o.t)("Add alert")}return e})(),isEditMode:et,width:500,wrapProps:{},children:(0,a.Y)("div",{css:ee,children:(0,a.Y)(g.S,{expandIconPosition:"end",defaultActiveKey:"general",accordion:!0,modalMode:!0,items:[{key:"general",label:(0,a.Y)(_.s,{title:oe.GENERAL_TITLE,subtitle:(0,o.t)("Set up basic details, such as name and description."),validateCheckStatus:!Xe[R.Z_.General].hasErrors,testId:"general-information-panel"}),children:(0,a.FD)("div",{className:"header-section",children:[(0,a.Y)(D.Gk,{label:m?(0,o.t)("Report name"):(0,o.t)("Alert name"),required:!0,children:(0,a.Y)(b.Input,{name:"name",placeholder:m?(0,o.t)("Enter report name"):(0,o.t)("Enter alert name"),value:ge?ge.name:"",onChange:Ut})}),(0,a.Y)(D.Gk,{label:(0,o.t)("Owners"),required:!0,children:(0,a.Y)(T.A,{ariaLabel:(0,o.t)("Owners"),allowClear:!0,name:"owners",mode:"multiple",placeholder:(0,o.t)("Select owners"),value:(null==ge?void 0:ge.owners)||[],options:At,onChange:e=>{Ft("owners",e||[])}})}),(0,a.Y)(D.Gk,{label:(0,o.t)("Description"),children:(0,a.Y)(b.Input,{name:"description",value:ge&&ge.description||"",placeholder:(0,o.t)("Include description to be sent with %s",Qe),onChange:Ut})}),(0,a.FD)(ne,{children:[(0,a.Y)(b.Switch,{checked:!!ge&&ge.active,defaultChecked:!0,onChange:e=>{Ft("active",e)}}),(0,a.Y)("div",{className:"switch-label",children:m?(0,o.t)("Report is active"):(0,o.t)("Alert is active")})]})]})},...m?[]:[{key:"condition",label:(0,a.Y)(_.s,{title:oe.ALERT_CONDITION_TITLE,subtitle:(0,o.t)("Define the database, SQL query, and triggering conditions for alert."),validateCheckStatus:!Xe[R.Z_.Alert].hasErrors,testId:"alert-condition-panel"}),children:(0,a.FD)("div",{children:[(0,a.FD)(ae,{children:[(0,a.FD)("div",{className:"control-label",children:[(0,o.t)("Database"),(0,a.Y)("span",{className:"required",children:"*"})]}),(0,a.Y)("div",{className:"input-container",children:(0,a.Y)(T.A,{ariaLabel:(0,o.t)("Database"),name:"source",placeholder:(0,o.t)("Select database"),value:null!=ge&&null!=(k=ge.database)&&k.label&&null!=ge&&null!=(w=ge.database)&&w.value?{value:ge.database.value,label:ge.database.label}:void 0,options:Dt,onChange:e=>{Ft("database",e||[])}})})]}),(0,a.FD)(ae,{children:[(0,a.FD)("div",{className:"control-label",children:[(0,o.t)("SQL Query"),(0,a.Y)(E.I,{tooltip:(0,o.t)('The result of this query must be a value capable of numeric interpretation e.g. 1, 1.0, or "1" (compatible with Python\'s float() function).')}),(0,a.Y)("span",{className:"required",children:"*"})]}),(0,a.Y)(S.A,{name:"sql",language:"sql",offerEditInModal:!1,minLines:15,maxLines:15,onChange:e=>{Ft("sql",e||"")},readOnly:!1,initialValue:null==yt?void 0:yt.sql},null==ge?void 0:ge.id)]}),(0,a.FD)("div",{className:"inline-container wrap",css:s.AH`
                            gap: ${he.sizeUnit}px;
                          `,children:[(0,a.FD)(ae,{css:Q,children:[(0,a.FD)("div",{className:"control-label",css:re,children:[(0,o.t)("Trigger Alert If..."),(0,a.Y)("span",{className:"required",children:"*"})]}),(0,a.Y)("div",{className:"input-container",children:(0,a.Y)(f.A,{ariaLabel:(0,o.t)("Condition"),onChange:e=>{var t;Fe("not null"===e);const n={op:e,threshold:ge?null==(t=ge.validator_config_json)?void 0:t.threshold:void 0};Ft("validator_config_json",n)},placeholder:(0,o.t)("Condition"),value:(null==ge||null==(z=ge.validator_config_json)?void 0:z.op)||void 0,options:W})})]}),(0,a.FD)(ae,{css:Q,children:[(0,a.FD)("div",{className:"control-label",children:[(0,o.t)("Value")," ",!Ie&&(0,a.Y)("span",{className:"required",children:"*"})]}),(0,a.Y)("div",{className:"input-container",children:(0,a.Y)(b.InputNumber,{disabled:Ie,type:"number",name:"threshold",value:void 0===(null==ge||null==(V=ge.validator_config_json)?void 0:V.threshold)||Ie?"":ge.validator_config_json.threshold,min:0,placeholder:(0,o.t)("Value"),onChange:e=>{var t;const n={op:ge?null==(t=ge.validator_config_json)?void 0:t.op:void 0,threshold:e};Ft("validator_config_json",n)}})})]})]})]})}],{key:"contents",label:(0,a.Y)(_.s,{title:m?oe.REPORT_CONTENTS_TITLE:oe.ALERT_CONTENTS_TITLE,subtitle:(0,o.t)("Customize data source, filters, and layout."),validateCheckStatus:!Xe[R.Z_.Content].hasErrors,testId:"contents-panel"}),children:(0,a.FD)(a.FK,{children:[(0,a.FD)(ae,{children:[(0,a.FD)("div",{className:"control-label",children:[(0,o.t)("Content type"),(0,a.Y)("span",{className:"required",children:"*"})]}),(0,a.Y)(f.A,{ariaLabel:(0,o.t)("Select content type"),onChange:e=>{Oe(!1),Ne(e)},value:ye,options:H,placeholder:(0,o.t)("Select content type")})]}),(0,a.Y)(ae,{children:ye===R.cM.Chart?(0,a.FD)(a.FK,{children:[(0,a.FD)("div",{className:"control-label",children:[(0,o.t)("Select chart"),(0,a.Y)("span",{className:"required",children:"*"})]}),(0,a.Y)(T.A,{ariaLabel:(0,o.t)("Chart"),name:"chart",value:null!=ge&&null!=($=ge.chart)&&$.label&&null!=ge&&null!=(le=ge.chart)&&le.value?{value:ge.chart.value,label:ge.chart.label}:void 0,options:Vt,onChange:e=>{(e=>{d.A.get({endpoint:`/api/v1/chart/${e.value}`}).then(e=>Je(e.json.result.viz_type))})(e),Ft("chart",e||void 0),Ft("dashboard",null)},placeholder:(0,o.t)("Select chart to use")})]}):(0,a.FD)(a.FK,{children:[(0,a.FD)("div",{className:"control-label",children:[(0,o.t)("Select dashboard"),(0,a.Y)("span",{className:"required",children:"*"})]}),(0,a.Y)(T.A,{ariaLabel:(0,o.t)("Dashboard"),name:"dashboard",value:null!=ge&&null!=(ce=ge.dashboard)&&ce.label&&null!=ge&&null!=(de=ge.dashboard)&&de.value?{value:ge.dashboard.value,label:ge.dashboard.label}:void 0,options:kt,onChange:e=>{Ft("dashboard",e||void 0),Ft("chart",null),nt&&(Ve([]),Ue([]),Tt("")),at&&Ge([{filterName:"",filterType:"",nativeFilterId:null,columnLabel:"",columnName:"",filterValues:[]}])},placeholder:(0,o.t)("Select dashboard to use")})]})}),(0,a.Y)(ae,{css:["PDF","TEXT","CSV"].includes(Se)&&Q,children:tt&&(0,a.FD)(a.FK,{children:[(0,a.FD)("div",{className:"control-label",children:[(0,o.t)("Content format"),(0,a.Y)("span",{className:"required",children:"*"})]}),(0,a.Y)(f.A,{ariaLabel:(0,o.t)("Select format"),onChange:e=>{Ce(e)},value:Se,options:ye===R.cM.Dashboard?["pdf","png"].map(e=>J[e]):P.includes(He)?Object.values(J):["pdf","png","csv"].map(e=>J[e]),placeholder:(0,o.t)("Select format")})]})}),nt&&ye===R.cM.Dashboard&&(0,a.Y)(ae,{children:(0,a.FD)(a.FK,{children:[(0,a.Y)("div",{className:"control-label",children:(0,o.t)("Select tab")}),(0,a.Y)(te,{disabled:0===(null==ze?void 0:ze.length),treeData:ze,value:null==ge||null==(ue=ge.extra)||null==(ue=ue.dashboard)?void 0:ue.anchor,onSelect:Tt,placeholder:(0,o.t)("Select a tab")})]})}),at&&ye===R.cM.Dashboard&&(0,a.Y)(ae,{children:(0,a.Y)(y.l,{className:"filters",name:"form",autoComplete:"off",children:(0,a.Y)(y.l.List,{name:"filters",initialValue:qe,children:(t,{add:n,remove:l})=>(0,a.FD)("div",{children:[t.map(({key:t,name:n})=>{var i,r;return(0,a.FD)("div",{className:"filters-container",children:[(0,a.FD)("div",{className:"filters-dash-container",children:[(0,a.FD)("div",{className:"control-label",children:[(0,a.Y)("span",{className:"label-with-tooltip",children:(0,o.t)("Dashboard Filter")}),(0,a.Y)(E.I,{tooltip:(0,o.t)("Choose from existing dashboard filters and select a value to refine your report results.")})]}),(0,a.Y)(f.A,{disabled:(null==$e?void 0:$e.length)<1&&!(null!=(i=qe[n])&&i.filterName),ariaLabel:(0,o.t)("Select Filter"),placeholder:(0,o.t)("Select Filter"),value:null==(r=qe[n])?void 0:r.filterName,options:ft(),onChange:t=>((t,n)=>{var a;if(!n||"undefined"===n||"null"===n)return;const l=Object.values(je).flat().filter(e=>e.id===n)[0],{filterType:i,adhoc_filters:r}=l;if(qe.some(e=>e.nativeFilterId===n))return void e((0,o.t)("This filter already exist on the report"));const s=l.name;let c;c="filter_time"===i||"filter_timecolumn"===i||"filter_timegrain"===i?l.name:l.targets[0].column.name;const d=l.targets[0].datasetId||null,u=$e.filter(e=>e.value===n)[0].label,h=null==ge||null==(a=ge.dashboard)?void 0:a.value,p={formData:{datasource:`${d}__table`,groupby:[c],metrics:["count"],row_limit:1e3,showSearch:!0,viz_type:"filter_select",type:"NATIVE_FILTER",dashboardId:h,adhoc_filters:r},force:!1,ownState:{}};if("filter_time"===i||"filter_timecolumn"===i||"filter_timegrain"===i)return bt(h,c,d,i,r).then(e=>{Ge(qe.map((a,l)=>l===t?{...a,filterName:s,filterType:i,nativeFilterId:n,columnLabel:u,columnName:c,optionFilterValues:e,filterValues:[]}:a))}),void Ge(qe.map((e,a)=>a===t?{...e,filterName:s,filterType:i,nativeFilterId:n,columnLabel:u,columnName:c,optionFilterValues:[],filterValues:[]}:e));(0,A.getChartDataRequest)(p).then(e=>{const a=e.json.result[0].data.map(e=>({value:e[c],label:e[c]}));Ge(qe.map((e,l)=>l===t?{...e,filterName:s,filterType:i,nativeFilterId:n,columnLabel:u,columnName:c,optionFilterValues:a,filterValues:[]}:e))})})(n,String(t)),onClear:()=>{qe[n].columnName="",qe[n].filterName="",qe[n].filterValues=[]},css:s.AH`
                                        flex: 1;
                                      `,oneLine:!0,allowClear:!0})]}),(0,a.FD)("div",{className:"filters-dashvalue-container",children:[(0,a.Y)("div",{className:"control-label",children:(0,o.t)("Value")}),Gt(qe[n],n)]}),(0!==n||et)&&(0,a.Y)("div",{className:"filters-delete",children:(0,a.Y)(F.F.DeleteOutlined,{iconSize:"xl",className:"filters-trashcan",onClick:()=>{(e=>{const t=qe||[];t.splice(e,1),Ge(t)})(n),l(n)}})})]},t)}),(0,a.Y)("div",{className:"filters-add-container",children:ft().length>0&&(0,a.FD)("a",{className:"filters-add-btn",role:"button",tabIndex:0,onClick:()=>{jt(),n()},onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(jt(),n())},children:["+ ",(0,o.t)("Apply another dashboard filter")]})})]})})})}),xe&&(0,a.FD)(ae,{css:!m&&ye===R.cM.Chart&&Q,children:[(0,a.Y)("div",{className:"control-label",children:(0,o.t)("Screenshot width")}),(0,a.Y)("div",{className:"input-container",children:(0,a.Y)(b.InputNumber,{type:"number",name:"custom_width",value:(null==ge?void 0:ge.custom_width)||void 0,min:600,max:2400,placeholder:(0,o.t)("Input custom width in pixels"),onChange:e=>{const t=null==e||"string"==typeof e&&Number.isNaN(Number(e))?null:Number(e);Ft("custom_width",t)}})})]}),(m||ye===R.cM.Dashboard)&&(0,a.Y)("div",{className:"inline-container",children:(0,a.Y)(b.Checkbox,{checked:Re,onChange:e=>{Oe(e.target.checked)},children:(0,o.t)("Ignore cache when generating report")})})]})},{key:"schedule",label:(0,a.Y)(_.s,{title:oe.SCHEDULE_TITLE,subtitle:(0,o.t)("Define delivery schedule, timezone, and frequency settings."),validateCheckStatus:!Xe[R.Z_.Schedule].hasErrors,testId:"schedule-panel"}),children:(0,a.FD)(a.FK,{children:[(0,a.Y)(M,{value:(null==ge?void 0:ge.crontab)||"",onChange:e=>Ft("crontab",e)}),(0,a.FD)(ae,{children:[(0,a.FD)("div",{className:"control-label",children:[(0,o.t)("Timezone")," ",(0,a.Y)("span",{className:"required",children:"*"})]}),(0,a.Y)(N.A,{onTimezoneChange:e=>{Ft("timezone",e)},timezone:null==ge?void 0:ge.timezone,minWidth:"100%"})]}),(0,a.FD)(ae,{children:[(0,a.FD)("div",{className:"control-label",children:[(0,o.t)("Log retention"),(0,a.Y)("span",{className:"required",children:"*"})]}),(0,a.Y)("div",{className:"input-container",children:(0,a.Y)(f.A,{ariaLabel:(0,o.t)("Log retention"),placeholder:(0,o.t)("Log retention"),onChange:e=>{Ft("log_retention",e)},value:null==ge?void 0:ge.log_retention,options:K,sortComparator:(0,v.qw)("value")})})]}),(0,a.Y)(ae,{css:Q,children:m?(0,a.FD)(a.FK,{children:[(0,a.FD)("div",{className:"control-label",children:[(0,o.t)("Working timeout"),(0,a.Y)("span",{className:"required",children:"*"})]}),(0,a.Y)("div",{className:"input-container",children:(0,a.Y)(Y,{min:1,name:"working_timeout",value:(null==ge?void 0:ge.working_timeout)||"",placeholder:(0,o.t)("Time in seconds"),onChange:Pt,timeUnit:(0,o.t)("seconds")})})]}):(0,a.FD)(a.FK,{children:[(0,a.Y)("div",{className:"control-label",children:(0,o.t)("Grace period")}),(0,a.Y)("div",{className:"input-container",children:(0,a.Y)(Y,{min:1,name:"grace_period",value:(null==ge?void 0:ge.grace_period)||"",placeholder:(0,o.t)("Time in seconds"),onChange:Pt,timeUnit:(0,o.t)("seconds")})})]})})]})},{key:"notification",label:(0,a.Y)(_.s,{title:oe.NOTIFICATION_TITLE,subtitle:(0,o.t)("Choose notification method and recipients."),validateCheckStatus:!Xe[R.Z_.Notification].hasErrors,testId:"notification-method-panel"}),children:(0,a.FD)(a.FK,{children:[rt.map((e,t)=>(0,a.Y)(ie,{children:(0,a.Y)(U,{setting:e,index:t,onUpdate:gt,onRemove:_t,onInputChange:Ut,email_subject:(null==ge?void 0:ge.email_subject)||"",defaultSubject:st||"",setErrorSubject:Wt},`NotificationMethod-${t}`)})),Zt>rt.length&&(0,a.Y)(se,{status:lt,onClick:()=>{ot([...rt,{recipients:"",options:ve.filter(e=>!rt.reduce((t,n)=>t||e===n.method,!1))}]),it(rt.length===Zt?"hidden":"disabled")}})]})}]})})})})},96611:(e,t,n)=>{var a,l,i,r,o;n.d(t,{Or:()=>l,Z_:()=>r,cM:()=>o,yV:()=>a}),function(e){e.Email="Email",e.Slack="Slack",e.SlackV2="SlackV2"}(a||(a={})),function(e){e.Success="Success",e.Working="Working",e.Error="Error",e.Noop="Not triggered",e.Grace="On Grace"}(l||(l={})),function(e){e.Email="Email",e.Slack="Slack",e.SlackV2="SlackV2"}(i||(i={})),function(e){e.General="generalSection",e.Content="contentSection",e.Alert="alertConditionSection",e.Schedule="scheduleSection",e.Notification="notificationSection"}(r||(r={})),function(e){e.Dashboard="dashboard",e.Chart="chart"}(o||(o={}))}}]);