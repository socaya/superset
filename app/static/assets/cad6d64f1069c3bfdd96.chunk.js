"use strict";(globalThis.webpackChunksuperset=globalThis.webpackChunksuperset||[]).push([[7338],{28027:(t,e,n)=>{n.d(e,{A:()=>c});var o=n(2445),r=n(24002),l=n(29898);const i=n(81465).I4.div`
  ${({theme:t})=>`\n    font-size: ${t.fontSizeSM}px;\n    position: absolute;\n    background: ${t.colorBgElevated};\n    box-shadow: 0 0 ${t.sizeUnit}px ${t.colorBorderSecondary};\n    margin: ${6*t.sizeUnit}px;\n    padding: ${3*t.sizeUnit}px ${5*t.sizeUnit}px;\n    outline: none;\n    overflow-y: scroll;\n    max-height: 200px;\n    border: 1px solid ${t.colorBorder};\n    border-radius: ${t.borderRadius}px;\n\n    & ul {\n      list-style: none;\n      padding-left: 0;\n      margin: 0;\n\n      & li a {\n        display: flex;\n        color: ${t.colorText};\n        text-decoration: none;\n        padding: ${t.sizeUnit}px 0;\n\n        & span {\n          margin-right: ${t.sizeUnit}px;\n        }\n      }\n    }\n  `}
`,a=" - ",u=({format:t=null,forceCategorical:e=!1,position:n="tr",categories:r={},toggleCategory:u=()=>{},showSingleCategory:c=()=>{}})=>{const s=n=>{if(!t||e)return n;const o=parseFloat(n);return(0,l.ZV)(t,o)},d=e=>{if(!t)return e;if(e.includes(a)){const t=e.split(a);return s(t[0])+a+s(t[1])}return s(e)};if(0===Object.keys(r).length||null===n)return null;const p=Object.entries(r).map(([t,e])=>{var n;const r={color:`rgba(${null==(n=e.color)?void 0:n.join(", ")})`},l=e.enabled?"◼":"◻";return(0,o.Y)("li",{children:(0,o.FD)("a",{href:"#",role:"button",onClick:()=>u(t),onDoubleClick:()=>c(t),children:[(0,o.Y)("span",{style:r,children:l})," ",d(t)]})},t)}),m="t"===(null==n?void 0:n.charAt(0))?"top":"bottom",g="r"===(null==n?void 0:n.charAt(1))?"right":"left",v={position:"absolute",[m]:"0px",[g]:"10px"};return(0,o.Y)(i,{className:"dupa",style:v,children:(0,o.Y)("ul",{children:p})})},c=(0,r.memo)(u)},42828:(t,e,n)=>{n.d(e,{EO:()=>f,j1:()=>y});var o=n(2445),r=n(74098),l=n(24002),i=n(11331),a=n.n(i),u=n(81465),c=n(7566),s=n(59674),d=n(97596),p=n.n(d);const m=u.I4.pre`
  white-space: pre-wrap;
  color: ${({theme:t})=>t.colorError};
  background-color: ${({theme:t})=>t.colorErrorBg};
  padding: ${({theme:t})=>2*t.sizeUnit}px;
  border-radius: ${({theme:t})=>t.borderRadius}px;
`,g=(0,l.memo)(({templateSource:t,data:e})=>{var n,i;const[a,u]=(0,l.useState)(""),[s,d]=(0,l.useState)(""),g=document.getElementById("app"),{common:v}=JSON.parse((null==g?void 0:g.getAttribute("data-bootstrap"))||"{}"),b=null==(n=null==v||null==(i=v.conf)?void 0:i.HTML_SANITIZATION)||n;(0,l.useEffect)(()=>{try{const n=p().compile(t)(e);u(n),d("")}catch(t){u(""),d(t.message||"Unknown template error")}},[t,e]);const f=(0,l.useMemo)(()=>b?(0,c.pn)(a):a,[a,b]);return s?(0,o.Y)(m,{children:s}):a||""===a?(0,o.Y)("div",{style:{maxWidth:"300px",wordWrap:"break-word",fontSize:"12px",lineHeight:"1.4"},dangerouslySetInnerHTML:{__html:f}}):(0,o.Y)("p",{children:(0,r.t)("Loading...")})});p().registerHelper("dateFormat",function(t,e){const n=e.hash.format||"YYYY-MM-DD HH:mm:ss";if(!t)return"";try{if("number"==typeof t){const e=t>1e12?t:1e3*t;return(0,s.XV)(e).format(n)}return(0,s.XV)(t).format(n)}catch(e){return String(t)}}),p().registerHelper("formatNumber",function(t,e){if("number"!=typeof t)return t;const n=e.hash.locale||"en-US",{minimumFractionDigits:o}=e.hash,{maximumFractionDigits:r}=e.hash,l={};return void 0!==o&&(l.minimumFractionDigits=o),void 0!==r&&(l.maximumFractionDigits=r),t.toLocaleString(n,l)}),p().registerHelper("stringify",function(t){if(null==t)return"";if(a()(t))try{return JSON.stringify(t,null,2)}catch(e){return String(t)}return String(t)}),p().registerHelper("ifExists",function(t,e){return null!=t&&""!==t?e.fn(this):e.inverse(this)}),p().registerHelper("default",function(t,e){return null!=t&&""!==t?t:e}),p().registerHelper("truncate",function(t,e){return"string"!=typeof t||t.length<=e?t:`${t.substring(0,e)}...`}),p().registerHelper("formatCoordinate",function(t,e){return null==t||null==e?"":`${"number"==typeof t?t.toFixed(6):t}, ${"number"==typeof e?e.toFixed(6):e}`}),p().registerHelper("first",function(t){return Array.isArray(t)&&t.length>0?t[0]:null}),p().registerHelper("getField",function(t,e){if(!Array.isArray(t)||0===t.length)return"";const n=t.map(t=>t[e]).filter((t,e,n)=>null!=t&&n.indexOf(t)===e);return 0===n.length?"":1===n.length?n[0]:n.slice(0,3).join(", ")+(n.length>3?"...":"")}),p().registerHelper("limit",function(t,e){if(!t)return"";if(Array.isArray(t))return t.slice(0,e).join(", ")+(t.length>e?"...":"");if("string"==typeof t){const n=t.split(",").map(t=>t.trim());return n.length<=e?t:`${n.slice(0,e).join(", ")}...`}return t});var v=n(52480);const b=(0,l.memo)(g),f={position:(t,e)=>{var n,l;return(0,o.Y)(v.A,{label:`${(0,r.t)("Longitude and Latitude")}: `,value:`${(null==e?void 0:e[0])||(null==(n=t.object)||null==(n=n.position)?void 0:n[0])}, ${(null==e?void 0:e[1])||(null==(l=t.object)||null==(l=l.position)?void 0:l[1])}`})},arcPositions:t=>{var e,n,l,i;return(0,o.FD)(o.FK,{children:[(0,o.Y)(v.A,{label:(0,r.t)("Start (Longitude, Latitude): "),value:`${null==(e=t.object)||null==(e=e.sourcePosition)?void 0:e[0]}, ${null==(n=t.object)||null==(n=n.sourcePosition)?void 0:n[1]}`}),(0,o.Y)(v.A,{label:(0,r.t)("End (Longitude, Latitude): "),value:`${null==(l=t.object)||null==(l=l.targetPosition)?void 0:l[0]}, ${null==(i=t.object)||null==(i=i.targetPosition)?void 0:i[1]}`})]})},centroid:t=>{var e,n;return(0,o.Y)(v.A,{label:(0,r.t)("Centroid (Longitude and Latitude): "),value:`(${null==(e=t.coordinate)?void 0:e[0]}, ${null==(n=t.coordinate)?void 0:n[1]})`})},category:t=>{var e;return null!=(e=t.object)&&e.cat_color?(0,o.Y)(v.A,{label:`${(0,r.t)("Category")}: `,value:`${t.object.cat_color}`}):null},metric:(t,e,n)=>{var r;const l=e.point_radius_fixed||e.size||e.metric;if(!l)return null;const i=(null==n?void 0:n[l.value])||(null==l?void 0:l.value)||(null==l?void 0:l.label)||"Metric";return null!=(r=t.object)&&r.metric?(0,o.Y)(v.A,{label:`${i}: `,value:`${t.object.metric}`}):null}};function h(t,e,n=!0){var o,r,l,i;let a=(null==(o=t.object)?void 0:o[e])||(null==(r=t.object)||null==(r=r.properties)?void 0:r[e])||(null==(l=t.object)||null==(l=l.data)?void 0:l[e])||"";if(!a&&n&&Array.isArray(null==(i=t.object)?void 0:i.points)){const n=t.object.points.map(t=>t[e]).filter(t=>null!=t);if(n.length>0)return a=n[0],{value:a,allValues:n}}return{value:a,allValues:[]}}function y(t,e){return n=>{var r;if(null!=(r=t.tooltip_template)&&r.trim()&&!t.tooltip_template.includes('Drop columns/metrics in "Tooltip contents" above')){const e=function(t,e){var n,o,r,l,i;let a={...{...t.object||{},coordinate:t.coordinate,index:t.index,picked:t.picked,title:e.viz_type||"Chart",coordinateString:t.coordinate?`${t.coordinate[0]}, ${t.coordinate[1]}`:"",positionString:null!=(n=t.object)&&n.position?`${t.object.position[0]}, ${t.object.position[1]}`:"",threshold:null==(o=t.object)||null==(o=o.contour)?void 0:o.threshold,contourThreshold:null==(r=t.object)||null==(r=r.contour)?void 0:r.threshold,nearbyPoints:null==(l=t.object)?void 0:l.nearbyPoints,totalPoints:null==(i=t.object)?void 0:i.totalPoints}};var u;if("deck_heatmap"!==e.viz_type&&"deck_contour"!==e.viz_type||(null!=(u=t.object)&&u.position&&(a={...a,LON:t.object.position[0],LAT:t.object.position[1]}),t.coordinate&&(a={...a,LON:t.coordinate[0],LAT:t.coordinate[1]}),t.object||"deck_heatmap"!==e.viz_type||(a={...a,aggregated:!0,note:"Aggregated cell - individual point data not available"})),e.tooltip_contents&&e.tooltip_contents.length>0){const n=e.tooltip_contents.reduce((n,o)=>{const r=function(t,e,n){let o="";if("string"==typeof t?o=t:"column"===(null==t?void 0:t.item_type)?o=t.column_name:"metric"===(null==t?void 0:t.item_type)&&(o=t.metric_name||t.label),!o)return{};const r=h(e,o);let{value:l}=r;var i;return"metric"!==(null==t?void 0:t.item_type)||l||(l=(null==(i=e.object)?void 0:i.metric)||""),"deck_screengrid"!==n.viz_type||l?r.allValues.length>0?{[o]:r.allValues,[`${o}s`]:r.allValues.join(", "),[`${o}_count`]:r.allValues.length}:""!==l?{[o]:l}:{}:function(t,e,n){const o={};if(n.allValues.length>0)o[e]=n.allValues,o[`${e}s`]=n.allValues.join(", "),o[`${e}_count`]=n.allValues.length;else{var r,l;const n=`Aggregated: ${(null==(r=t.object)?void 0:r.count)||0} points, total value: ${(null==(l=t.object)?void 0:l.value)||0}`;o[e]=n,o[`${e}_aggregated`]=n}return o}(e,o,r)}(o,t,e);return{...n,...r}},{});a={...a,...n}}return a}(n,t);return(0,o.Y)("div",{className:"deckgl-tooltip","data-tooltip-type":"custom",children:(0,o.Y)(b,{templateSource:t.tooltip_template,data:e})})}if(t.tooltip_contents&&t.tooltip_contents.length>0){const e=function(t,e){const n=[];return e.tooltip_contents.forEach((r,l)=>{var i;let a="",u="";if("string"==typeof r?(a=r,u=r):"column"===r.item_type?(a=r.verbose_name||r.column_name||r.label,u=r.column_name):"metric"===r.item_type&&(a=r.verbose_name||r.metric_name||r.label,u=r.metric_name||r.label),!a||!u)return;let{value:c}=h(t,u);var s;if(c||"metric"!==r.item_type||(c=(null==(s=t.object)?void 0:s.metric)||""),"deck_screengrid"===e.viz_type&&!c&&Array.isArray(null==(i=t.object)?void 0:i.points)){const{allValues:e}=h(t,u);e.length>0&&(c=e.join(", "))}if(""!==c){const t=function(t){return""===t?"":"string"==typeof t&&t.match(/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}/)?new Date(t).toLocaleString():`${t}`}(c);n.push((0,o.Y)(v.A,{label:`${a}: `,value:t},`tooltip-${l}`))}}),n}(n,t);return(0,o.Y)("div",{className:"deckgl-tooltip",children:e})}return e(n)}}}}]);