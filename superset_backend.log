Loaded your LOCAL configuration at [/Users/stephocay/projects/hispuganda/superset/superset_config.py]
2025-12-06 19:33:42,191:INFO:alembic.runtime.migration:Context impl SQLiteImpl.
2025-12-06 19:33:42,191:INFO:alembic.runtime.migration:Will assume non-transactional DDL.
2025-12-06 19:33:42,305:INFO:superset.app:Syncing configuration to database...
2025-12-06 19:33:42,309:INFO:superset.app:Configuration sync to database completed successfully
 * Serving Flask app 'superset'
 * Debug mode: on
2025-12-06 19:33:42,608:INFO:werkzeug:[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:8088
2025-12-06 19:33:42,609:INFO:werkzeug:[33mPress CTRL+C to quit[0m
2025-12-06 19:33:42,675:INFO:werkzeug: * Restarting with watchdog (fsevents)
Loaded your LOCAL configuration at [/Users/stephocay/projects/hispuganda/superset/superset_config.py]
2025-12-06 19:33:43,659:INFO:alembic.runtime.migration:Context impl SQLiteImpl.
2025-12-06 19:33:43,659:INFO:alembic.runtime.migration:Will assume non-transactional DDL.
2025-12-06 19:33:43,733:INFO:superset.app:Syncing configuration to database...
2025-12-06 19:33:43,736:INFO:superset.app:Configuration sync to database completed successfully
2025-12-06 19:33:43,973:WARNING:werkzeug: * Debugger is active!
2025-12-06 19:33:43,980:INFO:werkzeug: * Debugger PIN: 114-810-287
2025-12-06 19:33:44,058:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:33:44] "GET /health HTTP/1.1" 200 -
2025-12-06 19:34:50,251:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:34:50] "[32mGET / HTTP/1.1[0m" 302 -
2025-12-06 19:34:50,757:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:34:50] "GET /superset/welcome/ HTTP/1.1" 200 -
2025-12-06 19:34:50,944:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1458, in dispatch_request
    self.raise_routing_exception(req)
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1440, in raise_routing_exception
    raise request.routing_exception  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/ctx.py", line 353, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/werkzeug/routing/map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-12-06 19:34:50,948:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:34:50] "[33mGET /ws HTTP/1.1[0m" 404 -
2025-12-06 19:34:51,556:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:34:51] "GET /api/v1/database/?q=(filters:!((col:allow_file_upload,opr:upload_is_enabled,value:!t))) HTTP/1.1" 200 -
2025-12-06 19:34:51,564:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:34:51] "GET /api/v1/log/recent_activity/?q=(distinct:!f,page_size:24) HTTP/1.1" 200 -
2025-12-06 19:34:51,588:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:34:51] "GET /api/v1/dashboard/?q=(filters:!((col:owners,opr:rel_m_m,value:'1')),order_column:changed_on_delta_humanized,order_direction:desc,page:0,page_size:5) HTTP/1.1" 200 -
2025-12-06 19:34:51,706:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:34:51] "GET /api/v1/saved_query/?q=(filters:!((col:created_by,opr:rel_o_m,value:'1')),order_column:changed_on_delta_humanized,order_direction:desc,page:0,page_size:5) HTTP/1.1" 200 -
2025-12-06 19:34:51,729:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:34:51] "GET /api/v1/chart/?q=(filters:!((col:owners,opr:rel_m_m,value:'1')),order_column:changed_on_delta_humanized,order_direction:desc,page:0,page_size:5) HTTP/1.1" 200 -
2025-12-06 19:34:51,742:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:34:51] "GET /api/v1/dashboard/?q=(filters:!(),order_column:changed_on_delta_humanized,order_direction:desc,page:0,page_size:5) HTTP/1.1" 200 -
2025-12-06 19:34:51,754:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:34:51] "GET /api/v1/chart/?q=(filters:!(),order_column:changed_on_delta_humanized,order_direction:desc,page:0,page_size:5) HTTP/1.1" 200 -
2025-12-06 19:34:51,759:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:34:51] "GET /api/v1/database/?q=(filters:!((col:database_name,opr:neq,value:examples))) HTTP/1.1" 200 -
2025-12-06 19:34:51,824:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:34:51] "GET /api/v1/dashboard/_info?q=(keys:!(permissions)) HTTP/1.1" 200 -
2025-12-06 19:34:51,828:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:34:51] "GET /api/v1/chart/_info?q=(keys:!(permissions)) HTTP/1.1" 200 -
2025-12-06 19:34:51,830:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:34:51] "GET /api/v1/chart/favorite_status/?q=!(1) HTTP/1.1" 200 -
2025-12-06 19:34:52,371:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:34:52] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-06 19:34:52,472:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1458, in dispatch_request
    self.raise_routing_exception(req)
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1440, in raise_routing_exception
    raise request.routing_exception  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/ctx.py", line 353, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/werkzeug/routing/map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-12-06 19:34:52,473:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:34:52] "[33mGET /ws HTTP/1.1[0m" 404 -
2025-12-06 19:34:54,554:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1458, in dispatch_request
    self.raise_routing_exception(req)
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1440, in raise_routing_exception
    raise request.routing_exception  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/ctx.py", line 353, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/werkzeug/routing/map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-12-06 19:34:54,556:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:34:54] "[33mGET /ws HTTP/1.1[0m" 404 -
2025-12-06 19:34:56,802:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:34:56] "[32mGET / HTTP/1.1[0m" 302 -
2025-12-06 19:34:56,824:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:34:56] "GET /superset/welcome/ HTTP/1.1" 200 -
2025-12-06 19:34:56,861:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:34:56] "GET /static/appbuilder/css/flags/flags16.css HTTP/1.1" 200 -
2025-12-06 19:34:56,866:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:34:56] "GET /static/assets/theme.0d705af4.entry.js HTTP/1.1" 200 -
2025-12-06 19:34:56,869:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:34:56] "GET /static/assets/thumbnail.0759d391.entry.js HTTP/1.1" 200 -
2025-12-06 19:34:56,881:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:34:56] "GET /static/assets/vendors-node_modules_rc-component_color-picker_es_index_js-node_modules_rc-component_mutate-o-700049.6a9d3af6.entry.js HTTP/1.1" 200 -
2025-12-06 19:34:57,523:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1458, in dispatch_request
    self.raise_routing_exception(req)
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1440, in raise_routing_exception
    raise request.routing_exception  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/ctx.py", line 353, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/werkzeug/routing/map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-12-06 19:34:57,525:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:34:57] "[33mGET /ws HTTP/1.1[0m" 404 -
2025-12-06 19:34:57,594:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:34:57] "GET /api/v1/saved_query/?q=(filters:!((col:created_by,opr:rel_o_m,value:'1')),order_column:changed_on_delta_humanized,order_direction:desc,page:0,page_size:5) HTTP/1.1" 200 -
2025-12-06 19:34:57,597:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:34:57] "GET /api/v1/log/recent_activity/?q=(distinct:!f,page_size:24) HTTP/1.1" 200 -
2025-12-06 19:34:57,598:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:34:57] "GET /api/v1/me/ HTTP/1.1" 200 -
2025-12-06 19:34:57,619:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:34:57] "GET /api/v1/dashboard/?q=(filters:!((col:owners,opr:rel_m_m,value:'1')),order_column:changed_on_delta_humanized,order_direction:desc,page:0,page_size:5) HTTP/1.1" 200 -
2025-12-06 19:34:57,628:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:34:57] "GET /api/v1/database/?q=(filters:!((col:database_name,opr:neq,value:examples))) HTTP/1.1" 200 -
2025-12-06 19:34:57,630:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:34:57] "GET /api/v1/database/?q=(filters:!((col:allow_file_upload,opr:upload_is_enabled,value:!t))) HTTP/1.1" 200 -
2025-12-06 19:34:57,649:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:34:57] "GET /api/v1/chart/?q=(filters:!((col:owners,opr:rel_m_m,value:'1')),order_column:changed_on_delta_humanized,order_direction:desc,page:0,page_size:5) HTTP/1.1" 200 -
2025-12-06 19:34:57,658:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:34:57] "GET /api/v1/dashboard/?q=(filters:!(),order_column:changed_on_delta_humanized,order_direction:desc,page:0,page_size:5) HTTP/1.1" 200 -
2025-12-06 19:34:57,661:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:34:57] "GET /api/v1/chart/?q=(filters:!(),order_column:changed_on_delta_humanized,order_direction:desc,page:0,page_size:5) HTTP/1.1" 200 -
2025-12-06 19:34:57,712:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:34:57] "GET /api/v1/dashboard/_info?q=(keys:!(permissions)) HTTP/1.1" 200 -
2025-12-06 19:34:57,718:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:34:57] "GET /api/v1/chart/favorite_status/?q=!(1) HTTP/1.1" 200 -
2025-12-06 19:34:57,721:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:34:57] "GET /api/v1/chart/_info?q=(keys:!(permissions)) HTTP/1.1" 200 -
2025-12-06 19:34:58,478:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:34:58] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-06 19:34:58,640:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1458, in dispatch_request
    self.raise_routing_exception(req)
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1440, in raise_routing_exception
    raise request.routing_exception  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/ctx.py", line 353, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/werkzeug/routing/map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-12-06 19:34:58,641:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:34:58] "[33mGET /ws HTTP/1.1[0m" 404 -
2025-12-06 19:34:59,273:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1458, in dispatch_request
    self.raise_routing_exception(req)
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1440, in raise_routing_exception
    raise request.routing_exception  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/ctx.py", line 353, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/werkzeug/routing/map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-12-06 19:34:59,274:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:34:59] "[33mGET /ws HTTP/1.1[0m" 404 -
2025-12-06 19:34:59,794:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:34:59] "GET /api/v1/dataset/_info?q=(keys:!(permissions)) HTTP/1.1" 200 -
2025-12-06 19:34:59,795:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:34:59] "GET /api/v1/dataset/?q=(order_column:changed_on_delta_humanized,order_direction:desc,page:0,page_size:25) HTTP/1.1" 200 -
2025-12-06 19:35:00,699:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:35:00] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-06 19:35:00,720:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1458, in dispatch_request
    self.raise_routing_exception(req)
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1440, in raise_routing_exception
    raise request.routing_exception  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/ctx.py", line 353, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/werkzeug/routing/map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-12-06 19:35:00,720:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:35:00] "[33mGET /ws HTTP/1.1[0m" 404 -
2025-12-06 19:35:01,621:INFO:superset.db_engine_specs.dhis2:[DHIS2] get_parameters_from_uri called
2025-12-06 19:35:01,621:ERROR:superset.db_engine_specs.dhis2:[DHIS2] Failed to extract parameters from URI: 'URL' object has no attribute 'decode'
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/superset/db_engine_specs/dhis2.py", line 361, in get_parameters_from_uri
    parsed = urlparse(uri)
             ^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/urllib/parse.py", line 394, in urlparse
    url, scheme, _coerce_result = _coerce_args(url, scheme)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/urllib/parse.py", line 133, in _coerce_args
    return _decode_args(args) + (_encode_result,)
           ^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/urllib/parse.py", line 117, in _decode_args
    return tuple(x.decode(encoding, errors) if x else '' for x in args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/urllib/parse.py", line 117, in <genexpr>
    return tuple(x.decode(encoding, errors) if x else '' for x in args)
                 ^^^^^^^^
AttributeError: 'URL' object has no attribute 'decode'
2025-12-06 19:35:01,631:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:35:01] "GET /api/v1/explore/?datasource_type=table&datasource_id=1 HTTP/1.1" 200 -
2025-12-06 19:35:01,739:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:35:01] "GET /static/assets/node_modules_svgr_webpack_dist_index_js_src_assets_images_icons_big_number_chart_tile_svg.97c95346.chunk.js HTTP/1.1" 200 -
2025-12-06 19:35:01,779:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:35:01] "GET /static/assets/node_modules_svgr_webpack_dist_index_js_src_assets_images_icons_drag_svg.7fafc6ce.chunk.js HTTP/1.1" 200 -
2025-12-06 19:35:01,796:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:35:01] "GET /static/assets/8d61e6fb0ce397d8bf21.woff2 HTTP/1.1" 200 -
2025-12-06 19:35:02,753:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:35:02] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-06 19:35:02,806:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:35:02] "[35m[1mPOST /api/v1/explore/form_data?tab_id=6 HTTP/1.1[0m" 201 -
2025-12-06 19:35:04,726:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1458, in dispatch_request
    self.raise_routing_exception(req)
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1440, in raise_routing_exception
    raise request.routing_exception  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/ctx.py", line 353, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/werkzeug/routing/map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-12-06 19:35:04,727:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:35:04] "[33mGET /ws HTTP/1.1[0m" 404 -
2025-12-06 19:35:08,277:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1458, in dispatch_request
    self.raise_routing_exception(req)
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1440, in raise_routing_exception
    raise request.routing_exception  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/ctx.py", line 353, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/werkzeug/routing/map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-12-06 19:35:08,280:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:35:08] "[33mGET /ws HTTP/1.1[0m" 404 -
2025-12-06 19:35:09,058:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:35:09] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-06 19:35:12,759:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1458, in dispatch_request
    self.raise_routing_exception(req)
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1440, in raise_routing_exception
    raise request.routing_exception  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/ctx.py", line 353, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/werkzeug/routing/map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-12-06 19:35:12,759:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:35:12] "[33mGET /ws HTTP/1.1[0m" 404 -
2025-12-06 19:35:12,880:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:35:12] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-06 19:35:17,186:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:35:17] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-06 19:35:22,204:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:35:22] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-06 19:35:23,253:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:35:23] "GET /static/assets/node_modules_svgr_webpack_dist_index_js_src_assets_images_icons_square_svg.492461a3.chunk.js HTTP/1.1" 200 -
2025-12-06 19:35:23,284:ERROR:superset.models.helpers:[METRICS-TRACE] Processing 2 metrics
2025-12-06 19:35:23,284:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 0: adhoc - SUM(105_EP01b_Malaria_Total)
2025-12-06 19:35:23,284:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105_EP01b_Malaria_Total)
2025-12-06 19:35:23,284:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 1: adhoc - SUM(105_EP01a_Suspected_fever)
2025-12-06 19:35:23,284:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105_EP01a_Suspected_fever)
2025-12-06 19:35:23,284:ERROR:superset.models.helpers:[METRICS-TRACE] Total metrics added: 2
2025-12-06 19:35:23,284:ERROR:superset.models.helpers:[METRICS-TRACE] Before dedup: 2 select_exprs + 2 metrics_exprs
2025-12-06 19:35:23,284:ERROR:superset.models.helpers:[METRICS-TRACE] After dedup: 4 total select_exprs
2025-12-06 19:35:23,284:INFO:superset.models.helpers:[COLUMN_TRACE] SQL Query Building:
2025-12-06 19:35:23,284:INFO:superset.models.helpers:[COLUMN_TRACE]   columns: ['OrgUnit', 'Period']
2025-12-06 19:35:23,285:INFO:superset.models.helpers:[COLUMN_TRACE]   metrics: [{'expressionType': 'SIMPLE', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01b_Malaria_Total', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 3, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'INT', 'type_generic': 0, 'uuid': '959bffaa-826b-4d13-8b7b-6d9c4ea25e50', 'verbose_name': None, 'warning_markdown': None}, 'aggregate': 'SUM', 'sqlExpression': None, 'datasourceWarning': False, 'hasCustomLabel': False, 'label': 'SUM(105_EP01b_Malaria_Total)', 'optionName': 'metric_45302laesg5_qggnouu9br'}, {'expressionType': 'SIMPLE', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01a_Suspected_fever', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 4, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'column', 'type_generic': 0, 'uuid': '530216fe-7198-4b8e-b688-a479bcf67426', 'verbose_name': None, 'warning_markdown': None}, 'aggregate': 'SUM', 'sqlExpression': None, 'datasourceWarning': False, 'hasCustomLabel': False, 'label': 'SUM(105_EP01a_Suspected_fever)', 'optionName': 'metric_k45orb1omq9_1qf1acagf2y'}]
2025-12-06 19:35:23,285:INFO:superset.models.helpers:[COLUMN_TRACE]   groupby: []
2025-12-06 19:35:23,285:INFO:superset.models.helpers:[COLUMN_TRACE]   labels_expected: ['OrgUnit', 'Period', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)']
2025-12-06 19:35:23,285:INFO:superset.models.helpers:[COLUMN_TRACE]   select_exprs count: 4
2025-12-06 19:35:23,285:INFO:superset.models.helpers:[COLUMN_TRACE]     [0] key=OrgUnit, name=OrgUnit, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-06 19:35:23,285:INFO:superset.models.helpers:[COLUMN_TRACE]     [1] key=Period, name=Period, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-06 19:35:23,285:INFO:superset.models.helpers:[COLUMN_TRACE]     [2] key=SUM(105_EP01b_Malaria_Total), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-06 19:35:23,285:INFO:superset.models.helpers:[COLUMN_TRACE]     [3] key=SUM(105_EP01a_Suspected_fever), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-06 19:35:23,285:INFO:superset.connectors.sqla.models:[DHIS2] get_from_clause for virtual dataset 1: analytics_LAST_YEAR_20251206
2025-12-06 19:35:23,285:INFO:superset.connectors.sqla.models:[DHIS2] Full SQL stored: SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
2025-12-06 19:35:23,285:INFO:superset.connectors.sqla.models:[DHIS2] Loaded params from extra field: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayPropert
2025-12-06 19:35:23,286:INFO:superset.connectors.sqla.models:[DHIS2] Cached params with key: dhis2_params_1_analytics
2025-12-06 19:35:23,286:INFO:superset.connectors.sqla.models:[DHIS2] Stored params in Flask g for DHIS2 table: analytics
2025-12-06 19:35:23,289:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Query execution in connectors/sqla/models.py:
2025-12-06 19:35:23,289:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   SQL (first 500 chars): SELECT "OrgUnit", "Period", sum("105_EP01b_Malaria_Total") AS sum_1, sum("105_EP01a_Suspected_fever") AS sum_2 
FROM (SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
) AS virtual_table GROUP BY "OrgUnit", "Period" ORDER BY sum("105_EP01b_Malaria_Total") DESC
 LIMIT 10000
2025-12-06 19:35:23,289:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   labels_expected: ['OrgUnit', 'Period', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)']
2025-12-06 19:35:23,291:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 connection initialized: https://tests.dhis2.hispuganda.org/hmis/api
2025-12-06 19:35:23,291:INFO:superset.db_engine_specs.dhis2_dialect:Executing DHIS2 query: SELECT
  "OrgUnit",
  "Period",
  SUM("105_EP01b_Malaria_Total") AS sum_1,
  SUM("105_EP01a_Suspected_fever") AS sum_2
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "OrgUnit",
  "Period"
ORDER BY
  SUM("105_EP01b_Malaria_Total") DESC
LIMIT 10000
2025-12-06 19:35:23,291:INFO:superset.db_engine_specs.dhis2_dialect:Parsed endpoint: analytics
2025-12-06 19:35:23,292:INFO:superset.db_engine_specs.dhis2_dialect:Using stored parameters from Flask g for table: analytics
2025-12-06 19:35:23,292:INFO:superset.db_engine_specs.dhis2_dialect:Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
2025-12-06 19:35:23,292:INFO:superset.db_engine_specs.dhis2_dialect:Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
2025-12-06 19:35:23,292:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API request: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
2025-12-06 19:35:24,250:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:35:24] "PUT /api/v1/explore/form_data/fTQlGTUBnOM?tab_id=6 HTTP/1.1" 200 -
2025-12-06 19:35:24,929:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:35:24] "GET /static/assets/images/favicon.png HTTP/1.1" 200 -
2025-12-06 19:35:25,277:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1458, in dispatch_request
    self.raise_routing_exception(req)
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1440, in raise_routing_exception
    raise request.routing_exception  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/ctx.py", line 353, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/werkzeug/routing/map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-12-06 19:35:25,278:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:35:25] "[33mGET /ws HTTP/1.1[0m" 404 -
2025-12-06 19:35:28,831:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1458, in dispatch_request
    self.raise_routing_exception(req)
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1440, in raise_routing_exception
    raise request.routing_exception  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/ctx.py", line 353, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/werkzeug/routing/map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-12-06 19:35:28,833:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:35:28] "[33mGET /ws HTTP/1.1[0m" 404 -
2025-12-06 19:35:58,280:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1458, in dispatch_request
    self.raise_routing_exception(req)
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1440, in raise_routing_exception
    raise request.routing_exception  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/ctx.py", line 353, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/werkzeug/routing/map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-12-06 19:35:58,282:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:35:58] "[33mGET /ws HTTP/1.1[0m" 404 -
2025-12-06 19:36:00,925:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1458, in dispatch_request
    self.raise_routing_exception(req)
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1440, in raise_routing_exception
    raise request.routing_exception  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/ctx.py", line 353, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/werkzeug/routing/map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-12-06 19:36:00,926:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:36:00] "[33mGET /ws HTTP/1.1[0m" 404 -
2025-12-06 19:36:23,330:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:36:23] "[33mGET /api/v1/chart/0 HTTP/1.1[0m" 404 -
2025-12-06 19:36:23,334:ERROR:superset.models.helpers:[METRICS-TRACE] Processing 2 metrics
2025-12-06 19:36:23,334:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 0: adhoc - SUM(105_EP01b_Malaria_Total)
2025-12-06 19:36:23,334:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105_EP01b_Malaria_Total)
2025-12-06 19:36:23,334:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 1: adhoc - SUM(105_EP01a_Suspected_fever)
2025-12-06 19:36:23,334:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105_EP01a_Suspected_fever)
2025-12-06 19:36:23,334:ERROR:superset.models.helpers:[METRICS-TRACE] Total metrics added: 2
2025-12-06 19:36:23,334:ERROR:superset.models.helpers:[METRICS-TRACE] Before dedup: 2 select_exprs + 2 metrics_exprs
2025-12-06 19:36:23,334:ERROR:superset.models.helpers:[METRICS-TRACE] After dedup: 4 total select_exprs
2025-12-06 19:36:23,334:INFO:superset.models.helpers:[COLUMN_TRACE] SQL Query Building:
2025-12-06 19:36:23,334:INFO:superset.models.helpers:[COLUMN_TRACE]   columns: ['OrgUnit', 'Period']
2025-12-06 19:36:23,334:INFO:superset.models.helpers:[COLUMN_TRACE]   metrics: [{'expressionType': 'SIMPLE', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01b_Malaria_Total', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 3, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'INT', 'type_generic': 0, 'uuid': '959bffaa-826b-4d13-8b7b-6d9c4ea25e50', 'verbose_name': None, 'warning_markdown': None}, 'aggregate': 'SUM', 'sqlExpression': None, 'datasourceWarning': False, 'hasCustomLabel': False, 'label': 'SUM(105_EP01b_Malaria_Total)', 'optionName': 'metric_45302laesg5_qggnouu9br'}, {'expressionType': 'SIMPLE', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01a_Suspected_fever', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 4, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'column', 'type_generic': 0, 'uuid': '530216fe-7198-4b8e-b688-a479bcf67426', 'verbose_name': None, 'warning_markdown': None}, 'aggregate': 'SUM', 'sqlExpression': None, 'datasourceWarning': False, 'hasCustomLabel': False, 'label': 'SUM(105_EP01a_Suspected_fever)', 'optionName': 'metric_k45orb1omq9_1qf1acagf2y'}]
2025-12-06 19:36:23,334:INFO:superset.models.helpers:[COLUMN_TRACE]   groupby: []
2025-12-06 19:36:23,334:INFO:superset.models.helpers:[COLUMN_TRACE]   labels_expected: ['OrgUnit', 'Period', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)']
2025-12-06 19:36:23,335:INFO:superset.models.helpers:[COLUMN_TRACE]   select_exprs count: 4
2025-12-06 19:36:23,335:INFO:superset.models.helpers:[COLUMN_TRACE]     [0] key=OrgUnit, name=OrgUnit, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-06 19:36:23,335:INFO:superset.models.helpers:[COLUMN_TRACE]     [1] key=Period, name=Period, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-06 19:36:23,335:INFO:superset.models.helpers:[COLUMN_TRACE]     [2] key=SUM(105_EP01b_Malaria_Total), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-06 19:36:23,335:INFO:superset.models.helpers:[COLUMN_TRACE]     [3] key=SUM(105_EP01a_Suspected_fever), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-06 19:36:23,335:INFO:superset.connectors.sqla.models:[DHIS2] get_from_clause for virtual dataset 1: analytics_LAST_YEAR_20251206
2025-12-06 19:36:23,335:INFO:superset.connectors.sqla.models:[DHIS2] Full SQL stored: SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
2025-12-06 19:36:23,335:INFO:superset.connectors.sqla.models:[DHIS2] Loaded params from extra field: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayPropert
2025-12-06 19:36:23,336:INFO:superset.connectors.sqla.models:[DHIS2] Cached params with key: dhis2_params_1_analytics
2025-12-06 19:36:23,336:INFO:superset.connectors.sqla.models:[DHIS2] Stored params in Flask g for DHIS2 table: analytics
2025-12-06 19:36:23,338:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Query execution in connectors/sqla/models.py:
2025-12-06 19:36:23,338:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   SQL (first 500 chars): SELECT "OrgUnit", "Period", sum("105_EP01b_Malaria_Total") AS sum_1, sum("105_EP01a_Suspected_fever") AS sum_2 
FROM (SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
) AS virtual_table GROUP BY "OrgUnit", "Period" ORDER BY sum("105_EP01b_Malaria_Total") DESC
 LIMIT 10000
2025-12-06 19:36:23,338:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   labels_expected: ['OrgUnit', 'Period', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)']
2025-12-06 19:36:23,339:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 connection initialized: https://tests.dhis2.hispuganda.org/hmis/api
2025-12-06 19:36:23,340:INFO:superset.db_engine_specs.dhis2_dialect:Executing DHIS2 query: SELECT
  "OrgUnit",
  "Period",
  SUM("105_EP01b_Malaria_Total") AS sum_1,
  SUM("105_EP01a_Suspected_fever") AS sum_2
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "OrgUnit",
  "Period"
ORDER BY
  SUM("105_EP01b_Malaria_Total") DESC
LIMIT 10000
2025-12-06 19:36:23,340:INFO:superset.db_engine_specs.dhis2_dialect:Parsed endpoint: analytics
2025-12-06 19:36:23,340:INFO:superset.db_engine_specs.dhis2_dialect:Using stored parameters from Flask g for table: analytics
2025-12-06 19:36:23,340:INFO:superset.db_engine_specs.dhis2_dialect:Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
2025-12-06 19:36:23,340:INFO:superset.db_engine_specs.dhis2_dialect:Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
2025-12-06 19:36:23,340:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API request: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
2025-12-06 19:36:24,279:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:36:24] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-06 19:36:25,435:ERROR:superset.db_engine_specs.dhis2_dialect:DHIS2 API request timeout
2025-12-06 19:36:25,437:WARNING:superset.connectors.sqla.models:Query SELECT "OrgUnit", "Period", sum("105_EP01b_Malaria_Total") AS sum_1, sum("105_EP01a_Suspected_fever") AS sum_2 
FROM (SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
) AS virtual_table GROUP BY "OrgUnit", "Period" ORDER BY sum("105_EP01b_Malaria_Total") DESC
 LIMIT 10000 on schema dhis2 failed
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/superset/connectors/sqla/models.py", line 1804, in query
    df = self.database.get_df(
         ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/superset/models/core.py", line 770, in get_df
    cursor, rows, description = self._execute_sql_with_mutation_and_logging(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/superset/models/core.py", line 723, in _execute_sql_with_mutation_and_logging
    self.db_engine_spec.execute(cursor, sql_, self)
  File "/Users/stephocay/projects/hispuganda/superset/superset/db_engine_specs/base.py", line 1890, in execute
    raise cls.get_dbapi_mapped_exception(ex) from ex
  File "/Users/stephocay/projects/hispuganda/superset/superset/db_engine_specs/base.py", line 1886, in execute
    cursor.execute(query)
  File "/Users/stephocay/projects/hispuganda/superset/superset/db_engine_specs/dhis2_dialect.py", line 1838, in execute
    self._rows = self._make_api_request(endpoint, api_params, query)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/superset/db_engine_specs/dhis2_dialect.py", line 1713, in _make_api_request
    raise DHIS2DBAPI.OperationalError("Request timeout")
superset.db_engine_specs.dhis2_dialect.DHIS2DBAPI.OperationalError: Request timeout
2025-12-06 19:36:25,449:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:36:25] "[31m[1mPOST /api/v1/chart/data HTTP/1.1[0m" 400 -
2025-12-06 19:36:29,306:INFO:superset.db_engine_specs.dhis2_dialect:Using wide/pivoted format for analytics
2025-12-06 19:36:29,306:INFO:superset.db_engine_specs.dhis2_dialect:normalize_analytics called with pivot=True, returning WIDE format
2025-12-06 19:36:29,307:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column construction - data_elements: ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
2025-12-06 19:36:29,307:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column names constructed (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 19:36:29,307:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] FIRST ROW CONSTRUCTION:
2025-12-06 19:36:29,307:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   Period (index 0): 2020
2025-12-06 19:36:29,307:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   OrgUnit (index 1): MOH - Uganda
2025-12-06 19:36:29,307:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01b. Malaria Total (index 2): 14479324
2025-12-06 19:36:29,307:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01a. Suspected fever (index 3): 22994823
2025-12-06 19:36:29,307:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01d. Malaria cases treated (index 4): 15266488
2025-12-06 19:36:29,307:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01c. Malaria Confirmed (B/s and RDT Positive) (index 5): 13326277
2025-12-06 19:36:29,307:INFO:superset.db_engine_specs.dhis2_dialect:First pivoted row - Period: '2020', OrgUnit: 'MOH - Uganda'
2025-12-06 19:36:29,307:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total pivoted rows: 4, columns: 6
2025-12-06 19:36:29,307:INFO:superset.db_engine_specs.dhis2_dialect:Normalized 4 rows with 6 columns for endpoint analytics
2025-12-06 19:36:29,307:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API returned 4 rows
2025-12-06 19:36:29,313:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() - Row count: 4
2025-12-06 19:36:29,313:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 19:36:29,313:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names length: 6
2025-12-06 19:36:29,313:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values count: 6
2025-12-06 19:36:29,313:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-06 19:36:29,313:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 0 (Period): 2020 -> 2020 (STRING)
2025-12-06 19:36:29,313:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (OrgUnit): MOH - Uganda -> MOH - Uganda (STRING)
2025-12-06 19:36:29,313:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (105_EP01b_Malaria_Total): 14479324 (PROCESSED)
2025-12-06 19:36:29,313:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (105_EP01a_Suspected_fever): 22994823 (PROCESSED)
2025-12-06 19:36:29,313:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (105_EP01d_Malaria_cases_treated): 15266488 (PROCESSED)
2025-12-06 19:36:29,313:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() returning 4 rows with 6 columns each
2025-12-06 19:36:29,313:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Got 4 rows from cursor
2025-12-06 19:36:29,313:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-06 19:36:29,313:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 19:36:29,313:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Types from cursor: ['String', 'String', 'String', 'String', 'String', 'String']
2025-12-06 19:36:29,318:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: DataFrame created with 4 rows, 6 columns
2025-12-06 19:36:29,319:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 19:36:29,319:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes BEFORE fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-06 19:36:29,319:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Period' to object dtype (dimension)
2025-12-06 19:36:29,320:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'OrgUnit' to object dtype (dimension)
2025-12-06 19:36:29,320:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes AFTER fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-06 19:36:29,320:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: First row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-06 19:36:29,326:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] BEFORE assign_column_label:
2025-12-06 19:36:29,326:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 6)
2025-12-06 19:36:29,326:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 19:36:29,326:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['OrgUnit', 'Period', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)']
2025-12-06 19:36:29,326:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: False
2025-12-06 19:36:29,326:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-06 19:36:29,326:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Column truncation needed: df has 6 columns, expected 4
2025-12-06 19:36:29,326:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   DataFrame actual columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 19:36:29,326:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Expected columns: ['OrgUnit', 'Period', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)']
2025-12-06 19:36:29,326:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] âœ“ Selecting columns BY NAME (matched all expected columns)
2025-12-06 19:36:29,326:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Column mapping: {'OrgUnit': 'OrgUnit', 'Period': 'Period', 'SUM(105_EP01b_Malaria_Total)': '105_EP01b_Malaria_Total', 'SUM(105_EP01a_Suspected_fever)': '105_EP01a_Suspected_fever'}
2025-12-06 19:36:29,327:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] Column Selection âœ“ SUCCESS - method=BY_NAME, datasource=analytics_LAST_YEAR_20251206
2025-12-06 19:36:29,327:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['OrgUnit', 'Period', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)']
2025-12-06 19:36:29,327:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   tried_by_name=True, success=True, fallback=False
2025-12-06 19:36:29,327:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Assigning column labels: ['OrgUnit', 'Period', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)']
2025-12-06 19:36:29,327:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] AFTER assign_column_label:
2025-12-06 19:36:29,327:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 4)
2025-12-06 19:36:29,327:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['OrgUnit', 'Period', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)']
2025-12-06 19:36:29,327:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['OrgUnit', 'Period', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)']
2025-12-06 19:36:29,327:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: True
2025-12-06 19:36:29,327:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'OrgUnit': 'MOH - Uganda', 'Period': '2020', 'SUM(105_EP01b_Malaria_Total)': 14479324, 'SUM(105_EP01a_Suspected_fever)': 22994823}
2025-12-06 19:36:29,340:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:36:29] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-06 19:36:35,244:ERROR:superset.models.helpers:[METRICS-TRACE] Processing 2 metrics
2025-12-06 19:36:35,245:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 0: adhoc - SUM(105_EP01b_Malaria_Total)
2025-12-06 19:36:35,245:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105_EP01b_Malaria_Total)
2025-12-06 19:36:35,246:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 1: adhoc - SUM(105_EP01a_Suspected_fever)
2025-12-06 19:36:35,246:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105_EP01a_Suspected_fever)
2025-12-06 19:36:35,246:ERROR:superset.models.helpers:[METRICS-TRACE] Total metrics added: 2
2025-12-06 19:36:35,247:ERROR:superset.models.helpers:[METRICS-TRACE] Before dedup: 2 select_exprs + 2 metrics_exprs
2025-12-06 19:36:35,247:ERROR:superset.models.helpers:[METRICS-TRACE] After dedup: 4 total select_exprs
2025-12-06 19:36:35,247:INFO:superset.models.helpers:[COLUMN_TRACE] SQL Query Building:
2025-12-06 19:36:35,247:INFO:superset.models.helpers:[COLUMN_TRACE]   columns: ['OrgUnit', 'Period']
2025-12-06 19:36:35,247:INFO:superset.models.helpers:[COLUMN_TRACE]   metrics: [{'expressionType': 'SIMPLE', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01b_Malaria_Total', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 3, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'INT', 'type_generic': 0, 'uuid': '959bffaa-826b-4d13-8b7b-6d9c4ea25e50', 'verbose_name': None, 'warning_markdown': None}, 'aggregate': 'SUM', 'sqlExpression': None, 'datasourceWarning': False, 'hasCustomLabel': False, 'label': 'SUM(105_EP01b_Malaria_Total)', 'optionName': 'metric_45302laesg5_qggnouu9br'}, {'expressionType': 'SIMPLE', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01a_Suspected_fever', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 4, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'column', 'type_generic': 0, 'uuid': '530216fe-7198-4b8e-b688-a479bcf67426', 'verbose_name': None, 'warning_markdown': None}, 'aggregate': 'SUM', 'sqlExpression': None, 'datasourceWarning': False, 'hasCustomLabel': False, 'label': 'SUM(105_EP01a_Suspected_fever)', 'optionName': 'metric_k45orb1omq9_1qf1acagf2y'}]
2025-12-06 19:36:35,247:INFO:superset.models.helpers:[COLUMN_TRACE]   groupby: []
2025-12-06 19:36:35,247:INFO:superset.models.helpers:[COLUMN_TRACE]   labels_expected: ['OrgUnit', 'Period', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)']
2025-12-06 19:36:35,247:INFO:superset.models.helpers:[COLUMN_TRACE]   select_exprs count: 4
2025-12-06 19:36:35,247:INFO:superset.models.helpers:[COLUMN_TRACE]     [0] key=OrgUnit, name=OrgUnit, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-06 19:36:35,247:INFO:superset.models.helpers:[COLUMN_TRACE]     [1] key=Period, name=Period, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-06 19:36:35,247:INFO:superset.models.helpers:[COLUMN_TRACE]     [2] key=SUM(105_EP01b_Malaria_Total), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-06 19:36:35,247:INFO:superset.models.helpers:[COLUMN_TRACE]     [3] key=SUM(105_EP01a_Suspected_fever), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-06 19:36:35,247:INFO:superset.connectors.sqla.models:[DHIS2] get_from_clause for virtual dataset 1: analytics_LAST_YEAR_20251206
2025-12-06 19:36:35,247:INFO:superset.connectors.sqla.models:[DHIS2] Full SQL stored: SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
2025-12-06 19:36:35,247:INFO:superset.connectors.sqla.models:[DHIS2] Loaded params from extra field: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayPropert
2025-12-06 19:36:35,248:INFO:superset.connectors.sqla.models:[DHIS2] Cached params with key: dhis2_params_1_analytics
2025-12-06 19:36:35,248:INFO:superset.connectors.sqla.models:[DHIS2] Stored params in Flask g for DHIS2 table: analytics
2025-12-06 19:36:35,251:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Query execution in connectors/sqla/models.py:
2025-12-06 19:36:35,251:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   SQL (first 500 chars): SELECT "OrgUnit", "Period", sum("105_EP01b_Malaria_Total") AS sum_1, sum("105_EP01a_Suspected_fever") AS sum_2 
FROM (SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
) AS virtual_table GROUP BY "OrgUnit", "Period" ORDER BY sum("105_EP01b_Malaria_Total") DESC
 LIMIT 10000
2025-12-06 19:36:35,251:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   labels_expected: ['OrgUnit', 'Period', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)']
2025-12-06 19:36:35,253:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 connection initialized: https://tests.dhis2.hispuganda.org/hmis/api
2025-12-06 19:36:35,253:INFO:superset.db_engine_specs.dhis2_dialect:Executing DHIS2 query: SELECT
  "OrgUnit",
  "Period",
  SUM("105_EP01b_Malaria_Total") AS sum_1,
  SUM("105_EP01a_Suspected_fever") AS sum_2
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "OrgUnit",
  "Period"
ORDER BY
  SUM("105_EP01b_Malaria_Total") DESC
LIMIT 10000
2025-12-06 19:36:35,253:INFO:superset.db_engine_specs.dhis2_dialect:Parsed endpoint: analytics
2025-12-06 19:36:35,254:INFO:superset.db_engine_specs.dhis2_dialect:Using stored parameters from Flask g for table: analytics
2025-12-06 19:36:35,254:INFO:superset.db_engine_specs.dhis2_dialect:Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
2025-12-06 19:36:35,254:INFO:superset.db_engine_specs.dhis2_dialect:Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
2025-12-06 19:36:35,254:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API request: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
2025-12-06 19:36:35,258:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:36:35] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-06 19:36:36,183:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:36:36] "PUT /api/v1/explore/form_data/fTQlGTUBnOM?tab_id=6 HTTP/1.1" 200 -
2025-12-06 19:36:38,517:INFO:superset.db_engine_specs.dhis2_dialect:Using wide/pivoted format for analytics
2025-12-06 19:36:38,517:INFO:superset.db_engine_specs.dhis2_dialect:normalize_analytics called with pivot=True, returning WIDE format
2025-12-06 19:36:38,517:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column construction - data_elements: ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
2025-12-06 19:36:38,517:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column names constructed (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 19:36:38,517:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] FIRST ROW CONSTRUCTION:
2025-12-06 19:36:38,517:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   Period (index 0): 2020
2025-12-06 19:36:38,517:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   OrgUnit (index 1): MOH - Uganda
2025-12-06 19:36:38,517:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01b. Malaria Total (index 2): 14479324
2025-12-06 19:36:38,517:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01a. Suspected fever (index 3): 22994823
2025-12-06 19:36:38,517:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01d. Malaria cases treated (index 4): 15266488
2025-12-06 19:36:38,517:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01c. Malaria Confirmed (B/s and RDT Positive) (index 5): 13326277
2025-12-06 19:36:38,517:INFO:superset.db_engine_specs.dhis2_dialect:First pivoted row - Period: '2020', OrgUnit: 'MOH - Uganda'
2025-12-06 19:36:38,517:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total pivoted rows: 4, columns: 6
[DHIS2] Executing query: SELECT
  "OrgUnit",
  "Period",
  SUM("105_EP01b_Malaria_Total") AS sum_1,
  SUM("105_EP01a_Suspected_fever") AS sum_2
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "OrgUnit",
  "Period"
ORDER BY
  SUM("105_EP01b_Malaria_Total") DESC
LIMIT 10000
[DHIS2] Parsed endpoint: analytics
[DHIS2] Found params in Flask g for analytics: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;
[DHIS2] Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
[DHIS2] Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
[DHIS2] API request URL: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
[DHIS2] Executing query: SELECT
  "OrgUnit",
  "Period",
  SUM("105_EP01b_Malaria_Total") AS sum_1,
  SUM("105_EP01a_Suspected_fever") AS sum_2
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "OrgUnit",
  "Period"
ORDER BY
  SUM("105_EP01b_Malaria_Total") DESC
LIMIT 10000
[DHIS2] Parsed endpoint: analytics
[DHIS2] Found params in Flask g for analytics: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;
[DHIS2] Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
[DHIS2] Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
[DHIS2] API request URL: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
[DHIS2] Raw API response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Raw DHIS2 rows count: 16
[DHIS2] First raw row: ['QHnwKs2OUZv', '2020', 'akV6429SUqu', '15266488']
[DHIS2] Parsing response for endpoint: analytics
[DHIS2] Response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Response sample: {'headers': [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}], 'metaDat
[DHIS2] Using WIDE/PIVOTED format (Period, OrgUnit, DX1, DX2, ...) for analytics
[DHIS2] normalize_analytics: pivot=True, using WIDE/PIVOTED format
[DHIS2] PIVOT CONSTRUCTION:
[DHIS2]   data_elements (UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   data_element_list (sorted UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   col_names (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized row count: 4
[DHIS2] First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] _set_description: columns=['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], types=['String', 'String', 'String', 'String', 'String', 'String']
[DHIS2] Transformed rows count: 4
[DHIS2] First transformed row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] Fetched 4 rows
[DHIS2] fetchall() called - returning 4 rows
[DHIS2] fetchall() - First row type: <class 'tuple'>
[DHIS2] fetchall() - First row (original): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Column count from description: 6
[DHIS2] fetchall() - First row (fixed types): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Type enforcement: dimensions=STRING, measures=FLOAT
[DHIS2] Executing query: SELECT
  "OrgUnit",
  "Period",
  SUM("105_EP01b_Malaria_Total") AS sum_1,
  SUM("105_EP01a_Suspected_fever") AS sum_2
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "OrgUnit",
  "Period"
ORDER BY
  SUM("105_EP01b_Malaria_Total") DESC
LIMIT 10000
[DHIS2] Parsed endpoint: analytics
[DHIS2] Found params in Flask g for analytics: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;
[DHIS2] Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
[DHIS2] Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
[DHIS2] API request URL: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
[DHIS2] Raw API response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Raw DHIS2 rows count: 16
[DHIS2] First raw row: ['QHnwKs2OUZv', '2020', 'akV6429SUqu', '15266488']
[DHIS2] Parsing response for endpoint: analytics
[DHIS2] Response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Response sample: {'headers': [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}], 'metaDat
[DHIS2] Using WIDE/PIVOTED format (Period, OrgUnit, DX1, DX2, ...) for analytics
[DHIS2] normalize_analytics: pivot=True, using WIDE/PIVOTED format
[DHIS2] PIVOT CONSTRUCTION:
[DHIS2]   data_elements (UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   data_element_list (sorted UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   col_names (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized row count: 4
[DHIS2] First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] _set_description: columns=['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], types=['String', 'String', 'String', 'String', 'String', 'String']2025-12-06 19:36:38,517:INFO:superset.db_engine_specs.dhis2_dialect:Normalized 4 rows with 6 columns for endpoint analytics
2025-12-06 19:36:38,517:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API returned 4 rows
2025-12-06 19:36:38,523:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() - Row count: 4
2025-12-06 19:36:38,523:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 19:36:38,523:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names length: 6
2025-12-06 19:36:38,523:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values count: 6
2025-12-06 19:36:38,523:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-06 19:36:38,523:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 0 (Period): 2020 -> 2020 (STRING)
2025-12-06 19:36:38,523:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (OrgUnit): MOH - Uganda -> MOH - Uganda (STRING)
2025-12-06 19:36:38,523:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (105_EP01b_Malaria_Total): 14479324 (PROCESSED)
2025-12-06 19:36:38,523:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (105_EP01a_Suspected_fever): 22994823 (PROCESSED)
2025-12-06 19:36:38,523:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (105_EP01d_Malaria_cases_treated): 15266488 (PROCESSED)
2025-12-06 19:36:38,523:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() returning 4 rows with 6 columns each
2025-12-06 19:36:38,523:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Got 4 rows from cursor
2025-12-06 19:36:38,523:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-06 19:36:38,523:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 19:36:38,523:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Types from cursor: ['String', 'String', 'String', 'String', 'String', 'String']
2025-12-06 19:36:38,524:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: DataFrame created with 4 rows, 6 columns
2025-12-06 19:36:38,524:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 19:36:38,524:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes BEFORE fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-06 19:36:38,525:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Period' to object dtype (dimension)
2025-12-06 19:36:38,525:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'OrgUnit' to object dtype (dimension)
2025-12-06 19:36:38,525:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes AFTER fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-06 19:36:38,525:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: First row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-06 19:36:38,529:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] BEFORE assign_column_label:
2025-12-06 19:36:38,530:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 6)
2025-12-06 19:36:38,530:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 19:36:38,530:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['OrgUnit', 'Period', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)']
2025-12-06 19:36:38,530:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: False
2025-12-06 19:36:38,530:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-06 19:36:38,530:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Column truncation needed: df has 6 columns, expected 4
2025-12-06 19:36:38,530:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   DataFrame actual columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 19:36:38,530:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Expected columns: ['OrgUnit', 'Period', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)']
2025-12-06 19:36:38,530:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] âœ“ Selecting columns BY NAME (matched all expected columns)
2025-12-06 19:36:38,530:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Column mapping: {'OrgUnit': 'OrgUnit', 'Period': 'Period', 'SUM(105_EP01b_Malaria_Total)': '105_EP01b_Malaria_Total', 'SUM(105_EP01a_Suspected_fever)': '105_EP01a_Suspected_fever'}
2025-12-06 19:36:38,530:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] Column Selection âœ“ SUCCESS - method=BY_NAME, datasource=analytics_LAST_YEAR_20251206
2025-12-06 19:36:38,530:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['OrgUnit', 'Period', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)']
2025-12-06 19:36:38,530:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   tried_by_name=True, success=True, fallback=False
2025-12-06 19:36:38,530:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Assigning column labels: ['OrgUnit', 'Period', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)']
2025-12-06 19:36:38,531:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] AFTER assign_column_label:
2025-12-06 19:36:38,531:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 4)
2025-12-06 19:36:38,531:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['OrgUnit', 'Period', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)']
2025-12-06 19:36:38,531:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['OrgUnit', 'Period', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)']
2025-12-06 19:36:38,531:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: True
2025-12-06 19:36:38,531:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'OrgUnit': 'MOH - Uganda', 'Period': '2020', 'SUM(105_EP01b_Malaria_Total)': 14479324, 'SUM(105_EP01a_Suspected_fever)': 22994823}
2025-12-06 19:36:38,545:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:36:38] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-06 19:36:38,575:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:36:38] "GET /static/assets/plugins_plugin-chart-table_src_TableChart_tsx.6305cc9d.chunk.js HTTP/1.1" 200 -
2025-12-06 19:36:39,561:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:36:39] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-06 19:36:59,156:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:36:59] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-06 19:37:03,277:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1458, in dispatch_request
    self.raise_routing_exception(req)
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1440, in raise_routing_exception
    raise request.routing_exception  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/ctx.py", line 353, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/werkzeug/routing/map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-12-06 19:37:03,278:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:37:03] "[33mGET /ws HTTP/1.1[0m" 404 -
2025-12-06 19:37:05,010:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1458, in dispatch_request
    self.raise_routing_exception(req)
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1440, in raise_routing_exception
    raise request.routing_exception  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/ctx.py", line 353, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/werkzeug/routing/map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-12-06 19:37:05,011:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:37:05] "[33mGET /ws HTTP/1.1[0m" 404 -
2025-12-06 19:37:09,792:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:37:09] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-06 19:37:12,477:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:37:12] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-06 19:37:15,319:ERROR:superset.models.helpers:[METRICS-TRACE] Processing 2 metrics
2025-12-06 19:37:15,319:ERROR:superset.models.helpers:[METRICS-TRACE] Processing 2 metrics
2025-12-06 19:37:15,319:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 0: adhoc - SUM(105_EP01b_Malaria_Total)
2025-12-06 19:37:15,319:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 0: adhoc - SUM(105_EP01b_Malaria_Total)
2025-12-06 19:37:15,320:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105_EP01b_Malaria_Total)
2025-12-06 19:37:15,320:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105_EP01b_Malaria_Total)
2025-12-06 19:37:15,320:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 1: adhoc - SUM(105_EP01a_Suspected_fever)
2025-12-06 19:37:15,320:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 1: adhoc - SUM(105_EP01a_Suspected_fever)
2025-12-06 19:37:15,320:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105_EP01a_Suspected_fever)
2025-12-06 19:37:15,320:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105_EP01a_Suspected_fever)
2025-12-06 19:37:15,320:ERROR:superset.models.helpers:[METRICS-TRACE] Total metrics added: 2
2025-12-06 19:37:15,320:ERROR:superset.models.helpers:[METRICS-TRACE] Total metrics added: 2
2025-12-06 19:37:15,326:ERROR:superset.models.helpers:[METRICS-TRACE] Before dedup: 2 select_exprs + 2 metrics_exprs
2025-12-06 19:37:15,326:ERROR:superset.models.helpers:[METRICS-TRACE] Before dedup: 2 select_exprs + 2 metrics_exprs
2025-12-06 19:37:15,326:ERROR:superset.models.helpers:[METRICS-TRACE] After dedup: 4 total select_exprs
2025-12-06 19:37:15,327:ERROR:superset.models.helpers:[METRICS-TRACE] After dedup: 4 total select_exprs
2025-12-06 19:37:15,327:INFO:superset.models.helpers:[COLUMN_TRACE] SQL Query Building:
2025-12-06 19:37:15,327:INFO:superset.models.helpers:[COLUMN_TRACE] SQL Query Building:
2025-12-06 19:37:15,327:INFO:superset.models.helpers:[COLUMN_TRACE]   columns: [{'columnType': 'BASE_AXIS', 'sqlExpression': 'OrgUnit', 'label': 'OrgUnit', 'expressionType': 'SQL'}, 'Period']
2025-12-06 19:37:15,327:INFO:superset.models.helpers:[COLUMN_TRACE]   columns: [{'columnType': 'BASE_AXIS', 'sqlExpression': 'OrgUnit', 'label': 'OrgUnit', 'expressionType': 'SQL'}, 'Period']
2025-12-06 19:37:15,327:INFO:superset.models.helpers:[COLUMN_TRACE]   metrics: [{'expressionType': 'SIMPLE', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01b_Malaria_Total', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 3, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'INT', 'type_generic': 0, 'uuid': '959bffaa-826b-4d13-8b7b-6d9c4ea25e50', 'verbose_name': None, 'warning_markdown': None}, 'aggregate': 'SUM', 'sqlExpression': None, 'datasourceWarning': False, 'hasCustomLabel': False, 'label': 'SUM(105_EP01b_Malaria_Total)', 'optionName': 'metric_45302laesg5_qggnouu9br'}, {'expressionType': 'SIMPLE', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01a_Suspected_fever', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 4, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'column', 'type_generic': 0, 'uuid': '530216fe-7198-4b8e-b688-a479bcf67426', 'verbose_name': None, 'warning_markdown': None}, 'aggregate': 'SUM', 'sqlExpression': None, 'datasourceWarning': False, 'hasCustomLabel': False, 'label': 'SUM(105_EP01a_Suspected_fever)', 'optionName': 'metric_k45orb1omq9_1qf1acagf2y'}]
2025-12-06 19:37:15,327:INFO:superset.models.helpers:[COLUMN_TRACE]   metrics: [{'expressionType': 'SIMPLE', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01b_Malaria_Total', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 3, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'INT', 'type_generic': 0, 'uuid': '959bffaa-826b-4d13-8b7b-6d9c4ea25e50', 'verbose_name': None, 'warning_markdown': None}, 'aggregate': 'SUM', 'sqlExpression': None, 'datasourceWarning': False, 'hasCustomLabel': False, 'label': 'SUM(105_EP01b_Malaria_Total)', 'optionName': 'metric_45302laesg5_qggnouu9br'}, {'expressionType': 'SIMPLE', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01a_Suspected_fever', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 4, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'column', 'type_generic': 0, 'uuid': '530216fe-7198-4b8e-b688-a479bcf67426', 'verbose_name': None, 'warning_markdown': None}, 'aggregate': 'SUM', 'sqlExpression': None, 'datasourceWarning': False, 'hasCustomLabel': False, 'label': 'SUM(105_EP01a_Suspected_fever)', 'optionName': 'metric_k45orb1omq9_1qf1acagf2y'}]
2025-12-06 19:37:15,327:INFO:superset.models.helpers:[COLUMN_TRACE]   groupby: []
2025-12-06 19:37:15,327:INFO:superset.models.helpers:[COLUMN_TRACE]   groupby: []
2025-12-06 19:37:15,327:INFO:superset.models.helpers:[COLUMN_TRACE]   labels_expected: ['OrgUnit', 'Period', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)']
2025-12-06 19:37:15,327:INFO:superset.models.helpers:[COLUMN_TRACE]   labels_expected: ['OrgUnit', 'Period', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)']
2025-12-06 19:37:15,327:INFO:superset.models.helpers:[COLUMN_TRACE]   select_exprs count: 4
2025-12-06 19:37:15,327:INFO:superset.models.helpers:[COLUMN_TRACE]   select_exprs count: 4
2025-12-06 19:37:15,327:INFO:superset.models.helpers:[COLUMN_TRACE]     [0] key=OrgUnit, name=OrgUnit, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-06 19:37:15,328:INFO:superset.models.helpers:[COLUMN_TRACE]     [0] key=OrgUnit, name=OrgUnit, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-06 19:37:15,328:INFO:superset.models.helpers:[COLUMN_TRACE]     [1] key=Period, name=Period, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-06 19:37:15,328:INFO:superset.models.helpers:[COLUMN_TRACE]     [1] key=Period, name=Period, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-06 19:37:15,328:INFO:superset.models.helpers:[COLUMN_TRACE]     [2] key=SUM(105_EP01b_Malaria_Total), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-06 19:37:15,328:INFO:superset.models.helpers:[COLUMN_TRACE]     [2] key=SUM(105_EP01b_Malaria_Total), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-06 19:37:15,328:INFO:superset.models.helpers:[COLUMN_TRACE]     [3] key=SUM(105_EP01a_Suspected_fever), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-06 19:37:15,328:INFO:superset.models.helpers:[COLUMN_TRACE]     [3] key=SUM(105_EP01a_Suspected_fever), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-06 19:37:15,328:INFO:superset.connectors.sqla.models:[DHIS2] get_from_clause for virtual dataset 1: analytics_LAST_YEAR_20251206
2025-12-06 19:37:15,328:INFO:superset.connectors.sqla.models:[DHIS2] get_from_clause for virtual dataset 1: analytics_LAST_YEAR_20251206
2025-12-06 19:37:15,328:INFO:superset.connectors.sqla.models:[DHIS2] Full SQL stored: SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
2025-12-06 19:37:15,328:INFO:superset.connectors.sqla.models:[DHIS2] Full SQL stored: SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
2025-12-06 19:37:15,328:INFO:superset.connectors.sqla.models:[DHIS2] Loaded params from extra field: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayPropert
2025-12-06 19:37:15,328:INFO:superset.connectors.sqla.models:[DHIS2] Loaded params from extra field: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayPropert
2025-12-06 19:37:15,330:INFO:superset.connectors.sqla.models:[DHIS2] Cached params with key: dhis2_params_1_analytics
2025-12-06 19:37:15,330:INFO:superset.connectors.sqla.models:[DHIS2] Stored params in Flask g for DHIS2 table: analytics
2025-12-06 19:37:15,331:INFO:superset.connectors.sqla.models:[DHIS2] Cached params with key: dhis2_params_1_analytics
2025-12-06 19:37:15,332:INFO:superset.connectors.sqla.models:[DHIS2] Stored params in Flask g for DHIS2 table: analytics
2025-12-06 19:37:15,332:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Query execution in connectors/sqla/models.py:
2025-12-06 19:37:15,334:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   SQL (first 500 chars): SELECT "OrgUnit", "Period", sum("105_EP01b_Malaria_Total") AS sum_1, sum("105_EP01a_Suspected_fever") AS sum_2 
FROM (SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
) AS virtual_table GROUP BY "OrgUnit", "Period" ORDER BY sum("105_EP01b_Malaria_Total") DESC
 LIMIT 10000
2025-12-06 19:37:15,334:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Query execution in connectors/sqla/models.py:
2025-12-06 19:37:15,334:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   labels_expected: ['OrgUnit', 'Period', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)']
2025-12-06 19:37:15,334:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   SQL (first 500 chars): SELECT "OrgUnit", "Period", sum("105_EP01b_Malaria_Total") AS sum_1, sum("105_EP01a_Suspected_fever") AS sum_2 
FROM (SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
) AS virtual_table GROUP BY "OrgUnit", "Period" ORDER BY sum("105_EP01b_Malaria_Total") DESC
 LIMIT 10000
2025-12-06 19:37:15,335:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   labels_expected: ['OrgUnit', 'Period', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)']
2025-12-06 19:37:15,337:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 connection initialized: https://tests.dhis2.hispuganda.org/hmis/api
2025-12-06 19:37:15,338:INFO:superset.db_engine_specs.dhis2_dialect:Executing DHIS2 query: SELECT
  "OrgUnit",
  "Period",
  SUM("105_EP01b_Malaria_Total") AS sum_1,
  SUM("105_EP01a_Suspected_fever") AS sum_2
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "OrgUnit",
  "Period"
ORDER BY
  SUM("105_EP01b_Malaria_Total") DESC
LIMIT 10000
2025-12-06 19:37:15,338:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 connection initialized: https://tests.dhis2.hispuganda.org/hmis/api
2025-12-06 19:37:15,338:INFO:superset.db_engine_specs.dhis2_dialect:Parsed endpoint: analytics
2025-12-06 19:37:15,338:INFO:superset.db_engine_specs.dhis2_dialect:Executing DHIS2 query: SELECT
  "OrgUnit",
  "Period",
  SUM("105_EP01b_Malaria_Total") AS sum_1,
  SUM("105_EP01a_Suspected_fever") AS sum_2
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "OrgUnit",
  "Period"
ORDER BY
  SUM("105_EP01b_Malaria_Total") DESC
LIMIT 10000
2025-12-06 19:37:15,338:INFO:superset.db_engine_specs.dhis2_dialect:Using stored parameters from Flask g for table: analytics
2025-12-06 19:37:15,338:INFO:superset.db_engine_specs.dhis2_dialect:Parsed endpoint: analytics
2025-12-06 19:37:15,338:INFO:superset.db_engine_specs.dhis2_dialect:Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
2025-12-06 19:37:15,338:INFO:superset.db_engine_specs.dhis2_dialect:Using stored parameters from Flask g for table: analytics
2025-12-06 19:37:15,338:INFO:superset.db_engine_specs.dhis2_dialect:Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
2025-12-06 19:37:15,338:INFO:superset.db_engine_specs.dhis2_dialect:Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
2025-12-06 19:37:15,338:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API request: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
2025-12-06 19:37:15,339:INFO:superset.db_engine_specs.dhis2_dialect:Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
2025-12-06 19:37:15,339:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API request: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
2025-12-06 19:37:16,256:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:37:16] "PUT /api/v1/explore/form_data/fTQlGTUBnOM?tab_id=6 HTTP/1.1" 200 -
2025-12-06 19:37:18,837:INFO:superset.db_engine_specs.dhis2_dialect:Using wide/pivoted format for analytics
2025-12-06 19:37:18,838:INFO:superset.db_engine_specs.dhis2_dialect:normalize_analytics called with pivot=True, returning WIDE format
2025-12-06 19:37:18,838:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column construction - data_elements: ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
2025-12-06 19:37:18,838:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column names constructed (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 19:37:18,838:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] FIRST ROW CONSTRUCTION:
2025-12-06 19:37:18,838:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   Period (index 0): 2020
2025-12-06 19:37:18,838:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   OrgUnit (index 1): MOH - Uganda
2025-12-06 19:37:18,838:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01b. Malaria Total (index 2): 14479324
2025-12-06 19:37:18,838:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01a. Suspected fever (index 3): 22994823
2025-12-06 19:37:18,838:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01d. Malaria cases treated (index 4): 15266488
2025-12-06 19:37:18,838:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01c. Malaria Confirmed (B/s and RDT Positive) (index 5): 13326277
2025-12-06 19:37:18,838:INFO:superset.db_engine_specs.dhis2_dialect:First pivoted row - Period: '2020', OrgUnit: 'MOH - Uganda'
2025-12-06 19:37:18,838:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total pivoted rows: 4, columns: 6
2025-12-06 19:37:18,838:INFO:superset.db_engine_specs.dhis2_dialect:Normalized 4 rows with 6 columns for endpoint analytics
2025-12-06 19:37:18,838:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API returned 4 rows
2025-12-06 19:37:18,843:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() - Row count: 4
2025-12-06 19:37:18,843:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 19:37:18,843:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names length: 6
2025-12-06 19:37:18,843:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values count: 6
2025-12-06 19:37:18,843:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-06 19:37:18,843:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 0 (Period): 2020 -> 2020 (STRING)
2025-12-06 19:37:18,843:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (OrgUnit): MOH - Uganda -> MOH - Uganda (STRING)
2025-12-06 19:37:18,843:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (105_EP01b_Malaria_Total): 14479324 (PROCESSED)
2025-12-06 19:37:18,843:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (105_EP01a_Suspected_fever): 22994823 (PROCESSED)
2025-12-06 19:37:18,843:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (105_EP01d_Malaria_cases_treated): 15266488 (PROCESSED)
2025-12-06 19:37:18,843:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() returning 4 rows with 6 columns each
2025-12-06 19:37:18,843:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Got 4 rows from cursor
2025-12-06 19:37:18,843:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-06 19:37:18,843:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 19:37:18,843:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Types from cursor: ['String', 'String', 'String', 'String', 'String', 'String']
2025-12-06 19:37:18,845:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: DataFrame created with 4 rows, 6 columns
2025-12-06 19:37:18,845:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 19:37:18,845:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes BEFORE fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-06 19:37:18,846:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Period' to object dtype (dimension)
2025-12-06 19:37:18,846:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'OrgUnit' to object dtype (dimension)
2025-12-06 19:37:18,846:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes AFTER fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-06 19:37:18,846:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: First row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-06 19:37:18,849:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] BEFORE assign_column_label:
2025-12-06 19:37:18,849:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 6)
2025-12-06 19:37:18,849:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 19:37:18,849:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['OrgUnit', 'Period', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)']
2025-12-06 19:37:18,849:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: False
2025-12-06 19:37:18,849:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-06 19:37:18,849:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Column truncation needed: df has 6 columns, expected 4
2025-12-06 19:37:18,849:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   DataFrame actual columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 19:37:18,849:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Expected columns: ['OrgUnit', 'Period', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)']
2025-12-06 19:37:18,849:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] âœ“ Selecting columns BY NAME (matched all expected columns)
2025-12-06 19:37:18,849:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Column mapping: {'OrgUnit': 'OrgUnit', 'Period': 'Period', 'SUM(105_EP01b_Malaria_Total)': '105_EP01b_Malaria_Total', 'SUM(105_EP01a_Suspected_fever)': '105_EP01a_Suspected_fever'}
2025-12-06 19:37:18,849:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] Column Selection âœ“ SUCCESS - method=BY_NAME, datasource=analytics_LAST_YEAR_20251206
2025-12-06 19:37:18,849:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['OrgUnit', 'Period', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)']
2025-12-06 19:37:18,849:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   tried_by_name=True, success=True, fallback=False
2025-12-06 19:37:18,849:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Assigning column labels: ['OrgUnit', 'Period', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)']
2025-12-06 19:37:18,850:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] AFTER assign_column_label:
2025-12-06 19:37:18,850:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 4)
2025-12-06 19:37:18,850:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['OrgUnit', 'Period', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)']
2025-12-06 19:37:18,850:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['OrgUnit', 'Period', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)']
2025-12-06 19:37:18,850:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: True
2025-12-06 19:37:18,850:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'OrgUnit': 'MOH - Uganda', 'Period': '2020', 'SUM(105_EP01b_Malaria_Total)': 14479324, 'SUM(105_EP01a_Suspected_fever)': 22994823}
2025-12-06 19:37:18,851:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] DataFrame columns: ['OrgUnit', 'Period', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)']
2025-12-06 19:37:18,851:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Aggregates: {'SUM(105_EP01b_Malaria_Total)': {'operator': 'mean'}, 'SUM(105_EP01a_Suspected_fever)': {'operator': 'mean'}}
2025-12-06 19:37:18,851:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105_EP01b_Malaria_Total)', column='SUM(105_EP01b_Malaria_Total)'
2025-12-06 19:37:18,851:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105_EP01a_Suspected_fever)', column='SUM(105_EP01a_Suspected_fever)'
2025-12-06 19:37:18,873:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:37:18] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-06 19:37:18,893:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:37:18] "GET /static/assets/node_modules_buffer_index_js-plugins_plugin-chart-echarts_src_Timeseries_EchartsTimeseries_tsx.48a43cac.chunk.js HTTP/1.1" 200 -
2025-12-06 19:37:19,914:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:37:19] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-06 19:37:23,187:INFO:superset.db_engine_specs.dhis2_dialect:Using wide/pivoted format for analytics
2025-12-06 19:37:23,187:INFO:superset.db_engine_specs.dhis2_dialect:normalize_analytics called with pivot=True, returning WIDE format
2025-12-06 19:37:23,187:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column construction - data_elements: ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
2025-12-06 19:37:23,187:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column names constructed (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 19:37:23,187:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] FIRST ROW CONSTRUCTION:
2025-12-06 19:37:23,187:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   Period (index 0): 2020
2025-12-06 19:37:23,187:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   OrgUnit (index 1): MOH - Uganda
2025-12-06 19:37:23,187:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01b. Malaria Total (index 2): 14479324
2025-12-06 19:37:23,188:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01a. Suspected fever (index 3): 22994823
2025-12-06 19:37:23,188:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01d. Malaria cases treated (index 4): 15266488
2025-12-06 19:37:23,188:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01c. Malaria Confirmed (B/s and RDT Positive) (index 5): 13326277
2025-12-06 19:37:23,188:INFO:superset.db_engine_specs.dhis2_dialect:First pivoted row - Period: '2020', OrgUnit: 'MOH - Uganda'
2025-12-06 19:37:23,188:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total pivoted rows: 4, columns: 6
2025-12-06 19:37:23,188:INFO:superset.db_engine_specs.dhis2_dialect:Normalized 4 rows with 6 columns for endpoint analytics
2025-12-06 19:37:23,188:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API returned 4 rows
2025-12-06 19:37:23,201:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() - Row count: 4
2025-12-06 19:37:23,201:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 19:37:23,201:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names length: 6
2025-12-06 19:37:23,201:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values count: 6
2025-12-06 19:37:23,201:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-06 19:37:23,201:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 0 (Period): 2020 -> 2020 (STRING)
2025-12-06 19:37:23,201:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (OrgUnit): MOH - Uganda -> MOH - Uganda (STRING)
2025-12-06 19:37:23,201:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (105_EP01b_Malaria_Total): 14479324 (PROCESSED)
2025-12-06 19:37:23,202:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (105_EP01a_Suspected_fever): 22994823 (PROCESSED)
2025-12-06 19:37:23,202:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (105_EP01d_Malaria_cases_treated): 15266488 (PROCESSED)

[DHIS2] Transformed rows count: 4
[DHIS2] First transformed row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] Fetched 4 rows
[DHIS2] fetchall() called - returning 4 rows
[DHIS2] fetchall() - First row type: <class 'tuple'>
[DHIS2] fetchall() - First row (original): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Column count from description: 6
[DHIS2] fetchall() - First row (fixed types): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Type enforcement: dimensions=STRING, measures=FLOAT
[DHIS2] Executing query: SELECT
  "OrgUnit",
  "Period",
  SUM("105_EP01b_Malaria_Total") AS sum_1,
  SUM("105_EP01a_Suspected_fever") AS sum_2
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "OrgUnit",
  "Period"
ORDER BY
  SUM("105_EP01b_Malaria_Total") DESC
LIMIT 10000
[DHIS2] Parsed endpoint: analytics
[DHIS2] Executing query: SELECT
  "OrgUnit",
  "Period",
  SUM("105_EP01b_Malaria_Total") AS sum_1,
  SUM("105_EP01a_Suspected_fever") AS sum_2
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "OrgUnit",
  "Period"
ORDER BY
  SUM("105_EP01b_Malaria_Total") DESC
LIMIT 10000
[DHIS2] Found params in Flask g for analytics: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;
[DHIS2] Parsed endpoint: analytics
[DHIS2] Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
[DHIS2] Found params in Flask g for analytics: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;
[DHIS2] Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
[DHIS2] Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
[DHIS2] API request URL: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
[DHIS2] Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
[DHIS2] API request URL: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
[DHIS2] Raw API response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Raw DHIS2 rows count: 16
[DHIS2] First raw row: ['QHnwKs2OUZv', '2020', 'akV6429SUqu', '15266488']
[DHIS2] Parsing response for endpoint: analytics
[DHIS2] Response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Response sample: {'headers': [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}], 'metaDat
[DHIS2] Using WIDE/PIVOTED format (Period, OrgUnit, DX1, DX2, ...) for analytics
[DHIS2] normalize_analytics: pivot=True, using WIDE/PIVOTED format
[DHIS2] PIVOT CONSTRUCTION:
[DHIS2]   data_elements (UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   data_element_list (sorted UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   col_names (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized row count: 4
[DHIS2] First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] _set_description: columns=['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], types=['String', 'String', 'String', 'String', 'String', 'String']
[DHIS2] Transformed rows count: 4
[DHIS2] First transformed row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] Fetched 4 rows
[DHIS2] fetchall() called - returning 4 rows
[DHIS2] fetchall() - First row type: <class 'tuple'>
[DHIS2] fetchall() - First row (original): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Column count from description: 6
[DHIS2] fetchall() - First row (fixed types): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Type enforcement: dimensions=STRING, measures=FLOAT
[DHIS2] Raw API response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Raw DHIS2 rows count: 16
[DHIS2] First raw row: ['QHnwKs2OUZv', '2020', 'akV6429SUqu', '15266488']
[DHIS2] Parsing response for endpoint: analytics
[DHIS2] Response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Response sample: {'headers': [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}], 'metaDat
[DHIS2] Using WIDE/PIVOTED format (Period, OrgUnit, DX1, DX2, ...) for analytics
[DHIS2] normalize_analytics: pivot=True, using WIDE/PIVOTED format
[DHIS2] PIVOT CONSTRUCTION:
[DHIS2]   data_elements (UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   data_element_list (sorted UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   col_names (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized row count: 4
[DHIS2] First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] _set_description: columns=['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], types=['String', 'String', 'String', 'String', 'String', 'String']
[DHIS2] Transformed rows count: 4
[DHIS2] First transformed row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] Fetched 4 rows
[DHIS2] fetchall() called - returning 4 rows
[DHIS2] fetchall() - First row type: <class 'tuple'>
[DHIS2] fetchall() - First row (original): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Column count from description: 6
[DHIS2] fetchall() - First row (fixed types): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Type enforcement: dimensions=STRING, measures=FLOAT2025-12-06 19:37:23,202:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() returning 4 rows with 6 columns each
2025-12-06 19:37:23,202:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Got 4 rows from cursor
2025-12-06 19:37:23,202:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-06 19:37:23,202:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 19:37:23,202:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Types from cursor: ['String', 'String', 'String', 'String', 'String', 'String']
2025-12-06 19:37:23,208:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: DataFrame created with 4 rows, 6 columns
2025-12-06 19:37:23,209:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 19:37:23,210:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes BEFORE fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-06 19:37:23,211:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Period' to object dtype (dimension)
2025-12-06 19:37:23,211:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'OrgUnit' to object dtype (dimension)
2025-12-06 19:37:23,211:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes AFTER fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-06 19:37:23,211:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: First row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-06 19:37:23,216:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] BEFORE assign_column_label:
2025-12-06 19:37:23,216:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 6)
2025-12-06 19:37:23,216:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 19:37:23,216:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['OrgUnit', 'Period', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)']
2025-12-06 19:37:23,216:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: False
2025-12-06 19:37:23,216:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-06 19:37:23,216:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Column truncation needed: df has 6 columns, expected 4
2025-12-06 19:37:23,216:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   DataFrame actual columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 19:37:23,216:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Expected columns: ['OrgUnit', 'Period', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)']
2025-12-06 19:37:23,217:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] âœ“ Selecting columns BY NAME (matched all expected columns)
2025-12-06 19:37:23,217:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Column mapping: {'OrgUnit': 'OrgUnit', 'Period': 'Period', 'SUM(105_EP01b_Malaria_Total)': '105_EP01b_Malaria_Total', 'SUM(105_EP01a_Suspected_fever)': '105_EP01a_Suspected_fever'}
2025-12-06 19:37:23,217:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] Column Selection âœ“ SUCCESS - method=BY_NAME, datasource=analytics_LAST_YEAR_20251206
2025-12-06 19:37:23,217:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['OrgUnit', 'Period', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)']
2025-12-06 19:37:23,217:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   tried_by_name=True, success=True, fallback=False
2025-12-06 19:37:23,217:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Assigning column labels: ['OrgUnit', 'Period', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)']
2025-12-06 19:37:23,217:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] AFTER assign_column_label:
2025-12-06 19:37:23,217:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 4)
2025-12-06 19:37:23,217:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['OrgUnit', 'Period', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)']
2025-12-06 19:37:23,217:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['OrgUnit', 'Period', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)']
2025-12-06 19:37:23,217:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: True
2025-12-06 19:37:23,217:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'OrgUnit': 'MOH - Uganda', 'Period': '2020', 'SUM(105_EP01b_Malaria_Total)': 14479324, 'SUM(105_EP01a_Suspected_fever)': 22994823}
2025-12-06 19:37:23,221:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] DataFrame columns: ['OrgUnit', 'Period', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)']
2025-12-06 19:37:23,221:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Aggregates: {'SUM(105_EP01b_Malaria_Total)': {'operator': 'mean'}, 'SUM(105_EP01a_Suspected_fever)': {'operator': 'mean'}}
2025-12-06 19:37:23,221:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105_EP01b_Malaria_Total)', column='SUM(105_EP01b_Malaria_Total)'
2025-12-06 19:37:23,221:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105_EP01a_Suspected_fever)', column='SUM(105_EP01a_Suspected_fever)'
2025-12-06 19:37:23,241:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:37:23] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-06 19:37:31,722:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:37:31] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-06 19:37:33,063:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:37:33] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-06 19:37:33,064:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:37:33] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-06 19:37:33,946:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:37:33] "PUT /api/v1/explore/form_data/fTQlGTUBnOM?tab_id=6 HTTP/1.1" 200 -
2025-12-06 19:37:34,118:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:37:34] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-06 19:37:48,706:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:37:48] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-06 19:37:52,020:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:37:52] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-06 19:37:52,022:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:37:52] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-06 19:37:52,870:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:37:52] "PUT /api/v1/explore/form_data/fTQlGTUBnOM?tab_id=6 HTTP/1.1" 200 -
2025-12-06 19:37:53,030:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:37:53] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-06 19:38:10,572:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:38:10] "GET /static/assets/node_modules_svgr_webpack_dist_index_js_src_assets_images_icons_ballot_svg.06ed661d.chunk.js HTTP/1.1" 200 -
2025-12-06 19:38:10,573:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:38:10] "GET /static/assets/Table.f8a6698c.jpg HTTP/1.1" 200 -
2025-12-06 19:38:10,574:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:38:10] "GET /static/assets/thumbnail.b751c252.png HTTP/1.1" 200 -
2025-12-06 19:38:10,574:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:38:10] "GET /static/assets/node_modules_svgr_webpack_dist_index_js_src_assets_images_icons_category_svg.c9ede4fb.chunk.js HTTP/1.1" 200 -
2025-12-06 19:38:10,575:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:38:10] "GET /static/assets/thumbnail.0cdc0470.png HTTP/1.1" 200 -
2025-12-06 19:38:10,575:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:38:10] "GET /static/assets/thumbnail.92b5826e.png HTTP/1.1" 200 -
2025-12-06 19:38:10,577:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:38:10] "GET /static/assets/Table2.c8533c18.jpg HTTP/1.1" 200 -
2025-12-06 19:38:10,577:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:38:10] "GET /static/assets/Table3.8997ea72.jpg HTTP/1.1" 200 -
2025-12-06 19:38:14,812:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:38:14] "GET /static/assets/thumbnail.6b7ac120.png HTTP/1.1" 200 -
2025-12-06 19:38:14,813:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:38:14] "GET /static/assets/thumbnail.ee528db4.png HTTP/1.1" 200 -
2025-12-06 19:38:14,813:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:38:14] "GET /static/assets/thumbnail.652ad50f.png HTTP/1.1" 200 -
2025-12-06 19:38:19,707:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:38:19] "GET /static/assets/example2.1e997473.png HTTP/1.1" 200 -
2025-12-06 19:38:19,708:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:38:19] "GET /static/assets/example1.bd493731.png HTTP/1.1" 200 -
2025-12-06 19:38:30,450:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:38:30] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-06 19:38:38,894:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:38:38] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-06 19:38:53,106:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:38:53] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-06 19:38:54,632:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:38:54] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-06 19:38:55,706:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:38:55] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-06 19:38:58,767:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:38:58] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-06 19:39:11,709:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:39:11] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-06 19:39:12,200:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1458, in dispatch_request
    self.raise_routing_exception(req)
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1440, in raise_routing_exception
    raise request.routing_exception  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/ctx.py", line 353, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/werkzeug/routing/map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-12-06 19:39:12,203:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:39:12] "[33mGET /ws HTTP/1.1[0m" 404 -
2025-12-06 19:39:12,992:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1458, in dispatch_request
    self.raise_routing_exception(req)
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1440, in raise_routing_exception
    raise request.routing_exception  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/ctx.py", line 353, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/werkzeug/routing/map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-12-06 19:39:12,993:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:39:12] "[33mGET /ws HTTP/1.1[0m" 404 -
2025-12-06 19:39:14,593:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:39:14] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-06 19:39:25,270:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:39:25] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-06 19:39:26,343:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:39:26] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-06 19:39:29,004:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:39:29] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-06 19:39:43,222:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:39:43] "GET /static/assets/thumbnail.4a9b5e62.png HTTP/1.1" 200 -
2025-12-06 19:39:43,223:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:39:43] "GET /static/assets/thumbnail.0be12067.png HTTP/1.1" 200 -
2025-12-06 19:39:43,223:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:39:43] "GET /static/assets/thumbnail.5d5ddfcc.png HTTP/1.1" 200 -
2025-12-06 19:39:43,226:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:39:43] "GET /static/assets/thumbnail.d2ebb8b7.png HTTP/1.1" 200 -
2025-12-06 19:39:43,226:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:39:43] "GET /static/assets/thumbnail.50c780c0.png HTTP/1.1" 200 -
2025-12-06 19:39:43,226:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:39:43] "GET /static/assets/thumbnail.3b5aef49.png HTTP/1.1" 200 -
2025-12-06 19:39:43,229:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:39:43] "GET /static/assets/thumbnail.ea1ff627.png HTTP/1.1" 200 -
2025-12-06 19:39:43,230:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:39:43] "GET /static/assets/thumbnail.e3f36081.png HTTP/1.1" 200 -
2025-12-06 19:39:43,230:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:39:43] "GET /static/assets/thumbnail.2ec285ca.png HTTP/1.1" 200 -
2025-12-06 19:39:43,233:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:39:43] "GET /static/assets/thumbnail.b627d1a4.png HTTP/1.1" 200 -
2025-12-06 19:39:43,234:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:39:43] "GET /static/assets/thumbnail.e556fb5f.png HTTP/1.1" 200 -
2025-12-06 19:39:47,226:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:39:47] "GET /static/assets/Bar1.05db33fe.png HTTP/1.1" 200 -
2025-12-06 19:39:47,226:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:39:47] "GET /static/assets/Bar3.0ace6ce6.png HTTP/1.1" 200 -
2025-12-06 19:39:47,226:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:39:47] "GET /static/assets/Bar2.c41826d8.png HTTP/1.1" 200 -
2025-12-06 19:39:50,268:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:39:50] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-06 19:39:51,901:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:39:51] "[31m[1mPOST /api/v1/chart/data HTTP/1.1[0m" 400 -
2025-12-06 19:39:51,902:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:39:51] "[31m[1mPOST /api/v1/chart/data HTTP/1.1[0m" 400 -
2025-12-06 19:39:51,932:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:39:51] "[33mGET /api/v1/chart/0 HTTP/1.1[0m" 404 -
2025-12-06 19:39:52,773:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:39:52] "PUT /api/v1/explore/form_data/fTQlGTUBnOM?tab_id=6 HTTP/1.1" 200 -
2025-12-06 19:39:52,909:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:39:52] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-06 19:40:00,050:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:40:00] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-06 19:40:01,335:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:40:01] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-06 19:40:01,339:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:40:01] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-06 19:40:02,249:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:40:02] "PUT /api/v1/explore/form_data/fTQlGTUBnOM?tab_id=6 HTTP/1.1" 200 -
2025-12-06 19:40:02,345:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:40:02] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-06 19:40:42,304:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:40:42] "GET /static/assets/src_explore_components_controls_AnnotationLayerControl_AnnotationLayer_jsx.f80713cd.chunk.js HTTP/1.1" 200 -
2025-12-06 19:40:51,401:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:40:51] "PUT /api/v1/explore/form_data/fTQlGTUBnOM?tab_id=6 HTTP/1.1" 200 -
2025-12-06 19:40:55,773:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:40:55] "PUT /api/v1/explore/form_data/fTQlGTUBnOM?tab_id=6 HTTP/1.1" 200 -
2025-12-06 19:41:15,104:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:41:15] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-06 19:41:18,582:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:41:18] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-06 19:41:21,848:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:41:21] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-06 19:41:28,618:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:41:28] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-06 19:41:29,722:ERROR:superset.models.helpers:[METRICS-TRACE] Processing 2 metrics
2025-12-06 19:41:29,723:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 0: adhoc - SUM(105_EP01b_Malaria_Total)
2025-12-06 19:41:29,727:ERROR:superset.models.helpers:[METRICS-TRACE] Processing 2 metrics
2025-12-06 19:41:29,730:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105_EP01b_Malaria_Total)
2025-12-06 19:41:29,731:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 0: adhoc - SUM(105_EP01b_Malaria_Total)
2025-12-06 19:41:29,731:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 1: adhoc - SUM(105_EP01a_Suspected_fever)
2025-12-06 19:41:29,733:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105_EP01b_Malaria_Total)
2025-12-06 19:41:29,734:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 1: adhoc - SUM(105_EP01a_Suspected_fever)
2025-12-06 19:41:29,733:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105_EP01a_Suspected_fever)
2025-12-06 19:41:29,735:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105_EP01a_Suspected_fever)
2025-12-06 19:41:29,735:ERROR:superset.models.helpers:[METRICS-TRACE] Total metrics added: 2
2025-12-06 19:41:29,735:ERROR:superset.models.helpers:[METRICS-TRACE] Total metrics added: 2
2025-12-06 19:41:29,752:ERROR:superset.models.helpers:[METRICS-TRACE] Before dedup: 2 select_exprs + 2 metrics_exprs
2025-12-06 19:41:29,755:ERROR:superset.models.helpers:[METRICS-TRACE] Before dedup: 2 select_exprs + 2 metrics_exprs
2025-12-06 19:41:29,755:ERROR:superset.models.helpers:[METRICS-TRACE] After dedup: 4 total select_exprs
2025-12-06 19:41:29,755:INFO:superset.models.helpers:[COLUMN_TRACE] SQL Query Building:
2025-12-06 19:41:29,755:INFO:superset.models.helpers:[COLUMN_TRACE]   columns: [{'columnType': 'BASE_AXIS', 'sqlExpression': 'Period', 'label': 'Period', 'expressionType': 'SQL'}, 'OrgUnit']
2025-12-06 19:41:29,755:INFO:superset.models.helpers:[COLUMN_TRACE]   metrics: [{'expressionType': 'SIMPLE', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01b_Malaria_Total', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 3, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'INT', 'type_generic': 0, 'uuid': '959bffaa-826b-4d13-8b7b-6d9c4ea25e50', 'verbose_name': None, 'warning_markdown': None}, 'aggregate': 'SUM', 'sqlExpression': None, 'datasourceWarning': False, 'hasCustomLabel': False, 'label': 'SUM(105_EP01b_Malaria_Total)', 'optionName': 'metric_45302laesg5_qggnouu9br'}, {'expressionType': 'SIMPLE', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01a_Suspected_fever', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 4, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'column', 'type_generic': 0, 'uuid': '530216fe-7198-4b8e-b688-a479bcf67426', 'verbose_name': None, 'warning_markdown': None}, 'aggregate': 'SUM', 'sqlExpression': None, 'datasourceWarning': False, 'hasCustomLabel': False, 'label': 'SUM(105_EP01a_Suspected_fever)', 'optionName': 'metric_k45orb1omq9_1qf1acagf2y'}]
2025-12-06 19:41:29,755:INFO:superset.models.helpers:[COLUMN_TRACE]   groupby: []
2025-12-06 19:41:29,755:INFO:superset.models.helpers:[COLUMN_TRACE]   labels_expected: ['Period', 'OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)']
2025-12-06 19:41:29,755:INFO:superset.models.helpers:[COLUMN_TRACE]   select_exprs count: 4
2025-12-06 19:41:29,755:ERROR:superset.models.helpers:[METRICS-TRACE] After dedup: 4 total select_exprs
2025-12-06 19:41:29,756:INFO:superset.models.helpers:[COLUMN_TRACE]     [0] key=Period, name=Period, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-06 19:41:29,756:INFO:superset.models.helpers:[COLUMN_TRACE] SQL Query Building:
2025-12-06 19:41:29,756:INFO:superset.models.helpers:[COLUMN_TRACE]     [1] key=OrgUnit, name=OrgUnit, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-06 19:41:29,756:INFO:superset.models.helpers:[COLUMN_TRACE]   columns: [{'columnType': 'BASE_AXIS', 'sqlExpression': 'Period', 'label': 'Period', 'expressionType': 'SQL'}, 'OrgUnit']
2025-12-06 19:41:29,756:INFO:superset.models.helpers:[COLUMN_TRACE]   metrics: [{'expressionType': 'SIMPLE', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01b_Malaria_Total', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 3, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'INT', 'type_generic': 0, 'uuid': '959bffaa-826b-4d13-8b7b-6d9c4ea25e50', 'verbose_name': None, 'warning_markdown': None}, 'aggregate': 'SUM', 'sqlExpression': None, 'datasourceWarning': False, 'hasCustomLabel': False, 'label': 'SUM(105_EP01b_Malaria_Total)', 'optionName': 'metric_45302laesg5_qggnouu9br'}, {'expressionType': 'SIMPLE', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01a_Suspected_fever', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 4, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'column', 'type_generic': 0, 'uuid': '530216fe-7198-4b8e-b688-a479bcf67426', 'verbose_name': None, 'warning_markdown': None}, 'aggregate': 'SUM', 'sqlExpression': None, 'datasourceWarning': False, 'hasCustomLabel': False, 'label': 'SUM(105_EP01a_Suspected_fever)', 'optionName': 'metric_k45orb1omq9_1qf1acagf2y'}]
2025-12-06 19:41:29,756:INFO:superset.models.helpers:[COLUMN_TRACE]     [2] key=SUM(105_EP01b_Malaria_Total), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-06 19:41:29,756:INFO:superset.models.helpers:[COLUMN_TRACE]     [3] key=SUM(105_EP01a_Suspected_fever), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-06 19:41:29,756:INFO:superset.models.helpers:[COLUMN_TRACE]   groupby: []
2025-12-06 19:41:29,757:INFO:superset.connectors.sqla.models:[DHIS2] get_from_clause for virtual dataset 1: analytics_LAST_YEAR_20251206
2025-12-06 19:41:29,757:INFO:superset.models.helpers:[COLUMN_TRACE]   labels_expected: ['Period', 'OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)']
2025-12-06 19:41:29,757:INFO:superset.connectors.sqla.models:[DHIS2] Full SQL stored: SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
2025-12-06 19:41:29,757:INFO:superset.models.helpers:[COLUMN_TRACE]   select_exprs count: 4
2025-12-06 19:41:29,757:INFO:superset.connectors.sqla.models:[DHIS2] Loaded params from extra field: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayPropert
2025-12-06 19:41:29,757:INFO:superset.models.helpers:[COLUMN_TRACE]     [0] key=Period, name=Period, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-06 19:41:29,757:INFO:superset.models.helpers:[COLUMN_TRACE]     [1] key=OrgUnit, name=OrgUnit, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-06 19:41:29,757:INFO:superset.models.helpers:[COLUMN_TRACE]     [2] key=SUM(105_EP01b_Malaria_Total), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-06 19:41:29,757:INFO:superset.models.helpers:[COLUMN_TRACE]     [3] key=SUM(105_EP01a_Suspected_fever), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-06 19:41:29,757:INFO:superset.connectors.sqla.models:[DHIS2] get_from_clause for virtual dataset 1: analytics_LAST_YEAR_20251206
2025-12-06 19:41:29,757:INFO:superset.connectors.sqla.models:[DHIS2] Full SQL stored: SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
2025-12-06 19:41:29,757:INFO:superset.connectors.sqla.models:[DHIS2] Loaded params from extra field: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayPropert
2025-12-06 19:41:29,758:INFO:superset.connectors.sqla.models:[DHIS2] Cached params with key: dhis2_params_1_analytics
2025-12-06 19:41:29,758:INFO:superset.connectors.sqla.models:[DHIS2] Stored params in Flask g for DHIS2 table: analytics
2025-12-06 19:41:29,763:INFO:superset.connectors.sqla.models:[DHIS2] Cached params with key: dhis2_params_1_analytics
2025-12-06 19:41:29,765:INFO:superset.connectors.sqla.models:[DHIS2] Stored params in Flask g for DHIS2 table: analytics
2025-12-06 19:41:29,768:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Query execution in connectors/sqla/models.py:
2025-12-06 19:41:29,775:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   SQL (first 500 chars): SELECT "Period", "OrgUnit", sum("105_EP01b_Malaria_Total") AS sum_1, sum("105_EP01a_Suspected_fever") AS sum_2 
FROM (SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
) AS virtual_table GROUP BY "Period", "OrgUnit" ORDER BY sum("105_EP01b_Malaria_Total") DESC
 LIMIT 10000
2025-12-06 19:41:29,776:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   labels_expected: ['Period', 'OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)']
2025-12-06 19:41:29,782:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Query execution in connectors/sqla/models.py:
2025-12-06 19:41:29,783:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   SQL (first 500 chars): SELECT "Period", "OrgUnit", sum("105_EP01b_Malaria_Total") AS sum_1, sum("105_EP01a_Suspected_fever") AS sum_2 
FROM (SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
) AS virtual_table GROUP BY "Period", "OrgUnit" ORDER BY sum("105_EP01b_Malaria_Total") DESC
 LIMIT 10000
2025-12-06 19:41:29,783:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   labels_expected: ['Period', 'OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)']
2025-12-06 19:41:29,783:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 connection initialized: https://tests.dhis2.hispuganda.org/hmis/api
2025-12-06 19:41:29,785:INFO:superset.db_engine_specs.dhis2_dialect:Executing DHIS2 query: SELECT
  "Period",
  "OrgUnit",
  SUM("105_EP01b_Malaria_Total") AS sum_1,
  SUM("105_EP01a_Suspected_fever") AS sum_2
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "Period",
  "OrgUnit"
ORDER BY
  SUM("105_EP01b_Malaria_Total") DESC
LIMIT 10000
2025-12-06 19:41:29,785:INFO:superset.db_engine_specs.dhis2_dialect:Parsed endpoint: analytics
2025-12-06 19:41:29,785:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 connection initialized: https://tests.dhis2.hispuganda.org/hmis/api
2025-12-06 19:41:29,785:INFO:superset.db_engine_specs.dhis2_dialect:Using stored parameters from Flask g for table: analytics
2025-12-06 19:41:29,786:INFO:superset.db_engine_specs.dhis2_dialect:Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
2025-12-06 19:41:29,786:INFO:superset.db_engine_specs.dhis2_dialect:Executing DHIS2 query: SELECT
  "Period",
  "OrgUnit",
  SUM("105_EP01b_Malaria_Total") AS sum_1,
  SUM("105_EP01a_Suspected_fever") AS sum_2
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "Period",
  "OrgUnit"
ORDER BY
  SUM("105_EP01b_Malaria_Total") DESC
LIMIT 10000
2025-12-06 19:41:29,786:INFO:superset.db_engine_specs.dhis2_dialect:Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
2025-12-06 19:41:29,786:INFO:superset.db_engine_specs.dhis2_dialect:Parsed endpoint: analytics
2025-12-06 19:41:29,787:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API request: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
2025-12-06 19:41:29,787:INFO:superset.db_engine_specs.dhis2_dialect:Using stored parameters from Flask g for table: analytics
2025-12-06 19:41:29,790:INFO:superset.db_engine_specs.dhis2_dialect:Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
2025-12-06 19:41:29,790:INFO:superset.db_engine_specs.dhis2_dialect:Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
2025-12-06 19:41:29,791:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API request: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
2025-12-06 19:41:30,576:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:41:30] "PUT /api/v1/explore/form_data/fTQlGTUBnOM?tab_id=6 HTTP/1.1" 200 -
2025-12-06 19:41:32,830:INFO:superset.db_engine_specs.dhis2_dialect:Using wide/pivoted format for analytics
2025-12-06 19:41:32,830:INFO:superset.db_engine_specs.dhis2_dialect:normalize_analytics called with pivot=True, returning WIDE format
2025-12-06 19:41:32,830:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column construction - data_elements: ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
2025-12-06 19:41:32,830:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column names constructed (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 19:41:32,830:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] FIRST ROW CONSTRUCTION:
2025-12-06 19:41:32,830:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   Period (index 0): 2020
2025-12-06 19:41:32,830:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   OrgUnit (index 1): MOH - Uganda
2025-12-06 19:41:32,830:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01b. Malaria Total (index 2): 14479324
2025-12-06 19:41:32,830:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01a. Suspected fever (index 3): 22994823
2025-12-06 19:41:32,830:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01d. Malaria cases treated (index 4): 15266488
2025-12-06 19:41:32,830:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01c. Malaria Confirmed (B/s and RDT Positive) (index 5): 13326277
2025-12-06 19:41:32,830:INFO:superset.db_engine_specs.dhis2_dialect:First pivoted row - Period: '2020', OrgUnit: 'MOH - Uganda'
2025-12-06 19:41:32,830:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total pivoted rows: 4, columns: 6
2025-12-06 19:41:32,830:INFO:superset.db_engine_specs.dhis2_dialect:Normalized 4 rows with 6 columns for endpoint analytics
2025-12-06 19:41:32,830:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API returned 4 rows
2025-12-06 19:41:32,834:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() - Row count: 4
2025-12-06 19:41:32,834:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 19:41:32,834:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names length: 6
2025-12-06 19:41:32,834:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values count: 6
2025-12-06 19:41:32,834:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-06 19:41:32,834:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 0 (Period): 2020 -> 2020 (STRING)
2025-12-06 19:41:32,834:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (OrgUnit): MOH - Uganda -> MOH - Uganda (STRING)
2025-12-06 19:41:32,834:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (105_EP01b_Malaria_Total): 14479324 (PROCESSED)
2025-12-06 19:41:32,834:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (105_EP01a_Suspected_fever): 22994823 (PROCESSED)
2025-12-06 19:41:32,834:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (105_EP01d_Malaria_cases_treated): 15266488 (PROCESSED)
2025-12-06 19:41:32,834:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() returning 4 rows with 6 columns each
2025-12-06 19:41:32,834:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Got 4 rows from cursor
2025-12-06 19:41:32,834:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-06 19:41:32,834:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 19:41:32,834:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Types from cursor: ['String', 'String', 'String', 'String', 'String', 'String']
2025-12-06 19:41:32,835:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: DataFrame created with 4 rows, 6 columns
2025-12-06 19:41:32,835:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 19:41:32,836:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes BEFORE fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-06 19:41:32,836:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Period' to object dtype (dimension)
2025-12-06 19:41:32,836:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'OrgUnit' to object dtype (dimension)
2025-12-06 19:41:32,837:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes AFTER fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-06 19:41:32,837:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: First row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-06 19:41:32,839:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] BEFORE assign_column_label:
2025-12-06 19:41:32,839:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 6)
2025-12-06 19:41:32,839:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 19:41:32,839:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['Period', 'OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)']
2025-12-06 19:41:32,839:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: False
2025-12-06 19:41:32,839:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-06 19:41:32,839:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Column truncation needed: df has 6 columns, expected 4
2025-12-06 19:41:32,839:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   DataFrame actual columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 19:41:32,839:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Expected columns: ['Period', 'OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)']
2025-12-06 19:41:32,839:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] âœ“ Selecting columns BY NAME (matched all expected columns)
2025-12-06 19:41:32,839:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Column mapping: {'Period': 'Period', 'OrgUnit': 'OrgUnit', 'SUM(105_EP01b_Malaria_Total)': '105_EP01b_Malaria_Total', 'SUM(105_EP01a_Suspected_fever)': '105_EP01a_Suspected_fever'}
2025-12-06 19:41:32,839:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] Column Selection âœ“ SUCCESS - method=BY_NAME, datasource=analytics_LAST_YEAR_20251206
2025-12-06 19:41:32,839:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)']
2025-12-06 19:41:32,839:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   tried_by_name=True, success=True, fallback=False
2025-12-06 19:41:32,839:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Assigning column labels: ['Period', 'OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)']
2025-12-06 19:41:32,839:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] AFTER assign_column_label:
2025-12-06 19:41:32,839:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 4)
2025-12-06 19:41:32,839:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)']
2025-12-06 19:41:32,839:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['Period', 'OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)']
2025-12-06 19:41:32,839:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: True
2025-12-06 19:41:32,839:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', 'SUM(105_EP01b_Malaria_Total)': 14479324, 'SUM(105_EP01a_Suspected_fever)': 22994823}
2025-12-06 19:41:32,841:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] DataFrame columns: ['Period', 'OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)']
2025-12-06 19:41:32,841:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Aggregates: {'SUM(105_EP01b_Malaria_Total)': {'operator': 'mean'}, 'SUM(105_EP01a_Suspected_fever)': {'operator': 'mean'}}
2025-12-06 19:41:32,841:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105_EP01b_Malaria_Total)', column='SUM(105_EP01b_Malaria_Total)'
2025-12-06 19:41:32,841:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105_EP01a_Suspected_fever)', column='SUM(105_EP01a_Suspected_fever)'
2025-12-06 19:41:32,852:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:41:32] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-06 19:41:33,232:INFO:superset.db_engine_specs.dhis2_dialect:Using wide/pivoted format for analytics
2025-12-06 19:41:33,232:INFO:superset.db_engine_specs.dhis2_dialect:normalize_analytics called with pivot=True, returning WIDE format
2025-12-06 19:41:33,232:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column construction - data_elements: ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
2025-12-06 19:41:33,232:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column names constructed (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 19:41:33,232:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] FIRST ROW CONSTRUCTION:
2025-12-06 19:41:33,232:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   Period (index 0): 2020
2025-12-06 19:41:33,232:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   OrgUnit (index 1): MOH - Uganda
2025-12-06 19:41:33,232:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01b. Malaria Total (index 2): 14479324
2025-12-06 19:41:33,232:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01a. Suspected fever (index 3): 22994823
2025-12-06 19:41:33,232:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01d. Malaria cases treated (index 4): 15266488
2025-12-06 19:41:33,232:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01c. Malaria Confirmed (B/s and RDT Positive) (index 5): 13326277
2025-12-06 19:41:33,232:INFO:superset.db_engine_specs.dhis2_dialect:First pivoted row - Period: '2020', OrgUnit: 'MOH - Uganda'
2025-12-06 19:41:33,232:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total pivoted rows: 4, columns: 6
2025-12-06 19:41:33,232:INFO:superset.db_engine_specs.dhis2_dialect:Normalized 4 rows with 6 columns for endpoint analytics
2025-12-06 19:41:33,232:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API returned 4 rows
2025-12-06 19:41:33,235:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() - Row count: 4
2025-12-06 19:41:33,235:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 19:41:33,235:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names length: 6
2025-12-06 19:41:33,235:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values count: 6
2025-12-06 19:41:33,235:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-06 19:41:33,235:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 0 (Period): 2020 -> 2020 (STRING)
2025-12-06 19:41:33,235:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (OrgUnit): MOH - Uganda -> MOH - Uganda (STRING)
2025-12-06 19:41:33,235:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (105_EP01b_Malaria_Total): 14479324 (PROCESSED)
2025-12-06 19:41:33,235:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (105_EP01a_Suspected_fever): 22994823 (PROCESSED)
2025-12-06 19:41:33,235:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (105_EP01d_Malaria_cases_treated): 15266488 (PROCESSED)
2025-12-06 19:41:33,235:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() returning 4 rows with 6 columns each
2025-12-06 19:41:33,235:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Got 4 rows from cursor
2025-12-06 19:41:33,235:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-06 19:41:33,235:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 19:41:33,236:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Types from cursor: ['String', 'String', 'String', 'String', 'String', 'String']
2025-12-06 19:41:33,236:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: DataFrame created with 4 rows, 6 columns
2025-12-06 19:41:33,236:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 19:41:33,236:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes BEFORE fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-06 19:41:33,236:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Period' to object dtype (dimension)
2025-12-06 19:41:33,236:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'OrgUnit' to object dtype (dimension)
2025-12-06 19:41:33,237:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes AFTER fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-06 19:41:33,237:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: First row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-06 19:41:33,239:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] BEFORE assign_column_label:
2025-12-06 19:41:33,239:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 6)
2025-12-06 19:41:33,239:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 19:41:33,239:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['Period', 'OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)']
2025-12-06 19:41:33,239:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: False
2025-12-06 19:41:33,239:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-06 19:41:33,239:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Column truncation needed: df has 6 columns, expected 4
2025-12-06 19:41:33,239:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   DataFrame actual columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 19:41:33,239:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Expected columns: ['Period', 'OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)']
2025-12-06 19:41:33,239:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] âœ“ Selecting columns BY NAME (matched all expected columns)
2025-12-06 19:41:33,239:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Column mapping: {'Period': 'Period', 'OrgUnit': 'OrgUnit', 'SUM(105_EP01b_Malaria_Total)': '105_EP01b_Malaria_Total', 'SUM(105_EP01a_Suspected_fever)': '105_EP01a_Suspected_fever'}
2025-12-06 19:41:33,240:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] Column Selection âœ“ SUCCESS - method=BY_NAME, datasource=analytics_LAST_YEAR_20251206
2025-12-06 19:41:33,240:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)']
2025-12-06 19:41:33,240:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   tried_by_name=True, success=True, fallback=False
2025-12-06 19:41:33,240:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Assigning column labels: ['Period', 'OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)']
2025-12-06 19:41:33,240:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] AFTER assign_column_label:
2025-12-06 19:41:33,240:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 4)
2025-12-06 19:41:33,240:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)']
2025-12-06 19:41:33,240:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['Period', 'OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)']
2025-12-06 19:41:33,240:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: True
2025-12-06 19:41:33,240:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', 'SUM(105_EP01b_Malaria_Total)': 14479324, 'SUM(105_EP01a_Suspected_fever)': 22994823}
2025-12-06 19:41:33,241:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] DataFrame columns: ['Period', 'OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)']
2025-12-06 19:41:33,241:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Aggregates: {'SUM(105_EP01b_Malaria_Total)': {'operator': 'mean'}, 'SUM(105_EP01a_Suspected_fever)': {'operator': 'mean'}}
2025-12-06 19:41:33,241:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105_EP01b_Malaria_Total)', column='SUM(105_EP01b_Malaria_Total)'
2025-12-06 19:41:33,241:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105_EP01a_Suspected_fever)', column='SUM(105_EP01a_Suspected_fever)'
2025-12-06 19:41:33,251:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:41:33] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-06 19:41:33,885:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:41:33] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-06 19:42:09,016:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:42:09] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-06 19:42:09,428:ERROR:superset.models.helpers:[METRICS-TRACE] Processing 3 metrics
2025-12-06 19:42:09,428:ERROR:superset.models.helpers:[METRICS-TRACE] Processing 3 metrics
2025-12-06 19:42:09,428:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 0: adhoc - SUM(105_EP01b_Malaria_Total)
2025-12-06 19:42:09,428:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 0: adhoc - SUM(105_EP01b_Malaria_Total)
2025-12-06 19:42:09,429:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105_EP01b_Malaria_Total)
2025-12-06 19:42:09,429:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105_EP01b_Malaria_Total)
2025-12-06 19:42:09,429:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 1: adhoc - SUM(105_EP01a_Suspected_fever)
2025-12-06 19:42:09,429:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 1: adhoc - SUM(105_EP01a_Suspected_fever)
2025-12-06 19:42:09,429:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105_EP01a_Suspected_fever)
2025-12-06 19:42:09,429:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105_EP01a_Suspected_fever)
2025-12-06 19:42:09,429:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 2: adhoc - SUM(105_EP01d_Malaria_cases_treated)
2025-12-06 19:42:09,429:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 2: adhoc - SUM(105_EP01d_Malaria_cases_treated)
2025-12-06 19:42:09,430:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105_EP01d_Malaria_cases_treated)
2025-12-06 19:42:09,430:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105_EP01d_Malaria_cases_treated)
2025-12-06 19:42:09,430:ERROR:superset.models.helpers:[METRICS-TRACE] Total metrics added: 3
2025-12-06 19:42:09,430:ERROR:superset.models.helpers:[METRICS-TRACE] Total metrics added: 3
2025-12-06 19:42:09,432:ERROR:superset.models.helpers:[METRICS-TRACE] Before dedup: 2 select_exprs + 3 metrics_exprs
2025-12-06 19:42:09,432:ERROR:superset.models.helpers:[METRICS-TRACE] Before dedup: 2 select_exprs + 3 metrics_exprs
2025-12-06 19:42:09,432:ERROR:superset.models.helpers:[METRICS-TRACE] After dedup: 5 total select_exprs
2025-12-06 19:42:09,433:ERROR:superset.models.helpers:[METRICS-TRACE] After dedup: 5 total select_exprs
2025-12-06 19:42:09,433:INFO:superset.models.helpers:[COLUMN_TRACE] SQL Query Building:
2025-12-06 19:42:09,433:INFO:superset.models.helpers:[COLUMN_TRACE] SQL Query Building:
2025-12-06 19:42:09,433:INFO:superset.models.helpers:[COLUMN_TRACE]   columns: [{'columnType': 'BASE_AXIS', 'sqlExpression': 'Period', 'label': 'Period', 'expressionType': 'SQL'}, 'OrgUnit']
2025-12-06 19:42:09,433:INFO:superset.models.helpers:[COLUMN_TRACE]   columns: [{'columnType': 'BASE_AXIS', 'sqlExpression': 'Period', 'label': 'Period', 'expressionType': 'SQL'}, 'OrgUnit']
2025-12-06 19:42:09,433:INFO:superset.models.helpers:[COLUMN_TRACE]   metrics: [{'expressionType': 'SIMPLE', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01b_Malaria_Total', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 3, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'INT', 'type_generic': 0, 'uuid': '959bffaa-826b-4d13-8b7b-6d9c4ea25e50', 'verbose_name': None, 'warning_markdown': None}, 'aggregate': 'SUM', 'sqlExpression': None, 'datasourceWarning': False, 'hasCustomLabel': False, 'label': 'SUM(105_EP01b_Malaria_Total)', 'optionName': 'metric_45302laesg5_qggnouu9br'}, {'expressionType': 'SIMPLE', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01a_Suspected_fever', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 4, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'INT', 'type_generic': 0, 'uuid': '530216fe-7198-4b8e-b688-a479bcf67426', 'verbose_name': None, 'warning_markdown': None}, 'aggregate': 'SUM', 'sqlExpression': None, 'datasourceWarning': False, 'hasCustomLabel': False, 'label': 'SUM(105_EP01a_Suspected_fever)', 'optionName': 'metric_k45orb1omq9_1qf1acagf2y'}, {'expressionType': 'SIMPLE', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01d_Malaria_cases_treated', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 5, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'column', 'type_generic': 0, 'uuid': 'ffc52aba-a038-4c22-b6c8-169f3e2b8b97', 'verbose_name': None, 'warning_markdown': None}, 'aggregate': 'SUM', 'sqlExpression': None, 'datasourceWarning': False, 'hasCustomLabel': False, 'label': 'SUM(105_EP01d_Malaria_cases_treated)', 'optionName': 'metric_f1nae8hwjxs_winu84yl9zr'}]
2025-12-06 19:42:09,433:INFO:superset.models.helpers:[COLUMN_TRACE]   metrics: [{'expressionType': 'SIMPLE', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01b_Malaria_Total', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 3, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'INT', 'type_generic': 0, 'uuid': '959bffaa-826b-4d13-8b7b-6d9c4ea25e50', 'verbose_name': None, 'warning_markdown': None}, 'aggregate': 'SUM', 'sqlExpression': None, 'datasourceWarning': False, 'hasCustomLabel': False, 'label': 'SUM(105_EP01b_Malaria_Total)', 'optionName': 'metric_45302laesg5_qggnouu9br'}, {'expressionType': 'SIMPLE', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01a_Suspected_fever', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 4, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'INT', 'type_generic': 0, 'uuid': '530216fe-7198-4b8e-b688-a479bcf67426', 'verbose_name': None, 'warning_markdown': None}, 'aggregate': 'SUM', 'sqlExpression': None, 'datasourceWarning': False, 'hasCustomLabel': False, 'label': 'SUM(105_EP01a_Suspected_fever)', 'optionName': 'metric_k45orb1omq9_1qf1acagf2y'}, {'expressionType': 'SIMPLE', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01d_Malaria_cases_treated', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 5, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'column', 'type_generic': 0, 'uuid': 'ffc52aba-a038-4c22-b6c8-169f3e2b8b97', 'verbose_name': None, 'warning_markdown': None}, 'aggregate': 'SUM', 'sqlExpression': None, 'datasourceWarning': False, 'hasCustomLabel': False, 'label': 'SUM(105_EP01d_Malaria_cases_treated)', 'optionName': 'metric_f1nae8hwjxs_winu84yl9zr'}]
2025-12-06 19:42:09,433:INFO:superset.models.helpers:[COLUMN_TRACE]   groupby: []
2025-12-06 19:42:09,433:INFO:superset.models.helpers:[COLUMN_TRACE]   groupby: []
2025-12-06 19:42:09,433:INFO:superset.models.helpers:[COLUMN_TRACE]   labels_expected: ['Period', 'OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-06 19:42:09,433:INFO:superset.models.helpers:[COLUMN_TRACE]   labels_expected: ['Period', 'OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-06 19:42:09,433:INFO:superset.models.helpers:[COLUMN_TRACE]   select_exprs count: 5
2025-12-06 19:42:09,433:INFO:superset.models.helpers:[COLUMN_TRACE]   select_exprs count: 5
2025-12-06 19:42:09,433:INFO:superset.models.helpers:[COLUMN_TRACE]     [0] key=Period, name=Period, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-06 19:42:09,433:INFO:superset.models.helpers:[COLUMN_TRACE]     [0] key=Period, name=Period, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-06 19:42:09,433:INFO:superset.models.helpers:[COLUMN_TRACE]     [1] key=OrgUnit, name=OrgUnit, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-06 19:42:09,433:INFO:superset.models.helpers:[COLUMN_TRACE]     [1] key=OrgUnit, name=OrgUnit, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-06 19:42:09,433:INFO:superset.models.helpers:[COLUMN_TRACE]     [2] key=SUM(105_EP01b_Malaria_Total), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-06 19:42:09,433:INFO:superset.models.helpers:[COLUMN_TRACE]     [2] key=SUM(105_EP01b_Malaria_Total), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-06 19:42:09,433:INFO:superset.models.helpers:[COLUMN_TRACE]     [3] key=SUM(105_EP01a_Suspected_fever), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-06 19:42:09,433:INFO:superset.models.helpers:[COLUMN_TRACE]     [3] key=SUM(105_EP01a_Suspected_fever), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-06 19:42:09,433:INFO:superset.models.helpers:[COLUMN_TRACE]     [4] key=SUM(105_EP01d_Malaria_cases_treated), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-06 19:42:09,433:INFO:superset.models.helpers:[COLUMN_TRACE]     [4] key=SUM(105_EP01d_Malaria_cases_treated), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-06 19:42:09,434:INFO:superset.connectors.sqla.models:[DHIS2] get_from_clause for virtual dataset 1: analytics_LAST_YEAR_20251206
2025-12-06 19:42:09,434:INFO:superset.connectors.sqla.models:[DHIS2] get_from_clause for virtual dataset 1: analytics_LAST_YEAR_20251206
2025-12-06 19:42:09,434:INFO:superset.connectors.sqla.models:[DHIS2] Full SQL stored: SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
2025-12-06 19:42:09,434:INFO:superset.connectors.sqla.models:[DHIS2] Full SQL stored: SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
2025-12-06 19:42:09,434:INFO:superset.connectors.sqla.models:[DHIS2] Loaded params from extra field: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayPropert
2025-12-06 19:42:09,434:INFO:superset.connectors.sqla.models:[DHIS2] Loaded params from extra field: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayPropert
2025-12-06 19:42:09,435:INFO:superset.connectors.sqla.models:[DHIS2] Cached params with key: dhis2_params_1_analytics
2025-12-06 19:42:09,435:INFO:superset.connectors.sqla.models:[DHIS2] Stored params in Flask g for DHIS2 table: analytics
2025-12-06 19:42:09,438:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Query execution in connectors/sqla/models.py:
2025-12-06 19:42:09,438:INFO:superset.connectors.sqla.models:[DHIS2] Cached params with key: dhis2_params_1_analytics
2025-12-06 19:42:09,438:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   SQL (first 500 chars): SELECT "Period", "OrgUnit", sum("105_EP01b_Malaria_Total") AS sum_1, sum("105_EP01a_Suspected_fever") AS sum_2, sum("105_EP01d_Malaria_cases_treated") AS sum_3 
FROM (SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
) AS virtual_table GROUP BY "Period", "OrgUnit" ORDER BY sum("105_EP01b_Malaria_Total") DESC
 LIMIT 10000
2025-12-06 19:42:09,438:INFO:superset.connectors.sqla.models:[DHIS2] Stored params in Flask g for DHIS2 table: analytics
2025-12-06 19:42:09,438:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   labels_expected: ['Period', 'OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-06 19:42:09,442:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Query execution in connectors/sqla/models.py:
2025-12-06 19:42:09,442:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   SQL (first 500 chars): SELECT "Period", "OrgUnit", sum("105_EP01b_Malaria_Total") AS sum_1, sum("105_EP01a_Suspected_fever") AS sum_2, sum("105_EP01d_Malaria_cases_treated") AS sum_3 
FROM (SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
) AS virtual_table GROUP BY "Period", "OrgUnit" ORDER BY sum("105_EP01b_Malaria_Total") DESC
 LIMIT 10000
2025-12-06 19:42:09,442:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 connection initialized: https://tests.dhis2.hispuganda.org/hmis/api
2025-12-06 19:42:09,442:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   labels_expected: ['Period', 'OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-06 19:42:09,443:INFO:superset.db_engine_specs.dhis2_dialect:Executing DHIS2 query: SELECT
  "Period",
  "OrgUnit",
  SUM("105_EP01b_Malaria_Total") AS sum_1,
  SUM("105_EP01a_Suspected_fever") AS sum_2,
  SUM("105_EP01d_Malaria_cases_treated") AS sum_3
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "Period",
  "OrgUnit"
ORDER BY
  SUM("105_EP01b_Malaria_Total") DESC
LIMIT 10000
2025-12-06 19:42:09,443:INFO:superset.db_engine_specs.dhis2_dialect:Parsed endpoint: analytics
2025-12-06 19:42:09,444:INFO:superset.db_engine_specs.dhis2_dialect:Using stored parameters from Flask g for table: analytics

[DHIS2] Executing query: SELECT
  "Period",
  "OrgUnit",
  SUM("105_EP01b_Malaria_Total") AS sum_1,
  SUM("105_EP01a_Suspected_fever") AS sum_2
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "Period",
  "OrgUnit"
ORDER BY
  SUM("105_EP01b_Malaria_Total") DESC
LIMIT 10000
[DHIS2] Parsed endpoint: analytics
[DHIS2] Found params in Flask g for analytics: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;
[DHIS2] Executing query: SELECT
  "Period",
  "OrgUnit",
  SUM("105_EP01b_Malaria_Total") AS sum_1,
  SUM("105_EP01a_Suspected_fever") AS sum_2
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "Period",
  "OrgUnit"
ORDER BY
  SUM("105_EP01b_Malaria_Total") DESC
LIMIT 10000
[DHIS2] Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
[DHIS2] Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
[DHIS2] Parsed endpoint: analytics
[DHIS2] API request URL: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
[DHIS2] Found params in Flask g for analytics: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;
[DHIS2] Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
[DHIS2] Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
[DHIS2] API request URL: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
[DHIS2] Raw API response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Raw DHIS2 rows count: 16
[DHIS2] First raw row: ['QHnwKs2OUZv', '2020', 'akV6429SUqu', '15266488']
[DHIS2] Parsing response for endpoint: analytics
[DHIS2] Response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Response sample: {'headers': [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}], 'metaDat
[DHIS2] Using WIDE/PIVOTED format (Period, OrgUnit, DX1, DX2, ...) for analytics
[DHIS2] normalize_analytics: pivot=True, using WIDE/PIVOTED format
[DHIS2] PIVOT CONSTRUCTION:
[DHIS2]   data_elements (UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   data_element_list (sorted UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   col_names (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized row count: 4
[DHIS2] First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] _set_description: columns=['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], types=['String', 'String', 'String', 'String', 'String', 'String']
[DHIS2] Transformed rows count: 4
[DHIS2] First transformed row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] Fetched 4 rows
[DHIS2] fetchall() called - returning 4 rows
[DHIS2] fetchall() - First row type: <class 'tuple'>
[DHIS2] fetchall() - First row (original): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Column count from description: 6
[DHIS2] fetchall() - First row (fixed types): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Type enforcement: dimensions=STRING, measures=FLOAT
[DHIS2] Raw API response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Raw DHIS2 rows count: 16
[DHIS2] First raw row: ['QHnwKs2OUZv', '2020', 'akV6429SUqu', '15266488']
[DHIS2] Parsing response for endpoint: analytics
[DHIS2] Response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Response sample: {'headers': [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}], 'metaDat
[DHIS2] Using WIDE/PIVOTED format (Period, OrgUnit, DX1, DX2, ...) for analytics
[DHIS2] normalize_analytics: pivot=True, using WIDE/PIVOTED format
[DHIS2] PIVOT CONSTRUCTION:
[DHIS2]   data_elements (UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   data_element_list (sorted UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   col_names (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized row count: 4
[DHIS2] First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] _set_description: columns=['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], types=['String', 'String', 'String', 'String', 'String', 'String']
[DHIS2] Transformed rows count: 4
[DHIS2] First transformed row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] Fetched 4 rows
[DHIS2] fetchall() called - returning 4 rows
[DHIS2] fetchall() - First row type: <class 'tuple'>
[DHIS2] fetchall() - First row (original): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Column count from description: 6
[DHIS2] fetchall() - First row (fixed types): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Type enforcement: dimensions=STRING, measures=FLOAT
[DHIS2] Executing query: SELECT
  "Period",
  "OrgUnit",
  SUM("105_EP01b_Malaria_Total") AS sum_1,
  SUM("105_EP01a_Suspected_fever") AS sum_2,
  SUM("105_EP01d_Malaria_cases_treated") AS sum_3
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "Period",
  "OrgUnit"
ORDER BY
  SUM("105_EP01b_Malaria_Total") DESC
LIMIT 10000
[DHIS2] Parsed endpoint: analytics
[DHIS2] Found params in Flask g for analytics: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;
[DHIS2] Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}2025-12-06 19:42:09,444:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 connection initialized: https://tests.dhis2.hispuganda.org/hmis/api
2025-12-06 19:42:09,444:INFO:superset.db_engine_specs.dhis2_dialect:Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
2025-12-06 19:42:09,445:INFO:superset.db_engine_specs.dhis2_dialect:Executing DHIS2 query: SELECT
  "Period",
  "OrgUnit",
  SUM("105_EP01b_Malaria_Total") AS sum_1,
  SUM("105_EP01a_Suspected_fever") AS sum_2,
  SUM("105_EP01d_Malaria_cases_treated") AS sum_3
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "Period",
  "OrgUnit"
ORDER BY
  SUM("105_EP01b_Malaria_Total") DESC
LIMIT 10000
2025-12-06 19:42:09,445:INFO:superset.db_engine_specs.dhis2_dialect:Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
2025-12-06 19:42:09,445:INFO:superset.db_engine_specs.dhis2_dialect:Parsed endpoint: analytics
2025-12-06 19:42:09,445:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API request: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
2025-12-06 19:42:09,445:INFO:superset.db_engine_specs.dhis2_dialect:Using stored parameters from Flask g for table: analytics
2025-12-06 19:42:09,446:INFO:superset.db_engine_specs.dhis2_dialect:Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
2025-12-06 19:42:09,446:INFO:superset.db_engine_specs.dhis2_dialect:Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
2025-12-06 19:42:09,446:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API request: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
2025-12-06 19:42:10,342:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:42:10] "PUT /api/v1/explore/form_data/fTQlGTUBnOM?tab_id=6 HTTP/1.1" 200 -
2025-12-06 19:42:21,245:INFO:superset.db_engine_specs.dhis2_dialect:Using wide/pivoted format for analytics
2025-12-06 19:42:21,246:INFO:superset.db_engine_specs.dhis2_dialect:normalize_analytics called with pivot=True, returning WIDE format
2025-12-06 19:42:21,247:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column construction - data_elements: ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
2025-12-06 19:42:21,247:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column names constructed (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 19:42:21,247:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] FIRST ROW CONSTRUCTION:
2025-12-06 19:42:21,247:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   Period (index 0): 2020
2025-12-06 19:42:21,247:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   OrgUnit (index 1): MOH - Uganda
2025-12-06 19:42:21,248:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01b. Malaria Total (index 2): 14479324
2025-12-06 19:42:21,248:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01a. Suspected fever (index 3): 22994823
2025-12-06 19:42:21,248:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01d. Malaria cases treated (index 4): 15266488
2025-12-06 19:42:21,248:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01c. Malaria Confirmed (B/s and RDT Positive) (index 5): 13326277
2025-12-06 19:42:21,248:INFO:superset.db_engine_specs.dhis2_dialect:First pivoted row - Period: '2020', OrgUnit: 'MOH - Uganda'
2025-12-06 19:42:21,248:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total pivoted rows: 4, columns: 6
2025-12-06 19:42:21,248:INFO:superset.db_engine_specs.dhis2_dialect:Normalized 4 rows with 6 columns for endpoint analytics
2025-12-06 19:42:21,248:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API returned 4 rows
2025-12-06 19:42:21,293:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() - Row count: 4
2025-12-06 19:42:21,294:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 19:42:21,294:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names length: 6
2025-12-06 19:42:21,294:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values count: 6
2025-12-06 19:42:21,294:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-06 19:42:21,294:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 0 (Period): 2020 -> 2020 (STRING)
2025-12-06 19:42:21,294:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (OrgUnit): MOH - Uganda -> MOH - Uganda (STRING)
2025-12-06 19:42:21,295:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (105_EP01b_Malaria_Total): 14479324 (PROCESSED)
2025-12-06 19:42:21,295:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (105_EP01a_Suspected_fever): 22994823 (PROCESSED)
2025-12-06 19:42:21,295:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (105_EP01d_Malaria_cases_treated): 15266488 (PROCESSED)
2025-12-06 19:42:21,295:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() returning 4 rows with 6 columns each
2025-12-06 19:42:21,296:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Got 4 rows from cursor
2025-12-06 19:42:21,296:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-06 19:42:21,296:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 19:42:21,296:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Types from cursor: ['String', 'String', 'String', 'String', 'String', 'String']
2025-12-06 19:42:21,306:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: DataFrame created with 4 rows, 6 columns
2025-12-06 19:42:21,306:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 19:42:21,308:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes BEFORE fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-06 19:42:21,312:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Period' to object dtype (dimension)
2025-12-06 19:42:21,313:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'OrgUnit' to object dtype (dimension)
2025-12-06 19:42:21,314:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes AFTER fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-06 19:42:21,316:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: First row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-06 19:42:21,320:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] BEFORE assign_column_label:
2025-12-06 19:42:21,320:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 6)
2025-12-06 19:42:21,320:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 19:42:21,320:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['Period', 'OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-06 19:42:21,320:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: False
2025-12-06 19:42:21,320:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-06 19:42:21,320:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Column truncation needed: df has 6 columns, expected 5
2025-12-06 19:42:21,320:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   DataFrame actual columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 19:42:21,320:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Expected columns: ['Period', 'OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-06 19:42:21,320:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] âœ“ Selecting columns BY NAME (matched all expected columns)
2025-12-06 19:42:21,320:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Column mapping: {'Period': 'Period', 'OrgUnit': 'OrgUnit', 'SUM(105_EP01b_Malaria_Total)': '105_EP01b_Malaria_Total', 'SUM(105_EP01a_Suspected_fever)': '105_EP01a_Suspected_fever', 'SUM(105_EP01d_Malaria_cases_treated)': '105_EP01d_Malaria_cases_treated'}
2025-12-06 19:42:21,320:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] Column Selection âœ“ SUCCESS - method=BY_NAME, datasource=analytics_LAST_YEAR_20251206
2025-12-06 19:42:21,320:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-06 19:42:21,320:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   tried_by_name=True, success=True, fallback=False
2025-12-06 19:42:21,320:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Assigning column labels: ['Period', 'OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-06 19:42:21,320:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] AFTER assign_column_label:
2025-12-06 19:42:21,320:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 5)
2025-12-06 19:42:21,320:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-06 19:42:21,320:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['Period', 'OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-06 19:42:21,320:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: True
2025-12-06 19:42:21,320:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', 'SUM(105_EP01b_Malaria_Total)': 14479324, 'SUM(105_EP01a_Suspected_fever)': 22994823, 'SUM(105_EP01d_Malaria_cases_treated)': 15266488}
2025-12-06 19:42:21,322:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] DataFrame columns: ['Period', 'OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-06 19:42:21,322:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Aggregates: {'SUM(105_EP01b_Malaria_Total)': {'operator': 'mean'}, 'SUM(105_EP01a_Suspected_fever)': {'operator': 'mean'}, 'SUM(105_EP01d_Malaria_cases_treated)': {'operator': 'mean'}}
2025-12-06 19:42:21,322:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105_EP01b_Malaria_Total)', column='SUM(105_EP01b_Malaria_Total)'
2025-12-06 19:42:21,322:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105_EP01a_Suspected_fever)', column='SUM(105_EP01a_Suspected_fever)'
2025-12-06 19:42:21,323:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105_EP01d_Malaria_cases_treated)', column='SUM(105_EP01d_Malaria_cases_treated)'
2025-12-06 19:42:21,395:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:42:21] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-06 19:42:21,521:INFO:superset.db_engine_specs.dhis2_dialect:Using wide/pivoted format for analytics
2025-12-06 19:42:21,521:INFO:superset.db_engine_specs.dhis2_dialect:normalize_analytics called with pivot=True, returning WIDE format
2025-12-06 19:42:21,521:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column construction - data_elements: ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
2025-12-06 19:42:21,522:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column names constructed (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 19:42:21,522:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] FIRST ROW CONSTRUCTION:
2025-12-06 19:42:21,522:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   Period (index 0): 2020
2025-12-06 19:42:21,522:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   OrgUnit (index 1): MOH - Uganda
2025-12-06 19:42:21,522:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01b. Malaria Total (index 2): 14479324
2025-12-06 19:42:21,522:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01a. Suspected fever (index 3): 22994823
2025-12-06 19:42:21,522:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01d. Malaria cases treated (index 4): 15266488
2025-12-06 19:42:21,522:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01c. Malaria Confirmed (B/s and RDT Positive) (index 5): 13326277
2025-12-06 19:42:21,522:INFO:superset.db_engine_specs.dhis2_dialect:First pivoted row - Period: '2020', OrgUnit: 'MOH - Uganda'
2025-12-06 19:42:21,522:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total pivoted rows: 4, columns: 6
2025-12-06 19:42:21,522:INFO:superset.db_engine_specs.dhis2_dialect:Normalized 4 rows with 6 columns for endpoint analytics
2025-12-06 19:42:21,522:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API returned 4 rows
2025-12-06 19:42:21,538:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() - Row count: 4
2025-12-06 19:42:21,538:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 19:42:21,538:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names length: 6
2025-12-06 19:42:21,539:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values count: 6
2025-12-06 19:42:21,539:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-06 19:42:21,539:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 0 (Period): 2020 -> 2020 (STRING)
2025-12-06 19:42:21,539:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (OrgUnit): MOH - Uganda -> MOH - Uganda (STRING)
2025-12-06 19:42:21,539:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (105_EP01b_Malaria_Total): 14479324 (PROCESSED)
2025-12-06 19:42:21,539:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (105_EP01a_Suspected_fever): 22994823 (PROCESSED)
2025-12-06 19:42:21,539:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (105_EP01d_Malaria_cases_treated): 15266488 (PROCESSED)
2025-12-06 19:42:21,539:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() returning 4 rows with 6 columns each
2025-12-06 19:42:21,539:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Got 4 rows from cursor
2025-12-06 19:42:21,539:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-06 19:42:21,539:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 19:42:21,539:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Types from cursor: ['String', 'String', 'String', 'String', 'String', 'String']
2025-12-06 19:42:21,541:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: DataFrame created with 4 rows, 6 columns
2025-12-06 19:42:21,541:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 19:42:21,542:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes BEFORE fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-06 19:42:21,542:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Period' to object dtype (dimension)
2025-12-06 19:42:21,542:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'OrgUnit' to object dtype (dimension)
2025-12-06 19:42:21,543:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes AFTER fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-06 19:42:21,543:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: First row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-06 19:42:21,546:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] BEFORE assign_column_label:
2025-12-06 19:42:21,546:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 6)
2025-12-06 19:42:21,546:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 19:42:21,546:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['Period', 'OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-06 19:42:21,546:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: False
2025-12-06 19:42:21,546:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-06 19:42:21,546:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Column truncation needed: df has 6 columns, expected 5
2025-12-06 19:42:21,546:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   DataFrame actual columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 19:42:21,546:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Expected columns: ['Period', 'OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-06 19:42:21,546:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] âœ“ Selecting columns BY NAME (matched all expected columns)
2025-12-06 19:42:21,546:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Column mapping: {'Period': 'Period', 'OrgUnit': 'OrgUnit', 'SUM(105_EP01b_Malaria_Total)': '105_EP01b_Malaria_Total', 'SUM(105_EP01a_Suspected_fever)': '105_EP01a_Suspected_fever', 'SUM(105_EP01d_Malaria_cases_treated)': '105_EP01d_Malaria_cases_treated'}
2025-12-06 19:42:21,546:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] Column Selection âœ“ SUCCESS - method=BY_NAME, datasource=analytics_LAST_YEAR_20251206
2025-12-06 19:42:21,547:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-06 19:42:21,547:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   tried_by_name=True, success=True, fallback=False
2025-12-06 19:42:21,547:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Assigning column labels: ['Period', 'OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-06 19:42:21,547:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] AFTER assign_column_label:
2025-12-06 19:42:21,547:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 5)
2025-12-06 19:42:21,547:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-06 19:42:21,547:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['Period', 'OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-06 19:42:21,547:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: True
2025-12-06 19:42:21,547:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', 'SUM(105_EP01b_Malaria_Total)': 14479324, 'SUM(105_EP01a_Suspected_fever)': 22994823, 'SUM(105_EP01d_Malaria_cases_treated)': 15266488}
2025-12-06 19:42:21,548:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] DataFrame columns: ['Period', 'OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-06 19:42:21,548:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Aggregates: {'SUM(105_EP01b_Malaria_Total)': {'operator': 'mean'}, 'SUM(105_EP01a_Suspected_fever)': {'operator': 'mean'}, 'SUM(105_EP01d_Malaria_cases_treated)': {'operator': 'mean'}}
2025-12-06 19:42:21,548:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105_EP01b_Malaria_Total)', column='SUM(105_EP01b_Malaria_Total)'
2025-12-06 19:42:21,548:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105_EP01a_Suspected_fever)', column='SUM(105_EP01a_Suspected_fever)'
2025-12-06 19:42:21,548:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105_EP01d_Malaria_cases_treated)', column='SUM(105_EP01d_Malaria_cases_treated)'
2025-12-06 19:42:21,560:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:42:21] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-06 19:42:22,416:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:42:22] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-06 19:43:05,106:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:43:05] "GET /static/assets/thumbnail.a924bed4.png HTTP/1.1" 200 -
2025-12-06 19:43:05,106:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:43:05] "GET /static/assets/thumbnail.9d4c8d11.png HTTP/1.1" 200 -
2025-12-06 19:43:05,107:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:43:05] "GET /static/assets/thumbnail.ab750ae6.png HTTP/1.1" 200 -
2025-12-06 19:43:05,107:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:43:05] "GET /static/assets/thumbnail.5ec3e6bd.png HTTP/1.1" 200 -
2025-12-06 19:43:05,108:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:43:05] "GET /static/assets/thumbnail.8d7d3cbe.png HTTP/1.1" 200 -
2025-12-06 19:43:07,047:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:43:07] "GET /static/assets/thumbnail.1a9ace38.png HTTP/1.1" 200 -
2025-12-06 19:43:07,048:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:43:07] "GET /static/assets/thumbnail.f2cfa9c4.png HTTP/1.1" 200 -
2025-12-06 19:43:07,049:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:43:07] "GET /static/assets/thumbnail.60104e6d.png HTTP/1.1" 200 -
2025-12-06 19:43:07,052:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:43:07] "GET /static/assets/thumbnail.154cdccd.png HTTP/1.1" 200 -
2025-12-06 19:43:07,052:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:43:07] "GET /static/assets/thumbnail.a463d279.png HTTP/1.1" 200 -
2025-12-06 19:43:07,054:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:43:07] "GET /static/assets/thumbnail.c2670397.png HTTP/1.1" 200 -
2025-12-06 19:43:07,056:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:43:07] "GET /static/assets/thumbnail.241865fc.png HTTP/1.1" 200 -
2025-12-06 19:43:07,058:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:43:07] "GET /static/assets/thumbnail.22e46caa.png HTTP/1.1" 200 -
2025-12-06 19:43:07,058:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:43:07] "GET /static/assets/thumbnail.8e8858da.png HTTP/1.1" 200 -
2025-12-06 19:43:07,059:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:43:07] "GET /static/assets/thumbnail.f5779edd.png HTTP/1.1" 200 -
2025-12-06 19:43:07,059:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:43:07] "GET /static/assets/thumbnail.9506c7f0.png HTTP/1.1" 200 -
2025-12-06 19:43:08,334:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:43:08] "GET /static/assets/thumbnail.d29dbe85.png HTTP/1.1" 200 -
2025-12-06 19:43:08,335:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:43:08] "GET /static/assets/thumbnail.c501c39d.png HTTP/1.1" 200 -
2025-12-06 19:43:08,335:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:43:08] "GET /static/assets/thumbnail.b0251af6.png HTTP/1.1" 200 -
2025-12-06 19:43:08,335:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:43:08] "GET /static/assets/thumbnail.ab8113ee.png HTTP/1.1" 200 -
2025-12-06 19:43:08,336:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:43:08] "GET /static/assets/thumbnail.0fd3ce37.png HTTP/1.1" 200 -
2025-12-06 19:43:08,338:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:43:08] "GET /static/assets/thumbnail.fa7923e8.png HTTP/1.1" 200 -
2025-12-06 19:43:08,339:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:43:08] "GET /static/assets/thumbnail.6a0f4c32.png HTTP/1.1" 200 -
2025-12-06 19:43:08,341:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:43:08] "GET /static/assets/thumbnail.76dd9cc1.png HTTP/1.1" 200 -
2025-12-06 19:43:08,343:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:43:08] "GET /static/assets/thumbnail.1e4e5b08.png HTTP/1.1" 200 -
2025-12-06 19:43:08,343:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:43:08] "GET /static/assets/thumbnail.b290682b.png HTTP/1.1" 200 -
2025-12-06 19:43:08,345:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:43:08] "GET /static/assets/thumbnail.394cbcc9.png HTTP/1.1" 200 -
2025-12-06 19:43:08,349:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:43:08] "GET /static/assets/thumbnail.9905c92f.png HTTP/1.1" 200 -
2025-12-06 19:43:08,350:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:43:08] "GET /static/assets/thumbnail.f2d16e54.png HTTP/1.1" 200 -
2025-12-06 19:43:08,351:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:43:08] "GET /static/assets/thumbnail.f6ecb617.png HTTP/1.1" 200 -
2025-12-06 19:43:08,353:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:43:08] "GET /static/assets/thumbnail.94dfb10d.png HTTP/1.1" 200 -
2025-12-06 19:43:08,354:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:43:08] "GET /static/assets/thumbnail.2b21fc4a.png HTTP/1.1" 200 -
2025-12-06 19:43:08,356:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:43:08] "GET /static/assets/thumbnail.e9235c2d.png HTTP/1.1" 200 -
2025-12-06 19:43:08,356:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:43:08] "GET /static/assets/thumbnail.0bdf08a4.png HTTP/1.1" 200 -
2025-12-06 19:43:08,359:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:43:08] "GET /static/assets/thumbnail.e8cd4936.png HTTP/1.1" 200 -
2025-12-06 19:43:08,362:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:43:08] "GET /static/assets/thumbnail.aa9710fc.png HTTP/1.1" 200 -
2025-12-06 19:43:08,362:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:43:08] "GET /static/assets/thumbnail.a55df64a.png HTTP/1.1" 200 -
2025-12-06 19:43:29,060:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1458, in dispatch_request
    self.raise_routing_exception(req)
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1440, in raise_routing_exception
    raise request.routing_exception  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/ctx.py", line 353, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/werkzeug/routing/map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-12-06 19:43:29,065:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:43:29] "[33mGET /ws HTTP/1.1[0m" 404 -
2025-12-06 19:43:29,200:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1458, in dispatch_request
    self.raise_routing_exception(req)
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1440, in raise_routing_exception
    raise request.routing_exception  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/ctx.py", line 353, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/werkzeug/routing/map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-12-06 19:43:29,202:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:43:29] "[33mGET /ws HTTP/1.1[0m" 404 -
2025-12-06 19:43:35,121:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:43:35] "GET /api/v1/me/ HTTP/1.1" 200 -
2025-12-06 19:43:39,684:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:43:39] "GET /api/v1/me/ HTTP/1.1" 200 -
2025-12-06 19:43:45,502:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:43:45] "GET /api/v1/me/ HTTP/1.1" 200 -
2025-12-06 19:45:11,302:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:45:11] "GET /api/v1/me/ HTTP/1.1" 200 -
2025-12-06 19:45:53,678:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:45:53] "PUT /api/v1/explore/form_data/fTQlGTUBnOM?tab_id=6 HTTP/1.1" 200 -
2025-12-06 19:45:58,128:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:45:58] "PUT /api/v1/explore/form_data/fTQlGTUBnOM?tab_id=6 HTTP/1.1" 200 -
2025-12-06 19:46:02,211:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:46:02] "PUT /api/v1/explore/form_data/fTQlGTUBnOM?tab_id=6 HTTP/1.1" 200 -
2025-12-06 19:46:13,715:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:46:13] "PUT /api/v1/explore/form_data/fTQlGTUBnOM?tab_id=6 HTTP/1.1" 200 -
2025-12-06 19:46:37,228:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:46:37] "PUT /api/v1/explore/form_data/fTQlGTUBnOM?tab_id=6 HTTP/1.1" 200 -
2025-12-06 19:46:40,115:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:46:40] "PUT /api/v1/explore/form_data/fTQlGTUBnOM?tab_id=6 HTTP/1.1" 200 -
2025-12-06 19:46:41,262:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:46:41] "PUT /api/v1/explore/form_data/fTQlGTUBnOM?tab_id=6 HTTP/1.1" 200 -
2025-12-06 19:46:48,719:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:46:48] "PUT /api/v1/explore/form_data/fTQlGTUBnOM?tab_id=6 HTTP/1.1" 200 -
2025-12-06 19:46:49,801:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:46:49] "PUT /api/v1/explore/form_data/fTQlGTUBnOM?tab_id=6 HTTP/1.1" 200 -
2025-12-06 19:46:51,903:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:46:51] "PUT /api/v1/explore/form_data/fTQlGTUBnOM?tab_id=6 HTTP/1.1" 200 -
2025-12-06 19:46:56,149:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:46:56] "PUT /api/v1/explore/form_data/fTQlGTUBnOM?tab_id=6 HTTP/1.1" 200 -
2025-12-06 19:47:21,651:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:47:21] "PUT /api/v1/explore/form_data/fTQlGTUBnOM?tab_id=6 HTTP/1.1" 200 -
2025-12-06 19:50:32,416:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:50:32] "GET /api/v1/me/ HTTP/1.1" 200 -
2025-12-06 19:52:01,202:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1458, in dispatch_request
    self.raise_routing_exception(req)
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1440, in raise_routing_exception
    raise request.routing_exception  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/ctx.py", line 353, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/werkzeug/routing/map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-12-06 19:52:01,206:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:52:01] "[33mGET /ws HTTP/1.1[0m" 404 -
2025-12-06 19:52:02,196:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1458, in dispatch_request
    self.raise_routing_exception(req)
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1440, in raise_routing_exception
    raise request.routing_exception  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/ctx.py", line 353, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/werkzeug/routing/map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-12-06 19:52:02,198:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:52:02] "[33mGET /ws HTTP/1.1[0m" 404 -
2025-12-06 19:57:01,791:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:57:01] "GET /api/v1/me/ HTTP/1.1" 200 -
2025-12-06 19:57:09,861:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:57:09] "GET /api/v1/me/ HTTP/1.1" 200 -
2025-12-06 19:57:11,353:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:57:11] "GET /api/v1/me/ HTTP/1.1" 200 -
2025-12-06 19:57:14,101:ERROR:superset.models.helpers:[METRICS-TRACE] Processing 2 metrics
2025-12-06 19:57:14,101:ERROR:superset.models.helpers:[METRICS-TRACE] Processing 2 metrics
2025-12-06 19:57:14,101:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 0: adhoc - SUM(105_EP01b_Malaria_Total)
2025-12-06 19:57:14,101:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 0: adhoc - SUM(105_EP01b_Malaria_Total)
2025-12-06 19:57:14,102:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105_EP01b_Malaria_Total)
2025-12-06 19:57:14,102:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105_EP01b_Malaria_Total)
2025-12-06 19:57:14,102:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 1: adhoc - SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)
2025-12-06 19:57:14,102:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 1: adhoc - SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)
2025-12-06 19:57:14,103:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)
2025-12-06 19:57:14,103:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)
2025-12-06 19:57:14,103:ERROR:superset.models.helpers:[METRICS-TRACE] Total metrics added: 2
2025-12-06 19:57:14,103:ERROR:superset.models.helpers:[METRICS-TRACE] Total metrics added: 2
2025-12-06 19:57:14,106:ERROR:superset.models.helpers:[METRICS-TRACE] Before dedup: 1 select_exprs + 2 metrics_exprs
2025-12-06 19:57:14,107:ERROR:superset.models.helpers:[METRICS-TRACE] Before dedup: 1 select_exprs + 2 metrics_exprs
2025-12-06 19:57:14,107:ERROR:superset.models.helpers:[METRICS-TRACE] After dedup: 3 total select_exprs
2025-12-06 19:57:14,107:ERROR:superset.models.helpers:[METRICS-TRACE] After dedup: 3 total select_exprs
2025-12-06 19:57:14,107:INFO:superset.models.helpers:[COLUMN_TRACE] SQL Query Building:
2025-12-06 19:57:14,107:INFO:superset.models.helpers:[COLUMN_TRACE] SQL Query Building:
2025-12-06 19:57:14,107:INFO:superset.models.helpers:[COLUMN_TRACE]   columns: [{'columnType': 'BASE_AXIS', 'sqlExpression': 'OrgUnit', 'label': 'OrgUnit', 'expressionType': 'SQL'}]
2025-12-06 19:57:14,107:INFO:superset.models.helpers:[COLUMN_TRACE]   columns: [{'columnType': 'BASE_AXIS', 'sqlExpression': 'OrgUnit', 'label': 'OrgUnit', 'expressionType': 'SQL'}]
2025-12-06 19:57:14,107:INFO:superset.models.helpers:[COLUMN_TRACE]   metrics: [{'expressionType': 'SIMPLE', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01b_Malaria_Total', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 3, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'INT', 'type_generic': 0, 'uuid': '959bffaa-826b-4d13-8b7b-6d9c4ea25e50', 'verbose_name': None, 'warning_markdown': None}, 'aggregate': 'SUM', 'sqlExpression': None, 'datasourceWarning': False, 'hasCustomLabel': False, 'label': 'SUM(105_EP01b_Malaria_Total)', 'optionName': 'metric_7om94y7wg44_o1syozv7mh'}, {'expressionType': 'SIMPLE', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 6, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'column', 'type_generic': 0, 'uuid': '928946a1-6cea-4202-b8d6-0683414af79e', 'verbose_name': None, 'warning_markdown': None}, 'aggregate': 'SUM', 'sqlExpression': None, 'datasourceWarning': False, 'hasCustomLabel': False, 'label': 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', 'optionName': 'metric_cy8hjg2pvba_0r6xq6dmz2h'}]
2025-12-06 19:57:14,107:INFO:superset.models.helpers:[COLUMN_TRACE]   metrics: [{'expressionType': 'SIMPLE', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01b_Malaria_Total', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 3, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'INT', 'type_generic': 0, 'uuid': '959bffaa-826b-4d13-8b7b-6d9c4ea25e50', 'verbose_name': None, 'warning_markdown': None}, 'aggregate': 'SUM', 'sqlExpression': None, 'datasourceWarning': False, 'hasCustomLabel': False, 'label': 'SUM(105_EP01b_Malaria_Total)', 'optionName': 'metric_7om94y7wg44_o1syozv7mh'}, {'expressionType': 'SIMPLE', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 6, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'column', 'type_generic': 0, 'uuid': '928946a1-6cea-4202-b8d6-0683414af79e', 'verbose_name': None, 'warning_markdown': None}, 'aggregate': 'SUM', 'sqlExpression': None, 'datasourceWarning': False, 'hasCustomLabel': False, 'label': 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', 'optionName': 'metric_cy8hjg2pvba_0r6xq6dmz2h'}]
2025-12-06 19:57:14,107:INFO:superset.models.helpers:[COLUMN_TRACE]   groupby: []
2025-12-06 19:57:14,107:INFO:superset.models.helpers:[COLUMN_TRACE]   groupby: []
2025-12-06 19:57:14,107:INFO:superset.models.helpers:[COLUMN_TRACE]   labels_expected: ['OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)']
2025-12-06 19:57:14,107:INFO:superset.models.helpers:[COLUMN_TRACE]   labels_expected: ['OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)']
2025-12-06 19:57:14,107:INFO:superset.models.helpers:[COLUMN_TRACE]   select_exprs count: 3
2025-12-06 19:57:14,107:INFO:superset.models.helpers:[COLUMN_TRACE]   select_exprs count: 3
2025-12-06 19:57:14,107:INFO:superset.models.helpers:[COLUMN_TRACE]     [0] key=OrgUnit, name=OrgUnit, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-06 19:57:14,108:INFO:superset.models.helpers:[COLUMN_TRACE]     [0] key=OrgUnit, name=OrgUnit, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-06 19:57:14,108:INFO:superset.models.helpers:[COLUMN_TRACE]     [1] key=SUM(105_EP01b_Malaria_Total), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-06 19:57:14,108:INFO:superset.models.helpers:[COLUMN_TRACE]     [2] key=SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-06 19:57:14,108:INFO:superset.models.helpers:[COLUMN_TRACE]     [1] key=SUM(105_EP01b_Malaria_Total), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-06 19:57:14,108:INFO:superset.connectors.sqla.models:[DHIS2] get_from_clause for virtual dataset 1: analytics_LAST_YEAR_20251206
2025-12-06 19:57:14,108:INFO:superset.models.helpers:[COLUMN_TRACE]     [2] key=SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-06 19:57:14,108:INFO:superset.connectors.sqla.models:[DHIS2] Full SQL stored: SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
2025-12-06 19:57:14,108:INFO:superset.connectors.sqla.models:[DHIS2] get_from_clause for virtual dataset 1: analytics_LAST_YEAR_20251206
2025-12-06 19:57:14,108:INFO:superset.connectors.sqla.models:[DHIS2] Loaded params from extra field: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayPropert
2025-12-06 19:57:14,108:INFO:superset.connectors.sqla.models:[DHIS2] Full SQL stored: SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
2025-12-06 19:57:14,108:INFO:superset.connectors.sqla.models:[DHIS2] Loaded params from extra field: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayPropert
2025-12-06 19:57:14,109:INFO:superset.connectors.sqla.models:[DHIS2] Cached params with key: dhis2_params_1_analytics
2025-12-06 19:57:14,109:INFO:superset.connectors.sqla.models:[DHIS2] Stored params in Flask g for DHIS2 table: analytics
2025-12-06 19:57:14,111:INFO:superset.connectors.sqla.models:[DHIS2] Cached params with key: dhis2_params_1_analytics
2025-12-06 19:57:14,111:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Query execution in connectors/sqla/models.py:
2025-12-06 19:57:14,112:INFO:superset.connectors.sqla.models:[DHIS2] Stored params in Flask g for DHIS2 table: analytics
2025-12-06 19:57:14,112:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   SQL (first 500 chars): SELECT "OrgUnit", sum("105_EP01b_Malaria_Total") AS sum_1, sum("105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive") AS sum_2 
FROM (SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
) AS virtual_table GROUP BY "OrgUnit" ORDER BY sum("105_EP01b_Malaria_Total") DESC
 LIMIT 10000
2025-12-06 19:57:14,113:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   labels_expected: ['OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)']
2025-12-06 19:57:14,115:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Query execution in connectors/sqla/models.py:
2025-12-06 19:57:14,115:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 connection initialized: https://tests.dhis2.hispuganda.org/hmis/api
2025-12-06 19:57:14,115:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   SQL (first 500 chars): SELECT "OrgUnit", sum("105_EP01b_Malaria_Total") AS sum_1, sum("105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive") AS sum_2 
FROM (SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
) AS virtual_table GROUP BY "OrgUnit" ORDER BY sum("105_EP01b_Malaria_Total") DESC
 LIMIT 10000
2025-12-06 19:57:14,116:INFO:superset.db_engine_specs.dhis2_dialect:Executing DHIS2 query: SELECT
  "OrgUnit",
  SUM("105_EP01b_Malaria_Total") AS sum_1,
  SUM("105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive") AS sum_2
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "OrgUnit"
ORDER BY
  SUM("105_EP01b_Malaria_Total") DESC
LIMIT 10000
2025-12-06 19:57:14,116:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   labels_expected: ['OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)']
2025-12-06 19:57:14,116:INFO:superset.db_engine_specs.dhis2_dialect:Parsed endpoint: analytics
2025-12-06 19:57:14,117:INFO:superset.db_engine_specs.dhis2_dialect:Using stored parameters from Flask g for table: analytics
2025-12-06 19:57:14,117:INFO:superset.db_engine_specs.dhis2_dialect:Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
2025-12-06 19:57:14,117:INFO:superset.db_engine_specs.dhis2_dialect:Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}

[DHIS2] Executing query: SELECT
  "Period",
  "OrgUnit",
  SUM("105_EP01b_Malaria_Total") AS sum_1,
  SUM("105_EP01a_Suspected_fever") AS sum_2,
  SUM("105_EP01d_Malaria_cases_treated") AS sum_3
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "Period",
  "OrgUnit"
ORDER BY
  SUM("105_EP01b_Malaria_Total") DESC
LIMIT 10000
[DHIS2] Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
[DHIS2] Parsed endpoint: analytics
[DHIS2] API request URL: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
[DHIS2] Found params in Flask g for analytics: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;
[DHIS2] Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
[DHIS2] Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
[DHIS2] API request URL: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
[DHIS2] Raw API response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Raw DHIS2 rows count: 16
[DHIS2] First raw row: ['QHnwKs2OUZv', '2020', 'akV6429SUqu', '15266488']
[DHIS2] Parsing response for endpoint: analytics
[DHIS2] Response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Response sample: {'headers': [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}], 'metaDat
[DHIS2] Using WIDE/PIVOTED format (Period, OrgUnit, DX1, DX2, ...) for analytics
[DHIS2] normalize_analytics: pivot=True, using WIDE/PIVOTED format
[DHIS2] PIVOT CONSTRUCTION:
[DHIS2]   data_elements (UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   data_element_list (sorted UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   col_names (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized row count: 4
[DHIS2] First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] _set_description: columns=['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], types=['String', 'String', 'String', 'String', 'String', 'String']
[DHIS2] Transformed rows count: 4
[DHIS2] First transformed row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] Fetched 4 rows
[DHIS2] fetchall() called - returning 4 rows
[DHIS2] fetchall() - First row type: <class 'tuple'>
[DHIS2] fetchall() - First row (original): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Column count from description: 6
[DHIS2] fetchall() - First row (fixed types): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Type enforcement: dimensions=STRING, measures=FLOAT
[DHIS2] Raw API response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Raw DHIS2 rows count: 16
[DHIS2] First raw row: ['QHnwKs2OUZv', '2020', 'akV6429SUqu', '15266488']
[DHIS2] Parsing response for endpoint: analytics
[DHIS2] Response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Response sample: {'headers': [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}], 'metaDat
[DHIS2] Using WIDE/PIVOTED format (Period, OrgUnit, DX1, DX2, ...) for analytics
[DHIS2] normalize_analytics: pivot=True, using WIDE/PIVOTED format
[DHIS2] PIVOT CONSTRUCTION:
[DHIS2]   data_elements (UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   data_element_list (sorted UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   col_names (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized row count: 4
[DHIS2] First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] _set_description: columns=['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], types=['String', 'String', 'String', 'String', 'String', 'String']
[DHIS2] Transformed rows count: 4
[DHIS2] First transformed row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] Fetched 4 rows
[DHIS2] fetchall() called - returning 4 rows
[DHIS2] fetchall() - First row type: <class 'tuple'>
[DHIS2] fetchall() - First row (original): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Column count from description: 6
[DHIS2] fetchall() - First row (fixed types): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Type enforcement: dimensions=STRING, measures=FLOAT
[DHIS2] Executing query: SELECT
  "OrgUnit",
  SUM("105_EP01b_Malaria_Total") AS sum_1,
  SUM("105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive") AS sum_2
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "OrgUnit"
ORDER BY
  SUM("105_EP01b_Malaria_Total") DESC
LIMIT 10000
[DHIS2] Parsed endpoint: analytics
[DHIS2] Found params in Flask g for analytics: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;
[DHIS2] Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
[DHIS2] Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
[DHIS2] API request URL: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT2025-12-06 19:57:14,117:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 connection initialized: https://tests.dhis2.hispuganda.org/hmis/api
2025-12-06 19:57:14,117:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API request: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
2025-12-06 19:57:14,118:INFO:superset.db_engine_specs.dhis2_dialect:Executing DHIS2 query: SELECT
  "OrgUnit",
  SUM("105_EP01b_Malaria_Total") AS sum_1,
  SUM("105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive") AS sum_2
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "OrgUnit"
ORDER BY
  SUM("105_EP01b_Malaria_Total") DESC
LIMIT 10000
2025-12-06 19:57:14,118:INFO:superset.db_engine_specs.dhis2_dialect:Parsed endpoint: analytics
2025-12-06 19:57:14,118:INFO:superset.db_engine_specs.dhis2_dialect:Using stored parameters from Flask g for table: analytics
2025-12-06 19:57:14,118:INFO:superset.db_engine_specs.dhis2_dialect:Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
2025-12-06 19:57:14,118:INFO:superset.db_engine_specs.dhis2_dialect:Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
2025-12-06 19:57:14,118:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API request: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
2025-12-06 19:57:15,046:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:57:15] "PUT /api/v1/explore/form_data/QTQfaaLaQ_A?tab_id=12 HTTP/1.1" 200 -
2025-12-06 19:57:15,062:INFO:superset.db_engine_specs.dhis2_dialect:Using wide/pivoted format for analytics
2025-12-06 19:57:15,062:INFO:superset.db_engine_specs.dhis2_dialect:normalize_analytics called with pivot=True, returning WIDE format
2025-12-06 19:57:15,062:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column construction - data_elements: ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
2025-12-06 19:57:15,062:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column names constructed (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 19:57:15,062:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] FIRST ROW CONSTRUCTION:
2025-12-06 19:57:15,062:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   Period (index 0): 2020
2025-12-06 19:57:15,062:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   OrgUnit (index 1): MOH - Uganda
2025-12-06 19:57:15,062:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01b. Malaria Total (index 2): 14479324
2025-12-06 19:57:15,062:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01a. Suspected fever (index 3): 22994823
2025-12-06 19:57:15,062:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01d. Malaria cases treated (index 4): 15266488
2025-12-06 19:57:15,062:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01c. Malaria Confirmed (B/s and RDT Positive) (index 5): 13326277
2025-12-06 19:57:15,062:INFO:superset.db_engine_specs.dhis2_dialect:First pivoted row - Period: '2020', OrgUnit: 'MOH - Uganda'
2025-12-06 19:57:15,062:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total pivoted rows: 4, columns: 6
2025-12-06 19:57:15,062:INFO:superset.db_engine_specs.dhis2_dialect:Normalized 4 rows with 6 columns for endpoint analytics
2025-12-06 19:57:15,062:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API returned 4 rows
2025-12-06 19:57:15,066:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() - Row count: 4
2025-12-06 19:57:15,066:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 19:57:15,066:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names length: 6
2025-12-06 19:57:15,066:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values count: 6
2025-12-06 19:57:15,066:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-06 19:57:15,066:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 0 (Period): 2020 -> 2020 (STRING)
2025-12-06 19:57:15,066:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (OrgUnit): MOH - Uganda -> MOH - Uganda (STRING)
2025-12-06 19:57:15,066:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (105_EP01b_Malaria_Total): 14479324 (PROCESSED)
2025-12-06 19:57:15,066:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (105_EP01a_Suspected_fever): 22994823 (PROCESSED)
2025-12-06 19:57:15,066:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (105_EP01d_Malaria_cases_treated): 15266488 (PROCESSED)
2025-12-06 19:57:15,067:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() returning 4 rows with 6 columns each
2025-12-06 19:57:15,067:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Got 4 rows from cursor
2025-12-06 19:57:15,067:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-06 19:57:15,067:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 19:57:15,067:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Types from cursor: ['String', 'String', 'String', 'String', 'String', 'String']
2025-12-06 19:57:15,074:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: DataFrame created with 4 rows, 6 columns
2025-12-06 19:57:15,075:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 19:57:15,076:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes BEFORE fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-06 19:57:15,077:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Period' to object dtype (dimension)
2025-12-06 19:57:15,077:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'OrgUnit' to object dtype (dimension)
2025-12-06 19:57:15,077:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes AFTER fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-06 19:57:15,077:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: First row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-06 19:57:15,081:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] BEFORE assign_column_label:
2025-12-06 19:57:15,081:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 6)
2025-12-06 19:57:15,081:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 19:57:15,081:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)']
2025-12-06 19:57:15,081:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: False
2025-12-06 19:57:15,081:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-06 19:57:15,081:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Column truncation needed: df has 6 columns, expected 3
2025-12-06 19:57:15,081:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   DataFrame actual columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 19:57:15,081:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Expected columns: ['OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)']
2025-12-06 19:57:15,081:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] âœ“ Selecting columns BY NAME (matched all expected columns)
2025-12-06 19:57:15,081:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Column mapping: {'OrgUnit': 'OrgUnit', 'SUM(105_EP01b_Malaria_Total)': '105_EP01b_Malaria_Total', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)': '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'}
2025-12-06 19:57:15,082:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] Column Selection âœ“ SUCCESS - method=BY_NAME, datasource=analytics_LAST_YEAR_20251206
2025-12-06 19:57:15,082:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)']
2025-12-06 19:57:15,082:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   tried_by_name=True, success=True, fallback=False
2025-12-06 19:57:15,082:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Assigning column labels: ['OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)']
2025-12-06 19:57:15,082:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] AFTER assign_column_label:
2025-12-06 19:57:15,082:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 3)
2025-12-06 19:57:15,082:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)']
2025-12-06 19:57:15,082:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)']
2025-12-06 19:57:15,082:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: True
2025-12-06 19:57:15,082:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'OrgUnit': 'MOH - Uganda', 'SUM(105_EP01b_Malaria_Total)': 14479324, 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)': 13326277}
2025-12-06 19:57:15,083:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] DataFrame columns: ['OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)']
2025-12-06 19:57:15,083:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Aggregates: {'SUM(105_EP01b_Malaria_Total)': {'operator': 'mean'}, 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)': {'operator': 'mean'}}
2025-12-06 19:57:15,083:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105_EP01b_Malaria_Total)', column='SUM(105_EP01b_Malaria_Total)'
2025-12-06 19:57:15,083:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', column='SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)'
2025-12-06 19:57:15,095:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:57:15] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-06 19:57:15,452:INFO:superset.db_engine_specs.dhis2_dialect:Using wide/pivoted format for analytics
2025-12-06 19:57:15,452:INFO:superset.db_engine_specs.dhis2_dialect:normalize_analytics called with pivot=True, returning WIDE format
2025-12-06 19:57:15,452:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column construction - data_elements: ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
2025-12-06 19:57:15,452:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column names constructed (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 19:57:15,452:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] FIRST ROW CONSTRUCTION:
2025-12-06 19:57:15,452:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   Period (index 0): 2020
2025-12-06 19:57:15,452:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   OrgUnit (index 1): MOH - Uganda
2025-12-06 19:57:15,452:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01b. Malaria Total (index 2): 14479324
2025-12-06 19:57:15,453:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01a. Suspected fever (index 3): 22994823
2025-12-06 19:57:15,453:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01d. Malaria cases treated (index 4): 15266488
2025-12-06 19:57:15,453:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01c. Malaria Confirmed (B/s and RDT Positive) (index 5): 13326277
2025-12-06 19:57:15,453:INFO:superset.db_engine_specs.dhis2_dialect:First pivoted row - Period: '2020', OrgUnit: 'MOH - Uganda'
2025-12-06 19:57:15,453:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total pivoted rows: 4, columns: 6
2025-12-06 19:57:15,453:INFO:superset.db_engine_specs.dhis2_dialect:Normalized 4 rows with 6 columns for endpoint analytics
2025-12-06 19:57:15,453:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API returned 4 rows
2025-12-06 19:57:15,460:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() - Row count: 4
2025-12-06 19:57:15,460:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 19:57:15,460:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names length: 6
2025-12-06 19:57:15,460:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values count: 6
2025-12-06 19:57:15,461:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-06 19:57:15,461:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 0 (Period): 2020 -> 2020 (STRING)
2025-12-06 19:57:15,461:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (OrgUnit): MOH - Uganda -> MOH - Uganda (STRING)
2025-12-06 19:57:15,461:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (105_EP01b_Malaria_Total): 14479324 (PROCESSED)
2025-12-06 19:57:15,461:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (105_EP01a_Suspected_fever): 22994823 (PROCESSED)
2025-12-06 19:57:15,461:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (105_EP01d_Malaria_cases_treated): 15266488 (PROCESSED)
2025-12-06 19:57:15,461:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() returning 4 rows with 6 columns each
2025-12-06 19:57:15,461:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Got 4 rows from cursor
2025-12-06 19:57:15,461:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-06 19:57:15,461:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 19:57:15,461:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Types from cursor: ['String', 'String', 'String', 'String', 'String', 'String']
2025-12-06 19:57:15,462:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: DataFrame created with 4 rows, 6 columns
2025-12-06 19:57:15,462:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 19:57:15,462:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes BEFORE fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-06 19:57:15,462:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Period' to object dtype (dimension)
2025-12-06 19:57:15,462:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'OrgUnit' to object dtype (dimension)
2025-12-06 19:57:15,463:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes AFTER fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-06 19:57:15,463:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: First row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-06 19:57:15,467:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] BEFORE assign_column_label:
2025-12-06 19:57:15,467:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 6)
2025-12-06 19:57:15,467:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 19:57:15,467:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)']
2025-12-06 19:57:15,467:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: False
2025-12-06 19:57:15,467:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-06 19:57:15,467:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Column truncation needed: df has 6 columns, expected 3
2025-12-06 19:57:15,467:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   DataFrame actual columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 19:57:15,467:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Expected columns: ['OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)']
2025-12-06 19:57:15,467:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] âœ“ Selecting columns BY NAME (matched all expected columns)
2025-12-06 19:57:15,467:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Column mapping: {'OrgUnit': 'OrgUnit', 'SUM(105_EP01b_Malaria_Total)': '105_EP01b_Malaria_Total', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)': '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'}
2025-12-06 19:57:15,468:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] Column Selection âœ“ SUCCESS - method=BY_NAME, datasource=analytics_LAST_YEAR_20251206
2025-12-06 19:57:15,468:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)']
2025-12-06 19:57:15,468:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   tried_by_name=True, success=True, fallback=False
2025-12-06 19:57:15,468:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Assigning column labels: ['OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)']
2025-12-06 19:57:15,468:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] AFTER assign_column_label:
2025-12-06 19:57:15,468:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 3)
2025-12-06 19:57:15,468:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)']
2025-12-06 19:57:15,468:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)']
2025-12-06 19:57:15,468:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: True
2025-12-06 19:57:15,468:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'OrgUnit': 'MOH - Uganda', 'SUM(105_EP01b_Malaria_Total)': 14479324, 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)': 13326277}
2025-12-06 19:57:15,469:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] DataFrame columns: ['OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)']
2025-12-06 19:57:15,469:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Aggregates: {'SUM(105_EP01b_Malaria_Total)': {'operator': 'mean'}, 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)': {'operator': 'mean'}}
2025-12-06 19:57:15,469:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105_EP01b_Malaria_Total)', column='SUM(105_EP01b_Malaria_Total)'
2025-12-06 19:57:15,469:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', column='SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)'
2025-12-06 19:57:15,483:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:57:15] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-06 19:57:16,504:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:57:16] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-06 19:57:44,385:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:57:44] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-06 19:57:51,142:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:57:51] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-06 19:57:53,509:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:57:53] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-06 19:57:55,568:ERROR:superset.models.helpers:[METRICS-TRACE] Processing 4 metrics
2025-12-06 19:57:55,569:ERROR:superset.models.helpers:[METRICS-TRACE] Processing 4 metrics
2025-12-06 19:57:55,569:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 0: adhoc - SUM(105_EP01a_Suspected_fever)
2025-12-06 19:57:55,569:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 0: adhoc - SUM(105_EP01a_Suspected_fever)
2025-12-06 19:57:55,569:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105_EP01a_Suspected_fever)
2025-12-06 19:57:55,569:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105_EP01a_Suspected_fever)
2025-12-06 19:57:55,569:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 1: adhoc - SUM(105_EP01b_Malaria_Total)
2025-12-06 19:57:55,569:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 1: adhoc - SUM(105_EP01b_Malaria_Total)
2025-12-06 19:57:55,569:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105_EP01b_Malaria_Total)
2025-12-06 19:57:55,569:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 2: adhoc - SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)
2025-12-06 19:57:55,569:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105_EP01b_Malaria_Total)
2025-12-06 19:57:55,570:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)
2025-12-06 19:57:55,570:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 2: adhoc - SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)
2025-12-06 19:57:55,570:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 3: adhoc - SUM(105_EP01d_Malaria_cases_treated)
2025-12-06 19:57:55,570:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)
2025-12-06 19:57:55,570:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105_EP01d_Malaria_cases_treated)
2025-12-06 19:57:55,570:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 3: adhoc - SUM(105_EP01d_Malaria_cases_treated)
2025-12-06 19:57:55,570:ERROR:superset.models.helpers:[METRICS-TRACE] Total metrics added: 4
2025-12-06 19:57:55,570:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105_EP01d_Malaria_cases_treated)
2025-12-06 19:57:55,572:ERROR:superset.models.helpers:[METRICS-TRACE] Before dedup: 1 select_exprs + 4 metrics_exprs
2025-12-06 19:57:55,572:ERROR:superset.models.helpers:[METRICS-TRACE] Total metrics added: 4
2025-12-06 19:57:55,572:ERROR:superset.models.helpers:[METRICS-TRACE] After dedup: 5 total select_exprs
2025-12-06 19:57:55,573:ERROR:superset.models.helpers:[METRICS-TRACE] Before dedup: 1 select_exprs + 4 metrics_exprs
2025-12-06 19:57:55,573:INFO:superset.models.helpers:[COLUMN_TRACE] SQL Query Building:
2025-12-06 19:57:55,573:ERROR:superset.models.helpers:[METRICS-TRACE] After dedup: 5 total select_exprs
2025-12-06 19:57:55,573:INFO:superset.models.helpers:[COLUMN_TRACE]   columns: [{'columnType': 'BASE_AXIS', 'sqlExpression': 'OrgUnit', 'label': 'OrgUnit', 'expressionType': 'SQL'}]
2025-12-06 19:57:55,573:INFO:superset.models.helpers:[COLUMN_TRACE] SQL Query Building:
2025-12-06 19:57:55,573:INFO:superset.models.helpers:[COLUMN_TRACE]   metrics: [{'expressionType': 'SIMPLE', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01a_Suspected_fever', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 4, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'INT', 'type_generic': 0, 'uuid': '530216fe-7198-4b8e-b688-a479bcf67426', 'verbose_name': None, 'warning_markdown': None}, 'aggregate': 'SUM', 'sqlExpression': None, 'datasourceWarning': False, 'hasCustomLabel': False, 'label': 'SUM(105_EP01a_Suspected_fever)', 'optionName': 'metric_4dm6wzzpssx_evo63ixtdye'}, {'expressionType': 'SIMPLE', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01b_Malaria_Total', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 3, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'INT', 'type_generic': 0, 'uuid': '959bffaa-826b-4d13-8b7b-6d9c4ea25e50', 'verbose_name': None, 'warning_markdown': None}, 'aggregate': 'SUM', 'sqlExpression': None, 'datasourceWarning': False, 'hasCustomLabel': False, 'label': 'SUM(105_EP01b_Malaria_Total)', 'optionName': 'metric_7om94y7wg44_o1syozv7mh'}, {'expressionType': 'SIMPLE', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 6, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'INT', 'type_generic': 0, 'uuid': '928946a1-6cea-4202-b8d6-0683414af79e', 'verbose_name': None, 'warning_markdown': None}, 'aggregate': 'SUM', 'sqlExpression': None, 'datasourceWarning': False, 'hasCustomLabel': False, 'label': 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', 'optionName': 'metric_cy8hjg2pvba_0r6xq6dmz2h'}, {'expressionType': 'SIMPLE', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01d_Malaria_cases_treated', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 5, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'INT', 'type_generic': 0, 'uuid': 'ffc52aba-a038-4c22-b6c8-169f3e2b8b97', 'verbose_name': None, 'warning_markdown': None}, 'aggregate': 'SUM', 'sqlExpression': None, 'datasourceWarning': False, 'hasCustomLabel': False, 'label': 'SUM(105_EP01d_Malaria_cases_treated)', 'optionName': 'metric_igswf88vbz_0hgijhbkfbo6'}]
2025-12-06 19:57:55,573:INFO:superset.models.helpers:[COLUMN_TRACE]   columns: [{'columnType': 'BASE_AXIS', 'sqlExpression': 'OrgUnit', 'label': 'OrgUnit', 'expressionType': 'SQL'}]
2025-12-06 19:57:55,573:INFO:superset.models.helpers:[COLUMN_TRACE]   groupby: []
2025-12-06 19:57:55,573:INFO:superset.models.helpers:[COLUMN_TRACE]   metrics: [{'expressionType': 'SIMPLE', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01a_Suspected_fever', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 4, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'INT', 'type_generic': 0, 'uuid': '530216fe-7198-4b8e-b688-a479bcf67426', 'verbose_name': None, 'warning_markdown': None}, 'aggregate': 'SUM', 'sqlExpression': None, 'datasourceWarning': False, 'hasCustomLabel': False, 'label': 'SUM(105_EP01a_Suspected_fever)', 'optionName': 'metric_4dm6wzzpssx_evo63ixtdye'}, {'expressionType': 'SIMPLE', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01b_Malaria_Total', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 3, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'INT', 'type_generic': 0, 'uuid': '959bffaa-826b-4d13-8b7b-6d9c4ea25e50', 'verbose_name': None, 'warning_markdown': None}, 'aggregate': 'SUM', 'sqlExpression': None, 'datasourceWarning': False, 'hasCustomLabel': False, 'label': 'SUM(105_EP01b_Malaria_Total)', 'optionName': 'metric_7om94y7wg44_o1syozv7mh'}, {'expressionType': 'SIMPLE', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 6, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'INT', 'type_generic': 0, 'uuid': '928946a1-6cea-4202-b8d6-0683414af79e', 'verbose_name': None, 'warning_markdown': None}, 'aggregate': 'SUM', 'sqlExpression': None, 'datasourceWarning': False, 'hasCustomLabel': False, 'label': 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', 'optionName': 'metric_cy8hjg2pvba_0r6xq6dmz2h'}, {'expressionType': 'SIMPLE', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01d_Malaria_cases_treated', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 5, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'INT', 'type_generic': 0, 'uuid': 'ffc52aba-a038-4c22-b6c8-169f3e2b8b97', 'verbose_name': None, 'warning_markdown': None}, 'aggregate': 'SUM', 'sqlExpression': None, 'datasourceWarning': False, 'hasCustomLabel': False, 'label': 'SUM(105_EP01d_Malaria_cases_treated)', 'optionName': 'metric_igswf88vbz_0hgijhbkfbo6'}]
2025-12-06 19:57:55,573:INFO:superset.models.helpers:[COLUMN_TRACE]   labels_expected: ['OrgUnit', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-06 19:57:55,573:INFO:superset.models.helpers:[COLUMN_TRACE]   groupby: []
2025-12-06 19:57:55,573:INFO:superset.models.helpers:[COLUMN_TRACE]   select_exprs count: 5
2025-12-06 19:57:55,573:INFO:superset.models.helpers:[COLUMN_TRACE]   labels_expected: ['OrgUnit', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-06 19:57:55,573:INFO:superset.models.helpers:[COLUMN_TRACE]     [0] key=OrgUnit, name=OrgUnit, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-06 19:57:55,573:INFO:superset.models.helpers:[COLUMN_TRACE]   select_exprs count: 5
2025-12-06 19:57:55,573:INFO:superset.models.helpers:[COLUMN_TRACE]     [1] key=SUM(105_EP01a_Suspected_fever), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-06 19:57:55,574:INFO:superset.models.helpers:[COLUMN_TRACE]     [0] key=OrgUnit, name=OrgUnit, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-06 19:57:55,574:INFO:superset.models.helpers:[COLUMN_TRACE]     [2] key=SUM(105_EP01b_Malaria_Total), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-06 19:57:55,574:INFO:superset.models.helpers:[COLUMN_TRACE]     [1] key=SUM(105_EP01a_Suspected_fever), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-06 19:57:55,574:INFO:superset.models.helpers:[COLUMN_TRACE]     [3] key=SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-06 19:57:55,574:INFO:superset.models.helpers:[COLUMN_TRACE]     [2] key=SUM(105_EP01b_Malaria_Total), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-06 19:57:55,574:INFO:superset.models.helpers:[COLUMN_TRACE]     [4] key=SUM(105_EP01d_Malaria_cases_treated), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-06 19:57:55,574:INFO:superset.models.helpers:[COLUMN_TRACE]     [3] key=SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-06 19:57:55,574:INFO:superset.connectors.sqla.models:[DHIS2] get_from_clause for virtual dataset 1: analytics_LAST_YEAR_20251206
2025-12-06 19:57:55,574:INFO:superset.models.helpers:[COLUMN_TRACE]     [4] key=SUM(105_EP01d_Malaria_cases_treated), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-06 19:57:55,574:INFO:superset.connectors.sqla.models:[DHIS2] Full SQL stored: SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
2025-12-06 19:57:55,574:INFO:superset.connectors.sqla.models:[DHIS2] get_from_clause for virtual dataset 1: analytics_LAST_YEAR_20251206
2025-12-06 19:57:55,574:INFO:superset.connectors.sqla.models:[DHIS2] Full SQL stored: SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
2025-12-06 19:57:55,574:INFO:superset.connectors.sqla.models:[DHIS2] Loaded params from extra field: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayPropert
2025-12-06 19:57:55,574:INFO:superset.connectors.sqla.models:[DHIS2] Loaded params from extra field: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayPropert
2025-12-06 19:57:55,576:INFO:superset.connectors.sqla.models:[DHIS2] Cached params with key: dhis2_params_1_analytics
2025-12-06 19:57:55,576:INFO:superset.connectors.sqla.models:[DHIS2] Stored params in Flask g for DHIS2 table: analytics
2025-12-06 19:57:55,578:INFO:superset.connectors.sqla.models:[DHIS2] Cached params with key: dhis2_params_1_analytics
2025-12-06 19:57:55,579:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Query execution in connectors/sqla/models.py:
2025-12-06 19:57:55,579:INFO:superset.connectors.sqla.models:[DHIS2] Stored params in Flask g for DHIS2 table: analytics
2025-12-06 19:57:55,579:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   SQL (first 500 chars): SELECT "OrgUnit", sum("105_EP01a_Suspected_fever") AS sum_1, sum("105_EP01b_Malaria_Total") AS sum_2, sum("105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive") AS sum_3, sum("105_EP01d_Malaria_cases_treated") AS sum_4 
FROM (SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
) AS virtual_table GROUP BY "OrgUnit" ORDER BY sum("105_EP01a_Suspec
2025-12-06 19:57:55,580:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   labels_expected: ['OrgUnit', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-06 19:57:55,582:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Query execution in connectors/sqla/models.py:
2025-12-06 19:57:55,582:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   SQL (first 500 chars): SELECT "OrgUnit", sum("105_EP01a_Suspected_fever") AS sum_1, sum("105_EP01b_Malaria_Total") AS sum_2, sum("105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive") AS sum_3, sum("105_EP01d_Malaria_cases_treated") AS sum_4 
FROM (SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
) AS virtual_table GROUP BY "OrgUnit" ORDER BY sum("105_EP01a_Suspec
2025-12-06 19:57:55,583:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   labels_expected: ['OrgUnit', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-06 19:57:55,583:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 connection initialized: https://tests.dhis2.hispuganda.org/hmis/api
2025-12-06 19:57:55,585:INFO:superset.db_engine_specs.dhis2_dialect:Executing DHIS2 query: SELECT
  "OrgUnit",
  SUM("105_EP01a_Suspected_fever") AS sum_1,
  SUM("105_EP01b_Malaria_Total") AS sum_2,
  SUM("105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive") AS sum_3,
  SUM("105_EP01d_Malaria_cases_treated") AS sum_4
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "OrgUnit"
ORDER BY
  SUM("105_EP01a_Suspected_fever") DESC
LIMIT 10000
2025-12-06 19:57:55,585:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 connection initialized: https://tests.dhis2.hispuganda.org/hmis/api
2025-12-06 19:57:55,585:INFO:superset.db_engine_specs.dhis2_dialect:Parsed endpoint: analytics
2025-12-06 19:57:55,586:INFO:superset.db_engine_specs.dhis2_dialect:Executing DHIS2 query: SELECT
  "OrgUnit",
  SUM("105_EP01a_Suspected_fever") AS sum_1,
  SUM("105_EP01b_Malaria_Total") AS sum_2,
  SUM("105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive") AS sum_3,
  SUM("105_EP01d_Malaria_cases_treated") AS sum_4
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "OrgUnit"
ORDER BY
  SUM("105_EP01a_Suspected_fever") DESC
LIMIT 10000
2025-12-06 19:57:55,586:INFO:superset.db_engine_specs.dhis2_dialect:Using stored parameters from Flask g for table: analytics
2025-12-06 19:57:55,586:INFO:superset.db_engine_specs.dhis2_dialect:Parsed endpoint: analytics
2025-12-06 19:57:55,586:INFO:superset.db_engine_specs.dhis2_dialect:Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
2025-12-06 19:57:55,586:INFO:superset.db_engine_specs.dhis2_dialect:Using stored parameters from Flask g for table: analytics

[DHIS2] Executing query: SELECT
  "OrgUnit",
  SUM("105_EP01b_Malaria_Total") AS sum_1,
  SUM("105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive") AS sum_2
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "OrgUnit"
ORDER BY
  SUM("105_EP01b_Malaria_Total") DESC
LIMIT 10000
[DHIS2] Parsed endpoint: analytics
[DHIS2] Found params in Flask g for analytics: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;
[DHIS2] Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
[DHIS2] Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
[DHIS2] API request URL: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
[DHIS2] Raw API response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Raw DHIS2 rows count: 16
[DHIS2] First raw row: ['QHnwKs2OUZv', '2020', 'akV6429SUqu', '15266488']
[DHIS2] Parsing response for endpoint: analytics
[DHIS2] Response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Response sample: {'headers': [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}], 'metaDat
[DHIS2] Using WIDE/PIVOTED format (Period, OrgUnit, DX1, DX2, ...) for analytics
[DHIS2] normalize_analytics: pivot=True, using WIDE/PIVOTED format
[DHIS2] PIVOT CONSTRUCTION:
[DHIS2]   data_elements (UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   data_element_list (sorted UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   col_names (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized row count: 4
[DHIS2] First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] _set_description: columns=['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], types=['String', 'String', 'String', 'String', 'String', 'String']
[DHIS2] Transformed rows count: 4
[DHIS2] First transformed row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] Fetched 4 rows
[DHIS2] fetchall() called - returning 4 rows
[DHIS2] fetchall() - First row type: <class 'tuple'>
[DHIS2] fetchall() - First row (original): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Column count from description: 6
[DHIS2] fetchall() - First row (fixed types): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Type enforcement: dimensions=STRING, measures=FLOAT
[DHIS2] Raw API response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Raw DHIS2 rows count: 16
[DHIS2] First raw row: ['QHnwKs2OUZv', '2020', 'akV6429SUqu', '15266488']
[DHIS2] Parsing response for endpoint: analytics
[DHIS2] Response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Response sample: {'headers': [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}], 'metaDat
[DHIS2] Using WIDE/PIVOTED format (Period, OrgUnit, DX1, DX2, ...) for analytics
[DHIS2] normalize_analytics: pivot=True, using WIDE/PIVOTED format
[DHIS2] PIVOT CONSTRUCTION:
[DHIS2]   data_elements (UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   data_element_list (sorted UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   col_names (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized row count: 4
[DHIS2] First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] _set_description: columns=['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], types=['String', 'String', 'String', 'String', 'String', 'String']
[DHIS2] Transformed rows count: 4
[DHIS2] First transformed row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] Fetched 4 rows
[DHIS2] fetchall() called - returning 4 rows
[DHIS2] fetchall() - First row type: <class 'tuple'>
[DHIS2] fetchall() - First row (original): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Column count from description: 6
[DHIS2] fetchall() - First row (fixed types): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Type enforcement: dimensions=STRING, measures=FLOAT
[DHIS2] Executing query: SELECT
  "OrgUnit",
  SUM("105_EP01a_Suspected_fever") AS sum_1,
  SUM("105_EP01b_Malaria_Total") AS sum_2,
  SUM("105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive") AS sum_3,
  SUM("105_EP01d_Malaria_cases_treated") AS sum_4
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "OrgUnit"
ORDER BY
  SUM("105_EP01a_Suspected_fever") DESC
LIMIT 10000
[DHIS2] Parsed endpoint: analytics
[DHIS2] Executing query: SELECT
  "OrgUnit",
  SUM("105_EP01a_Suspected_fever") AS sum_1,
  SUM("105_EP01b_Malaria_Total") AS sum_2,
  SUM("105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive") AS sum_3,
  SUM("105_EP01d_Malaria_cases_treated") AS sum_4
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "OrgUnit"
ORDER BY
  SUM("105_EP01a_Suspected_fever") DESC
LIMIT 10000
[DHIS2] Found params in Flask g for analytics: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;
[DHIS2] Parsed endpoint: analytics
[DHIS2] Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
[DHIS2] Found params in Flask g for analytics: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;
[DHIS2] Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
[DHIS2] Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}2025-12-06 19:57:55,587:INFO:superset.db_engine_specs.dhis2_dialect:Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
2025-12-06 19:57:55,587:INFO:superset.db_engine_specs.dhis2_dialect:Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
2025-12-06 19:57:55,587:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API request: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
2025-12-06 19:57:55,587:INFO:superset.db_engine_specs.dhis2_dialect:Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
2025-12-06 19:57:55,587:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API request: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
2025-12-06 19:57:56,522:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:57:56] "PUT /api/v1/explore/form_data/QTQfaaLaQ_A?tab_id=12 HTTP/1.1" 200 -
2025-12-06 19:57:56,583:INFO:superset.db_engine_specs.dhis2_dialect:Using wide/pivoted format for analytics
2025-12-06 19:57:56,583:INFO:superset.db_engine_specs.dhis2_dialect:normalize_analytics called with pivot=True, returning WIDE format
2025-12-06 19:57:56,583:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column construction - data_elements: ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
2025-12-06 19:57:56,583:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column names constructed (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 19:57:56,583:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] FIRST ROW CONSTRUCTION:
2025-12-06 19:57:56,583:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   Period (index 0): 2020
2025-12-06 19:57:56,583:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   OrgUnit (index 1): MOH - Uganda
2025-12-06 19:57:56,583:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01b. Malaria Total (index 2): 14479324
2025-12-06 19:57:56,583:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01a. Suspected fever (index 3): 22994823
2025-12-06 19:57:56,583:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01d. Malaria cases treated (index 4): 15266488
2025-12-06 19:57:56,583:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01c. Malaria Confirmed (B/s and RDT Positive) (index 5): 13326277
2025-12-06 19:57:56,583:INFO:superset.db_engine_specs.dhis2_dialect:First pivoted row - Period: '2020', OrgUnit: 'MOH - Uganda'
2025-12-06 19:57:56,583:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total pivoted rows: 4, columns: 6
2025-12-06 19:57:56,583:INFO:superset.db_engine_specs.dhis2_dialect:Normalized 4 rows with 6 columns for endpoint analytics
2025-12-06 19:57:56,583:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API returned 4 rows
2025-12-06 19:57:56,590:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() - Row count: 4
2025-12-06 19:57:56,590:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 19:57:56,590:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names length: 6
2025-12-06 19:57:56,590:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values count: 6
2025-12-06 19:57:56,590:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-06 19:57:56,590:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 0 (Period): 2020 -> 2020 (STRING)
2025-12-06 19:57:56,590:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (OrgUnit): MOH - Uganda -> MOH - Uganda (STRING)
2025-12-06 19:57:56,590:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (105_EP01b_Malaria_Total): 14479324 (PROCESSED)
2025-12-06 19:57:56,590:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (105_EP01a_Suspected_fever): 22994823 (PROCESSED)
2025-12-06 19:57:56,590:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (105_EP01d_Malaria_cases_treated): 15266488 (PROCESSED)
2025-12-06 19:57:56,590:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() returning 4 rows with 6 columns each
2025-12-06 19:57:56,590:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Got 4 rows from cursor
2025-12-06 19:57:56,590:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-06 19:57:56,590:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 19:57:56,590:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Types from cursor: ['String', 'String', 'String', 'String', 'String', 'String']
2025-12-06 19:57:56,591:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: DataFrame created with 4 rows, 6 columns
2025-12-06 19:57:56,591:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 19:57:56,592:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes BEFORE fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-06 19:57:56,594:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Period' to object dtype (dimension)
2025-12-06 19:57:56,595:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'OrgUnit' to object dtype (dimension)
2025-12-06 19:57:56,596:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes AFTER fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-06 19:57:56,596:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: First row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-06 19:57:56,600:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] BEFORE assign_column_label:
2025-12-06 19:57:56,600:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 6)
2025-12-06 19:57:56,600:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 19:57:56,600:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['OrgUnit', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-06 19:57:56,600:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: False
2025-12-06 19:57:56,600:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-06 19:57:56,600:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Column truncation needed: df has 6 columns, expected 5
2025-12-06 19:57:56,600:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   DataFrame actual columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 19:57:56,600:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Expected columns: ['OrgUnit', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-06 19:57:56,600:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] âœ“ Selecting columns BY NAME (matched all expected columns)
2025-12-06 19:57:56,600:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Column mapping: {'OrgUnit': 'OrgUnit', 'SUM(105_EP01a_Suspected_fever)': '105_EP01a_Suspected_fever', 'SUM(105_EP01b_Malaria_Total)': '105_EP01b_Malaria_Total', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)': '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', 'SUM(105_EP01d_Malaria_cases_treated)': '105_EP01d_Malaria_cases_treated'}
2025-12-06 19:57:56,601:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] Column Selection âœ“ SUCCESS - method=BY_NAME, datasource=analytics_LAST_YEAR_20251206
2025-12-06 19:57:56,601:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['OrgUnit', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-06 19:57:56,601:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   tried_by_name=True, success=True, fallback=False
2025-12-06 19:57:56,601:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Assigning column labels: ['OrgUnit', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-06 19:57:56,601:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] AFTER assign_column_label:
2025-12-06 19:57:56,601:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 5)
2025-12-06 19:57:56,601:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['OrgUnit', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-06 19:57:56,601:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['OrgUnit', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-06 19:57:56,601:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: True
2025-12-06 19:57:56,601:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'OrgUnit': 'MOH - Uganda', 'SUM(105_EP01a_Suspected_fever)': 22994823, 'SUM(105_EP01b_Malaria_Total)': 14479324, 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)': 13326277, 'SUM(105_EP01d_Malaria_cases_treated)': 15266488}
2025-12-06 19:57:56,603:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] DataFrame columns: ['OrgUnit', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-06 19:57:56,603:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Aggregates: {'SUM(105_EP01a_Suspected_fever)': {'operator': 'mean'}, 'SUM(105_EP01b_Malaria_Total)': {'operator': 'mean'}, 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)': {'operator': 'mean'}, 'SUM(105_EP01d_Malaria_cases_treated)': {'operator': 'mean'}}
2025-12-06 19:57:56,603:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105_EP01a_Suspected_fever)', column='SUM(105_EP01a_Suspected_fever)'
2025-12-06 19:57:56,603:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105_EP01b_Malaria_Total)', column='SUM(105_EP01b_Malaria_Total)'
2025-12-06 19:57:56,603:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', column='SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)'
2025-12-06 19:57:56,603:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105_EP01d_Malaria_cases_treated)', column='SUM(105_EP01d_Malaria_cases_treated)'
2025-12-06 19:57:56,617:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:57:56] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-06 19:57:56,624:INFO:superset.db_engine_specs.dhis2_dialect:Using wide/pivoted format for analytics
2025-12-06 19:57:56,624:INFO:superset.db_engine_specs.dhis2_dialect:normalize_analytics called with pivot=True, returning WIDE format
2025-12-06 19:57:56,624:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column construction - data_elements: ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
2025-12-06 19:57:56,624:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column names constructed (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 19:57:56,624:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] FIRST ROW CONSTRUCTION:
2025-12-06 19:57:56,624:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   Period (index 0): 2020
2025-12-06 19:57:56,624:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   OrgUnit (index 1): MOH - Uganda
2025-12-06 19:57:56,624:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01b. Malaria Total (index 2): 14479324
2025-12-06 19:57:56,624:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01a. Suspected fever (index 3): 22994823
2025-12-06 19:57:56,624:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01d. Malaria cases treated (index 4): 15266488
2025-12-06 19:57:56,624:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01c. Malaria Confirmed (B/s and RDT Positive) (index 5): 13326277
2025-12-06 19:57:56,624:INFO:superset.db_engine_specs.dhis2_dialect:First pivoted row - Period: '2020', OrgUnit: 'MOH - Uganda'
2025-12-06 19:57:56,624:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total pivoted rows: 4, columns: 6
2025-12-06 19:57:56,624:INFO:superset.db_engine_specs.dhis2_dialect:Normalized 4 rows with 6 columns for endpoint analytics
2025-12-06 19:57:56,624:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API returned 4 rows
2025-12-06 19:57:56,627:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() - Row count: 4
2025-12-06 19:57:56,627:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 19:57:56,627:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names length: 6
2025-12-06 19:57:56,627:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values count: 6
2025-12-06 19:57:56,627:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-06 19:57:56,627:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 0 (Period): 2020 -> 2020 (STRING)
2025-12-06 19:57:56,627:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (OrgUnit): MOH - Uganda -> MOH - Uganda (STRING)
2025-12-06 19:57:56,627:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (105_EP01b_Malaria_Total): 14479324 (PROCESSED)
2025-12-06 19:57:56,627:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (105_EP01a_Suspected_fever): 22994823 (PROCESSED)
2025-12-06 19:57:56,627:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (105_EP01d_Malaria_cases_treated): 15266488 (PROCESSED)
2025-12-06 19:57:56,627:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() returning 4 rows with 6 columns each
2025-12-06 19:57:56,627:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Got 4 rows from cursor
2025-12-06 19:57:56,627:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-06 19:57:56,627:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 19:57:56,627:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Types from cursor: ['String', 'String', 'String', 'String', 'String', 'String']
2025-12-06 19:57:56,628:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: DataFrame created with 4 rows, 6 columns
2025-12-06 19:57:56,628:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 19:57:56,628:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes BEFORE fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-06 19:57:56,628:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Period' to object dtype (dimension)
2025-12-06 19:57:56,628:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'OrgUnit' to object dtype (dimension)
2025-12-06 19:57:56,629:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes AFTER fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-06 19:57:56,629:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: First row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-06 19:57:56,631:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] BEFORE assign_column_label:
2025-12-06 19:57:56,631:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 6)
2025-12-06 19:57:56,631:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 19:57:56,631:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['OrgUnit', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-06 19:57:56,631:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: False
2025-12-06 19:57:56,631:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-06 19:57:56,631:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Column truncation needed: df has 6 columns, expected 5
2025-12-06 19:57:56,631:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   DataFrame actual columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 19:57:56,631:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Expected columns: ['OrgUnit', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-06 19:57:56,631:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] âœ“ Selecting columns BY NAME (matched all expected columns)
2025-12-06 19:57:56,631:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Column mapping: {'OrgUnit': 'OrgUnit', 'SUM(105_EP01a_Suspected_fever)': '105_EP01a_Suspected_fever', 'SUM(105_EP01b_Malaria_Total)': '105_EP01b_Malaria_Total', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)': '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', 'SUM(105_EP01d_Malaria_cases_treated)': '105_EP01d_Malaria_cases_treated'}
2025-12-06 19:57:56,631:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] Column Selection âœ“ SUCCESS - method=BY_NAME, datasource=analytics_LAST_YEAR_20251206
2025-12-06 19:57:56,631:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['OrgUnit', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-06 19:57:56,631:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   tried_by_name=True, success=True, fallback=False
2025-12-06 19:57:56,631:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Assigning column labels: ['OrgUnit', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-06 19:57:56,631:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] AFTER assign_column_label:
2025-12-06 19:57:56,631:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 5)
2025-12-06 19:57:56,631:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['OrgUnit', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-06 19:57:56,631:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['OrgUnit', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-06 19:57:56,631:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: True
2025-12-06 19:57:56,631:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'OrgUnit': 'MOH - Uganda', 'SUM(105_EP01a_Suspected_fever)': 22994823, 'SUM(105_EP01b_Malaria_Total)': 14479324, 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)': 13326277, 'SUM(105_EP01d_Malaria_cases_treated)': 15266488}
2025-12-06 19:57:56,632:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] DataFrame columns: ['OrgUnit', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-06 19:57:56,632:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Aggregates: {'SUM(105_EP01a_Suspected_fever)': {'operator': 'mean'}, 'SUM(105_EP01b_Malaria_Total)': {'operator': 'mean'}, 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)': {'operator': 'mean'}, 'SUM(105_EP01d_Malaria_cases_treated)': {'operator': 'mean'}}
2025-12-06 19:57:56,632:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105_EP01a_Suspected_fever)', column='SUM(105_EP01a_Suspected_fever)'
2025-12-06 19:57:56,632:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105_EP01b_Malaria_Total)', column='SUM(105_EP01b_Malaria_Total)'
2025-12-06 19:57:56,632:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)', column='SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)'
2025-12-06 19:57:56,632:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105_EP01d_Malaria_cases_treated)', column='SUM(105_EP01d_Malaria_cases_treated)'
2025-12-06 19:57:56,645:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:57:56] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-06 19:57:57,678:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:57:57] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-06 19:58:35,579:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:58:35] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-06 19:58:35,582:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:58:35] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-06 19:58:36,484:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:58:36] "PUT /api/v1/explore/form_data/QTQfaaLaQ_A?tab_id=12 HTTP/1.1" 200 -
2025-12-06 19:58:36,628:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 19:58:36] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-06 20:01:00,245:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:01:00] "GET /api/v1/me/ HTTP/1.1" 200 -
2025-12-06 20:01:04,147:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:01:04] "GET /api/v1/me/ HTTP/1.1" 200 -
2025-12-06 20:01:17,207:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:01:17] "GET /api/v1/me/ HTTP/1.1" 200 -
2025-12-06 20:01:25,519:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:01:25] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-06 20:01:28,208:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:01:28] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-06 20:01:30,542:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:01:30] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-06 20:01:33,878:ERROR:superset.models.helpers:[METRICS-TRACE] Processing 3 metrics
2025-12-06 20:01:33,878:ERROR:superset.models.helpers:[METRICS-TRACE] Processing 3 metrics
2025-12-06 20:01:33,878:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 0: adhoc - SUM(105_EP01b_Malaria_Total)
2025-12-06 20:01:33,878:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 0: adhoc - SUM(105_EP01b_Malaria_Total)
2025-12-06 20:01:33,879:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105_EP01b_Malaria_Total)
2025-12-06 20:01:33,879:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105_EP01b_Malaria_Total)
2025-12-06 20:01:33,879:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 1: adhoc - SUM(105_EP01a_Suspected_fever)
2025-12-06 20:01:33,879:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 1: adhoc - SUM(105_EP01a_Suspected_fever)
2025-12-06 20:01:33,879:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105_EP01a_Suspected_fever)
2025-12-06 20:01:33,879:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105_EP01a_Suspected_fever)
2025-12-06 20:01:33,879:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 2: adhoc - SUM(105_EP01d_Malaria_cases_treated)
2025-12-06 20:01:33,879:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 2: adhoc - SUM(105_EP01d_Malaria_cases_treated)
2025-12-06 20:01:33,880:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105_EP01d_Malaria_cases_treated)
2025-12-06 20:01:33,880:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105_EP01d_Malaria_cases_treated)
2025-12-06 20:01:33,880:ERROR:superset.models.helpers:[METRICS-TRACE] Total metrics added: 3
2025-12-06 20:01:33,880:ERROR:superset.models.helpers:[METRICS-TRACE] Total metrics added: 3
2025-12-06 20:01:33,882:ERROR:superset.models.helpers:[METRICS-TRACE] Before dedup: 1 select_exprs + 3 metrics_exprs
2025-12-06 20:01:33,882:ERROR:superset.models.helpers:[METRICS-TRACE] Before dedup: 1 select_exprs + 3 metrics_exprs
2025-12-06 20:01:33,883:ERROR:superset.models.helpers:[METRICS-TRACE] After dedup: 4 total select_exprs
2025-12-06 20:01:33,883:ERROR:superset.models.helpers:[METRICS-TRACE] After dedup: 4 total select_exprs
2025-12-06 20:01:33,883:INFO:superset.models.helpers:[COLUMN_TRACE] SQL Query Building:
2025-12-06 20:01:33,883:INFO:superset.models.helpers:[COLUMN_TRACE] SQL Query Building:
2025-12-06 20:01:33,883:INFO:superset.models.helpers:[COLUMN_TRACE]   columns: [{'columnType': 'BASE_AXIS', 'sqlExpression': 'OrgUnit', 'label': 'OrgUnit', 'expressionType': 'SQL'}]
2025-12-06 20:01:33,883:INFO:superset.models.helpers:[COLUMN_TRACE]   columns: [{'columnType': 'BASE_AXIS', 'sqlExpression': 'OrgUnit', 'label': 'OrgUnit', 'expressionType': 'SQL'}]
2025-12-06 20:01:33,883:INFO:superset.models.helpers:[COLUMN_TRACE]   metrics: [{'expressionType': 'SIMPLE', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01b_Malaria_Total', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 3, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'INT', 'type_generic': 0, 'uuid': '959bffaa-826b-4d13-8b7b-6d9c4ea25e50', 'verbose_name': None, 'warning_markdown': None}, 'aggregate': 'SUM', 'sqlExpression': None, 'datasourceWarning': False, 'hasCustomLabel': False, 'label': 'SUM(105_EP01b_Malaria_Total)', 'optionName': 'metric_45302laesg5_qggnouu9br'}, {'expressionType': 'SIMPLE', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01a_Suspected_fever', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 4, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'INT', 'type_generic': 0, 'uuid': '530216fe-7198-4b8e-b688-a479bcf67426', 'verbose_name': None, 'warning_markdown': None}, 'aggregate': 'SUM', 'sqlExpression': None, 'datasourceWarning': False, 'hasCustomLabel': False, 'label': 'SUM(105_EP01a_Suspected_fever)', 'optionName': 'metric_k45orb1omq9_1qf1acagf2y'}, {'expressionType': 'SIMPLE', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01d_Malaria_cases_treated', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 5, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'column', 'type_generic': 0, 'uuid': 'ffc52aba-a038-4c22-b6c8-169f3e2b8b97', 'verbose_name': None, 'warning_markdown': None}, 'aggregate': 'SUM', 'sqlExpression': None, 'datasourceWarning': False, 'hasCustomLabel': False, 'label': 'SUM(105_EP01d_Malaria_cases_treated)', 'optionName': 'metric_f1nae8hwjxs_winu84yl9zr'}]
2025-12-06 20:01:33,883:INFO:superset.models.helpers:[COLUMN_TRACE]   metrics: [{'expressionType': 'SIMPLE', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01b_Malaria_Total', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 3, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'INT', 'type_generic': 0, 'uuid': '959bffaa-826b-4d13-8b7b-6d9c4ea25e50', 'verbose_name': None, 'warning_markdown': None}, 'aggregate': 'SUM', 'sqlExpression': None, 'datasourceWarning': False, 'hasCustomLabel': False, 'label': 'SUM(105_EP01b_Malaria_Total)', 'optionName': 'metric_45302laesg5_qggnouu9br'}, {'expressionType': 'SIMPLE', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01a_Suspected_fever', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 4, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'INT', 'type_generic': 0, 'uuid': '530216fe-7198-4b8e-b688-a479bcf67426', 'verbose_name': None, 'warning_markdown': None}, 'aggregate': 'SUM', 'sqlExpression': None, 'datasourceWarning': False, 'hasCustomLabel': False, 'label': 'SUM(105_EP01a_Suspected_fever)', 'optionName': 'metric_k45orb1omq9_1qf1acagf2y'}, {'expressionType': 'SIMPLE', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01d_Malaria_cases_treated', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 5, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'column', 'type_generic': 0, 'uuid': 'ffc52aba-a038-4c22-b6c8-169f3e2b8b97', 'verbose_name': None, 'warning_markdown': None}, 'aggregate': 'SUM', 'sqlExpression': None, 'datasourceWarning': False, 'hasCustomLabel': False, 'label': 'SUM(105_EP01d_Malaria_cases_treated)', 'optionName': 'metric_f1nae8hwjxs_winu84yl9zr'}]
2025-12-06 20:01:33,883:INFO:superset.models.helpers:[COLUMN_TRACE]   groupby: []
2025-12-06 20:01:33,883:INFO:superset.models.helpers:[COLUMN_TRACE]   groupby: []
2025-12-06 20:01:33,883:INFO:superset.models.helpers:[COLUMN_TRACE]   labels_expected: ['OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-06 20:01:33,883:INFO:superset.models.helpers:[COLUMN_TRACE]   labels_expected: ['OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-06 20:01:33,883:INFO:superset.models.helpers:[COLUMN_TRACE]   select_exprs count: 4
2025-12-06 20:01:33,883:INFO:superset.models.helpers:[COLUMN_TRACE]   select_exprs count: 4
2025-12-06 20:01:33,883:INFO:superset.models.helpers:[COLUMN_TRACE]     [0] key=OrgUnit, name=OrgUnit, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-06 20:01:33,883:INFO:superset.models.helpers:[COLUMN_TRACE]     [0] key=OrgUnit, name=OrgUnit, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-06 20:01:33,883:INFO:superset.models.helpers:[COLUMN_TRACE]     [1] key=SUM(105_EP01b_Malaria_Total), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-06 20:01:33,883:INFO:superset.models.helpers:[COLUMN_TRACE]     [1] key=SUM(105_EP01b_Malaria_Total), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-06 20:01:33,883:INFO:superset.models.helpers:[COLUMN_TRACE]     [2] key=SUM(105_EP01a_Suspected_fever), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-06 20:01:33,883:INFO:superset.models.helpers:[COLUMN_TRACE]     [2] key=SUM(105_EP01a_Suspected_fever), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-06 20:01:33,883:INFO:superset.models.helpers:[COLUMN_TRACE]     [3] key=SUM(105_EP01d_Malaria_cases_treated), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-06 20:01:33,883:INFO:superset.models.helpers:[COLUMN_TRACE]     [3] key=SUM(105_EP01d_Malaria_cases_treated), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-06 20:01:33,884:INFO:superset.connectors.sqla.models:[DHIS2] get_from_clause for virtual dataset 1: analytics_LAST_YEAR_20251206
2025-12-06 20:01:33,884:INFO:superset.connectors.sqla.models:[DHIS2] get_from_clause for virtual dataset 1: analytics_LAST_YEAR_20251206
2025-12-06 20:01:33,884:INFO:superset.connectors.sqla.models:[DHIS2] Full SQL stored: SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
2025-12-06 20:01:33,884:INFO:superset.connectors.sqla.models:[DHIS2] Full SQL stored: SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
2025-12-06 20:01:33,884:INFO:superset.connectors.sqla.models:[DHIS2] Loaded params from extra field: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayPropert
2025-12-06 20:01:33,885:INFO:superset.connectors.sqla.models:[DHIS2] Loaded params from extra field: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayPropert
2025-12-06 20:01:33,887:INFO:superset.connectors.sqla.models:[DHIS2] Cached params with key: dhis2_params_1_analytics
2025-12-06 20:01:33,887:INFO:superset.connectors.sqla.models:[DHIS2] Stored params in Flask g for DHIS2 table: analytics
2025-12-06 20:01:33,890:INFO:superset.connectors.sqla.models:[DHIS2] Cached params with key: dhis2_params_1_analytics
2025-12-06 20:01:33,891:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Query execution in connectors/sqla/models.py:
2025-12-06 20:01:33,891:INFO:superset.connectors.sqla.models:[DHIS2] Stored params in Flask g for DHIS2 table: analytics
2025-12-06 20:01:33,891:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   SQL (first 500 chars): SELECT "OrgUnit", sum("105_EP01b_Malaria_Total") AS sum_1, sum("105_EP01a_Suspected_fever") AS sum_2, sum("105_EP01d_Malaria_cases_treated") AS sum_3 
FROM (SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
) AS virtual_table GROUP BY "OrgUnit" ORDER BY sum("105_EP01b_Malaria_Total") DESC
 LIMIT 10000
2025-12-06 20:01:33,892:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   labels_expected: ['OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-06 20:01:33,893:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Query execution in connectors/sqla/models.py:
2025-12-06 20:01:33,894:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   SQL (first 500 chars): SELECT "OrgUnit", sum("105_EP01b_Malaria_Total") AS sum_1, sum("105_EP01a_Suspected_fever") AS sum_2, sum("105_EP01d_Malaria_cases_treated") AS sum_3 
FROM (SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
) AS virtual_table GROUP BY "OrgUnit" ORDER BY sum("105_EP01b_Malaria_Total") DESC
 LIMIT 10000
2025-12-06 20:01:33,895:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 connection initialized: https://tests.dhis2.hispuganda.org/hmis/api
2025-12-06 20:01:33,895:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   labels_expected: ['OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-06 20:01:33,895:INFO:superset.db_engine_specs.dhis2_dialect:Executing DHIS2 query: SELECT
  "OrgUnit",
  SUM("105_EP01b_Malaria_Total") AS sum_1,
  SUM("105_EP01a_Suspected_fever") AS sum_2,
  SUM("105_EP01d_Malaria_cases_treated") AS sum_3
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "OrgUnit"
ORDER BY
  SUM("105_EP01b_Malaria_Total") DESC
LIMIT 10000
2025-12-06 20:01:33,896:INFO:superset.db_engine_specs.dhis2_dialect:Parsed endpoint: analytics
2025-12-06 20:01:33,896:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 connection initialized: https://tests.dhis2.hispuganda.org/hmis/api
2025-12-06 20:01:33,897:INFO:superset.db_engine_specs.dhis2_dialect:Using stored parameters from Flask g for table: analytics
2025-12-06 20:01:33,897:INFO:superset.db_engine_specs.dhis2_dialect:Executing DHIS2 query: SELECT
  "OrgUnit",
  SUM("105_EP01b_Malaria_Total") AS sum_1,
  SUM("105_EP01a_Suspected_fever") AS sum_2,
  SUM("105_EP01d_Malaria_cases_treated") AS sum_3
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "OrgUnit"
ORDER BY
  SUM("105_EP01b_Malaria_Total") DESC
LIMIT 10000
2025-12-06 20:01:33,897:INFO:superset.db_engine_specs.dhis2_dialect:Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
2025-12-06 20:01:33,897:INFO:superset.db_engine_specs.dhis2_dialect:Parsed endpoint: analytics
2025-12-06 20:01:33,897:INFO:superset.db_engine_specs.dhis2_dialect:Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
2025-12-06 20:01:33,897:INFO:superset.db_engine_specs.dhis2_dialect:Using stored parameters from Flask g for table: analytics
2025-12-06 20:01:33,897:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API request: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
2025-12-06 20:01:33,897:INFO:superset.db_engine_specs.dhis2_dialect:Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}

[DHIS2] API request URL: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
[DHIS2] Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
[DHIS2] API request URL: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
[DHIS2] Raw API response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Raw DHIS2 rows count: 16
[DHIS2] First raw row: ['QHnwKs2OUZv', '2020', 'akV6429SUqu', '15266488']
[DHIS2] Parsing response for endpoint: analytics
[DHIS2] Response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Response sample: {'headers': [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}], 'metaDat
[DHIS2] Using WIDE/PIVOTED format (Period, OrgUnit, DX1, DX2, ...) for analytics
[DHIS2] normalize_analytics: pivot=True, using WIDE/PIVOTED format
[DHIS2] PIVOT CONSTRUCTION:
[DHIS2]   data_elements (UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   data_element_list (sorted UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   col_names (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized row count: 4
[DHIS2] First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] _set_description: columns=['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], types=['String', 'String', 'String', 'String', 'String', 'String']
[DHIS2] Transformed rows count: 4
[DHIS2] First transformed row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] Fetched 4 rows
[DHIS2] fetchall() called - returning 4 rows
[DHIS2] fetchall() - First row type: <class 'tuple'>
[DHIS2] fetchall() - First row (original): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Column count from description: 6
[DHIS2] fetchall() - First row (fixed types): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Type enforcement: dimensions=STRING, measures=FLOAT
[DHIS2] Raw API response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Raw DHIS2 rows count: 16
[DHIS2] First raw row: ['QHnwKs2OUZv', '2020', 'akV6429SUqu', '15266488']
[DHIS2] Parsing response for endpoint: analytics
[DHIS2] Response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Response sample: {'headers': [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}], 'metaDat
[DHIS2] Using WIDE/PIVOTED format (Period, OrgUnit, DX1, DX2, ...) for analytics
[DHIS2] normalize_analytics: pivot=True, using WIDE/PIVOTED format
[DHIS2] PIVOT CONSTRUCTION:
[DHIS2]   data_elements (UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   data_element_list (sorted UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   col_names (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized row count: 4
[DHIS2] First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] _set_description: columns=['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], types=['String', 'String', 'String', 'String', 'String', 'String']
[DHIS2] Transformed rows count: 4
[DHIS2] First transformed row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] Fetched 4 rows
[DHIS2] fetchall() called - returning 4 rows
[DHIS2] fetchall() - First row type: <class 'tuple'>
[DHIS2] fetchall() - First row (original): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Column count from description: 6
[DHIS2] fetchall() - First row (fixed types): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Type enforcement: dimensions=STRING, measures=FLOAT
[DHIS2] Executing query: SELECT
  "OrgUnit",
  SUM("105_EP01b_Malaria_Total") AS sum_1,
  SUM("105_EP01a_Suspected_fever") AS sum_2,
  SUM("105_EP01d_Malaria_cases_treated") AS sum_3
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "OrgUnit"
ORDER BY
  SUM("105_EP01b_Malaria_Total") DESC
LIMIT 10000
[DHIS2] Parsed endpoint: analytics
[DHIS2] Found params in Flask g for analytics: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;
[DHIS2] Executing query: SELECT
  "OrgUnit",
  SUM("105_EP01b_Malaria_Total") AS sum_1,
  SUM("105_EP01a_Suspected_fever") AS sum_2,
  SUM("105_EP01d_Malaria_cases_treated") AS sum_3
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "OrgUnit"
ORDER BY
  SUM("105_EP01b_Malaria_Total") DESC
LIMIT 10000
[DHIS2] Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
[DHIS2] Parsed endpoint: analytics
[DHIS2] Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
[DHIS2] Found params in Flask g for analytics: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;
[DHIS2] API request URL: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
[DHIS2] Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
[DHIS2] Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}2025-12-06 20:01:33,898:INFO:superset.db_engine_specs.dhis2_dialect:Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
2025-12-06 20:01:33,898:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API request: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
2025-12-06 20:01:34,789:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:01:34] "PUT /api/v1/explore/form_data/fTQlGTUBnOM?tab_id=6 HTTP/1.1" 200 -
2025-12-06 20:01:34,939:INFO:superset.db_engine_specs.dhis2_dialect:Using wide/pivoted format for analytics
2025-12-06 20:01:34,940:INFO:superset.db_engine_specs.dhis2_dialect:normalize_analytics called with pivot=True, returning WIDE format
2025-12-06 20:01:34,940:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column construction - data_elements: ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
2025-12-06 20:01:34,940:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column names constructed (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:01:34,940:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] FIRST ROW CONSTRUCTION:
2025-12-06 20:01:34,940:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   Period (index 0): 2020
2025-12-06 20:01:34,940:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   OrgUnit (index 1): MOH - Uganda
2025-12-06 20:01:34,940:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01b. Malaria Total (index 2): 14479324
2025-12-06 20:01:34,940:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01a. Suspected fever (index 3): 22994823
2025-12-06 20:01:34,940:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01d. Malaria cases treated (index 4): 15266488
2025-12-06 20:01:34,940:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01c. Malaria Confirmed (B/s and RDT Positive) (index 5): 13326277
2025-12-06 20:01:34,940:INFO:superset.db_engine_specs.dhis2_dialect:First pivoted row - Period: '2020', OrgUnit: 'MOH - Uganda'
2025-12-06 20:01:34,940:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total pivoted rows: 4, columns: 6
2025-12-06 20:01:34,940:INFO:superset.db_engine_specs.dhis2_dialect:Normalized 4 rows with 6 columns for endpoint analytics
2025-12-06 20:01:34,940:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API returned 4 rows
2025-12-06 20:01:34,946:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() - Row count: 4
2025-12-06 20:01:34,946:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:01:34,946:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names length: 6
2025-12-06 20:01:34,946:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values count: 6
2025-12-06 20:01:34,946:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-06 20:01:34,946:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 0 (Period): 2020 -> 2020 (STRING)
2025-12-06 20:01:34,946:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (OrgUnit): MOH - Uganda -> MOH - Uganda (STRING)
2025-12-06 20:01:34,946:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (105_EP01b_Malaria_Total): 14479324 (PROCESSED)
2025-12-06 20:01:34,946:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (105_EP01a_Suspected_fever): 22994823 (PROCESSED)
2025-12-06 20:01:34,946:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (105_EP01d_Malaria_cases_treated): 15266488 (PROCESSED)
2025-12-06 20:01:34,946:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() returning 4 rows with 6 columns each
2025-12-06 20:01:34,946:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Got 4 rows from cursor
2025-12-06 20:01:34,946:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-06 20:01:34,946:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:01:34,946:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Types from cursor: ['String', 'String', 'String', 'String', 'String', 'String']
2025-12-06 20:01:34,949:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: DataFrame created with 4 rows, 6 columns
2025-12-06 20:01:34,949:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:01:34,950:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes BEFORE fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-06 20:01:34,951:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Period' to object dtype (dimension)
2025-12-06 20:01:34,951:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'OrgUnit' to object dtype (dimension)
2025-12-06 20:01:34,952:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes AFTER fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-06 20:01:34,952:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: First row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-06 20:01:34,955:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] BEFORE assign_column_label:
2025-12-06 20:01:34,956:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 6)
2025-12-06 20:01:34,956:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:01:34,956:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-06 20:01:34,956:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: False
2025-12-06 20:01:34,956:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-06 20:01:34,956:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Column truncation needed: df has 6 columns, expected 4
2025-12-06 20:01:34,956:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   DataFrame actual columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:01:34,956:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Expected columns: ['OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-06 20:01:34,956:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] âœ“ Selecting columns BY NAME (matched all expected columns)
2025-12-06 20:01:34,956:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Column mapping: {'OrgUnit': 'OrgUnit', 'SUM(105_EP01b_Malaria_Total)': '105_EP01b_Malaria_Total', 'SUM(105_EP01a_Suspected_fever)': '105_EP01a_Suspected_fever', 'SUM(105_EP01d_Malaria_cases_treated)': '105_EP01d_Malaria_cases_treated'}
2025-12-06 20:01:34,957:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] Column Selection âœ“ SUCCESS - method=BY_NAME, datasource=analytics_LAST_YEAR_20251206
2025-12-06 20:01:34,957:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-06 20:01:34,957:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   tried_by_name=True, success=True, fallback=False
2025-12-06 20:01:34,957:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Assigning column labels: ['OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-06 20:01:34,957:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] AFTER assign_column_label:
2025-12-06 20:01:34,957:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 4)
2025-12-06 20:01:34,957:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-06 20:01:34,957:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-06 20:01:34,957:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: True
2025-12-06 20:01:34,957:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'OrgUnit': 'MOH - Uganda', 'SUM(105_EP01b_Malaria_Total)': 14479324, 'SUM(105_EP01a_Suspected_fever)': 22994823, 'SUM(105_EP01d_Malaria_cases_treated)': 15266488}
2025-12-06 20:01:34,959:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] DataFrame columns: ['OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-06 20:01:34,959:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Aggregates: {'SUM(105_EP01b_Malaria_Total)': {'operator': 'mean'}, 'SUM(105_EP01a_Suspected_fever)': {'operator': 'mean'}, 'SUM(105_EP01d_Malaria_cases_treated)': {'operator': 'mean'}}
2025-12-06 20:01:34,959:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105_EP01b_Malaria_Total)', column='SUM(105_EP01b_Malaria_Total)'
2025-12-06 20:01:34,959:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105_EP01a_Suspected_fever)', column='SUM(105_EP01a_Suspected_fever)'
2025-12-06 20:01:34,959:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105_EP01d_Malaria_cases_treated)', column='SUM(105_EP01d_Malaria_cases_treated)'
2025-12-06 20:01:34,974:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:01:34] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-06 20:01:35,226:INFO:superset.db_engine_specs.dhis2_dialect:Using wide/pivoted format for analytics
2025-12-06 20:01:35,226:INFO:superset.db_engine_specs.dhis2_dialect:normalize_analytics called with pivot=True, returning WIDE format
2025-12-06 20:01:35,226:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column construction - data_elements: ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
2025-12-06 20:01:35,226:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column names constructed (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:01:35,226:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] FIRST ROW CONSTRUCTION:
2025-12-06 20:01:35,226:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   Period (index 0): 2020
2025-12-06 20:01:35,226:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   OrgUnit (index 1): MOH - Uganda
2025-12-06 20:01:35,226:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01b. Malaria Total (index 2): 14479324
2025-12-06 20:01:35,226:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01a. Suspected fever (index 3): 22994823
2025-12-06 20:01:35,226:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01d. Malaria cases treated (index 4): 15266488
2025-12-06 20:01:35,226:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01c. Malaria Confirmed (B/s and RDT Positive) (index 5): 13326277
2025-12-06 20:01:35,226:INFO:superset.db_engine_specs.dhis2_dialect:First pivoted row - Period: '2020', OrgUnit: 'MOH - Uganda'
2025-12-06 20:01:35,226:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total pivoted rows: 4, columns: 6
2025-12-06 20:01:35,226:INFO:superset.db_engine_specs.dhis2_dialect:Normalized 4 rows with 6 columns for endpoint analytics
2025-12-06 20:01:35,226:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API returned 4 rows
2025-12-06 20:01:35,231:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() - Row count: 4
2025-12-06 20:01:35,231:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:01:35,231:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names length: 6
2025-12-06 20:01:35,231:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values count: 6
2025-12-06 20:01:35,231:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-06 20:01:35,231:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 0 (Period): 2020 -> 2020 (STRING)
2025-12-06 20:01:35,231:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (OrgUnit): MOH - Uganda -> MOH - Uganda (STRING)
2025-12-06 20:01:35,231:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (105_EP01b_Malaria_Total): 14479324 (PROCESSED)
2025-12-06 20:01:35,231:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (105_EP01a_Suspected_fever): 22994823 (PROCESSED)
2025-12-06 20:01:35,231:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (105_EP01d_Malaria_cases_treated): 15266488 (PROCESSED)
2025-12-06 20:01:35,231:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() returning 4 rows with 6 columns each
2025-12-06 20:01:35,231:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Got 4 rows from cursor
2025-12-06 20:01:35,232:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-06 20:01:35,232:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:01:35,232:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Types from cursor: ['String', 'String', 'String', 'String', 'String', 'String']
2025-12-06 20:01:35,232:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: DataFrame created with 4 rows, 6 columns
2025-12-06 20:01:35,232:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:01:35,232:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes BEFORE fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-06 20:01:35,233:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Period' to object dtype (dimension)
2025-12-06 20:01:35,233:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'OrgUnit' to object dtype (dimension)
2025-12-06 20:01:35,233:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes AFTER fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-06 20:01:35,233:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: First row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-06 20:01:35,237:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] BEFORE assign_column_label:
2025-12-06 20:01:35,237:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 6)
2025-12-06 20:01:35,237:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:01:35,237:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-06 20:01:35,237:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: False
2025-12-06 20:01:35,237:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-06 20:01:35,237:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Column truncation needed: df has 6 columns, expected 4
2025-12-06 20:01:35,237:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   DataFrame actual columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:01:35,237:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Expected columns: ['OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-06 20:01:35,237:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] âœ“ Selecting columns BY NAME (matched all expected columns)
2025-12-06 20:01:35,237:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Column mapping: {'OrgUnit': 'OrgUnit', 'SUM(105_EP01b_Malaria_Total)': '105_EP01b_Malaria_Total', 'SUM(105_EP01a_Suspected_fever)': '105_EP01a_Suspected_fever', 'SUM(105_EP01d_Malaria_cases_treated)': '105_EP01d_Malaria_cases_treated'}
2025-12-06 20:01:35,237:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] Column Selection âœ“ SUCCESS - method=BY_NAME, datasource=analytics_LAST_YEAR_20251206
2025-12-06 20:01:35,237:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-06 20:01:35,237:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   tried_by_name=True, success=True, fallback=False
2025-12-06 20:01:35,237:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Assigning column labels: ['OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-06 20:01:35,237:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] AFTER assign_column_label:
2025-12-06 20:01:35,238:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 4)
2025-12-06 20:01:35,238:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-06 20:01:35,238:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-06 20:01:35,238:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: True
2025-12-06 20:01:35,238:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'OrgUnit': 'MOH - Uganda', 'SUM(105_EP01b_Malaria_Total)': 14479324, 'SUM(105_EP01a_Suspected_fever)': 22994823, 'SUM(105_EP01d_Malaria_cases_treated)': 15266488}
2025-12-06 20:01:35,239:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] DataFrame columns: ['OrgUnit', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)', 'SUM(105_EP01d_Malaria_cases_treated)']
2025-12-06 20:01:35,239:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Aggregates: {'SUM(105_EP01b_Malaria_Total)': {'operator': 'mean'}, 'SUM(105_EP01a_Suspected_fever)': {'operator': 'mean'}, 'SUM(105_EP01d_Malaria_cases_treated)': {'operator': 'mean'}}
2025-12-06 20:01:35,239:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105_EP01b_Malaria_Total)', column='SUM(105_EP01b_Malaria_Total)'
2025-12-06 20:01:35,239:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105_EP01a_Suspected_fever)', column='SUM(105_EP01a_Suspected_fever)'
2025-12-06 20:01:35,239:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105_EP01d_Malaria_cases_treated)', column='SUM(105_EP01d_Malaria_cases_treated)'
2025-12-06 20:01:35,256:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:01:35] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-06 20:01:35,989:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:01:35] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-06 20:01:44,529:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:01:44] "GET /api/v1/me/ HTTP/1.1" 200 -
2025-12-06 20:15:50,729:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:15:50] "GET /api/v1/me/ HTTP/1.1" 200 -
2025-12-06 20:16:09,167:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:16:09] "GET /api/v1/me/ HTTP/1.1" 200 -
2025-12-06 20:16:13,963:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:16:13] "GET /api/v1/me/ HTTP/1.1" 200 -
2025-12-06 20:18:07,727:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:18:07] "GET /api/v1/me/ HTTP/1.1" 200 -
2025-12-06 20:18:29,945:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:18:29] "[32mGET / HTTP/1.1[0m" 302 -
2025-12-06 20:18:30,017:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:18:30] "GET /superset/welcome/ HTTP/1.1" 200 -
2025-12-06 20:18:30,035:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:18:30] "GET /static/appbuilder/css/flags/flags16.css HTTP/1.1" 200 -
2025-12-06 20:18:30,047:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:18:30] "GET /static/assets/theme.0d705af4.entry.js HTTP/1.1" 200 -
2025-12-06 20:18:30,056:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:18:30] "GET /static/assets/thumbnail.0759d391.entry.js HTTP/1.1" 200 -
2025-12-06 20:18:30,077:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:18:30] "GET /static/assets/vendors-node_modules_rc-component_color-picker_es_index_js-node_modules_rc-component_mutate-o-700049.6a9d3af6.entry.js HTTP/1.1" 200 -
2025-12-06 20:18:30,099:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:18:30] "GET /static/assets/vendors-node_modules_ace-builds_src-min-noconflict_mode-css_js-node_modules_ace-builds_src-mi-2f288a.5b49b91c.entry.js HTTP/1.1" 200 -
2025-12-06 20:18:30,100:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:18:30] "GET /static/assets/packages_superset-ui-core_src_ui-overrides_ExtensionsRegistry_ts-src_components_UiConfigConte-27f319.1a064ec8.entry.js HTTP/1.1" 200 -
2025-12-06 20:18:30,121:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:18:30] "GET /static/assets/packages_superset-ui-switchboard_src_index_ts-src_components_MessageToasts_ToastContainer_tsx-622036.1ba998dd.entry.js HTTP/1.1" 200 -
2025-12-06 20:18:30,139:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:18:30] "GET /static/assets/spa.433bf97d.entry.js HTTP/1.1" 200 -
2025-12-06 20:18:30,169:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:18:30] "GET /static/assets/vendors-node_modules_reduxjs_toolkit_dist_query_react_rtk-query-react_esm_js-node_modules_ans-dafe32.9cbde694.entry.js HTTP/1.1" 200 -
2025-12-06 20:18:30,179:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:18:30] "GET /static/assets/vendors.ba32905a.entry.js HTTP/1.1" 200 -
2025-12-06 20:18:30,271:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1458, in dispatch_request
    self.raise_routing_exception(req)
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1440, in raise_routing_exception
    raise request.routing_exception  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/ctx.py", line 353, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/werkzeug/routing/map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-12-06 20:18:30,272:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:18:30] "[33mGET /ws HTTP/1.1[0m" 404 -
2025-12-06 20:18:30,747:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:18:30] "GET /api/v1/database/?q=(filters:!((col:database_name,opr:neq,value:examples))) HTTP/1.1" 200 -
2025-12-06 20:18:30,749:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:18:30] "GET /static/assets/b7c27c60f848f2083f45.woff2 HTTP/1.1" 200 -
2025-12-06 20:18:30,750:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:18:30] "GET /static/assets/eca1e21531598d5db58f.woff2 HTTP/1.1" 200 -
2025-12-06 20:18:30,754:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:18:30] "GET /api/v1/log/recent_activity/?q=(distinct:!f,page_size:24) HTTP/1.1" 200 -
2025-12-06 20:18:30,951:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:18:30] "GET /api/v1/dashboard/?q=(filters:!(),order_column:changed_on_delta_humanized,order_direction:desc,page:0,page_size:5) HTTP/1.1" 200 -
2025-12-06 20:18:30,952:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:18:30] "GET /api/v1/database/?q=(filters:!((col:allow_file_upload,opr:upload_is_enabled,value:!t))) HTTP/1.1" 200 -
2025-12-06 20:18:30,954:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:18:30] "GET /api/v1/saved_query/?q=(filters:!((col:created_by,opr:rel_o_m,value:'1')),order_column:changed_on_delta_humanized,order_direction:desc,page:0,page_size:5) HTTP/1.1" 200 -
2025-12-06 20:18:30,958:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:18:30] "GET /api/v1/chart/?q=(filters:!((col:owners,opr:rel_m_m,value:'1')),order_column:changed_on_delta_humanized,order_direction:desc,page:0,page_size:5) HTTP/1.1" 200 -
2025-12-06 20:18:30,959:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:18:30] "GET /api/v1/chart/?q=(filters:!(),order_column:changed_on_delta_humanized,order_direction:desc,page:0,page_size:5) HTTP/1.1" 200 -
2025-12-06 20:18:30,964:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:18:30] "GET /api/v1/dashboard/?q=(filters:!((col:owners,opr:rel_m_m,value:'1')),order_column:changed_on_delta_humanized,order_direction:desc,page:0,page_size:5) HTTP/1.1" 200 -
2025-12-06 20:18:31,022:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:18:31] "GET /api/v1/chart/favorite_status/?q=!(1) HTTP/1.1" 200 -
2025-12-06 20:18:31,023:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:18:31] "GET /api/v1/chart/_info?q=(keys:!(permissions)) HTTP/1.1" 200 -
2025-12-06 20:18:31,032:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:18:31] "GET /api/v1/dashboard/_info?q=(keys:!(permissions)) HTTP/1.1" 200 -
2025-12-06 20:18:31,624:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:18:31] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-06 20:18:31,696:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1458, in dispatch_request
    self.raise_routing_exception(req)
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1440, in raise_routing_exception
    raise request.routing_exception  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/ctx.py", line 353, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/werkzeug/routing/map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-12-06 20:18:31,697:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:18:31] "[33mGET /ws HTTP/1.1[0m" 404 -
2025-12-06 20:18:32,676:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:18:32] "GET /static/assets/DatasetList.9079c013.chunk.js HTTP/1.1" 200 -
2025-12-06 20:18:32,800:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:18:32] "GET /api/v1/dataset/_info?q=(keys:!(permissions)) HTTP/1.1" 200 -
2025-12-06 20:18:32,801:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:18:32] "GET /api/v1/dataset/?q=(order_column:changed_on_delta_humanized,order_direction:desc,page:0,page_size:25) HTTP/1.1" 200 -
2025-12-06 20:18:33,692:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:18:33] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-06 20:18:33,727:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1458, in dispatch_request
    self.raise_routing_exception(req)
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1440, in raise_routing_exception
    raise request.routing_exception  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/ctx.py", line 353, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/werkzeug/routing/map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-12-06 20:18:33,728:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:18:33] "[33mGET /ws HTTP/1.1[0m" 404 -
2025-12-06 20:18:34,873:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:18:34] "GET /static/assets/vendors-node_modules_echarts_lib_chart_bar_install_js-node_modules_echarts_lib_chart_boxplot_-9902f1.abcac449.chunk.js HTTP/1.1" 200 -
2025-12-06 20:18:34,879:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:18:34] "GET /static/assets/vendors-node_modules_geostyler-openlayers-parser_build_dist_OlStyleParser_js-node_modules_ol_-d45488.9be558e8.chunk.js HTTP/1.1" 200 -
2025-12-06 20:18:34,881:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:18:34] "GET /static/assets/vendors-node_modules_visx_responsive_esm_components_ParentSize_js-node_modules_dom-to-image-m-c80308.bc78d78a.chunk.js HTTP/1.1" 200 -
2025-12-06 20:18:34,914:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:18:34] "GET /static/assets/DashboardContainer.56310f7c.chunk.js HTTP/1.1" 200 -
2025-12-06 20:18:34,944:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:18:34] "GET /static/assets/Chart.c516b9e3.chunk.js HTTP/1.1" 200 -
2025-12-06 20:18:35,260:INFO:superset.db_engine_specs.dhis2:[DHIS2] get_parameters_from_uri called
2025-12-06 20:18:35,260:ERROR:superset.db_engine_specs.dhis2:[DHIS2] Failed to extract parameters from URI: 'URL' object has no attribute 'decode'
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/superset/db_engine_specs/dhis2.py", line 361, in get_parameters_from_uri
    parsed = urlparse(uri)
             ^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/urllib/parse.py", line 394, in urlparse
    url, scheme, _coerce_result = _coerce_args(url, scheme)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/urllib/parse.py", line 133, in _coerce_args
    return _decode_args(args) + (_encode_result,)
           ^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/urllib/parse.py", line 117, in _decode_args
    return tuple(x.decode(encoding, errors) if x else '' for x in args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/urllib/parse.py", line 117, in <genexpr>
    return tuple(x.decode(encoding, errors) if x else '' for x in args)
                 ^^^^^^^^
AttributeError: 'URL' object has no attribute 'decode'
2025-12-06 20:18:35,265:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:18:35] "GET /api/v1/explore/?datasource_type=table&datasource_id=1 HTTP/1.1" 200 -
2025-12-06 20:18:35,385:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:18:35] "GET /static/assets/8d61e6fb0ce397d8bf21.woff2 HTTP/1.1" 200 -
2025-12-06 20:18:35,395:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:18:35] "GET /static/assets/node_modules_svgr_webpack_dist_index_js_src_assets_images_icons_big_number_chart_tile_svg.97c95346.chunk.js HTTP/1.1" 200 -
2025-12-06 20:18:35,435:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:18:35] "GET /static/assets/node_modules_svgr_webpack_dist_index_js_src_assets_images_icons_drag_svg.7fafc6ce.chunk.js HTTP/1.1" 200 -
2025-12-06 20:18:36,407:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:18:36] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-06 20:18:36,449:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:18:36] "[35m[1mPOST /api/v1/explore/form_data?tab_id=2 HTTP/1.1[0m" 201 -
2025-12-06 20:18:37,768:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1458, in dispatch_request
    self.raise_routing_exception(req)
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1440, in raise_routing_exception
    raise request.routing_exception  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/ctx.py", line 353, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/werkzeug/routing/map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-12-06 20:18:37,769:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:18:37] "[33mGET /ws HTTP/1.1[0m" 404 -
2025-12-06 20:18:40,567:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:18:40] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-06 20:18:45,042:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:18:45] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-06 20:18:45,733:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:18:45] "GET /static/assets/node_modules_svgr_webpack_dist_index_js_src_assets_images_icons_square_svg.492461a3.chunk.js HTTP/1.1" 200 -
2025-12-06 20:18:45,764:ERROR:superset.models.helpers:[METRICS-TRACE] Processing 0 metrics
2025-12-06 20:18:45,764:ERROR:superset.models.helpers:[METRICS-TRACE] Total metrics added: 0
2025-12-06 20:18:45,767:ERROR:superset.models.helpers:[METRICS-TRACE] Before dedup: 1 select_exprs + 0 metrics_exprs
2025-12-06 20:18:45,767:ERROR:superset.models.helpers:[METRICS-TRACE] After dedup: 1 total select_exprs
2025-12-06 20:18:45,767:INFO:superset.models.helpers:[COLUMN_TRACE] SQL Query Building:
2025-12-06 20:18:45,767:INFO:superset.models.helpers:[COLUMN_TRACE]   columns: ['105_EP01b_Malaria_Total']
2025-12-06 20:18:45,767:INFO:superset.models.helpers:[COLUMN_TRACE]   metrics: []
2025-12-06 20:18:45,767:INFO:superset.models.helpers:[COLUMN_TRACE]   groupby: []
2025-12-06 20:18:45,767:INFO:superset.models.helpers:[COLUMN_TRACE]   labels_expected: ['105_EP01b_Malaria_Total']
2025-12-06 20:18:45,767:INFO:superset.models.helpers:[COLUMN_TRACE]   select_exprs count: 1
2025-12-06 20:18:45,767:INFO:superset.models.helpers:[COLUMN_TRACE]     [0] key=105_EP01b_Malaria_Total, name=105_EP01b_Malaria_Total, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-06 20:18:45,767:INFO:superset.connectors.sqla.models:[DHIS2] get_from_clause for virtual dataset 1: analytics_LAST_YEAR_20251206
2025-12-06 20:18:45,767:INFO:superset.connectors.sqla.models:[DHIS2] Full SQL stored: SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
2025-12-06 20:18:45,767:INFO:superset.connectors.sqla.models:[DHIS2] Loaded params from extra field: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayPropert
2025-12-06 20:18:45,768:INFO:superset.connectors.sqla.models:[DHIS2] Cached params with key: dhis2_params_1_analytics
2025-12-06 20:18:45,768:INFO:superset.connectors.sqla.models:[DHIS2] Stored params in Flask g for DHIS2 table: analytics
2025-12-06 20:18:45,770:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Query execution in connectors/sqla/models.py:
2025-12-06 20:18:45,770:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   SQL (first 500 chars): SELECT "105_EP01b_Malaria_Total" 
FROM (SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
) AS virtual_table
 LIMIT 10000
2025-12-06 20:18:45,770:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   labels_expected: ['105_EP01b_Malaria_Total']
2025-12-06 20:18:45,771:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 connection initialized: https://tests.dhis2.hispuganda.org/hmis/api
2025-12-06 20:18:45,771:INFO:superset.db_engine_specs.dhis2_dialect:Executing DHIS2 query: SELECT
  "105_EP01b_Malaria_Total"
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
LIMIT 10000
2025-12-06 20:18:45,771:INFO:superset.db_engine_specs.dhis2_dialect:Parsed endpoint: analytics
2025-12-06 20:18:45,771:INFO:superset.db_engine_specs.dhis2_dialect:Using stored parameters from Flask g for table: analytics
2025-12-06 20:18:45,771:INFO:superset.db_engine_specs.dhis2_dialect:Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
2025-12-06 20:18:45,771:INFO:superset.db_engine_specs.dhis2_dialect:Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
2025-12-06 20:18:45,771:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API request: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
2025-12-06 20:18:45,844:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1458, in dispatch_request
    self.raise_routing_exception(req)
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1440, in raise_routing_exception
    raise request.routing_exception  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/ctx.py", line 353, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/werkzeug/routing/map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-12-06 20:18:45,845:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:18:45] "[33mGET /ws HTTP/1.1[0m" 404 -
2025-12-06 20:18:46,719:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:18:46] "PUT /api/v1/explore/form_data/k8bo1sy5Yq8?tab_id=2 HTTP/1.1" 200 -
2025-12-06 20:18:54,227:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:18:54] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-06 20:18:56,491:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:18:56] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-06 20:18:58,580:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:18:58] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-06 20:19:01,265:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:19:01] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-06 20:19:01,888:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1458, in dispatch_request
    self.raise_routing_exception(req)
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1440, in raise_routing_exception
    raise request.routing_exception  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/ctx.py", line 353, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/werkzeug/routing/map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-12-06 20:19:01,889:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:19:01] "[33mGET /ws HTTP/1.1[0m" 404 -
2025-12-06 20:19:03,210:INFO:superset.db_engine_specs.dhis2_dialect:Using wide/pivoted format for analytics
2025-12-06 20:19:03,210:INFO:superset.db_engine_specs.dhis2_dialect:normalize_analytics called with pivot=True, returning WIDE format
2025-12-06 20:19:03,210:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column construction - data_elements: ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
2025-12-06 20:19:03,210:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column names constructed (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:19:03,210:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] FIRST ROW CONSTRUCTION:
2025-12-06 20:19:03,210:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   Period (index 0): 2020
2025-12-06 20:19:03,210:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   OrgUnit (index 1): MOH - Uganda
2025-12-06 20:19:03,210:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01b. Malaria Total (index 2): 14479324
2025-12-06 20:19:03,210:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01a. Suspected fever (index 3): 22994823
2025-12-06 20:19:03,210:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01d. Malaria cases treated (index 4): 15266488
2025-12-06 20:19:03,210:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01c. Malaria Confirmed (B/s and RDT Positive) (index 5): 13326277
2025-12-06 20:19:03,210:INFO:superset.db_engine_specs.dhis2_dialect:First pivoted row - Period: '2020', OrgUnit: 'MOH - Uganda'
2025-12-06 20:19:03,211:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total pivoted rows: 4, columns: 6

[DHIS2] API request URL: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
[DHIS2] Raw API response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Raw DHIS2 rows count: 16
[DHIS2] First raw row: ['QHnwKs2OUZv', '2020', 'akV6429SUqu', '15266488']
[DHIS2] Parsing response for endpoint: analytics
[DHIS2] Response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Response sample: {'headers': [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}], 'metaDat
[DHIS2] Using WIDE/PIVOTED format (Period, OrgUnit, DX1, DX2, ...) for analytics
[DHIS2] normalize_analytics: pivot=True, using WIDE/PIVOTED format
[DHIS2] PIVOT CONSTRUCTION:
[DHIS2]   data_elements (UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   data_element_list (sorted UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   col_names (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized row count: 4
[DHIS2] First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] _set_description: columns=['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], types=['String', 'String', 'String', 'String', 'String', 'String']
[DHIS2] Transformed rows count: 4
[DHIS2] First transformed row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] Fetched 4 rows
[DHIS2] fetchall() called - returning 4 rows
[DHIS2] fetchall() - First row type: <class 'tuple'>
[DHIS2] fetchall() - First row (original): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Column count from description: 6
[DHIS2] fetchall() - First row (fixed types): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Type enforcement: dimensions=STRING, measures=FLOAT
[DHIS2] Raw API response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Raw DHIS2 rows count: 16
[DHIS2] First raw row: ['QHnwKs2OUZv', '2020', 'akV6429SUqu', '15266488']
[DHIS2] Parsing response for endpoint: analytics
[DHIS2] Response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Response sample: {'headers': [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}], 'metaDat
[DHIS2] Using WIDE/PIVOTED format (Period, OrgUnit, DX1, DX2, ...) for analytics
[DHIS2] normalize_analytics: pivot=True, using WIDE/PIVOTED format
[DHIS2] PIVOT CONSTRUCTION:
[DHIS2]   data_elements (UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   data_element_list (sorted UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   col_names (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized row count: 4
[DHIS2] First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] _set_description: columns=['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], types=['String', 'String', 'String', 'String', 'String', 'String']
[DHIS2] Transformed rows count: 4
[DHIS2] First transformed row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] Fetched 4 rows
[DHIS2] fetchall() called - returning 4 rows
[DHIS2] fetchall() - First row type: <class 'tuple'>
[DHIS2] fetchall() - First row (original): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Column count from description: 6
[DHIS2] fetchall() - First row (fixed types): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Type enforcement: dimensions=STRING, measures=FLOAT
[DHIS2] Executing query: SELECT
  "105_EP01b_Malaria_Total"
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
LIMIT 10000
[DHIS2] Parsed endpoint: analytics
[DHIS2] Found params in Flask g for analytics: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;
[DHIS2] Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
[DHIS2] Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
[DHIS2] API request URL: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
[DHIS2] Raw API response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Raw DHIS2 rows count: 16
[DHIS2] First raw row: ['QHnwKs2OUZv', '2020', 'akV6429SUqu', '15266488']
[DHIS2] Parsing response for endpoint: analytics
[DHIS2] Response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Response sample: {'headers': [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}], 'metaDat
[DHIS2] Using WIDE/PIVOTED format (Period, OrgUnit, DX1, DX2, ...) for analytics
[DHIS2] normalize_analytics: pivot=True, using WIDE/PIVOTED format
[DHIS2] PIVOT CONSTRUCTION:
[DHIS2]   data_elements (UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   data_element_list (sorted UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   col_names (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']2025-12-06 20:19:03,211:INFO:superset.db_engine_specs.dhis2_dialect:Normalized 4 rows with 6 columns for endpoint analytics
2025-12-06 20:19:03,211:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API returned 4 rows
2025-12-06 20:19:03,216:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() - Row count: 4
2025-12-06 20:19:03,216:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:19:03,216:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names length: 6
2025-12-06 20:19:03,216:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values count: 6
2025-12-06 20:19:03,216:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-06 20:19:03,216:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 0 (Period): 2020 -> 2020 (STRING)
2025-12-06 20:19:03,216:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (OrgUnit): MOH - Uganda -> MOH - Uganda (STRING)
2025-12-06 20:19:03,216:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (105_EP01b_Malaria_Total): 14479324 (PROCESSED)
2025-12-06 20:19:03,216:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (105_EP01a_Suspected_fever): 22994823 (PROCESSED)
2025-12-06 20:19:03,216:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (105_EP01d_Malaria_cases_treated): 15266488 (PROCESSED)
2025-12-06 20:19:03,216:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() returning 4 rows with 6 columns each
2025-12-06 20:19:03,216:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Got 4 rows from cursor
2025-12-06 20:19:03,216:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-06 20:19:03,216:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:19:03,216:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Types from cursor: ['String', 'String', 'String', 'String', 'String', 'String']
2025-12-06 20:19:03,218:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: DataFrame created with 4 rows, 6 columns
2025-12-06 20:19:03,218:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:19:03,219:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes BEFORE fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-06 20:19:03,220:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Period' to object dtype (dimension)
2025-12-06 20:19:03,220:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'OrgUnit' to object dtype (dimension)
2025-12-06 20:19:03,221:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes AFTER fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-06 20:19:03,221:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: First row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-06 20:19:03,224:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] BEFORE assign_column_label:
2025-12-06 20:19:03,224:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 6)
2025-12-06 20:19:03,224:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:19:03,224:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['105_EP01b_Malaria_Total']
2025-12-06 20:19:03,224:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: False
2025-12-06 20:19:03,224:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-06 20:19:03,224:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Column truncation needed: df has 6 columns, expected 1
2025-12-06 20:19:03,224:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   DataFrame actual columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:19:03,224:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Expected columns: ['105_EP01b_Malaria_Total']
2025-12-06 20:19:03,224:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] âœ“ Selecting columns BY NAME (matched all expected columns)
2025-12-06 20:19:03,225:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Column mapping: {'105_EP01b_Malaria_Total': '105_EP01b_Malaria_Total'}
2025-12-06 20:19:03,225:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] Column Selection âœ“ SUCCESS - method=BY_NAME, datasource=analytics_LAST_YEAR_20251206
2025-12-06 20:19:03,225:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['105_EP01b_Malaria_Total']
2025-12-06 20:19:03,225:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   tried_by_name=True, success=True, fallback=False
2025-12-06 20:19:03,225:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Assigning column labels: ['105_EP01b_Malaria_Total']
2025-12-06 20:19:03,225:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] AFTER assign_column_label:
2025-12-06 20:19:03,225:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 1)
2025-12-06 20:19:03,225:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['105_EP01b_Malaria_Total']
2025-12-06 20:19:03,225:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['105_EP01b_Malaria_Total']
2025-12-06 20:19:03,225:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: True
2025-12-06 20:19:03,225:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'105_EP01b_Malaria_Total': 14479324}
2025-12-06 20:19:03,237:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:19:03] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-06 20:19:03,265:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:19:03] "GET /static/assets/plugins_plugin-chart-table_src_TableChart_tsx.6305cc9d.chunk.js HTTP/1.1" 200 -
2025-12-06 20:19:03,279:ERROR:superset.models.helpers:[METRICS-TRACE] Processing 0 metrics
2025-12-06 20:19:03,279:ERROR:superset.models.helpers:[METRICS-TRACE] Total metrics added: 0
2025-12-06 20:19:03,280:ERROR:superset.models.helpers:[METRICS-TRACE] Before dedup: 1 select_exprs + 0 metrics_exprs
2025-12-06 20:19:03,280:ERROR:superset.models.helpers:[METRICS-TRACE] After dedup: 1 total select_exprs
2025-12-06 20:19:03,280:INFO:superset.models.helpers:[COLUMN_TRACE] SQL Query Building:
2025-12-06 20:19:03,280:INFO:superset.models.helpers:[COLUMN_TRACE]   columns: ['105_EP01b_Malaria_Total']
2025-12-06 20:19:03,280:INFO:superset.models.helpers:[COLUMN_TRACE]   metrics: []
2025-12-06 20:19:03,280:INFO:superset.models.helpers:[COLUMN_TRACE]   groupby: []
2025-12-06 20:19:03,280:INFO:superset.models.helpers:[COLUMN_TRACE]   labels_expected: ['105_EP01b_Malaria_Total']
2025-12-06 20:19:03,280:INFO:superset.models.helpers:[COLUMN_TRACE]   select_exprs count: 1
2025-12-06 20:19:03,280:INFO:superset.models.helpers:[COLUMN_TRACE]     [0] key=105_EP01b_Malaria_Total, name=105_EP01b_Malaria_Total, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-06 20:19:03,280:INFO:superset.connectors.sqla.models:[DHIS2] get_from_clause for virtual dataset 1: analytics_LAST_YEAR_20251206
2025-12-06 20:19:03,280:INFO:superset.connectors.sqla.models:[DHIS2] Full SQL stored: SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
2025-12-06 20:19:03,280:INFO:superset.connectors.sqla.models:[DHIS2] Loaded params from extra field: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayPropert
2025-12-06 20:19:03,281:INFO:superset.connectors.sqla.models:[DHIS2] Cached params with key: dhis2_params_1_analytics
2025-12-06 20:19:03,281:INFO:superset.connectors.sqla.models:[DHIS2] Stored params in Flask g for DHIS2 table: analytics
2025-12-06 20:19:03,283:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Query execution in connectors/sqla/models.py:
2025-12-06 20:19:03,283:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   SQL (first 500 chars): SELECT "105_EP01b_Malaria_Total" 
FROM (SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
) AS virtual_table
 LIMIT 10000
2025-12-06 20:19:03,283:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   labels_expected: ['105_EP01b_Malaria_Total']
2025-12-06 20:19:03,284:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 connection initialized: https://tests.dhis2.hispuganda.org/hmis/api
2025-12-06 20:19:03,284:INFO:superset.db_engine_specs.dhis2_dialect:Executing DHIS2 query: SELECT
  "105_EP01b_Malaria_Total"
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
LIMIT 10000
2025-12-06 20:19:03,284:INFO:superset.db_engine_specs.dhis2_dialect:Parsed endpoint: analytics
2025-12-06 20:19:03,284:INFO:superset.db_engine_specs.dhis2_dialect:Using stored parameters from Flask g for table: analytics
2025-12-06 20:19:03,284:INFO:superset.db_engine_specs.dhis2_dialect:Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
2025-12-06 20:19:03,284:INFO:superset.db_engine_specs.dhis2_dialect:Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
2025-12-06 20:19:03,284:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API request: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
2025-12-06 20:19:04,296:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:19:04] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-06 20:19:05,875:ERROR:superset.models.helpers:[METRICS-TRACE] Processing 0 metrics
2025-12-06 20:19:05,876:ERROR:superset.models.helpers:[METRICS-TRACE] Total metrics added: 0
2025-12-06 20:19:05,878:ERROR:superset.models.helpers:[METRICS-TRACE] Before dedup: 6 select_exprs + 0 metrics_exprs
2025-12-06 20:19:05,879:ERROR:superset.models.helpers:[METRICS-TRACE] Processing 0 metrics
2025-12-06 20:19:05,879:ERROR:superset.models.helpers:[METRICS-TRACE] After dedup: 6 total select_exprs
2025-12-06 20:19:05,879:ERROR:superset.models.helpers:[METRICS-TRACE] Total metrics added: 0
2025-12-06 20:19:05,879:INFO:superset.models.helpers:[COLUMN_TRACE] SQL Query Building:
2025-12-06 20:19:05,882:INFO:superset.models.helpers:[COLUMN_TRACE]   columns: ['105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', 'OrgUnit', 'Period']
2025-12-06 20:19:05,883:INFO:superset.models.helpers:[COLUMN_TRACE]   metrics: []
2025-12-06 20:19:05,883:INFO:superset.models.helpers:[COLUMN_TRACE]   groupby: []
2025-12-06 20:19:05,883:INFO:superset.models.helpers:[COLUMN_TRACE]   labels_expected: ['105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', 'OrgUnit', 'Period']
2025-12-06 20:19:05,883:INFO:superset.models.helpers:[COLUMN_TRACE]   select_exprs count: 6
2025-12-06 20:19:05,882:ERROR:superset.models.helpers:[METRICS-TRACE] Before dedup: 6 select_exprs + 0 metrics_exprs
2025-12-06 20:19:05,883:INFO:superset.models.helpers:[COLUMN_TRACE]     [0] key=105_EP01b_Malaria_Total, name=105_EP01b_Malaria_Total, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-06 20:19:05,883:ERROR:superset.models.helpers:[METRICS-TRACE] After dedup: 6 total select_exprs
2025-12-06 20:19:05,883:INFO:superset.models.helpers:[COLUMN_TRACE]     [1] key=105_EP01a_Suspected_fever, name=105_EP01a_Suspected_fever, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-06 20:19:05,883:INFO:superset.models.helpers:[COLUMN_TRACE] SQL Query Building:
2025-12-06 20:19:05,883:INFO:superset.models.helpers:[COLUMN_TRACE]     [2] key=105_EP01d_Malaria_cases_treated, name=105_EP01d_Malaria_cases_treated, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-06 20:19:05,883:INFO:superset.models.helpers:[COLUMN_TRACE]   columns: ['105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', 'OrgUnit', 'Period']
2025-12-06 20:19:05,883:INFO:superset.models.helpers:[COLUMN_TRACE]     [3] key=105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive, name=105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-06 20:19:05,883:INFO:superset.models.helpers:[COLUMN_TRACE]   metrics: []
2025-12-06 20:19:05,883:INFO:superset.models.helpers:[COLUMN_TRACE]     [4] key=OrgUnit, name=OrgUnit, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-06 20:19:05,883:INFO:superset.models.helpers:[COLUMN_TRACE]   groupby: []
2025-12-06 20:19:05,883:INFO:superset.models.helpers:[COLUMN_TRACE]     [5] key=Period, name=Period, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-06 20:19:05,883:INFO:superset.models.helpers:[COLUMN_TRACE]   labels_expected: ['105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', 'OrgUnit', 'Period']
2025-12-06 20:19:05,883:INFO:superset.connectors.sqla.models:[DHIS2] get_from_clause for virtual dataset 1: analytics_LAST_YEAR_20251206
2025-12-06 20:19:05,883:INFO:superset.models.helpers:[COLUMN_TRACE]   select_exprs count: 6
2025-12-06 20:19:05,883:INFO:superset.models.helpers:[COLUMN_TRACE]     [0] key=105_EP01b_Malaria_Total, name=105_EP01b_Malaria_Total, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-06 20:19:05,883:INFO:superset.connectors.sqla.models:[DHIS2] Full SQL stored: SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
2025-12-06 20:19:05,883:INFO:superset.models.helpers:[COLUMN_TRACE]     [1] key=105_EP01a_Suspected_fever, name=105_EP01a_Suspected_fever, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-06 20:19:05,883:INFO:superset.connectors.sqla.models:[DHIS2] Loaded params from extra field: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayPropert
2025-12-06 20:19:05,883:INFO:superset.models.helpers:[COLUMN_TRACE]     [2] key=105_EP01d_Malaria_cases_treated, name=105_EP01d_Malaria_cases_treated, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-06 20:19:05,884:INFO:superset.models.helpers:[COLUMN_TRACE]     [3] key=105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive, name=105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-06 20:19:05,884:INFO:superset.models.helpers:[COLUMN_TRACE]     [4] key=OrgUnit, name=OrgUnit, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-06 20:19:05,884:INFO:superset.models.helpers:[COLUMN_TRACE]     [5] key=Period, name=Period, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-06 20:19:05,884:INFO:superset.connectors.sqla.models:[DHIS2] get_from_clause for virtual dataset 1: analytics_LAST_YEAR_20251206
2025-12-06 20:19:05,884:INFO:superset.connectors.sqla.models:[DHIS2] Full SQL stored: SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
2025-12-06 20:19:05,884:INFO:superset.connectors.sqla.models:[DHIS2] Loaded params from extra field: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayPropert
2025-12-06 20:19:05,884:INFO:superset.connectors.sqla.models:[DHIS2] Cached params with key: dhis2_params_1_analytics
2025-12-06 20:19:05,884:INFO:superset.connectors.sqla.models:[DHIS2] Stored params in Flask g for DHIS2 table: analytics
2025-12-06 20:19:05,886:INFO:superset.connectors.sqla.models:[DHIS2] Cached params with key: dhis2_params_1_analytics
2025-12-06 20:19:05,886:INFO:superset.connectors.sqla.models:[DHIS2] Stored params in Flask g for DHIS2 table: analytics
2025-12-06 20:19:05,888:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Query execution in connectors/sqla/models.py:
2025-12-06 20:19:05,888:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   SQL (first 500 chars): SELECT "105_EP01b_Malaria_Total", "105_EP01a_Suspected_fever", "105_EP01d_Malaria_cases_treated", "105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive", "OrgUnit", "Period" 
FROM (SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
) AS virtual_table
 LIMIT 10000
2025-12-06 20:19:05,888:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   labels_expected: ['105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', 'OrgUnit', 'Period']
2025-12-06 20:19:05,889:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Query execution in connectors/sqla/models.py:
2025-12-06 20:19:05,889:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   SQL (first 500 chars): SELECT "105_EP01b_Malaria_Total", "105_EP01a_Suspected_fever", "105_EP01d_Malaria_cases_treated", "105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive", "OrgUnit", "Period" 
FROM (SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
) AS virtual_table
 LIMIT 10000
2025-12-06 20:19:05,889:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   labels_expected: ['105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', 'OrgUnit', 'Period']
2025-12-06 20:19:05,892:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 connection initialized: https://tests.dhis2.hispuganda.org/hmis/api
2025-12-06 20:19:05,892:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 connection initialized: https://tests.dhis2.hispuganda.org/hmis/api
2025-12-06 20:19:05,892:INFO:superset.db_engine_specs.dhis2_dialect:Executing DHIS2 query: SELECT
  "105_EP01b_Malaria_Total",
  "105_EP01a_Suspected_fever",
  "105_EP01d_Malaria_cases_treated",
  "105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive",
  "OrgUnit",
  "Period"
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
LIMIT 10000
2025-12-06 20:19:05,893:INFO:superset.db_engine_specs.dhis2_dialect:Executing DHIS2 query: SELECT
  "105_EP01b_Malaria_Total",
  "105_EP01a_Suspected_fever",
  "105_EP01d_Malaria_cases_treated",
  "105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive",
  "OrgUnit",
  "Period"
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
LIMIT 10000
2025-12-06 20:19:05,893:INFO:superset.db_engine_specs.dhis2_dialect:Parsed endpoint: analytics
2025-12-06 20:19:05,893:INFO:superset.db_engine_specs.dhis2_dialect:Parsed endpoint: analytics
2025-12-06 20:19:05,893:INFO:superset.db_engine_specs.dhis2_dialect:Using stored parameters from Flask g for table: analytics
2025-12-06 20:19:05,893:INFO:superset.db_engine_specs.dhis2_dialect:Using stored parameters from Flask g for table: analytics
2025-12-06 20:19:05,893:INFO:superset.db_engine_specs.dhis2_dialect:Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
2025-12-06 20:19:05,893:INFO:superset.db_engine_specs.dhis2_dialect:Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
2025-12-06 20:19:05,893:INFO:superset.db_engine_specs.dhis2_dialect:Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
2025-12-06 20:19:05,893:INFO:superset.db_engine_specs.dhis2_dialect:Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
2025-12-06 20:19:05,893:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API request: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
2025-12-06 20:19:05,893:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API request: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
2025-12-06 20:19:06,841:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:19:06] "PUT /api/v1/explore/form_data/k8bo1sy5Yq8?tab_id=2 HTTP/1.1" 200 -
2025-12-06 20:19:09,109:INFO:superset.db_engine_specs.dhis2_dialect:Using wide/pivoted format for analytics
2025-12-06 20:19:09,110:INFO:superset.db_engine_specs.dhis2_dialect:normalize_analytics called with pivot=True, returning WIDE format
2025-12-06 20:19:09,110:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column construction - data_elements: ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
2025-12-06 20:19:09,110:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column names constructed (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:19:09,110:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] FIRST ROW CONSTRUCTION:
2025-12-06 20:19:09,110:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   Period (index 0): 2020
2025-12-06 20:19:09,110:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   OrgUnit (index 1): MOH - Uganda
2025-12-06 20:19:09,110:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01b. Malaria Total (index 2): 14479324
2025-12-06 20:19:09,110:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01a. Suspected fever (index 3): 22994823
2025-12-06 20:19:09,110:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01d. Malaria cases treated (index 4): 15266488
2025-12-06 20:19:09,110:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01c. Malaria Confirmed (B/s and RDT Positive) (index 5): 13326277
2025-12-06 20:19:09,110:INFO:superset.db_engine_specs.dhis2_dialect:First pivoted row - Period: '2020', OrgUnit: 'MOH - Uganda'
2025-12-06 20:19:09,110:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total pivoted rows: 4, columns: 6
2025-12-06 20:19:09,110:INFO:superset.db_engine_specs.dhis2_dialect:Normalized 4 rows with 6 columns for endpoint analytics
2025-12-06 20:19:09,110:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API returned 4 rows
2025-12-06 20:19:09,115:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() - Row count: 4
2025-12-06 20:19:09,115:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:19:09,115:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names length: 6
2025-12-06 20:19:09,115:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values count: 6
2025-12-06 20:19:09,115:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-06 20:19:09,115:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 0 (Period): 2020 -> 2020 (STRING)
2025-12-06 20:19:09,115:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (OrgUnit): MOH - Uganda -> MOH - Uganda (STRING)
2025-12-06 20:19:09,115:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (105_EP01b_Malaria_Total): 14479324 (PROCESSED)
2025-12-06 20:19:09,115:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (105_EP01a_Suspected_fever): 22994823 (PROCESSED)
2025-12-06 20:19:09,115:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (105_EP01d_Malaria_cases_treated): 15266488 (PROCESSED)
2025-12-06 20:19:09,115:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() returning 4 rows with 6 columns each
2025-12-06 20:19:09,115:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Got 4 rows from cursor
2025-12-06 20:19:09,115:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-06 20:19:09,115:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:19:09,115:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Types from cursor: ['String', 'String', 'String', 'String', 'String', 'String']
2025-12-06 20:19:09,116:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: DataFrame created with 4 rows, 6 columns
2025-12-06 20:19:09,116:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:19:09,116:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes BEFORE fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-06 20:19:09,117:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Period' to object dtype (dimension)
2025-12-06 20:19:09,117:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'OrgUnit' to object dtype (dimension)
2025-12-06 20:19:09,117:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes AFTER fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-06 20:19:09,117:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: First row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-06 20:19:09,120:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] BEFORE assign_column_label:
2025-12-06 20:19:09,120:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 6)
2025-12-06 20:19:09,120:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:19:09,120:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['105_EP01b_Malaria_Total']
2025-12-06 20:19:09,120:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: False
2025-12-06 20:19:09,120:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-06 20:19:09,120:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Column truncation needed: df has 6 columns, expected 1
2025-12-06 20:19:09,120:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   DataFrame actual columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:19:09,120:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Expected columns: ['105_EP01b_Malaria_Total']
2025-12-06 20:19:09,120:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] âœ“ Selecting columns BY NAME (matched all expected columns)
2025-12-06 20:19:09,120:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Column mapping: {'105_EP01b_Malaria_Total': '105_EP01b_Malaria_Total'}
2025-12-06 20:19:09,121:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] Column Selection âœ“ SUCCESS - method=BY_NAME, datasource=analytics_LAST_YEAR_20251206
2025-12-06 20:19:09,121:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['105_EP01b_Malaria_Total']
2025-12-06 20:19:09,121:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   tried_by_name=True, success=True, fallback=False
2025-12-06 20:19:09,121:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Assigning column labels: ['105_EP01b_Malaria_Total']
2025-12-06 20:19:09,121:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] AFTER assign_column_label:
2025-12-06 20:19:09,121:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 1)
2025-12-06 20:19:09,121:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['105_EP01b_Malaria_Total']
2025-12-06 20:19:09,121:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['105_EP01b_Malaria_Total']
2025-12-06 20:19:09,121:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: True
2025-12-06 20:19:09,121:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'105_EP01b_Malaria_Total': 14479324}
2025-12-06 20:19:09,133:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:19:09] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-06 20:19:10,825:INFO:superset.db_engine_specs.dhis2_dialect:Using wide/pivoted format for analytics
2025-12-06 20:19:10,825:INFO:superset.db_engine_specs.dhis2_dialect:normalize_analytics called with pivot=True, returning WIDE format

[DHIS2] Normalized row count: 4
[DHIS2] First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] _set_description: columns=['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], types=['String', 'String', 'String', 'String', 'String', 'String']
[DHIS2] Transformed rows count: 4
[DHIS2] First transformed row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] Fetched 4 rows
[DHIS2] fetchall() called - returning 4 rows
[DHIS2] fetchall() - First row type: <class 'tuple'>
[DHIS2] fetchall() - First row (original): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Column count from description: 6
[DHIS2] fetchall() - First row (fixed types): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Type enforcement: dimensions=STRING, measures=FLOAT
[DHIS2] Executing query: SELECT
  "105_EP01b_Malaria_Total"
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
LIMIT 10000
[DHIS2] Parsed endpoint: analytics
[DHIS2] Found params in Flask g for analytics: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;
[DHIS2] Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
[DHIS2] Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
[DHIS2] API request URL: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
[DHIS2] Executing query: SELECT
  "105_EP01b_Malaria_Total",
  "105_EP01a_Suspected_fever",
  "105_EP01d_Malaria_cases_treated",
  "105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive",
  "OrgUnit",
  "Period"
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
LIMIT 10000
[DHIS2] Executing query: SELECT
  "105_EP01b_Malaria_Total",
  "105_EP01a_Suspected_fever",
  "105_EP01d_Malaria_cases_treated",
  "105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive",
  "OrgUnit",
  "Period"
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
LIMIT 10000
[DHIS2] Parsed endpoint: analytics
[DHIS2] Parsed endpoint: analytics
[DHIS2] Found params in Flask g for analytics: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;
[DHIS2] Found params in Flask g for analytics: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;
[DHIS2] Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
[DHIS2] Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
[DHIS2] Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
[DHIS2] Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
[DHIS2] API request URL: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
[DHIS2] API request URL: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
[DHIS2] Raw API response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Raw DHIS2 rows count: 16
[DHIS2] First raw row: ['QHnwKs2OUZv', '2020', 'akV6429SUqu', '15266488']
[DHIS2] Parsing response for endpoint: analytics
[DHIS2] Response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Response sample: {'headers': [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}], 'metaDat
[DHIS2] Using WIDE/PIVOTED format (Period, OrgUnit, DX1, DX2, ...) for analytics
[DHIS2] normalize_analytics: pivot=True, using WIDE/PIVOTED format
[DHIS2] PIVOT CONSTRUCTION:
[DHIS2]   data_elements (UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   data_element_list (sorted UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   col_names (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized row count: 4
[DHIS2] First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] _set_description: columns=['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], types=['String', 'String', 'String', 'String', 'String', 'String']
[DHIS2] Transformed rows count: 4
[DHIS2] First transformed row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] Fetched 4 rows
[DHIS2] fetchall() called - returning 4 rows
[DHIS2] fetchall() - First row type: <class 'tuple'>
[DHIS2] fetchall() - First row (original): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Column count from description: 6
[DHIS2] fetchall() - First row (fixed types): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Type enforcement: dimensions=STRING, measures=FLOAT
[DHIS2] Raw API response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Raw DHIS2 rows count: 16
[DHIS2] First raw row: ['QHnwKs2OUZv', '2020', 'akV6429SUqu', '15266488']
[DHIS2] Parsing response for endpoint: analytics
[DHIS2] Response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Response sample: {'headers': [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}], 'metaDat
[DHIS2] Using WIDE/PIVOTED format (Period, OrgUnit, DX1, DX2, ...) for analytics
[DHIS2] normalize_analytics: pivot=True, using WIDE/PIVOTED format
[DHIS2] PIVOT CONSTRUCTION:
[DHIS2]   data_elements (UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   data_element_list (sorted UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']2025-12-06 20:19:10,826:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column construction - data_elements: ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
2025-12-06 20:19:10,826:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column names constructed (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:19:10,826:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] FIRST ROW CONSTRUCTION:
2025-12-06 20:19:10,826:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   Period (index 0): 2020
2025-12-06 20:19:10,826:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   OrgUnit (index 1): MOH - Uganda
2025-12-06 20:19:10,826:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01b. Malaria Total (index 2): 14479324
2025-12-06 20:19:10,826:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01a. Suspected fever (index 3): 22994823
2025-12-06 20:19:10,826:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01d. Malaria cases treated (index 4): 15266488
2025-12-06 20:19:10,826:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01c. Malaria Confirmed (B/s and RDT Positive) (index 5): 13326277
2025-12-06 20:19:10,826:INFO:superset.db_engine_specs.dhis2_dialect:First pivoted row - Period: '2020', OrgUnit: 'MOH - Uganda'
2025-12-06 20:19:10,826:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total pivoted rows: 4, columns: 6
2025-12-06 20:19:10,826:INFO:superset.db_engine_specs.dhis2_dialect:Normalized 4 rows with 6 columns for endpoint analytics
2025-12-06 20:19:10,826:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API returned 4 rows
2025-12-06 20:19:10,829:INFO:superset.db_engine_specs.dhis2_dialect:Using wide/pivoted format for analytics
2025-12-06 20:19:10,830:INFO:superset.db_engine_specs.dhis2_dialect:normalize_analytics called with pivot=True, returning WIDE format
2025-12-06 20:19:10,830:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column construction - data_elements: ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
2025-12-06 20:19:10,830:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column names constructed (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:19:10,830:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] FIRST ROW CONSTRUCTION:
2025-12-06 20:19:10,830:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   Period (index 0): 2020
2025-12-06 20:19:10,830:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   OrgUnit (index 1): MOH - Uganda
2025-12-06 20:19:10,830:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01b. Malaria Total (index 2): 14479324
2025-12-06 20:19:10,830:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01a. Suspected fever (index 3): 22994823
2025-12-06 20:19:10,830:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01d. Malaria cases treated (index 4): 15266488
2025-12-06 20:19:10,830:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01c. Malaria Confirmed (B/s and RDT Positive) (index 5): 13326277
2025-12-06 20:19:10,830:INFO:superset.db_engine_specs.dhis2_dialect:First pivoted row - Period: '2020', OrgUnit: 'MOH - Uganda'
2025-12-06 20:19:10,830:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total pivoted rows: 4, columns: 6
2025-12-06 20:19:10,830:INFO:superset.db_engine_specs.dhis2_dialect:Normalized 4 rows with 6 columns for endpoint analytics
2025-12-06 20:19:10,831:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API returned 4 rows
2025-12-06 20:19:10,838:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() - Row count: 4
2025-12-06 20:19:10,838:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:19:10,838:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names length: 6
2025-12-06 20:19:10,838:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values count: 6
2025-12-06 20:19:10,838:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-06 20:19:10,838:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 0 (Period): 2020 -> 2020 (STRING)
2025-12-06 20:19:10,838:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (OrgUnit): MOH - Uganda -> MOH - Uganda (STRING)
2025-12-06 20:19:10,839:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (105_EP01b_Malaria_Total): 14479324 (PROCESSED)
2025-12-06 20:19:10,839:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (105_EP01a_Suspected_fever): 22994823 (PROCESSED)
2025-12-06 20:19:10,839:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (105_EP01d_Malaria_cases_treated): 15266488 (PROCESSED)
2025-12-06 20:19:10,839:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() returning 4 rows with 6 columns each
2025-12-06 20:19:10,839:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Got 4 rows from cursor
2025-12-06 20:19:10,839:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-06 20:19:10,839:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:19:10,839:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Types from cursor: ['String', 'String', 'String', 'String', 'String', 'String']
2025-12-06 20:19:10,840:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: DataFrame created with 4 rows, 6 columns
2025-12-06 20:19:10,840:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:19:10,840:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes BEFORE fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-06 20:19:10,840:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() - Row count: 4
2025-12-06 20:19:10,841:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Period' to object dtype (dimension)
2025-12-06 20:19:10,841:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:19:10,841:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'OrgUnit' to object dtype (dimension)
2025-12-06 20:19:10,841:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names length: 6
2025-12-06 20:19:10,842:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes AFTER fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-06 20:19:10,842:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values count: 6
2025-12-06 20:19:10,842:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: First row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-06 20:19:10,842:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-06 20:19:10,842:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 0 (Period): 2020 -> 2020 (STRING)
2025-12-06 20:19:10,842:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (OrgUnit): MOH - Uganda -> MOH - Uganda (STRING)
2025-12-06 20:19:10,842:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (105_EP01b_Malaria_Total): 14479324 (PROCESSED)
2025-12-06 20:19:10,842:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (105_EP01a_Suspected_fever): 22994823 (PROCESSED)
2025-12-06 20:19:10,843:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (105_EP01d_Malaria_cases_treated): 15266488 (PROCESSED)
2025-12-06 20:19:10,843:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() returning 4 rows with 6 columns each
2025-12-06 20:19:10,843:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Got 4 rows from cursor
2025-12-06 20:19:10,843:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-06 20:19:10,843:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:19:10,843:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Types from cursor: ['String', 'String', 'String', 'String', 'String', 'String']
2025-12-06 20:19:10,843:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: DataFrame created with 4 rows, 6 columns
2025-12-06 20:19:10,843:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:19:10,844:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes BEFORE fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-06 20:19:10,844:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Period' to object dtype (dimension)
2025-12-06 20:19:10,844:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'OrgUnit' to object dtype (dimension)
2025-12-06 20:19:10,844:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes AFTER fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-06 20:19:10,845:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: First row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-06 20:19:10,849:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] BEFORE assign_column_label:
2025-12-06 20:19:10,849:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 6)
2025-12-06 20:19:10,849:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:19:10,849:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', 'OrgUnit', 'Period']
2025-12-06 20:19:10,849:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: True
2025-12-06 20:19:10,849:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-06 20:19:10,849:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Assigning column labels: ['105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', 'OrgUnit', 'Period']
2025-12-06 20:19:10,849:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] AFTER assign_column_label:
2025-12-06 20:19:10,849:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 6)
2025-12-06 20:19:10,849:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', 'OrgUnit', 'Period']
2025-12-06 20:19:10,849:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', 'OrgUnit', 'Period']
2025-12-06 20:19:10,849:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: True
2025-12-06 20:19:10,849:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'105_EP01b_Malaria_Total': '2020', '105_EP01a_Suspected_fever': 'MOH - Uganda', '105_EP01d_Malaria_cases_treated': 14479324, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 22994823, 'OrgUnit': 15266488, 'Period': 13326277}
2025-12-06 20:19:10,850:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] BEFORE assign_column_label:
2025-12-06 20:19:10,850:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 6)
2025-12-06 20:19:10,850:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:19:10,850:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', 'OrgUnit', 'Period']
2025-12-06 20:19:10,851:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: True
2025-12-06 20:19:10,851:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-06 20:19:10,851:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Assigning column labels: ['105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', 'OrgUnit', 'Period']
2025-12-06 20:19:10,851:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] AFTER assign_column_label:
2025-12-06 20:19:10,851:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 6)
2025-12-06 20:19:10,851:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', 'OrgUnit', 'Period']
2025-12-06 20:19:10,851:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', 'OrgUnit', 'Period']
2025-12-06 20:19:10,851:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: True
2025-12-06 20:19:10,851:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'105_EP01b_Malaria_Total': '2020', '105_EP01a_Suspected_fever': 'MOH - Uganda', '105_EP01d_Malaria_cases_treated': 14479324, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 22994823, 'OrgUnit': 15266488, 'Period': 13326277}
2025-12-06 20:19:10,868:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:19:10] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-06 20:19:10,872:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:19:10] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-06 20:19:11,935:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:19:11] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-06 20:19:34,106:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1458, in dispatch_request
    self.raise_routing_exception(req)
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1440, in raise_routing_exception
    raise request.routing_exception  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/ctx.py", line 353, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/werkzeug/routing/map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-12-06 20:19:34,110:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:19:34] "[33mGET /ws HTTP/1.1[0m" 404 -
2025-12-06 20:20:09,680:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:20:09] "GET /api/v1/me/ HTTP/1.1" 200 -
2025-12-06 20:20:13,916:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:20:13] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-06 20:20:14,767:ERROR:superset.models.helpers:[METRICS-TRACE] Processing 0 metrics
2025-12-06 20:20:14,767:ERROR:superset.models.helpers:[METRICS-TRACE] Total metrics added: 0
2025-12-06 20:20:14,773:ERROR:superset.models.helpers:[METRICS-TRACE] Before dedup: 5 select_exprs + 0 metrics_exprs
2025-12-06 20:20:14,774:ERROR:superset.models.helpers:[METRICS-TRACE] After dedup: 5 total select_exprs
2025-12-06 20:20:14,774:INFO:superset.models.helpers:[COLUMN_TRACE] SQL Query Building:
2025-12-06 20:20:14,774:INFO:superset.models.helpers:[COLUMN_TRACE]   columns: ['105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period']
2025-12-06 20:20:14,774:INFO:superset.models.helpers:[COLUMN_TRACE]   metrics: []
2025-12-06 20:20:14,774:INFO:superset.models.helpers:[COLUMN_TRACE]   groupby: []
2025-12-06 20:20:14,775:INFO:superset.models.helpers:[COLUMN_TRACE]   labels_expected: ['105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period']
2025-12-06 20:20:14,775:INFO:superset.models.helpers:[COLUMN_TRACE]   select_exprs count: 5
2025-12-06 20:20:14,775:INFO:superset.models.helpers:[COLUMN_TRACE]     [0] key=105_EP01b_Malaria_Total, name=105_EP01b_Malaria_Total, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-06 20:20:14,775:INFO:superset.models.helpers:[COLUMN_TRACE]     [1] key=105_EP01a_Suspected_fever, name=105_EP01a_Suspected_fever, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-06 20:20:14,775:INFO:superset.models.helpers:[COLUMN_TRACE]     [2] key=105_EP01d_Malaria_cases_treated, name=105_EP01d_Malaria_cases_treated, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-06 20:20:14,775:INFO:superset.models.helpers:[COLUMN_TRACE]     [3] key=OrgUnit, name=OrgUnit, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-06 20:20:14,775:INFO:superset.models.helpers:[COLUMN_TRACE]     [4] key=Period, name=Period, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-06 20:20:14,775:INFO:superset.connectors.sqla.models:[DHIS2] get_from_clause for virtual dataset 1: analytics_LAST_YEAR_20251206
2025-12-06 20:20:14,775:INFO:superset.connectors.sqla.models:[DHIS2] Full SQL stored: SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
2025-12-06 20:20:14,775:INFO:superset.connectors.sqla.models:[DHIS2] Loaded params from extra field: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayPropert
2025-12-06 20:20:14,777:ERROR:superset.models.helpers:[METRICS-TRACE] Processing 0 metrics
2025-12-06 20:20:14,777:ERROR:superset.models.helpers:[METRICS-TRACE] Total metrics added: 0
2025-12-06 20:20:14,780:ERROR:superset.models.helpers:[METRICS-TRACE] Before dedup: 5 select_exprs + 0 metrics_exprs
2025-12-06 20:20:14,780:ERROR:superset.models.helpers:[METRICS-TRACE] After dedup: 5 total select_exprs
2025-12-06 20:20:14,780:INFO:superset.models.helpers:[COLUMN_TRACE] SQL Query Building:
2025-12-06 20:20:14,780:INFO:superset.models.helpers:[COLUMN_TRACE]   columns: ['105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period']
2025-12-06 20:20:14,780:INFO:superset.models.helpers:[COLUMN_TRACE]   metrics: []
2025-12-06 20:20:14,781:INFO:superset.models.helpers:[COLUMN_TRACE]   groupby: []
2025-12-06 20:20:14,781:INFO:superset.models.helpers:[COLUMN_TRACE]   labels_expected: ['105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period']
2025-12-06 20:20:14,781:INFO:superset.models.helpers:[COLUMN_TRACE]   select_exprs count: 5
2025-12-06 20:20:14,781:INFO:superset.models.helpers:[COLUMN_TRACE]     [0] key=105_EP01b_Malaria_Total, name=105_EP01b_Malaria_Total, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-06 20:20:14,781:INFO:superset.models.helpers:[COLUMN_TRACE]     [1] key=105_EP01a_Suspected_fever, name=105_EP01a_Suspected_fever, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-06 20:20:14,781:INFO:superset.models.helpers:[COLUMN_TRACE]     [2] key=105_EP01d_Malaria_cases_treated, name=105_EP01d_Malaria_cases_treated, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-06 20:20:14,781:INFO:superset.models.helpers:[COLUMN_TRACE]     [3] key=OrgUnit, name=OrgUnit, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-06 20:20:14,781:INFO:superset.models.helpers:[COLUMN_TRACE]     [4] key=Period, name=Period, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-06 20:20:14,781:INFO:superset.connectors.sqla.models:[DHIS2] get_from_clause for virtual dataset 1: analytics_LAST_YEAR_20251206
2025-12-06 20:20:14,781:INFO:superset.connectors.sqla.models:[DHIS2] Full SQL stored: SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
2025-12-06 20:20:14,781:INFO:superset.connectors.sqla.models:[DHIS2] Loaded params from extra field: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayPropert
2025-12-06 20:20:14,782:INFO:superset.connectors.sqla.models:[DHIS2] Cached params with key: dhis2_params_1_analytics
2025-12-06 20:20:14,782:INFO:superset.connectors.sqla.models:[DHIS2] Stored params in Flask g for DHIS2 table: analytics
2025-12-06 20:20:14,786:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Query execution in connectors/sqla/models.py:
2025-12-06 20:20:14,786:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   SQL (first 500 chars): SELECT "105_EP01b_Malaria_Total", "105_EP01a_Suspected_fever", "105_EP01d_Malaria_cases_treated", "OrgUnit", "Period" 
FROM (SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
) AS virtual_table
 LIMIT 10000
2025-12-06 20:20:14,786:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   labels_expected: ['105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period']
2025-12-06 20:20:14,787:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 connection initialized: https://tests.dhis2.hispuganda.org/hmis/api
2025-12-06 20:20:14,787:INFO:superset.db_engine_specs.dhis2_dialect:Executing DHIS2 query: SELECT
  "105_EP01b_Malaria_Total",
  "105_EP01a_Suspected_fever",
  "105_EP01d_Malaria_cases_treated",
  "OrgUnit",
  "Period"
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
LIMIT 10000
2025-12-06 20:20:14,787:INFO:superset.db_engine_specs.dhis2_dialect:Parsed endpoint: analytics
2025-12-06 20:20:14,787:INFO:superset.db_engine_specs.dhis2_dialect:Using stored parameters from Flask g for table: analytics
2025-12-06 20:20:14,787:INFO:superset.db_engine_specs.dhis2_dialect:Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
2025-12-06 20:20:14,787:INFO:superset.db_engine_specs.dhis2_dialect:Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
2025-12-06 20:20:14,787:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API request: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
2025-12-06 20:20:14,789:INFO:superset.connectors.sqla.models:[DHIS2] Cached params with key: dhis2_params_1_analytics
2025-12-06 20:20:14,789:INFO:superset.connectors.sqla.models:[DHIS2] Stored params in Flask g for DHIS2 table: analytics
2025-12-06 20:20:14,795:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Query execution in connectors/sqla/models.py:
2025-12-06 20:20:14,797:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   SQL (first 500 chars): SELECT "105_EP01b_Malaria_Total", "105_EP01a_Suspected_fever", "105_EP01d_Malaria_cases_treated", "OrgUnit", "Period" 
FROM (SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
) AS virtual_table
 LIMIT 10000
2025-12-06 20:20:14,797:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   labels_expected: ['105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period']
2025-12-06 20:20:14,802:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 connection initialized: https://tests.dhis2.hispuganda.org/hmis/api
2025-12-06 20:20:14,802:INFO:superset.db_engine_specs.dhis2_dialect:Executing DHIS2 query: SELECT
  "105_EP01b_Malaria_Total",
  "105_EP01a_Suspected_fever",
  "105_EP01d_Malaria_cases_treated",
  "OrgUnit",
  "Period"
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
LIMIT 10000
2025-12-06 20:20:14,802:INFO:superset.db_engine_specs.dhis2_dialect:Parsed endpoint: analytics
2025-12-06 20:20:14,802:INFO:superset.db_engine_specs.dhis2_dialect:Using stored parameters from Flask g for table: analytics
2025-12-06 20:20:14,802:INFO:superset.db_engine_specs.dhis2_dialect:Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
2025-12-06 20:20:14,802:INFO:superset.db_engine_specs.dhis2_dialect:Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
2025-12-06 20:20:14,802:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API request: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
2025-12-06 20:20:15,699:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:20:15] "PUT /api/v1/explore/form_data/k8bo1sy5Yq8?tab_id=2 HTTP/1.1" 200 -
2025-12-06 20:20:20,447:INFO:superset.db_engine_specs.dhis2_dialect:Using wide/pivoted format for analytics
2025-12-06 20:20:20,447:INFO:superset.db_engine_specs.dhis2_dialect:normalize_analytics called with pivot=True, returning WIDE format
2025-12-06 20:20:20,448:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column construction - data_elements: ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
2025-12-06 20:20:20,448:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column names constructed (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:20:20,448:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] FIRST ROW CONSTRUCTION:
2025-12-06 20:20:20,448:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   Period (index 0): 2020
2025-12-06 20:20:20,448:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   OrgUnit (index 1): MOH - Uganda
2025-12-06 20:20:20,448:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01b. Malaria Total (index 2): 14479324
2025-12-06 20:20:20,448:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01a. Suspected fever (index 3): 22994823
2025-12-06 20:20:20,448:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01d. Malaria cases treated (index 4): 15266488
2025-12-06 20:20:20,448:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01c. Malaria Confirmed (B/s and RDT Positive) (index 5): 13326277
2025-12-06 20:20:20,448:INFO:superset.db_engine_specs.dhis2_dialect:First pivoted row - Period: '2020', OrgUnit: 'MOH - Uganda'
2025-12-06 20:20:20,448:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total pivoted rows: 4, columns: 6

[DHIS2]   col_names (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized row count: 4
[DHIS2] First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] _set_description: columns=['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], types=['String', 'String', 'String', 'String', 'String', 'String']
[DHIS2] Transformed rows count: 4
[DHIS2] First transformed row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] Fetched 4 rows
[DHIS2] Raw API response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Raw DHIS2 rows count: 16
[DHIS2] First raw row: ['QHnwKs2OUZv', '2020', 'akV6429SUqu', '15266488']
[DHIS2] Parsing response for endpoint: analytics
[DHIS2] Response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Response sample: {'headers': [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}], 'metaDat
[DHIS2] Using WIDE/PIVOTED format (Period, OrgUnit, DX1, DX2, ...) for analytics
[DHIS2] normalize_analytics: pivot=True, using WIDE/PIVOTED format
[DHIS2] PIVOT CONSTRUCTION:
[DHIS2]   data_elements (UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   data_element_list (sorted UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   col_names (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized row count: 4
[DHIS2] First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] _set_description: columns=['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], types=['String', 'String', 'String', 'String', 'String', 'String']
[DHIS2] Transformed rows count: 4
[DHIS2] First transformed row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] Fetched 4 rows
[DHIS2] fetchall() called - returning 4 rows
[DHIS2] fetchall() - First row type: <class 'tuple'>
[DHIS2] fetchall() - First row (original): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Column count from description: 6
[DHIS2] fetchall() - First row (fixed types): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Type enforcement: dimensions=STRING, measures=FLOAT
[DHIS2] fetchall() called - returning 4 rows
[DHIS2] fetchall() - First row type: <class 'tuple'>
[DHIS2] fetchall() - First row (original): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Column count from description: 6
[DHIS2] fetchall() - First row (fixed types): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Type enforcement: dimensions=STRING, measures=FLOAT
[DHIS2] Executing query: SELECT
  "105_EP01b_Malaria_Total",
  "105_EP01a_Suspected_fever",
  "105_EP01d_Malaria_cases_treated",
  "OrgUnit",
  "Period"
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
LIMIT 10000
[DHIS2] Parsed endpoint: analytics
[DHIS2] Found params in Flask g for analytics: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;
[DHIS2] Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
[DHIS2] Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
[DHIS2] API request URL: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
[DHIS2] Executing query: SELECT
  "105_EP01b_Malaria_Total",
  "105_EP01a_Suspected_fever",
  "105_EP01d_Malaria_cases_treated",
  "OrgUnit",
  "Period"
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
LIMIT 10000
[DHIS2] Parsed endpoint: analytics
[DHIS2] Found params in Flask g for analytics: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;
[DHIS2] Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
[DHIS2] Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
[DHIS2] API request URL: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
[DHIS2] Raw API response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Raw DHIS2 rows count: 16
[DHIS2] First raw row: ['QHnwKs2OUZv', '2020', 'akV6429SUqu', '15266488']
[DHIS2] Parsing response for endpoint: analytics
[DHIS2] Response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Response sample: {'headers': [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}], 'metaDat
[DHIS2] Using WIDE/PIVOTED format (Period, OrgUnit, DX1, DX2, ...) for analytics
[DHIS2] normalize_analytics: pivot=True, using WIDE/PIVOTED format
[DHIS2] PIVOT CONSTRUCTION:
[DHIS2]   data_elements (UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   data_element_list (sorted UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   col_names (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized row count: 4
[DHIS2] First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] _set_description: columns=['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], types=['String', 'String', 'String', 'String', 'String', 'String']2025-12-06 20:20:20,448:INFO:superset.db_engine_specs.dhis2_dialect:Normalized 4 rows with 6 columns for endpoint analytics
2025-12-06 20:20:20,449:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API returned 4 rows
2025-12-06 20:20:20,454:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() - Row count: 4
2025-12-06 20:20:20,454:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:20:20,455:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names length: 6
2025-12-06 20:20:20,455:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values count: 6
2025-12-06 20:20:20,455:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-06 20:20:20,455:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 0 (Period): 2020 -> 2020 (STRING)
2025-12-06 20:20:20,455:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (OrgUnit): MOH - Uganda -> MOH - Uganda (STRING)
2025-12-06 20:20:20,455:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (105_EP01b_Malaria_Total): 14479324 (PROCESSED)
2025-12-06 20:20:20,455:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (105_EP01a_Suspected_fever): 22994823 (PROCESSED)
2025-12-06 20:20:20,455:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (105_EP01d_Malaria_cases_treated): 15266488 (PROCESSED)
2025-12-06 20:20:20,455:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() returning 4 rows with 6 columns each
2025-12-06 20:20:20,455:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Got 4 rows from cursor
2025-12-06 20:20:20,455:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-06 20:20:20,455:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:20:20,455:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Types from cursor: ['String', 'String', 'String', 'String', 'String', 'String']
2025-12-06 20:20:20,457:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: DataFrame created with 4 rows, 6 columns
2025-12-06 20:20:20,457:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:20:20,458:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes BEFORE fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-06 20:20:20,459:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Period' to object dtype (dimension)
2025-12-06 20:20:20,459:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'OrgUnit' to object dtype (dimension)
2025-12-06 20:20:20,459:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes AFTER fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-06 20:20:20,460:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: First row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-06 20:20:20,463:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] BEFORE assign_column_label:
2025-12-06 20:20:20,464:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 6)
2025-12-06 20:20:20,464:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:20:20,464:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period']
2025-12-06 20:20:20,464:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: False
2025-12-06 20:20:20,464:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-06 20:20:20,464:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Column truncation needed: df has 6 columns, expected 5
2025-12-06 20:20:20,464:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   DataFrame actual columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:20:20,464:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Expected columns: ['105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period']
2025-12-06 20:20:20,464:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] âœ“ Selecting columns BY NAME (matched all expected columns)
2025-12-06 20:20:20,464:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Column mapping: {'105_EP01b_Malaria_Total': '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever': '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated': '105_EP01d_Malaria_cases_treated', 'OrgUnit': 'OrgUnit', 'Period': 'Period'}
2025-12-06 20:20:20,465:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] Column Selection âœ“ SUCCESS - method=BY_NAME, datasource=analytics_LAST_YEAR_20251206
2025-12-06 20:20:20,465:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period']
2025-12-06 20:20:20,465:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   tried_by_name=True, success=True, fallback=False
2025-12-06 20:20:20,465:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Assigning column labels: ['105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period']
2025-12-06 20:20:20,465:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] AFTER assign_column_label:
2025-12-06 20:20:20,465:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 5)
2025-12-06 20:20:20,465:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period']
2025-12-06 20:20:20,465:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period']
2025-12-06 20:20:20,465:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: True
2025-12-06 20:20:20,465:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, 'OrgUnit': 'MOH - Uganda', 'Period': '2020'}
2025-12-06 20:20:20,476:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:20:20] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-06 20:20:20,754:INFO:superset.db_engine_specs.dhis2_dialect:Using wide/pivoted format for analytics
2025-12-06 20:20:20,754:INFO:superset.db_engine_specs.dhis2_dialect:normalize_analytics called with pivot=True, returning WIDE format
2025-12-06 20:20:20,755:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column construction - data_elements: ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
2025-12-06 20:20:20,755:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column names constructed (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:20:20,755:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] FIRST ROW CONSTRUCTION:
2025-12-06 20:20:20,755:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   Period (index 0): 2020
2025-12-06 20:20:20,755:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   OrgUnit (index 1): MOH - Uganda
2025-12-06 20:20:20,755:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01b. Malaria Total (index 2): 14479324
2025-12-06 20:20:20,755:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01a. Suspected fever (index 3): 22994823
2025-12-06 20:20:20,755:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01d. Malaria cases treated (index 4): 15266488
2025-12-06 20:20:20,755:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01c. Malaria Confirmed (B/s and RDT Positive) (index 5): 13326277
2025-12-06 20:20:20,755:INFO:superset.db_engine_specs.dhis2_dialect:First pivoted row - Period: '2020', OrgUnit: 'MOH - Uganda'
2025-12-06 20:20:20,755:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total pivoted rows: 4, columns: 6
2025-12-06 20:20:20,755:INFO:superset.db_engine_specs.dhis2_dialect:Normalized 4 rows with 6 columns for endpoint analytics
2025-12-06 20:20:20,755:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API returned 4 rows
2025-12-06 20:20:20,762:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() - Row count: 4
2025-12-06 20:20:20,762:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:20:20,762:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names length: 6
2025-12-06 20:20:20,762:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values count: 6
2025-12-06 20:20:20,762:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-06 20:20:20,762:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 0 (Period): 2020 -> 2020 (STRING)
2025-12-06 20:20:20,762:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (OrgUnit): MOH - Uganda -> MOH - Uganda (STRING)
2025-12-06 20:20:20,762:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (105_EP01b_Malaria_Total): 14479324 (PROCESSED)
2025-12-06 20:20:20,762:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (105_EP01a_Suspected_fever): 22994823 (PROCESSED)
2025-12-06 20:20:20,762:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (105_EP01d_Malaria_cases_treated): 15266488 (PROCESSED)
2025-12-06 20:20:20,762:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() returning 4 rows with 6 columns each
2025-12-06 20:20:20,762:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Got 4 rows from cursor
2025-12-06 20:20:20,762:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-06 20:20:20,762:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:20:20,762:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Types from cursor: ['String', 'String', 'String', 'String', 'String', 'String']
2025-12-06 20:20:20,763:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: DataFrame created with 4 rows, 6 columns
2025-12-06 20:20:20,763:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:20:20,763:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes BEFORE fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-06 20:20:20,764:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Period' to object dtype (dimension)
2025-12-06 20:20:20,764:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'OrgUnit' to object dtype (dimension)
2025-12-06 20:20:20,764:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes AFTER fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-06 20:20:20,764:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: First row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-06 20:20:20,769:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] BEFORE assign_column_label:
2025-12-06 20:20:20,769:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 6)
2025-12-06 20:20:20,769:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:20:20,769:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period']
2025-12-06 20:20:20,769:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: False
2025-12-06 20:20:20,769:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-06 20:20:20,769:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Column truncation needed: df has 6 columns, expected 5
2025-12-06 20:20:20,769:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   DataFrame actual columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:20:20,769:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Expected columns: ['105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period']
2025-12-06 20:20:20,769:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] âœ“ Selecting columns BY NAME (matched all expected columns)
2025-12-06 20:20:20,769:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Column mapping: {'105_EP01b_Malaria_Total': '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever': '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated': '105_EP01d_Malaria_cases_treated', 'OrgUnit': 'OrgUnit', 'Period': 'Period'}
2025-12-06 20:20:20,769:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] Column Selection âœ“ SUCCESS - method=BY_NAME, datasource=analytics_LAST_YEAR_20251206
2025-12-06 20:20:20,770:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period']
2025-12-06 20:20:20,770:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   tried_by_name=True, success=True, fallback=False
2025-12-06 20:20:20,770:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Assigning column labels: ['105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period']
2025-12-06 20:20:20,770:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] AFTER assign_column_label:
2025-12-06 20:20:20,770:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 5)
2025-12-06 20:20:20,770:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period']
2025-12-06 20:20:20,770:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period']
2025-12-06 20:20:20,770:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: True
2025-12-06 20:20:20,770:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, 'OrgUnit': 'MOH - Uganda', 'Period': '2020'}
2025-12-06 20:20:20,784:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:20:20] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-06 20:20:21,803:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:20:21] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-06 20:20:38,126:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1458, in dispatch_request
    self.raise_routing_exception(req)
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1440, in raise_routing_exception
    raise request.routing_exception  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/ctx.py", line 353, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/werkzeug/routing/map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-12-06 20:20:38,130:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:20:38] "[33mGET /ws HTTP/1.1[0m" 404 -
2025-12-06 20:20:52,554:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:20:52] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-06 20:20:54,951:ERROR:superset.models.helpers:[METRICS-TRACE] Processing 0 metrics
2025-12-06 20:20:54,952:ERROR:superset.models.helpers:[METRICS-TRACE] Processing 0 metrics
2025-12-06 20:20:54,952:ERROR:superset.models.helpers:[METRICS-TRACE] Total metrics added: 0
2025-12-06 20:20:54,952:ERROR:superset.models.helpers:[METRICS-TRACE] Total metrics added: 0
2025-12-06 20:20:54,959:ERROR:superset.models.helpers:[METRICS-TRACE] Before dedup: 6 select_exprs + 0 metrics_exprs
2025-12-06 20:20:54,961:ERROR:superset.models.helpers:[METRICS-TRACE] Before dedup: 6 select_exprs + 0 metrics_exprs
2025-12-06 20:20:54,962:ERROR:superset.models.helpers:[METRICS-TRACE] After dedup: 6 total select_exprs
2025-12-06 20:20:54,962:ERROR:superset.models.helpers:[METRICS-TRACE] After dedup: 6 total select_exprs
2025-12-06 20:20:54,963:INFO:superset.models.helpers:[COLUMN_TRACE] SQL Query Building:
2025-12-06 20:20:54,963:INFO:superset.models.helpers:[COLUMN_TRACE] SQL Query Building:
2025-12-06 20:20:54,963:INFO:superset.models.helpers:[COLUMN_TRACE]   columns: ['105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:20:54,963:INFO:superset.models.helpers:[COLUMN_TRACE]   columns: ['105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:20:54,963:INFO:superset.models.helpers:[COLUMN_TRACE]   metrics: []
2025-12-06 20:20:54,963:INFO:superset.models.helpers:[COLUMN_TRACE]   metrics: []
2025-12-06 20:20:54,963:INFO:superset.models.helpers:[COLUMN_TRACE]   groupby: []
2025-12-06 20:20:54,963:INFO:superset.models.helpers:[COLUMN_TRACE]   groupby: []
2025-12-06 20:20:54,963:INFO:superset.models.helpers:[COLUMN_TRACE]   labels_expected: ['105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:20:54,963:INFO:superset.models.helpers:[COLUMN_TRACE]   labels_expected: ['105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:20:54,963:INFO:superset.models.helpers:[COLUMN_TRACE]   select_exprs count: 6
2025-12-06 20:20:54,963:INFO:superset.models.helpers:[COLUMN_TRACE]   select_exprs count: 6
2025-12-06 20:20:54,963:INFO:superset.models.helpers:[COLUMN_TRACE]     [0] key=105_EP01b_Malaria_Total, name=105_EP01b_Malaria_Total, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-06 20:20:54,963:INFO:superset.models.helpers:[COLUMN_TRACE]     [0] key=105_EP01b_Malaria_Total, name=105_EP01b_Malaria_Total, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-06 20:20:54,963:INFO:superset.models.helpers:[COLUMN_TRACE]     [1] key=105_EP01a_Suspected_fever, name=105_EP01a_Suspected_fever, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-06 20:20:54,963:INFO:superset.models.helpers:[COLUMN_TRACE]     [1] key=105_EP01a_Suspected_fever, name=105_EP01a_Suspected_fever, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-06 20:20:54,963:INFO:superset.models.helpers:[COLUMN_TRACE]     [2] key=105_EP01d_Malaria_cases_treated, name=105_EP01d_Malaria_cases_treated, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-06 20:20:54,963:INFO:superset.models.helpers:[COLUMN_TRACE]     [2] key=105_EP01d_Malaria_cases_treated, name=105_EP01d_Malaria_cases_treated, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-06 20:20:54,963:INFO:superset.models.helpers:[COLUMN_TRACE]     [3] key=OrgUnit, name=OrgUnit, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-06 20:20:54,963:INFO:superset.models.helpers:[COLUMN_TRACE]     [4] key=Period, name=Period, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-06 20:20:54,963:INFO:superset.models.helpers:[COLUMN_TRACE]     [5] key=105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive, name=105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-06 20:20:54,963:INFO:superset.models.helpers:[COLUMN_TRACE]     [3] key=OrgUnit, name=OrgUnit, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-06 20:20:54,964:INFO:superset.connectors.sqla.models:[DHIS2] get_from_clause for virtual dataset 1: analytics_LAST_YEAR_20251206
2025-12-06 20:20:54,964:INFO:superset.models.helpers:[COLUMN_TRACE]     [4] key=Period, name=Period, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-06 20:20:54,964:INFO:superset.connectors.sqla.models:[DHIS2] Full SQL stored: SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
2025-12-06 20:20:54,964:INFO:superset.models.helpers:[COLUMN_TRACE]     [5] key=105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive, name=105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-06 20:20:54,964:INFO:superset.connectors.sqla.models:[DHIS2] Loaded params from extra field: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayPropert
2025-12-06 20:20:54,964:INFO:superset.connectors.sqla.models:[DHIS2] get_from_clause for virtual dataset 1: analytics_LAST_YEAR_20251206
2025-12-06 20:20:54,965:INFO:superset.connectors.sqla.models:[DHIS2] Full SQL stored: SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
2025-12-06 20:20:54,965:INFO:superset.connectors.sqla.models:[DHIS2] Loaded params from extra field: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayPropert
2025-12-06 20:20:54,968:INFO:superset.connectors.sqla.models:[DHIS2] Cached params with key: dhis2_params_1_analytics
2025-12-06 20:20:54,968:INFO:superset.connectors.sqla.models:[DHIS2] Stored params in Flask g for DHIS2 table: analytics
2025-12-06 20:20:54,971:INFO:superset.connectors.sqla.models:[DHIS2] Cached params with key: dhis2_params_1_analytics
2025-12-06 20:20:54,972:INFO:superset.connectors.sqla.models:[DHIS2] Stored params in Flask g for DHIS2 table: analytics
2025-12-06 20:20:54,972:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Query execution in connectors/sqla/models.py:
2025-12-06 20:20:54,973:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   SQL (first 500 chars): SELECT "105_EP01b_Malaria_Total", "105_EP01a_Suspected_fever", "105_EP01d_Malaria_cases_treated", "OrgUnit", "Period", "105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive" 
FROM (SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
) AS virtual_table
 LIMIT 10000
2025-12-06 20:20:54,974:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   labels_expected: ['105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:20:54,974:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Query execution in connectors/sqla/models.py:
2025-12-06 20:20:54,975:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   SQL (first 500 chars): SELECT "105_EP01b_Malaria_Total", "105_EP01a_Suspected_fever", "105_EP01d_Malaria_cases_treated", "OrgUnit", "Period", "105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive" 
FROM (SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
) AS virtual_table
 LIMIT 10000
2025-12-06 20:20:54,976:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   labels_expected: ['105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:20:54,976:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 connection initialized: https://tests.dhis2.hispuganda.org/hmis/api
2025-12-06 20:20:54,978:INFO:superset.db_engine_specs.dhis2_dialect:Executing DHIS2 query: SELECT
  "105_EP01b_Malaria_Total",
  "105_EP01a_Suspected_fever",
  "105_EP01d_Malaria_cases_treated",
  "OrgUnit",
  "Period",
  "105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive"
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
LIMIT 10000
2025-12-06 20:20:54,978:INFO:superset.db_engine_specs.dhis2_dialect:Parsed endpoint: analytics
2025-12-06 20:20:54,978:INFO:superset.db_engine_specs.dhis2_dialect:Using stored parameters from Flask g for table: analytics
2025-12-06 20:20:54,979:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 connection initialized: https://tests.dhis2.hispuganda.org/hmis/api
2025-12-06 20:20:54,979:INFO:superset.db_engine_specs.dhis2_dialect:Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
2025-12-06 20:20:54,979:INFO:superset.db_engine_specs.dhis2_dialect:Executing DHIS2 query: SELECT
  "105_EP01b_Malaria_Total",
  "105_EP01a_Suspected_fever",
  "105_EP01d_Malaria_cases_treated",
  "OrgUnit",
  "Period",
  "105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive"
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
LIMIT 10000
2025-12-06 20:20:54,979:INFO:superset.db_engine_specs.dhis2_dialect:Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
2025-12-06 20:20:54,980:INFO:superset.db_engine_specs.dhis2_dialect:Parsed endpoint: analytics
2025-12-06 20:20:54,980:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API request: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
2025-12-06 20:20:54,980:INFO:superset.db_engine_specs.dhis2_dialect:Using stored parameters from Flask g for table: analytics
2025-12-06 20:20:54,984:INFO:superset.db_engine_specs.dhis2_dialect:Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
2025-12-06 20:20:54,985:INFO:superset.db_engine_specs.dhis2_dialect:Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
2025-12-06 20:20:54,985:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API request: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
2025-12-06 20:20:55,913:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:20:55] "PUT /api/v1/explore/form_data/k8bo1sy5Yq8?tab_id=2 HTTP/1.1" 200 -
2025-12-06 20:21:05,381:INFO:superset.db_engine_specs.dhis2_dialect:Using wide/pivoted format for analytics
2025-12-06 20:21:05,381:INFO:superset.db_engine_specs.dhis2_dialect:normalize_analytics called with pivot=True, returning WIDE format
2025-12-06 20:21:05,382:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column construction - data_elements: ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
2025-12-06 20:21:05,382:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column names constructed (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:21:05,382:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] FIRST ROW CONSTRUCTION:
2025-12-06 20:21:05,382:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   Period (index 0): 2020
2025-12-06 20:21:05,382:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   OrgUnit (index 1): MOH - Uganda
2025-12-06 20:21:05,382:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01b. Malaria Total (index 2): 14479324
2025-12-06 20:21:05,382:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01a. Suspected fever (index 3): 22994823
2025-12-06 20:21:05,382:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01d. Malaria cases treated (index 4): 15266488
2025-12-06 20:21:05,382:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01c. Malaria Confirmed (B/s and RDT Positive) (index 5): 13326277
2025-12-06 20:21:05,382:INFO:superset.db_engine_specs.dhis2_dialect:First pivoted row - Period: '2020', OrgUnit: 'MOH - Uganda'
2025-12-06 20:21:05,382:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total pivoted rows: 4, columns: 6
2025-12-06 20:21:05,382:INFO:superset.db_engine_specs.dhis2_dialect:Normalized 4 rows with 6 columns for endpoint analytics
2025-12-06 20:21:05,382:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API returned 4 rows
2025-12-06 20:21:05,391:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() - Row count: 4
2025-12-06 20:21:05,391:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:21:05,391:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names length: 6
2025-12-06 20:21:05,391:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values count: 6
2025-12-06 20:21:05,391:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-06 20:21:05,391:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 0 (Period): 2020 -> 2020 (STRING)
2025-12-06 20:21:05,391:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (OrgUnit): MOH - Uganda -> MOH - Uganda (STRING)
2025-12-06 20:21:05,391:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (105_EP01b_Malaria_Total): 14479324 (PROCESSED)
2025-12-06 20:21:05,391:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (105_EP01a_Suspected_fever): 22994823 (PROCESSED)
2025-12-06 20:21:05,391:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (105_EP01d_Malaria_cases_treated): 15266488 (PROCESSED)

[DHIS2] Transformed rows count: 4
[DHIS2] First transformed row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] Fetched 4 rows
[DHIS2] fetchall() called - returning 4 rows
[DHIS2] fetchall() - First row type: <class 'tuple'>
[DHIS2] fetchall() - First row (original): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Column count from description: 6
[DHIS2] fetchall() - First row (fixed types): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Type enforcement: dimensions=STRING, measures=FLOAT
[DHIS2] Raw API response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Raw DHIS2 rows count: 16
[DHIS2] First raw row: ['QHnwKs2OUZv', '2020', 'akV6429SUqu', '15266488']
[DHIS2] Parsing response for endpoint: analytics
[DHIS2] Response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Response sample: {'headers': [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}], 'metaDat
[DHIS2] Using WIDE/PIVOTED format (Period, OrgUnit, DX1, DX2, ...) for analytics
[DHIS2] normalize_analytics: pivot=True, using WIDE/PIVOTED format
[DHIS2] PIVOT CONSTRUCTION:
[DHIS2]   data_elements (UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   data_element_list (sorted UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   col_names (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized row count: 4
[DHIS2] First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] _set_description: columns=['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], types=['String', 'String', 'String', 'String', 'String', 'String']
[DHIS2] Transformed rows count: 4
[DHIS2] First transformed row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] Fetched 4 rows
[DHIS2] fetchall() called - returning 4 rows
[DHIS2] fetchall() - First row type: <class 'tuple'>
[DHIS2] fetchall() - First row (original): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Column count from description: 6
[DHIS2] fetchall() - First row (fixed types): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Type enforcement: dimensions=STRING, measures=FLOAT
[DHIS2] Executing query: SELECT
  "105_EP01b_Malaria_Total",
  "105_EP01a_Suspected_fever",
  "105_EP01d_Malaria_cases_treated",
  "OrgUnit",
  "Period",
  "105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive"
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
LIMIT 10000
[DHIS2] Parsed endpoint: analytics
[DHIS2] Found params in Flask g for analytics: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;
[DHIS2] Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
[DHIS2] Executing query: SELECT
  "105_EP01b_Malaria_Total",
  "105_EP01a_Suspected_fever",
  "105_EP01d_Malaria_cases_treated",
  "OrgUnit",
  "Period",
  "105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive"
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
LIMIT 10000
[DHIS2] Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
[DHIS2] Parsed endpoint: analytics
[DHIS2] API request URL: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
[DHIS2] Found params in Flask g for analytics: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;
[DHIS2] Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
[DHIS2] Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
[DHIS2] API request URL: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
[DHIS2] Raw API response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Raw DHIS2 rows count: 16
[DHIS2] First raw row: ['QHnwKs2OUZv', '2020', 'akV6429SUqu', '15266488']
[DHIS2] Parsing response for endpoint: analytics
[DHIS2] Response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Response sample: {'headers': [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}], 'metaDat
[DHIS2] Using WIDE/PIVOTED format (Period, OrgUnit, DX1, DX2, ...) for analytics
[DHIS2] normalize_analytics: pivot=True, using WIDE/PIVOTED format
[DHIS2] PIVOT CONSTRUCTION:
[DHIS2]   data_elements (UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   data_element_list (sorted UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   col_names (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized row count: 4
[DHIS2] First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] _set_description: columns=['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], types=['String', 'String', 'String', 'String', 'String', 'String']
[DHIS2] Transformed rows count: 4
[DHIS2] First transformed row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] Fetched 4 rows
[DHIS2] fetchall() called - returning 4 rows
[DHIS2] fetchall() - First row type: <class 'tuple'>
[DHIS2] fetchall() - First row (original): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Column count from description: 6
[DHIS2] fetchall() - First row (fixed types): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Type enforcement: dimensions=STRING, measures=FLOAT2025-12-06 20:21:05,391:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() returning 4 rows with 6 columns each
2025-12-06 20:21:05,391:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Got 4 rows from cursor
2025-12-06 20:21:05,391:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-06 20:21:05,391:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:21:05,392:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Types from cursor: ['String', 'String', 'String', 'String', 'String', 'String']
2025-12-06 20:21:05,393:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: DataFrame created with 4 rows, 6 columns
2025-12-06 20:21:05,393:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:21:05,393:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes BEFORE fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-06 20:21:05,394:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Period' to object dtype (dimension)
2025-12-06 20:21:05,394:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'OrgUnit' to object dtype (dimension)
2025-12-06 20:21:05,394:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes AFTER fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-06 20:21:05,395:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: First row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-06 20:21:05,399:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] BEFORE assign_column_label:
2025-12-06 20:21:05,399:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 6)
2025-12-06 20:21:05,399:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:21:05,399:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:21:05,399:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: True
2025-12-06 20:21:05,399:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-06 20:21:05,399:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Assigning column labels: ['105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:21:05,399:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] AFTER assign_column_label:
2025-12-06 20:21:05,399:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 6)
2025-12-06 20:21:05,399:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:21:05,399:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:21:05,400:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: True
2025-12-06 20:21:05,400:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'105_EP01b_Malaria_Total': '2020', '105_EP01a_Suspected_fever': 'MOH - Uganda', '105_EP01d_Malaria_cases_treated': 14479324, 'OrgUnit': 22994823, 'Period': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-06 20:21:05,414:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:21:05] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-06 20:21:06,428:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:21:06] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-06 20:21:24,554:INFO:superset.db_engine_specs.dhis2_dialect:Using wide/pivoted format for analytics
2025-12-06 20:21:24,555:INFO:superset.db_engine_specs.dhis2_dialect:normalize_analytics called with pivot=True, returning WIDE format
2025-12-06 20:21:24,555:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column construction - data_elements: ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
2025-12-06 20:21:24,555:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column names constructed (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:21:24,555:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] FIRST ROW CONSTRUCTION:
2025-12-06 20:21:24,555:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   Period (index 0): 2020
2025-12-06 20:21:24,555:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   OrgUnit (index 1): MOH - Uganda
2025-12-06 20:21:24,555:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01b. Malaria Total (index 2): 14479324
2025-12-06 20:21:24,555:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01a. Suspected fever (index 3): 22994823
2025-12-06 20:21:24,555:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01d. Malaria cases treated (index 4): 15266488
2025-12-06 20:21:24,555:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01c. Malaria Confirmed (B/s and RDT Positive) (index 5): 13326277
2025-12-06 20:21:24,555:INFO:superset.db_engine_specs.dhis2_dialect:First pivoted row - Period: '2020', OrgUnit: 'MOH - Uganda'
2025-12-06 20:21:24,555:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total pivoted rows: 4, columns: 6
2025-12-06 20:21:24,555:INFO:superset.db_engine_specs.dhis2_dialect:Normalized 4 rows with 6 columns for endpoint analytics
2025-12-06 20:21:24,555:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API returned 4 rows
2025-12-06 20:21:24,564:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() - Row count: 4
2025-12-06 20:21:24,564:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:21:24,564:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names length: 6
2025-12-06 20:21:24,564:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values count: 6
2025-12-06 20:21:24,564:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-06 20:21:24,564:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 0 (Period): 2020 -> 2020 (STRING)
2025-12-06 20:21:24,564:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (OrgUnit): MOH - Uganda -> MOH - Uganda (STRING)
2025-12-06 20:21:24,564:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (105_EP01b_Malaria_Total): 14479324 (PROCESSED)
2025-12-06 20:21:24,564:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (105_EP01a_Suspected_fever): 22994823 (PROCESSED)
2025-12-06 20:21:24,564:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (105_EP01d_Malaria_cases_treated): 15266488 (PROCESSED)
2025-12-06 20:21:24,564:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() returning 4 rows with 6 columns each
2025-12-06 20:21:24,564:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Got 4 rows from cursor
2025-12-06 20:21:24,564:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-06 20:21:24,564:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:21:24,564:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Types from cursor: ['String', 'String', 'String', 'String', 'String', 'String']
2025-12-06 20:21:24,566:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: DataFrame created with 4 rows, 6 columns
2025-12-06 20:21:24,566:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:21:24,566:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes BEFORE fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-06 20:21:24,567:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Period' to object dtype (dimension)
2025-12-06 20:21:24,567:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'OrgUnit' to object dtype (dimension)
2025-12-06 20:21:24,567:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes AFTER fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-06 20:21:24,567:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: First row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-06 20:21:24,569:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] BEFORE assign_column_label:
2025-12-06 20:21:24,569:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 6)
2025-12-06 20:21:24,569:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:21:24,569:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:21:24,569:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: True
2025-12-06 20:21:24,569:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-06 20:21:24,570:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Assigning column labels: ['105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:21:24,570:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] AFTER assign_column_label:
2025-12-06 20:21:24,570:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 6)
2025-12-06 20:21:24,570:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:21:24,570:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:21:24,570:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: True
2025-12-06 20:21:24,570:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'105_EP01b_Malaria_Total': '2020', '105_EP01a_Suspected_fever': 'MOH - Uganda', '105_EP01d_Malaria_cases_treated': 14479324, 'OrgUnit': 22994823, 'Period': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-06 20:21:24,579:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:21:24] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-06 20:22:05,390:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:22:05] "GET /api/v1/me/ HTTP/1.1" 200 -
2025-12-06 20:22:47,094:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1458, in dispatch_request
    self.raise_routing_exception(req)
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1440, in raise_routing_exception
    raise request.routing_exception  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/ctx.py", line 353, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/werkzeug/routing/map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-12-06 20:22:47,097:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:22:47] "[33mGET /ws HTTP/1.1[0m" 404 -
2025-12-06 20:27:04,051:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1458, in dispatch_request
    self.raise_routing_exception(req)
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1440, in raise_routing_exception
    raise request.routing_exception  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/ctx.py", line 353, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/werkzeug/routing/map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-12-06 20:27:04,062:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:27:04] "[33mGET /ws HTTP/1.1[0m" 404 -
2025-12-06 20:27:25,843:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:27:25] "GET /api/v1/me/ HTTP/1.1" 200 -
2025-12-06 20:27:31,726:ERROR:superset.models.helpers:[METRICS-TRACE] Processing 0 metrics
2025-12-06 20:27:31,727:ERROR:superset.models.helpers:[METRICS-TRACE] Processing 0 metrics
2025-12-06 20:27:31,727:ERROR:superset.models.helpers:[METRICS-TRACE] Total metrics added: 0
2025-12-06 20:27:31,727:ERROR:superset.models.helpers:[METRICS-TRACE] Total metrics added: 0
2025-12-06 20:27:31,728:ERROR:superset.models.helpers:[METRICS-TRACE] Before dedup: 5 select_exprs + 0 metrics_exprs
2025-12-06 20:27:31,730:ERROR:superset.models.helpers:[METRICS-TRACE] Before dedup: 5 select_exprs + 0 metrics_exprs
2025-12-06 20:27:31,730:ERROR:superset.models.helpers:[METRICS-TRACE] After dedup: 5 total select_exprs
2025-12-06 20:27:31,730:ERROR:superset.models.helpers:[METRICS-TRACE] After dedup: 5 total select_exprs
2025-12-06 20:27:31,730:INFO:superset.models.helpers:[COLUMN_TRACE] SQL Query Building:
2025-12-06 20:27:31,730:INFO:superset.models.helpers:[COLUMN_TRACE] SQL Query Building:
2025-12-06 20:27:31,730:INFO:superset.models.helpers:[COLUMN_TRACE]   columns: ['105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period']
2025-12-06 20:27:31,730:INFO:superset.models.helpers:[COLUMN_TRACE]   columns: ['105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period']
2025-12-06 20:27:31,730:INFO:superset.models.helpers:[COLUMN_TRACE]   metrics: []
2025-12-06 20:27:31,730:INFO:superset.models.helpers:[COLUMN_TRACE]   metrics: []
2025-12-06 20:27:31,730:INFO:superset.models.helpers:[COLUMN_TRACE]   groupby: []
2025-12-06 20:27:31,730:INFO:superset.models.helpers:[COLUMN_TRACE]   groupby: []
2025-12-06 20:27:31,730:INFO:superset.models.helpers:[COLUMN_TRACE]   labels_expected: ['105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period']
2025-12-06 20:27:31,730:INFO:superset.models.helpers:[COLUMN_TRACE]   labels_expected: ['105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period']
2025-12-06 20:27:31,730:INFO:superset.models.helpers:[COLUMN_TRACE]   select_exprs count: 5
2025-12-06 20:27:31,730:INFO:superset.models.helpers:[COLUMN_TRACE]   select_exprs count: 5
2025-12-06 20:27:31,730:INFO:superset.models.helpers:[COLUMN_TRACE]     [0] key=105_EP01b_Malaria_Total, name=105_EP01b_Malaria_Total, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-06 20:27:31,730:INFO:superset.models.helpers:[COLUMN_TRACE]     [0] key=105_EP01b_Malaria_Total, name=105_EP01b_Malaria_Total, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-06 20:27:31,730:INFO:superset.models.helpers:[COLUMN_TRACE]     [1] key=105_EP01a_Suspected_fever, name=105_EP01a_Suspected_fever, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-06 20:27:31,730:INFO:superset.models.helpers:[COLUMN_TRACE]     [1] key=105_EP01a_Suspected_fever, name=105_EP01a_Suspected_fever, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-06 20:27:31,730:INFO:superset.models.helpers:[COLUMN_TRACE]     [2] key=105_EP01d_Malaria_cases_treated, name=105_EP01d_Malaria_cases_treated, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-06 20:27:31,730:INFO:superset.models.helpers:[COLUMN_TRACE]     [2] key=105_EP01d_Malaria_cases_treated, name=105_EP01d_Malaria_cases_treated, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-06 20:27:31,730:INFO:superset.models.helpers:[COLUMN_TRACE]     [3] key=OrgUnit, name=OrgUnit, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-06 20:27:31,730:INFO:superset.models.helpers:[COLUMN_TRACE]     [3] key=OrgUnit, name=OrgUnit, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-06 20:27:31,730:INFO:superset.models.helpers:[COLUMN_TRACE]     [4] key=Period, name=Period, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-06 20:27:31,730:INFO:superset.models.helpers:[COLUMN_TRACE]     [4] key=Period, name=Period, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-06 20:27:31,731:INFO:superset.connectors.sqla.models:[DHIS2] get_from_clause for virtual dataset 1: analytics_LAST_YEAR_20251206
2025-12-06 20:27:31,731:INFO:superset.connectors.sqla.models:[DHIS2] get_from_clause for virtual dataset 1: analytics_LAST_YEAR_20251206
2025-12-06 20:27:31,731:INFO:superset.connectors.sqla.models:[DHIS2] Full SQL stored: SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
2025-12-06 20:27:31,731:INFO:superset.connectors.sqla.models:[DHIS2] Full SQL stored: SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
2025-12-06 20:27:31,731:INFO:superset.connectors.sqla.models:[DHIS2] Loaded params from extra field: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayPropert
2025-12-06 20:27:31,731:INFO:superset.connectors.sqla.models:[DHIS2] Loaded params from extra field: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayPropert
2025-12-06 20:27:31,732:INFO:superset.connectors.sqla.models:[DHIS2] Cached params with key: dhis2_params_1_analytics
2025-12-06 20:27:31,732:INFO:superset.connectors.sqla.models:[DHIS2] Stored params in Flask g for DHIS2 table: analytics
2025-12-06 20:27:31,732:INFO:superset.connectors.sqla.models:[DHIS2] Cached params with key: dhis2_params_1_analytics
2025-12-06 20:27:31,734:INFO:superset.connectors.sqla.models:[DHIS2] Stored params in Flask g for DHIS2 table: analytics
2025-12-06 20:27:31,735:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Query execution in connectors/sqla/models.py:
2025-12-06 20:27:31,735:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   SQL (first 500 chars): SELECT "105_EP01b_Malaria_Total", "105_EP01a_Suspected_fever", "105_EP01d_Malaria_cases_treated", "OrgUnit", "Period" 
FROM (SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
) AS virtual_table
 LIMIT 10000
2025-12-06 20:27:31,736:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Query execution in connectors/sqla/models.py:
2025-12-06 20:27:31,736:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   labels_expected: ['105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period']
2025-12-06 20:27:31,736:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   SQL (first 500 chars): SELECT "105_EP01b_Malaria_Total", "105_EP01a_Suspected_fever", "105_EP01d_Malaria_cases_treated", "OrgUnit", "Period" 
FROM (SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
) AS virtual_table
 LIMIT 10000
2025-12-06 20:27:31,737:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   labels_expected: ['105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period']
2025-12-06 20:27:31,737:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 connection initialized: https://tests.dhis2.hispuganda.org/hmis/api
2025-12-06 20:27:31,738:INFO:superset.db_engine_specs.dhis2_dialect:Executing DHIS2 query: SELECT
  "105_EP01b_Malaria_Total",
  "105_EP01a_Suspected_fever",
  "105_EP01d_Malaria_cases_treated",
  "OrgUnit",
  "Period"
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
LIMIT 10000
2025-12-06 20:27:31,738:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 connection initialized: https://tests.dhis2.hispuganda.org/hmis/api
2025-12-06 20:27:31,738:INFO:superset.db_engine_specs.dhis2_dialect:Parsed endpoint: analytics
2025-12-06 20:27:31,738:INFO:superset.db_engine_specs.dhis2_dialect:Executing DHIS2 query: SELECT
  "105_EP01b_Malaria_Total",
  "105_EP01a_Suspected_fever",
  "105_EP01d_Malaria_cases_treated",
  "OrgUnit",
  "Period"
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
LIMIT 10000
2025-12-06 20:27:31,739:INFO:superset.db_engine_specs.dhis2_dialect:Using stored parameters from Flask g for table: analytics
2025-12-06 20:27:31,739:INFO:superset.db_engine_specs.dhis2_dialect:Parsed endpoint: analytics
2025-12-06 20:27:31,739:INFO:superset.db_engine_specs.dhis2_dialect:Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
2025-12-06 20:27:31,739:INFO:superset.db_engine_specs.dhis2_dialect:Using stored parameters from Flask g for table: analytics
2025-12-06 20:27:31,739:INFO:superset.db_engine_specs.dhis2_dialect:Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
2025-12-06 20:27:31,739:INFO:superset.db_engine_specs.dhis2_dialect:Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
2025-12-06 20:27:31,739:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API request: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
2025-12-06 20:27:31,739:INFO:superset.db_engine_specs.dhis2_dialect:Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
2025-12-06 20:27:31,739:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API request: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
2025-12-06 20:27:32,684:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:27:32] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-06 20:27:42,037:INFO:superset.db_engine_specs.dhis2_dialect:Using wide/pivoted format for analytics
2025-12-06 20:27:42,037:INFO:superset.db_engine_specs.dhis2_dialect:normalize_analytics called with pivot=True, returning WIDE format
2025-12-06 20:27:42,038:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column construction - data_elements: ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
2025-12-06 20:27:42,038:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column names constructed (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:27:42,038:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] FIRST ROW CONSTRUCTION:
2025-12-06 20:27:42,038:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   Period (index 0): 2020
2025-12-06 20:27:42,038:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   OrgUnit (index 1): MOH - Uganda
2025-12-06 20:27:42,038:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01b. Malaria Total (index 2): 14479324
2025-12-06 20:27:42,038:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01a. Suspected fever (index 3): 22994823
2025-12-06 20:27:42,038:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01d. Malaria cases treated (index 4): 15266488
2025-12-06 20:27:42,038:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01c. Malaria Confirmed (B/s and RDT Positive) (index 5): 13326277
2025-12-06 20:27:42,038:INFO:superset.db_engine_specs.dhis2_dialect:First pivoted row - Period: '2020', OrgUnit: 'MOH - Uganda'
2025-12-06 20:27:42,038:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total pivoted rows: 4, columns: 6
2025-12-06 20:27:42,038:INFO:superset.db_engine_specs.dhis2_dialect:Normalized 4 rows with 6 columns for endpoint analytics
2025-12-06 20:27:42,038:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API returned 4 rows
2025-12-06 20:27:42,046:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() - Row count: 4
2025-12-06 20:27:42,046:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:27:42,046:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names length: 6
2025-12-06 20:27:42,046:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values count: 6
2025-12-06 20:27:42,046:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-06 20:27:42,046:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 0 (Period): 2020 -> 2020 (STRING)
2025-12-06 20:27:42,046:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (OrgUnit): MOH - Uganda -> MOH - Uganda (STRING)
2025-12-06 20:27:42,046:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (105_EP01b_Malaria_Total): 14479324 (PROCESSED)
2025-12-06 20:27:42,046:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (105_EP01a_Suspected_fever): 22994823 (PROCESSED)
2025-12-06 20:27:42,046:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (105_EP01d_Malaria_cases_treated): 15266488 (PROCESSED)
2025-12-06 20:27:42,046:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() returning 4 rows with 6 columns each
2025-12-06 20:27:42,046:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Got 4 rows from cursor
2025-12-06 20:27:42,046:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-06 20:27:42,046:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:27:42,046:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Types from cursor: ['String', 'String', 'String', 'String', 'String', 'String']
2025-12-06 20:27:42,048:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: DataFrame created with 4 rows, 6 columns
2025-12-06 20:27:42,048:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:27:42,049:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes BEFORE fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-06 20:27:42,050:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Period' to object dtype (dimension)
2025-12-06 20:27:42,050:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'OrgUnit' to object dtype (dimension)
2025-12-06 20:27:42,050:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes AFTER fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-06 20:27:42,051:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: First row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-06 20:27:42,054:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] BEFORE assign_column_label:
2025-12-06 20:27:42,054:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 6)
2025-12-06 20:27:42,054:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:27:42,054:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period']
2025-12-06 20:27:42,054:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: False
2025-12-06 20:27:42,054:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-06 20:27:42,054:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Column truncation needed: df has 6 columns, expected 5
2025-12-06 20:27:42,054:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   DataFrame actual columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:27:42,054:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Expected columns: ['105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period']
2025-12-06 20:27:42,054:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] âœ“ Selecting columns BY NAME (matched all expected columns)
2025-12-06 20:27:42,054:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Column mapping: {'105_EP01b_Malaria_Total': '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever': '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated': '105_EP01d_Malaria_cases_treated', 'OrgUnit': 'OrgUnit', 'Period': 'Period'}
2025-12-06 20:27:42,055:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] Column Selection âœ“ SUCCESS - method=BY_NAME, datasource=analytics_LAST_YEAR_20251206
2025-12-06 20:27:42,055:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period']
2025-12-06 20:27:42,055:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   tried_by_name=True, success=True, fallback=False
2025-12-06 20:27:42,055:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Assigning column labels: ['105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period']
2025-12-06 20:27:42,055:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] AFTER assign_column_label:
2025-12-06 20:27:42,055:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 5)
2025-12-06 20:27:42,055:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period']
2025-12-06 20:27:42,055:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period']
2025-12-06 20:27:42,055:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: True
2025-12-06 20:27:42,055:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, 'OrgUnit': 'MOH - Uganda', 'Period': '2020'}
2025-12-06 20:27:42,066:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:27:42] "POST /api/v1/chart/data HTTP/1.1" 200 -

[DHIS2] Raw API response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Raw DHIS2 rows count: 16
[DHIS2] First raw row: ['QHnwKs2OUZv', '2020', 'akV6429SUqu', '15266488']
[DHIS2] Parsing response for endpoint: analytics
[DHIS2] Response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Response sample: {'headers': [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}], 'metaDat
[DHIS2] Using WIDE/PIVOTED format (Period, OrgUnit, DX1, DX2, ...) for analytics
[DHIS2] normalize_analytics: pivot=True, using WIDE/PIVOTED format
[DHIS2] PIVOT CONSTRUCTION:
[DHIS2]   data_elements (UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   data_element_list (sorted UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   col_names (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized row count: 4
[DHIS2] First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] _set_description: columns=['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], types=['String', 'String', 'String', 'String', 'String', 'String']
[DHIS2] Transformed rows count: 4
[DHIS2] First transformed row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] Fetched 4 rows
[DHIS2] fetchall() called - returning 4 rows
[DHIS2] fetchall() - First row type: <class 'tuple'>
[DHIS2] fetchall() - First row (original): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Column count from description: 6
[DHIS2] fetchall() - First row (fixed types): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Type enforcement: dimensions=STRING, measures=FLOAT
[DHIS2] Executing query: SELECT
  "105_EP01b_Malaria_Total",
  "105_EP01a_Suspected_fever",
  "105_EP01d_Malaria_cases_treated",
  "OrgUnit",
  "Period"
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
LIMIT 10000
[DHIS2] Parsed endpoint: analytics
[DHIS2] Executing query: SELECT
  "105_EP01b_Malaria_Total",
  "105_EP01a_Suspected_fever",
  "105_EP01d_Malaria_cases_treated",
  "OrgUnit",
  "Period"
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
LIMIT 10000
[DHIS2] Found params in Flask g for analytics: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;
[DHIS2] Parsed endpoint: analytics
[DHIS2] Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
[DHIS2] Found params in Flask g for analytics: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;
[DHIS2] Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
[DHIS2] Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
[DHIS2] API request URL: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
[DHIS2] Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_YEAR;2025;2024;2023;2022;2021;2020;ou:USER_ORGUNIT'}
[DHIS2] API request URL: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_YEAR;2025;2024;2023;2022;2021;2020&dimension=ou:USER_ORGUNIT
[DHIS2] Raw API response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Raw DHIS2 rows count: 16
[DHIS2] First raw row: ['QHnwKs2OUZv', '2020', 'akV6429SUqu', '15266488']
[DHIS2] Parsing response for endpoint: analytics
[DHIS2] Response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Response sample: {'headers': [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}], 'metaDat
[DHIS2] Using WIDE/PIVOTED format (Period, OrgUnit, DX1, DX2, ...) for analytics
[DHIS2] normalize_analytics: pivot=True, using WIDE/PIVOTED format
[DHIS2] PIVOT CONSTRUCTION:
[DHIS2]   data_elements (UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   data_element_list (sorted UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   col_names (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized row count: 4
[DHIS2] First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] _set_description: columns=['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], types=['String', 'String', 'String', 'String', 'String', 'String']
[DHIS2] Transformed rows count: 4
[DHIS2] First transformed row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] Fetched 4 rows
[DHIS2] fetchall() called - returning 4 rows
[DHIS2] fetchall() - First row type: <class 'tuple'>
[DHIS2] fetchall() - First row (original): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Column count from description: 6
[DHIS2] fetchall() - First row (fixed types): ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
[DHIS2] fetchall() - Type enforcement: dimensions=STRING, measures=FLOAT
[DHIS2] Raw API response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Raw DHIS2 rows count: 16
[DHIS2] First raw row: ['QHnwKs2OUZv', '2020', 'akV6429SUqu', '15266488']
[DHIS2] Parsing response for endpoint: analytics
[DHIS2] Response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Response sample: {'headers': [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}], 'metaDat2025-12-06 20:27:51,332:INFO:superset.db_engine_specs.dhis2_dialect:Using wide/pivoted format for analytics
2025-12-06 20:27:51,332:INFO:superset.db_engine_specs.dhis2_dialect:normalize_analytics called with pivot=True, returning WIDE format
2025-12-06 20:27:51,332:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column construction - data_elements: ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
2025-12-06 20:27:51,333:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column names constructed (SANITIZED): ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:27:51,333:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] FIRST ROW CONSTRUCTION:
2025-12-06 20:27:51,333:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   Period (index 0): 2020
2025-12-06 20:27:51,333:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   OrgUnit (index 1): MOH - Uganda
2025-12-06 20:27:51,333:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01b. Malaria Total (index 2): 14479324
2025-12-06 20:27:51,333:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01a. Suspected fever (index 3): 22994823
2025-12-06 20:27:51,333:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01d. Malaria cases treated (index 4): 15266488
2025-12-06 20:27:51,334:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01c. Malaria Confirmed (B/s and RDT Positive) (index 5): 13326277
2025-12-06 20:27:51,334:INFO:superset.db_engine_specs.dhis2_dialect:First pivoted row - Period: '2020', OrgUnit: 'MOH - Uganda'
2025-12-06 20:27:51,334:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total pivoted rows: 4, columns: 6
2025-12-06 20:27:51,334:INFO:superset.db_engine_specs.dhis2_dialect:Normalized 4 rows with 6 columns for endpoint analytics
2025-12-06 20:27:51,334:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API returned 4 rows
2025-12-06 20:27:51,344:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() - Row count: 4
2025-12-06 20:27:51,344:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:27:51,344:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names length: 6
2025-12-06 20:27:51,344:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values count: 6
2025-12-06 20:27:51,344:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-06 20:27:51,344:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 0 (Period): 2020 -> 2020 (STRING)
2025-12-06 20:27:51,344:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (OrgUnit): MOH - Uganda -> MOH - Uganda (STRING)
2025-12-06 20:27:51,344:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (105_EP01b_Malaria_Total): 14479324 (PROCESSED)
2025-12-06 20:27:51,344:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (105_EP01a_Suspected_fever): 22994823 (PROCESSED)
2025-12-06 20:27:51,344:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (105_EP01d_Malaria_cases_treated): 15266488 (PROCESSED)
2025-12-06 20:27:51,344:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() returning 4 rows with 6 columns each
2025-12-06 20:27:51,344:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Got 4 rows from cursor
2025-12-06 20:27:51,344:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: First row: ('2020', 'MOH - Uganda', 14479324, 22994823, 15266488, 13326277)
2025-12-06 20:27:51,344:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:27:51,344:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Types from cursor: ['String', 'String', 'String', 'String', 'String', 'String']
2025-12-06 20:27:51,345:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: DataFrame created with 4 rows, 6 columns
2025-12-06 20:27:51,345:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:27:51,346:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes BEFORE fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-06 20:27:51,346:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Period' to object dtype (dimension)
2025-12-06 20:27:51,346:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'OrgUnit' to object dtype (dimension)
2025-12-06 20:27:51,346:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes AFTER fix: {'Period': dtype('O'), 'OrgUnit': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-06 20:27:51,346:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: First row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-06 20:27:51,350:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] BEFORE assign_column_label:
2025-12-06 20:27:51,350:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 6)
2025-12-06 20:27:51,350:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:27:51,350:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period']
2025-12-06 20:27:51,350:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: False
2025-12-06 20:27:51,350:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Period': '2020', 'OrgUnit': 'MOH - Uganda', '105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 13326277}
2025-12-06 20:27:51,350:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Column truncation needed: df has 6 columns, expected 5
2025-12-06 20:27:51,350:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   DataFrame actual columns: ['Period', 'OrgUnit', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-06 20:27:51,350:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Expected columns: ['105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period']
2025-12-06 20:27:51,350:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] âœ“ Selecting columns BY NAME (matched all expected columns)
2025-12-06 20:27:51,350:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Column mapping: {'105_EP01b_Malaria_Total': '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever': '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated': '105_EP01d_Malaria_cases_treated', 'OrgUnit': 'OrgUnit', 'Period': 'Period'}
2025-12-06 20:27:51,350:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] Column Selection âœ“ SUCCESS - method=BY_NAME, datasource=analytics_LAST_YEAR_20251206
2025-12-06 20:27:51,350:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period']
2025-12-06 20:27:51,350:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   tried_by_name=True, success=True, fallback=False
2025-12-06 20:27:51,350:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Assigning column labels: ['105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period']
2025-12-06 20:27:51,351:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] AFTER assign_column_label:
2025-12-06 20:27:51,351:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4, 5)
2025-12-06 20:27:51,351:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period']
2025-12-06 20:27:51,351:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', 'OrgUnit', 'Period']
2025-12-06 20:27:51,351:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: True
2025-12-06 20:27:51,351:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'105_EP01b_Malaria_Total': 14479324, '105_EP01a_Suspected_fever': 22994823, '105_EP01d_Malaria_cases_treated': 15266488, 'OrgUnit': 'MOH - Uganda', 'Period': '2020'}
2025-12-06 20:27:51,363:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:27:51] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-06 20:27:53,048:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:27:53] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-06 20:31:09,516:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:31:09] "GET /api/v1/me/ HTTP/1.1" 200 -
2025-12-06 20:35:37,040:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1458, in dispatch_request
    self.raise_routing_exception(req)
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1440, in raise_routing_exception
    raise request.routing_exception  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/ctx.py", line 353, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/werkzeug/routing/map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-12-06 20:35:37,047:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:35:37] "[33mGET /ws HTTP/1.1[0m" 404 -
2025-12-06 20:45:28,401:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:45:28] "GET /api/v1/me/ HTTP/1.1" 200 -
2025-12-06 20:45:57,246:INFO:werkzeug:127.0.0.1 - - [06/Dec/2025 20:45:57] "GET /api/v1/me/ HTTP/1.1" 200 -
