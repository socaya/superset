Loaded your LOCAL configuration at [/Users/stephocay/projects/hispuganda/superset/superset_config.py]
2025-12-18 13:14:05,923:INFO:superset.init_public_dashboards:[Embedded Dashboard] Initialization complete. Total dashboards processed: 1
2025-12-18 13:14:05,924:INFO:alembic.runtime.migration:Context impl SQLiteImpl.
2025-12-18 13:14:05,924:INFO:alembic.runtime.migration:Will assume non-transactional DDL.
2025-12-18 13:14:06,135:INFO:superset.app:Pending database migrations: run 'superset db upgrade'
 * Serving Flask app 'superset'
 * Debug mode: on
2025-12-18 13:14:06,635:INFO:werkzeug:[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:8088
2025-12-18 13:14:06,635:INFO:werkzeug:[33mPress CTRL+C to quit[0m
2025-12-18 13:14:06,649:INFO:werkzeug: * Restarting with watchdog (fsevents)
Loaded your LOCAL configuration at [/Users/stephocay/projects/hispuganda/superset/superset_config.py]
2025-12-18 13:14:07,827:INFO:superset.init_public_dashboards:[Embedded Dashboard] Initialization complete. Total dashboards processed: 1
2025-12-18 13:14:07,828:INFO:alembic.runtime.migration:Context impl SQLiteImpl.
2025-12-18 13:14:07,828:INFO:alembic.runtime.migration:Will assume non-transactional DDL.
2025-12-18 13:14:07,919:INFO:superset.app:Pending database migrations: run 'superset db upgrade'
2025-12-18 13:14:08,259:WARNING:werkzeug: * Debugger is active!
2025-12-18 13:14:08,270:INFO:werkzeug: * Debugger PIN: 114-810-287
2025-12-18 13:14:08,311:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:14:08] "GET /health HTTP/1.1" 200 -
2025-12-18 13:16:53,012:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:16:53] "[32mGET / HTTP/1.1[0m" 302 -
2025-12-18 13:16:56,022:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:16:56] "GET /superset/welcome/ HTTP/1.1" 200 -
2025-12-18 13:16:57,592:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:16:57] "GET /api/v1/database/?q=(filters:!((col:allow_file_upload,opr:upload_is_enabled,value:!t))) HTTP/1.1" 200 -
2025-12-18 13:16:57,595:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:16:57] "GET /api/v1/saved_query/?q=(filters:!((col:created_by,opr:rel_o_m,value:'1')),order_column:changed_on_delta_humanized,order_direction:desc,page:0,page_size:5) HTTP/1.1" 200 -
2025-12-18 13:16:57,982:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:16:57] "GET /api/v1/dashboard/?q=(filters:!((col:owners,opr:rel_m_m,value:'1')),order_column:changed_on_delta_humanized,order_direction:desc,page:0,page_size:5) HTTP/1.1" 200 -
2025-12-18 13:16:57,985:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:16:57] "GET /api/v1/chart/?q=(filters:!((col:owners,opr:rel_m_m,value:'1')),order_column:changed_on_delta_humanized,order_direction:desc,page:0,page_size:5) HTTP/1.1" 200 -
2025-12-18 13:16:57,999:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:16:57] "GET /api/v1/log/recent_activity/?q=(distinct:!f,page_size:24) HTTP/1.1" 200 -
2025-12-18 13:16:58,010:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:16:58] "GET /api/v1/database/?q=(filters:!((col:database_name,opr:neq,value:examples))) HTTP/1.1" 200 -
2025-12-18 13:16:58,095:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:16:58] "GET /api/v1/dashboard/?q=(filters:!(),order_column:changed_on_delta_humanized,order_direction:desc,page:0,page_size:5) HTTP/1.1" 200 -
2025-12-18 13:16:58,098:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:16:58] "GET /api/v1/chart/?q=(filters:!(),order_column:changed_on_delta_humanized,order_direction:desc,page:0,page_size:5) HTTP/1.1" 200 -
2025-12-18 13:16:58,191:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:16:58] "GET /api/v1/chart/_info?q=(keys:!(permissions)) HTTP/1.1" 200 -
2025-12-18 13:16:58,192:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:16:58] "GET /api/v1/dashboard/_info?q=(keys:!(permissions)) HTTP/1.1" 200 -
2025-12-18 13:16:58,193:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:16:58] "GET /api/v1/dashboard/favorite_status/?q=!(1) HTTP/1.1" 200 -
2025-12-18 13:16:58,193:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:16:58] "GET /api/v1/chart/favorite_status/?q=!(1,2,3) HTTP/1.1" 200 -
2025-12-18 13:16:58,369:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:16:58] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 13:17:06,671:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:17:06] "GET /superset/welcome/ HTTP/1.1" 200 -
2025-12-18 13:17:06,707:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:17:06] "GET /static/appbuilder/css/flags/flags16.css HTTP/1.1" 200 -
2025-12-18 13:17:07,489:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:17:07] "GET /api/v1/database/?q=(filters:!((col:allow_file_upload,opr:upload_is_enabled,value:!t))) HTTP/1.1" 200 -
2025-12-18 13:17:07,521:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:17:07] "GET /api/v1/saved_query/?q=(filters:!((col:created_by,opr:rel_o_m,value:'1')),order_column:changed_on_delta_humanized,order_direction:desc,page:0,page_size:5) HTTP/1.1" 200 -
2025-12-18 13:17:07,527:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:17:07] "GET /api/v1/log/recent_activity/?q=(distinct:!f,page_size:24) HTTP/1.1" 200 -
2025-12-18 13:17:07,537:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:17:07] "GET /api/v1/dashboard/?q=(filters:!((col:owners,opr:rel_m_m,value:'1')),order_column:changed_on_delta_humanized,order_direction:desc,page:0,page_size:5) HTTP/1.1" 200 -
2025-12-18 13:17:07,541:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:17:07] "GET /api/v1/database/?q=(filters:!((col:database_name,opr:neq,value:examples))) HTTP/1.1" 200 -
2025-12-18 13:17:07,571:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:17:07] "GET /api/v1/chart/?q=(filters:!((col:owners,opr:rel_m_m,value:'1')),order_column:changed_on_delta_humanized,order_direction:desc,page:0,page_size:5) HTTP/1.1" 200 -
2025-12-18 13:17:07,590:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:17:07] "GET /api/v1/dashboard/?q=(filters:!(),order_column:changed_on_delta_humanized,order_direction:desc,page:0,page_size:5) HTTP/1.1" 200 -
2025-12-18 13:17:07,596:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:17:07] "GET /api/v1/chart/?q=(filters:!(),order_column:changed_on_delta_humanized,order_direction:desc,page:0,page_size:5) HTTP/1.1" 200 -
2025-12-18 13:17:07,669:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:17:07] "GET /api/v1/dashboard/_info?q=(keys:!(permissions)) HTTP/1.1" 200 -
2025-12-18 13:17:07,678:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:17:07] "GET /api/v1/chart/_info?q=(keys:!(permissions)) HTTP/1.1" 200 -
2025-12-18 13:17:07,681:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:17:07] "GET /api/v1/dashboard/favorite_status/?q=!(1) HTTP/1.1" 200 -
2025-12-18 13:17:07,685:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:17:07] "GET /api/v1/chart/favorite_status/?q=!(1,2,3) HTTP/1.1" 200 -
2025-12-18 13:17:08,397:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:17:08] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 13:17:09,611:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:17:09] "GET /api/v1/dataset/_info?q=(keys:!(permissions)) HTTP/1.1" 200 -
2025-12-18 13:17:09,649:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:17:09] "GET /api/v1/dataset/?q=(order_column:changed_on_delta_humanized,order_direction:desc,page:0,page_size:25) HTTP/1.1" 200 -
2025-12-18 13:17:10,369:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:17:10] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 13:17:13,536:INFO:superset.databases.api:[DHIS2 Chart Data] Received SQL: SELECT * FROM analytics
/* DHIS2: table=analytics&dx=JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&pe=LAST_5_YEARS&ou=F1o6qBSx783;SUvODYOcaVf&ouMode=D...
2025-12-18 13:17:13,536:INFO:superset.databases.api:[DHIS2 Chart Data] Requested columns: []
2025-12-18 13:17:13,536:INFO:superset.databases.api:[DHIS2 Chart Data] Parsed params: {'table': 'analytics', 'dx': 'JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX', 'pe': 'LAST_5_YEARS', 'ou': 'F1o6qBSx783;SUvODYOcaVf', 'ouMode': 'DESCENDANTS'}
2025-12-18 13:17:13,536:INFO:superset.databases.api:[DHIS2 Chart Data] ouMode=DESCENDANTS, data_level_scope=all_levels, include_children=True
2025-12-18 13:17:13,536:INFO:superset.databases.api:[DHIS2 Chart Data] Expanded periods: ['2025', '2024', '2023', '2022', '2021']
2025-12-18 13:17:13,540:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 connection initialized: https://tests.dhis2.hispuganda.org/hmis/api
2025-12-18 13:17:13,540:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching org unit levels from: https://tests.dhis2.hispuganda.org/hmis/api/organisationUnitLevels.json?paging=false&fields=id,level,name
2025-12-18 13:17:14,025:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:17:14] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 13:17:14,045:INFO:superset.db_engine_specs.dhis2:[DHIS2] get_parameters_from_uri called
2025-12-18 13:17:14,045:ERROR:superset.db_engine_specs.dhis2:[DHIS2] Failed to extract parameters from URI: 'URL' object has no attribute 'decode'
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/superset/db_engine_specs/dhis2.py", line 361, in get_parameters_from_uri
    parsed = urlparse(uri)
             ^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/urllib/parse.py", line 394, in urlparse
    url, scheme, _coerce_result = _coerce_args(url, scheme)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/urllib/parse.py", line 133, in _coerce_args
    return _decode_args(args) + (_encode_result,)
           ^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/urllib/parse.py", line 117, in _decode_args
    return tuple(x.decode(encoding, errors) if x else '' for x in args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/urllib/parse.py", line 117, in <genexpr>
    return tuple(x.decode(encoding, errors) if x else '' for x in args)
                 ^^^^^^^^
AttributeError: 'URL' object has no attribute 'decode'
2025-12-18 13:17:14,064:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:17:14] "GET /api/v1/explore/?datasource_type=table&datasource_id=4 HTTP/1.1" 200 -
2025-12-18 13:17:14,391:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetched 5 org unit levels
2025-12-18 13:17:14,391:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Level 3 -> 'District'
2025-12-18 13:17:14,391:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Level 5 -> 'Health Facility'
2025-12-18 13:17:14,391:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Level 1 -> 'National'
2025-12-18 13:17:14,391:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Level 2 -> 'Region'
2025-12-18 13:17:14,391:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Level 4 -> 'Sub County/Town Council/Div'
2025-12-18 13:17:14,391:INFO:superset.databases.api:[DHIS2 Chart Data] Fetched level_names: {3: 'District', 5: 'Health Facility', 1: 'National', 2: 'Region', 4: 'Sub County/Town Council/Div'}
2025-12-18 13:17:14,391:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching display names for 8 DX items
2025-12-18 13:17:14,391:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Trying dataElements: https://tests.dhis2.hispuganda.org/hmis/api/dataElements.json?filter=id:in:[JhvC7ZR9hUe,D9A0afrTYPw,wUDxFVBapIc,QHnwKs2OUZv,BWZFz9RJRPI,AuAOIfCuBUp,pRZrTLDN7Ge,gHjJrtw9vQX]&fields=id,name,displayName&paging=false
2025-12-18 13:17:15,231:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:17:15] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 13:17:15,287:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:17:15] "[35m[1mPOST /api/v1/explore/form_data?tab_id=2 HTTP/1.1[0m" 201 -
2025-12-18 13:17:15,380:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Found 8 items in dataElements
2025-12-18 13:17:15,380:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] DX: JhvC7ZR9hUe -> '105-EP01a. Suspected fever'
2025-12-18 13:17:15,380:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] DX: D9A0afrTYPw -> '105-EP01b. Malaria Total'
2025-12-18 13:17:15,380:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] DX: wUDxFVBapIc -> '105-EP01c. Malaria Confirmed (B/s and RDT Positive)'
2025-12-18 13:17:15,380:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] DX: QHnwKs2OUZv -> '105-EP01d. Malaria cases treated'
2025-12-18 13:17:15,380:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] DX: BWZFz9RJRPI -> '108-EP01a.1. Malaria Total (Cases)'
2025-12-18 13:17:15,381:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] DX: AuAOIfCuBUp -> '108-EP01a.2. Malaria Total (Deaths)'
2025-12-18 13:17:15,381:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] DX: pRZrTLDN7Ge -> '108-EP01b.1. Malaria Confirmed (Microscopic &RDT) (Cases)'
2025-12-18 13:17:15,381:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] DX: gHjJrtw9vQX -> '108-EP01b.2. Malaria Confirmed (Microscopic &RDT) (Deaths)'
2025-12-18 13:17:15,381:INFO:superset.databases.api:[DHIS2 Chart Data] Fetched dx_names: {'JhvC7ZR9hUe': '105-EP01a. Suspected fever', 'D9A0afrTYPw': '105-EP01b. Malaria Total', 'wUDxFVBapIc': '105-EP01c. Malaria Confirmed (B/s and RDT Positive)', 'QHnwKs2OUZv': '105-EP01d. Malaria cases treated', 'BWZFz9RJRPI': '108-EP01a.1. Malaria Total (Cases)', 'AuAOIfCuBUp': '108-EP01a.2. Malaria Total (Deaths)', 'pRZrTLDN7Ge': '108-EP01b.1. Malaria Confirmed (Microscopic &RDT) (Cases)', 'gHjJrtw9vQX': '108-EP01b.2. Malaria Confirmed (Microscopic &RDT) (Deaths)'}
2025-12-18 13:17:15,381:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] fetch_org_units_with_ancestors called for 2 IDs: ['F1o6qBSx783', 'SUvODYOcaVf']...
2025-12-18 13:17:15,381:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching org units batch 1/1
2025-12-18 13:17:16,349:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetched 2 org units, found 1 ancestor IDs from paths
2025-12-18 13:17:16,349:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching 1 missing ancestors
2025-12-18 13:17:17,419:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Final result: 3 names, 3 levels, 3 parents
2025-12-18 13:17:17,419:INFO:superset.databases.api:[DHIS2 Chart Data] Fetched 3 org units with ancestors
2025-12-18 13:17:17,419:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Max selected level: 2, Data scope: all_levels
2025-12-18 13:17:17,419:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Added LEVEL-3 for all_levels scope
2025-12-18 13:17:17,420:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Added LEVEL-4 for all_levels scope
2025-12-18 13:17:17,420:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Added LEVEL-5 for all_levels scope
2025-12-18 13:17:17,420:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Built ou dimension: F1o6qBSx783;SUvODYOcaVf;LEVEL-3;LEVEL-4;LEVEL-5
2025-12-18 13:17:17,420:INFO:superset.databases.api:[DHIS2 Chart Data] Built ou_dimension: F1o6qBSx783;SUvODYOcaVf;LEVEL-3;LEVEL-4;LEVEL-5
2025-12-18 13:17:17,420:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Building hierarchy for 2 org units
2025-12-18 13:17:17,420:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] ou_names has 3 entries, ou_levels has 3 entries, ou_parents has 3 entries
2025-12-18 13:17:17,420:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Sample: id=F1o6qBSx783, name=Ankole, level=2, parent=akV6429SUqu
2025-12-18 13:17:17,420:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Built hierarchy: 2 entries, 2 with ancestors, 0 empty
2025-12-18 13:17:17,420:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Sample hierarchy for F1o6qBSx783: {'level': 2, 'ancestors_by_level': {2: 'F1o6qBSx783', 1: 'akV6429SUqu'}}
2025-12-18 13:17:17,420:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Level range: 1 to 2
2025-12-18 13:17:17,423:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 connection initialized: https://tests.dhis2.hispuganda.org/hmis/api
2025-12-18 13:17:17,423:INFO:superset.databases.api:[DHIS2 Chart Data] Fetching analytics data with ou_mode=DESCENDANTS...
2025-12-18 13:17:17,423:INFO:superset.db_engine_specs.dhis2_dialect:[Analytics API] Using custom ou dimension: F1o6qBSx783;SUvODYOcaVf;LEVEL-3;LEVEL-4;LEVEL-5
2025-12-18 13:17:17,423:INFO:superset.db_engine_specs.dhis2_dialect:[Analytics API] Using ouMode=DESCENDANTS
2025-12-18 13:17:17,423:INFO:superset.db_engine_specs.dhis2_dialect:[Analytics API] Fetching from https://tests.dhis2.hispuganda.org/hmis/api/analytics with de_ids=['JhvC7ZR9hUe', 'D9A0afrTYPw', 'wUDxFVBapIc', 'QHnwKs2OUZv', 'BWZFz9RJRPI', 'AuAOIfCuBUp', 'pRZrTLDN7Ge', 'gHjJrtw9vQX'], period_ids=['2025', '2024', '2023', '2022', '2021'], ou_ids=['F1o6qBSx783', 'SUvODYOcaVf'], ou_mode=DESCENDANTS
2025-12-18 13:17:19,647:INFO:superset.db_engine_specs.dhis2_dialect:[Analytics API] Response status: success, keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
2025-12-18 13:17:19,647:INFO:superset.db_engine_specs.dhis2_dialect:[Analytics API] Found 16953 raw rows from analytics
2025-12-18 13:17:19,647:INFO:superset.db_engine_specs.dhis2_dialect:[Analytics API] Column indices: dx=0, pe=1, ou=2, value=3
2025-12-18 13:17:19,654:INFO:superset.db_engine_specs.dhis2_dialect:[Analytics API] Pivoted 16953 rows into 3319 unique ou/period combinations
2025-12-18 13:17:19,655:INFO:superset.databases.api:[DHIS2 Chart Data] Total rows from analytics: 3319
2025-12-18 13:17:19,656:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] fetch_org_units_with_ancestors called for 50 IDs: ['QpXYf9Wb3CQ', 'a9ZI6jNBqXx', 'acQJJL9aUo0', 'aifkaPWfQez', 'B9cu6kigJ6f']...
2025-12-18 13:17:19,656:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching org units batch 1/1
2025-12-18 13:17:20,697:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetched 50 org units, found 55 ancestor IDs from paths
2025-12-18 13:17:20,697:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching 55 missing ancestors
2025-12-18 13:17:22,593:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Final result: 105 names, 105 levels, 105 parents
2025-12-18 13:17:22,594:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] fetch_org_units_with_ancestors called for 50 IDs: ['ZLnbMrovQ9f', 'ifmbldJaNrM', 'uG6WV4UKNaB', 'qbh38u2Laz4', 'UEKVlvKXJAC']...
2025-12-18 13:17:22,594:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching org units batch 1/1
2025-12-18 13:17:23,551:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetched 50 org units, found 55 ancestor IDs from paths
2025-12-18 13:17:23,552:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching 51 missing ancestors
2025-12-18 13:17:25,587:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Final result: 101 names, 101 levels, 101 parents
2025-12-18 13:17:25,588:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] fetch_org_units_with_ancestors called for 50 IDs: ['au6l6u0QySf', 'NdIteLoT2FC', 'UH56sJpuPoN', 'RXwynIETRuW', 'G51dLKvQTxh']...
2025-12-18 13:17:25,588:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching org units batch 1/1
2025-12-18 13:17:26,521:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetched 50 org units, found 58 ancestor IDs from paths
2025-12-18 13:17:26,522:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching 57 missing ancestors
2025-12-18 13:17:28,523:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Final result: 107 names, 107 levels, 107 parents
2025-12-18 13:17:28,523:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] fetch_org_units_with_ancestors called for 50 IDs: ['H9Kdh2eKGyz', 'PhCq4x6L2o1', 'LPJ8Gxge7ig', 'rVqSSRK4j18', 'tlIMKbS5bmI']...
2025-12-18 13:17:28,524:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching org units batch 1/1
2025-12-18 13:17:29,527:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetched 50 org units, found 55 ancestor IDs from paths
2025-12-18 13:17:29,527:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching 49 missing ancestors
2025-12-18 13:17:30,537:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Final result: 99 names, 99 levels, 99 parents
2025-12-18 13:17:30,538:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] fetch_org_units_with_ancestors called for 50 IDs: ['P2QYI0kDGW3', 'W7kX446X8Jn', 'Fi6rNyCYxsL', 'N00GWUvXv52', 'aJNgqIuVpYF']...
2025-12-18 13:17:30,538:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching org units batch 1/1
2025-12-18 13:17:31,474:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetched 50 org units, found 56 ancestor IDs from paths
2025-12-18 13:17:31,475:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching 50 missing ancestors
2025-12-18 13:17:32,500:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Final result: 100 names, 100 levels, 100 parents
2025-12-18 13:17:32,502:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] fetch_org_units_with_ancestors called for 50 IDs: ['x1UaYpPwx6c', 'w9mcV8YwoKa', 'WzfWcG6I4e6', 'gEJIdy608EI', 'U2iprp1G39M']...
2025-12-18 13:17:32,503:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching org units batch 1/1
2025-12-18 13:17:33,537:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetched 50 org units, found 63 ancestor IDs from paths
2025-12-18 13:17:33,537:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching 61 missing ancestors
2025-12-18 13:17:35,479:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Final result: 111 names, 111 levels, 111 parents
2025-12-18 13:17:35,479:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] fetch_org_units_with_ancestors called for 50 IDs: ['TEGq0O1M6Ff', 'EPyMwPkmKPx', 'WgmL7qQcVxV', 'i5CDWEBfo9n', 'BfumzskZzcA']...
2025-12-18 13:17:35,479:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching org units batch 1/1
2025-12-18 13:17:36,553:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetched 50 org units, found 63 ancestor IDs from paths
2025-12-18 13:17:36,553:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching 61 missing ancestors
2025-12-18 13:17:38,453:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Final result: 111 names, 111 levels, 111 parents
2025-12-18 13:17:38,454:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] fetch_org_units_with_ancestors called for 50 IDs: ['R43DSu1tUIj', 'V8YasjaiKtV', 'IalHV5BSxEb', 'CKPFNnfrvbR', 't7sCLD2E7gA']...
2025-12-18 13:17:38,454:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching org units batch 1/1
2025-12-18 13:17:39,514:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetched 50 org units, found 59 ancestor IDs from paths
2025-12-18 13:17:39,536:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching 59 missing ancestors
2025-12-18 13:17:41,614:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Final result: 109 names, 109 levels, 109 parents
2025-12-18 13:17:41,614:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] fetch_org_units_with_ancestors called for 50 IDs: ['oBsdf0a82Z7', 'axBP3PGZjM1', 'B7tG9VFceYl', 'cYnbNkuMQpk', 'fLGGzlZfyOJ']...
2025-12-18 13:17:41,615:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching org units batch 1/1
2025-12-18 13:17:42,690:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetched 50 org units, found 54 ancestor IDs from paths
2025-12-18 13:17:42,690:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching 53 missing ancestors
2025-12-18 13:17:44,607:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Final result: 103 names, 103 levels, 103 parents
2025-12-18 13:17:44,608:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] fetch_org_units_with_ancestors called for 50 IDs: ['s6nvpDfR2Vg', 'SXrFhwJB3wi', 'IDKLziIG6cU', 'q5gtDb5elfP', 'UmZdQJ8467Z']...
2025-12-18 13:17:44,609:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching org units batch 1/1
2025-12-18 13:17:45,580:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetched 50 org units, found 57 ancestor IDs from paths
2025-12-18 13:17:45,580:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching 54 missing ancestors
2025-12-18 13:17:47,529:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Final result: 104 names, 104 levels, 104 parents
2025-12-18 13:17:47,530:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] fetch_org_units_with_ancestors called for 50 IDs: ['ufFYZzS4K49', 'ipjC8RjDoJ0', 'edGJUvFwlKN', 'Pzuty2p5guf', 'OSfoWEwPx5d']...
2025-12-18 13:17:47,531:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching org units batch 1/1
2025-12-18 13:17:48,517:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetched 50 org units, found 52 ancestor IDs from paths
2025-12-18 13:17:48,517:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching 49 missing ancestors
2025-12-18 13:17:49,508:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Final result: 99 names, 99 levels, 99 parents
2025-12-18 13:17:49,510:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] fetch_org_units_with_ancestors called for 50 IDs: ['xTTc0XQndvv', 'aTaU1OfpPkU', 't8zaoJYNXPM', 'UUt3ZtL1hIJ', 'FtOWRUlH9Rw']...
2025-12-18 13:17:49,510:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching org units batch 1/1
2025-12-18 13:17:50,574:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetched 50 org units, found 56 ancestor IDs from paths
2025-12-18 13:17:50,574:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching 55 missing ancestors
2025-12-18 13:17:52,599:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Final result: 105 names, 105 levels, 105 parents
2025-12-18 13:17:52,600:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] fetch_org_units_with_ancestors called for 50 IDs: ['myrkJv85aqb', 'aR0Ye42mrx8', 'oMZSkQE6CzW', 'SXn9X0OzWLu', 'DgcoJ3W21vA']...
2025-12-18 13:17:52,600:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching org units batch 1/1
2025-12-18 13:17:53,574:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetched 50 org units, found 60 ancestor IDs from paths
2025-12-18 13:17:53,574:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching 57 missing ancestors
2025-12-18 13:17:55,490:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Final result: 107 names, 107 levels, 107 parents
2025-12-18 13:17:55,491:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] fetch_org_units_with_ancestors called for 50 IDs: ['OkLwuZ0WpVb', 'DNc692bmAk8', 'pXRws5D6wrR', 'jhAIyaJHXEJ', 'xErihzThO6h']...
2025-12-18 13:17:55,491:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching org units batch 1/1
2025-12-18 13:17:56,512:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetched 50 org units, found 50 ancestor IDs from paths
2025-12-18 13:17:56,513:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching 50 missing ancestors
2025-12-18 13:17:57,556:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Final result: 100 names, 100 levels, 100 parents
2025-12-18 13:17:57,557:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] fetch_org_units_with_ancestors called for 50 IDs: ['FNTxj1oKTQd', 'EJCiKQCS6WT', 'huR6kAEICw4', 'cdVSJIameMk', 'ASNnd0et215']...
2025-12-18 13:17:57,557:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching org units batch 1/1
2025-12-18 13:17:58,574:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetched 50 org units, found 51 ancestor IDs from paths
2025-12-18 13:17:58,574:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching 47 missing ancestors
2025-12-18 13:17:59,544:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Final result: 97 names, 97 levels, 97 parents
2025-12-18 13:17:59,545:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] fetch_org_units_with_ancestors called for 50 IDs: ['aVbYZpMDz2f', 'SMkx58aUYtC', 'ALL4sSTGBRn', 'Osw7UTwSksE', 'EmP1TgdHCnS']...
2025-12-18 13:17:59,545:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching org units batch 1/1
2025-12-18 13:18:00,467:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetched 50 org units, found 53 ancestor IDs from paths
2025-12-18 13:18:00,467:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching 50 missing ancestors
2025-12-18 13:18:01,493:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Final result: 100 names, 100 levels, 100 parents
2025-12-18 13:18:01,494:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] fetch_org_units_with_ancestors called for 50 IDs: ['qKVewTpVtG6', 'av9D2n2epXS', 'cerLt5Xg4P9', 'i6CIBWCCnRQ', 'AgYgZ65N9vd']...
2025-12-18 13:18:01,494:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching org units batch 1/1
2025-12-18 13:18:02,558:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetched 50 org units, found 54 ancestor IDs from paths
2025-12-18 13:18:02,558:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching 51 missing ancestors
2025-12-18 13:18:04,627:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Final result: 101 names, 101 levels, 101 parents
2025-12-18 13:18:04,628:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] fetch_org_units_with_ancestors called for 50 IDs: ['IoTKrKIPsRz', 'Myd1djyMQG5', 'q7s1d5LzgWc', 'XBRMWAS3FO2', 'RHk4V3ZlFbx']...
2025-12-18 13:18:04,629:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching org units batch 1/1
2025-12-18 13:18:05,740:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetched 50 org units, found 52 ancestor IDs from paths
2025-12-18 13:18:05,740:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching 49 missing ancestors
2025-12-18 13:18:06,768:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Final result: 99 names, 99 levels, 99 parents
2025-12-18 13:18:06,768:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] fetch_org_units_with_ancestors called for 50 IDs: ['Du5ZInfaPW0', 'aoD5b237vol', 'AljBYYOCrhQ', 'aIul7gx7RmZ', 'o4ERFQpXLCM']...
2025-12-18 13:18:06,768:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching org units batch 1/1
2025-12-18 13:18:07,784:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetched 50 org units, found 59 ancestor IDs from paths
2025-12-18 13:18:07,784:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching 56 missing ancestors
2025-12-18 13:18:09,660:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Final result: 106 names, 106 levels, 106 parents
2025-12-18 13:18:09,660:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] fetch_org_units_with_ancestors called for 50 IDs: ['aXyuXVfPhwz', 'EITWZ2b7fRb', 'COaxzbRhsBA', 'k4NnCKx6UY9', 'LcDCJ8enDPT']...
2025-12-18 13:18:09,660:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching org units batch 1/1
2025-12-18 13:18:10,620:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetched 50 org units, found 54 ancestor IDs from paths
2025-12-18 13:18:10,620:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching 52 missing ancestors
2025-12-18 13:18:12,537:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Final result: 102 names, 102 levels, 102 parents
2025-12-18 13:18:12,539:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] fetch_org_units_with_ancestors called for 50 IDs: ['GLbWzyzBfzw', 'kJ8CMUMloVu', 'BJXJyNCFAl2', 'rYNfPnt4Wko', 'BqmsCq2bJXK']...
2025-12-18 13:18:12,539:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching org units batch 1/1
2025-12-18 13:18:13,592:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetched 50 org units, found 56 ancestor IDs from paths
2025-12-18 13:18:13,592:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching 55 missing ancestors
2025-12-18 13:18:15,445:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Final result: 105 names, 105 levels, 105 parents
2025-12-18 13:18:15,446:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] fetch_org_units_with_ancestors called for 50 IDs: ['hUjYHzn0Rl0', 'COHtAqML4yd', 'D8FP89iQcBM', 'FGnMVMPBCLN', 'a8kHG8t6bY6']...
2025-12-18 13:18:15,446:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching org units batch 1/1
2025-12-18 13:18:16,389:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetched 50 org units, found 58 ancestor IDs from paths
2025-12-18 13:18:16,389:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching 56 missing ancestors
2025-12-18 13:18:19,110:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Final result: 106 names, 106 levels, 106 parents
2025-12-18 13:18:19,110:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] fetch_org_units_with_ancestors called for 29 IDs: ['v3S6pvqS63U', 'wHXti4lneOb', 'l1UGueRWDTc', 'H3LpQ7tdT1P', 'JryqknC2SNp']...
2025-12-18 13:18:19,110:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching org units batch 1/1
2025-12-18 13:18:20,000:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetched 29 org units, found 41 ancestor IDs from paths
2025-12-18 13:18:20,000:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching 41 missing ancestors
2025-12-18 13:18:20,984:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Final result: 70 names, 70 levels, 70 parents
2025-12-18 13:18:20,984:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Building hierarchy for 1129 org units
2025-12-18 13:18:20,984:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] ou_names has 1132 entries, ou_levels has 1132 entries, ou_parents has 1132 entries
2025-12-18 13:18:20,985:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Sample: id=QpXYf9Wb3CQ, name=Pajimo Military Health Centre II, level=5, parent=I0Dnu8MNpI6
2025-12-18 13:18:20,988:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Built hierarchy: 1129 entries, 1129 with ancestors, 0 empty
2025-12-18 13:18:20,989:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Sample hierarchy for QpXYf9Wb3CQ: {'level': 5, 'ancestors_by_level': {5: 'QpXYf9Wb3CQ', 4: 'I0Dnu8MNpI6', 3: 'pnTVIF5v27r', 2: 'SUvODYOcaVf', 1: 'akV6429SUqu'}}
2025-12-18 13:18:20,989:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Level range: 1 to 5
2025-12-18 13:18:21,064:INFO:superset.databases.api:[DHIS2 Chart Data] Processed 3319 rows
2025-12-18 13:18:21,065:INFO:superset.databases.api:[DHIS2 Chart Data] Returning 3319 rows, 15 columns
2025-12-18 13:18:21,096:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:18:21] "POST /api/v1/database/2/dhis2_chart_data/ HTTP/1.1" 200 -
2025-12-18 13:18:57,664:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:18:57] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 13:19:04,552:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:19:04] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 13:19:08,545:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:19:08] "PUT /api/v1/explore/form_data/ULWSeaI5Yyo?tab_id=2 HTTP/1.1" 200 -
2025-12-18 13:19:08,547:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:19:08] "[31m[1mPOST /api/v1/chart/data HTTP/1.1[0m" 400 -
2025-12-18 13:19:09,460:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:19:09] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 13:21:14,025:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:21:14] "[35m[1mGET /static/assets/spa.cb33bae9113050e32071.hot-update.json HTTP/1.1[0m" 204 -
2025-12-18 13:21:14,620:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:21:14] "GET /api/v1/database/?q=(filters:!((col:database_name,opr:neq,value:examples))) HTTP/1.1" 200 -
2025-12-18 13:21:14,620:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:21:14] "GET /api/v1/database/?q=(filters:!((col:allow_file_upload,opr:upload_is_enabled,value:!t))) HTTP/1.1" 200 -
2025-12-18 13:21:14,645:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:21:14] "GET /api/v1/database/?q=(filters:!((col:database_name,opr:neq,value:examples))) HTTP/1.1" 200 -
2025-12-18 13:21:14,648:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:21:14] "GET /api/v1/database/?q=(filters:!((col:allow_file_upload,opr:upload_is_enabled,value:!t))) HTTP/1.1" 200 -
2025-12-18 13:21:15,571:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:21:15] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 13:22:24,531:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:22:24] "GET /explore/?form_data_key=ULWSeaI5Yyo&datasource_type=table&datasource_id=4 HTTP/1.1" 200 -
2025-12-18 13:22:33,787:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:22:33] "GET /api/v1/database/?q=(filters:!((col:allow_file_upload,opr:upload_is_enabled,value:!t))) HTTP/1.1" 200 -
2025-12-18 13:22:33,854:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:22:33] "GET /api/v1/database/?q=(filters:!((col:database_name,opr:neq,value:examples))) HTTP/1.1" 200 -
2025-12-18 13:22:34,698:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:22:34] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 13:22:34,713:INFO:superset.db_engine_specs.dhis2:[DHIS2] get_parameters_from_uri called
2025-12-18 13:22:34,713:ERROR:superset.db_engine_specs.dhis2:[DHIS2] Failed to extract parameters from URI: 'URL' object has no attribute 'decode'
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/superset/db_engine_specs/dhis2.py", line 361, in get_parameters_from_uri
    parsed = urlparse(uri)
             ^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/urllib/parse.py", line 394, in urlparse
    url, scheme, _coerce_result = _coerce_args(url, scheme)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/urllib/parse.py", line 133, in _coerce_args
    return _decode_args(args) + (_encode_result,)
           ^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/urllib/parse.py", line 117, in _decode_args
    return tuple(x.decode(encoding, errors) if x else '' for x in args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/urllib/parse.py", line 117, in <genexpr>
    return tuple(x.decode(encoding, errors) if x else '' for x in args)
                 ^^^^^^^^
AttributeError: 'URL' object has no attribute 'decode'
2025-12-18 13:22:34,725:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:22:34] "GET /api/v1/explore/?form_data_key=ULWSeaI5Yyo&datasource_type=table&datasource_id=4 HTTP/1.1" 200 -
2025-12-18 13:22:35,327:ERROR:superset.models.helpers:[METRICS-TRACE] Processing 1 metrics
2025-12-18 13:22:35,327:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 0: adhoc - SUM(105-EP01b. Malaria Total)
2025-12-18 13:22:35,328:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105-EP01b. Malaria Total)
2025-12-18 13:22:35,328:ERROR:superset.models.helpers:[METRICS-TRACE] Total metrics added: 1
2025-12-18 13:22:35,329:ERROR:superset.models.helpers:[METRICS-TRACE] Before dedup: 1 select_exprs + 1 metrics_exprs
2025-12-18 13:22:35,329:ERROR:superset.models.helpers:[METRICS-TRACE] After dedup: 2 total select_exprs
2025-12-18 13:22:35,329:INFO:superset.models.helpers:[COLUMN_TRACE] SQL Query Building:
2025-12-18 13:22:35,330:INFO:superset.models.helpers:[COLUMN_TRACE]   columns: ['District']
2025-12-18 13:22:35,330:INFO:superset.models.helpers:[COLUMN_TRACE]   metrics: [{'aggregate': 'SUM', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01b_Malaria_Total', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 40, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'column', 'type_generic': 0, 'uuid': '5da7ec93-b44e-48b9-8004-7d62a62c5ac0', 'verbose_name': '105-EP01b. Malaria Total', 'warning_markdown': None}, 'datasourceWarning': False, 'expressionType': 'SIMPLE', 'hasCustomLabel': False, 'label': 'SUM(105-EP01b. Malaria Total)', 'optionName': 'metric_k9q7silao1_oi8evqrbvi', 'sqlExpression': None}]
2025-12-18 13:22:35,330:INFO:superset.models.helpers:[COLUMN_TRACE]   groupby: []
2025-12-18 13:22:35,330:INFO:superset.models.helpers:[COLUMN_TRACE]   labels_expected: ['District', 'SUM(105-EP01b. Malaria Total)']
2025-12-18 13:22:35,330:INFO:superset.models.helpers:[COLUMN_TRACE]   select_exprs count: 2
2025-12-18 13:22:35,330:INFO:superset.models.helpers:[COLUMN_TRACE]     [0] key=District, name=District, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-18 13:22:35,330:INFO:superset.models.helpers:[COLUMN_TRACE]     [1] key=SUM(105-EP01b. Malaria Total), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-18 13:22:35,330:INFO:superset.connectors.sqla.models:[DHIS2] get_from_clause for virtual dataset 4: analytics 20251217-3246
2025-12-18 13:22:35,330:INFO:superset.connectors.sqla.models:[DHIS2] Full SQL stored: SELECT * FROM analytics
/* DHIS2: table=analytics&dx=JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&pe=LAST_5_YEARS&ou=F1o6qBSx783;SUvODYOcaVf&ouMode=DESCENDANTS */
2025-12-18 13:22:35,331:INFO:superset.connectors.sqla.models:[DHIS2] Loaded params from extra field: table=analytics&dx=JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&pe=LAST_5_YEARS&ou=F1o6qBSx783;SUvO
2025-12-18 13:22:35,332:INFO:superset.connectors.sqla.models:[DHIS2] Cached params with key: dhis2_params_4_analytics
2025-12-18 13:22:35,332:INFO:superset.connectors.sqla.models:[DHIS2] Stored params in Flask g for DHIS2 table: analytics
2025-12-18 13:22:35,350:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Query execution in connectors/sqla/models.py:
2025-12-18 13:22:35,350:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   SQL (first 500 chars): SELECT "District", sum("105_EP01b_Malaria_Total") AS sum_1 
FROM (SELECT * FROM analytics
/* DHIS2: table=analytics&dx=JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&pe=LAST_5_YEARS&ou=F1o6qBSx783;SUvODYOcaVf&ouMode=DESCENDANTS */
) AS virtual_table GROUP BY "District" ORDER BY sum("105_EP01b_Malaria_Total") DESC
 LIMIT 10000
2025-12-18 13:22:35,350:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   labels_expected: ['District', 'SUM(105-EP01b. Malaria Total)']
2025-12-18 13:22:35,354:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 connection initialized: https://tests.dhis2.hispuganda.org/hmis/api
2025-12-18 13:22:35,355:INFO:superset.db_engine_specs.dhis2_dialect:Executing DHIS2 query: SELECT
  "District",
  SUM("105_EP01b_Malaria_Total") AS sum_1
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "District"
ORDER BY
  SUM("105_EP01b_Malaria_Total") DESC
LIMIT 10000
2025-12-18 13:22:35,356:INFO:superset.db_engine_specs.dhis2_dialect:Parsed endpoint: analytics
2025-12-18 13:22:35,356:INFO:superset.db_engine_specs.dhis2_dialect:Using stored parameters from Flask g for table: analytics
2025-12-18 13:22:35,357:INFO:superset.db_engine_specs.dhis2_dialect:Query params: {'table': 'analytics', 'dx': 'JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX', 'pe': 'LAST_5_YEARS', 'ou': 'F1o6qBSx783;SUvODYOcaVf', 'ouMode': 'DESCENDANTS'}
2025-12-18 13:22:35,357:INFO:superset.db_engine_specs.dhis2_dialect:Period dimension detected - omitting startDate/endDate (DHIS2 API rule)
2025-12-18 13:22:35,357:INFO:superset.db_engine_specs.dhis2_dialect:Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dx': 'JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX', 'pe': 'LAST_5_YEARS', 'ou': 'F1o6qBSx783;SUvODYOcaVf', 'ouMode': 'DESCENDANTS'}
2025-12-18 13:22:35,359:INFO:superset.db_engine_specs.dhis2_cache:[DHIS2 Cache] FileSystem backend initialized: /Users/stephocay/projects/hispuganda/superset/superset_home/dhis2_cache
2025-12-18 13:22:35,359:INFO:superset.db_engine_specs.dhis2_cache:[DHIS2 Cache] Using FileSystem backend
2025-12-18 13:22:35,891:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:22:35] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 13:22:35,960:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:22:35] "[35m[1mPOST /api/v1/explore/form_data?tab_id=2 HTTP/1.1[0m" 201 -
2025-12-18 13:22:36,279:INFO:superset.db_engine_specs.dhis2_dialect:Fetched org unit levels: {3: 'District', 5: 'Health Facility', 1: 'National', 2: 'Region', 4: 'Sub County/Town Council/Div'}
2025-12-18 13:22:37,198:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Using all_levels scope: ['LEVEL-3', 'LEVEL-4', 'LEVEL-5']
2025-12-18 13:22:37,199:INFO:superset.db_engine_specs.dhis2_dialect:Converted dx/pe/ou to dimension parameter: dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX;pe:LAST_5_YEARS;ou:F1o6qBSx783;SUvODYOcaVf;LEVEL-3;LEVEL-4;LEVEL-5
2025-12-18 13:22:37,199:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API request (cache miss): https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&dimension=pe:LAST_5_YEARS&dimension=ou:F1o6qBSx783;SUvODYOcaVf;LEVEL-3;LEVEL-4;LEVEL-5
2025-12-18 13:22:40,100:INFO:superset.db_engine_specs.dhis2_cache:[DHIS2 Cache] SET: analytics (ttl=3600s, key=dhis2:4a1c3321:analytics:5362e2052855...)
2025-12-18 13:22:40,101:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2 Cache] Stored response for analytics
2025-12-18 13:22:40,107:INFO:superset.db_engine_specs.dhis2_dialect:Using wide/pivoted format for analytics
2025-12-18 13:22:40,912:INFO:superset.db_engine_specs.dhis2_dialect:Fetched org unit levels: {3: 'District', 5: 'Health Facility', 1: 'National', 2: 'Region', 4: 'Sub County/Town Council/Div'}
2025-12-18 13:22:40,914:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] _fetch_org_unit_hierarchy: Fetching 1142 unique org units in batches...
2025-12-18 13:23:03,541:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Fetched 1142 org units, found 301 parent IDs
2025-12-18 13:23:03,543:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Iteration 1: Fetching 2 missing parent org units...
2025-12-18 13:23:04,515:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Iteration 2: Fetching 1 missing parent org units...
2025-12-18 13:23:05,377:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total org unit names available: 1145
2025-12-18 13:23:05,383:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Sample hierarchy for QpXYf9Wb3CQ: {'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Kitgum District', 'level_4': 'Labongo Akwang Subcounty', 'level_5': 'Pajimo Military Health Centre II', 'level_6': None}
2025-12-18 13:23:05,383:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] _fetch_org_unit_hierarchy completed: 1142 org units with hierarchy
2025-12-18 13:23:05,384:INFO:superset.db_engine_specs.dhis2_dialect:normalize_analytics called with pivot=True, returning WIDE format
2025-12-18 13:23:05,403:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column construction - data_elements: ['AuAOIfCuBUp', 'BWZFz9RJRPI', 'D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'gHjJrtw9vQX', 'pRZrTLDN7Ge', 'wUDxFVBapIc']
2025-12-18 13:23:05,404:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column names constructed (SANITIZED): ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 13:23:05,405:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] FIRST ROW CONSTRUCTION:
2025-12-18 13:23:05,405:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   Period (index 0): 2020
2025-12-18 13:23:05,405:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   108-EP01a.2. Malaria Total (Deaths) (index 6): None
2025-12-18 13:23:05,405:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   108-EP01a.1. Malaria Total (Cases) (index 7): 3
2025-12-18 13:23:05,405:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01b. Malaria Total (index 8): 1580
2025-12-18 13:23:05,405:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01a. Suspected fever (index 9): 6695
2025-12-18 13:23:05,406:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01d. Malaria cases treated (index 10): 1560
2025-12-18 13:23:05,406:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   108-EP01b.2. Malaria Confirmed (Microscopic &RDT) (Deaths) (index 11): None
2025-12-18 13:23:05,406:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   108-EP01b.1. Malaria Confirmed (Microscopic &RDT) (Cases) (index 12): 3
2025-12-18 13:23:05,406:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01c. Malaria Confirmed (B/s and RDT Positive) (index 13): 1579
2025-12-18 13:23:05,416:INFO:superset.db_engine_specs.dhis2_dialect:First pivoted row - Period: '2020'
2025-12-18 13:23:05,416:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total pivoted rows: 4437, columns: 14
[DHIS2] Executing query: SELECT
  "District",
  SUM("105_EP01b_Malaria_Total") AS sum_1
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "District"
ORDER BY
  SUM("105_EP01b_Malaria_Total") DESC
LIMIT 10000
[DHIS2] Parsed endpoint: analytics
[DHIS2] Found params in Flask g for analytics: table=analytics&dx=JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7
[DHIS2] Query params: {'table': 'analytics', 'dx': 'JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX', 'pe': 'LAST_5_YEARS', 'ou': 'F1o6qBSx783;SUvODYOcaVf', 'ouMode': 'DESCENDANTS'}
[DHIS2] Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dx': 'JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX', 'pe': 'LAST_5_YEARS', 'ou': 'F1o6qBSx783;SUvODYOcaVf', 'ouMode': 'DESCENDANTS'}
[DHIS2] Using all_levels scope: ['LEVEL-3', 'LEVEL-4', 'LEVEL-5']
[DHIS2] ðŸ”„ CACHE MISS - API request URL: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&dimension=pe:LAST_5_YEARS&dimension=ou:F1o6qBSx783;SUvODYOcaVf;LEVEL-3;LEVEL-4;LEVEL-5
[DHIS2] Raw API response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Raw DHIS2 rows count: 22727
[DHIS2] First raw row: ['JhvC7ZR9hUe', '2022', 'C0RSe3EWBqU', '246166']
[DHIS2] âœ… Cached response for analytics (API took 4732.2ms)
[DHIS2] Parsing response for endpoint: analytics
[DHIS2] Response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Response sample: {'headers': [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}], 'metaDat
[DHIS2] Using WIDE/PIVOTED format (Period, Level_1_Name, Level_2_Name, ..., DX1, DX2, ...) for analytics
[DHIS2] Analytics headers: [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}]
[DHIS2] Found 'ou' column at index 2
[DHIS2] Processing 22727 rows to extract org unit IDs
[DHIS2] Extracted 1142 unique org unit IDs from rows
[DHIS2] Found 1142 unique org units in analytics response
[DHIS2] Fetching hierarchy for 1142 org units...
[DHIS2] _fetch_org_unit_hierarchy: Fetching 1142 unique org units
[DHIS2] Batch 1: Got 50 org units from DHIS2
[DHIS2]   OU: SFDIr8urO72, name=Alim Health Centre II, level=5, parent=ayMSTn5sz80
[DHIS2]   OU: P2sdfoxH0a7, name=Angaya Health Centre III, level=5, parent=Anb2BySBeLP
[DHIS2]   OU: arbBXd1KN8n, name=Awere Health Centre III, level=5, parent=OkLwuZ0WpVb
[DHIS2] Batch 2: Got 50 org units from DHIS2
[DHIS2] Batch 3: Got 50 org units from DHIS2
[DHIS2] Batch 4: Got 50 org units from DHIS2
[DHIS2] Batch 5: Got 50 org units from DHIS2
[DHIS2] Batch 6: Got 50 org units from DHIS2
[DHIS2] Batch 7: Got 50 org units from DHIS2
[DHIS2] Batch 8: Got 50 org units from DHIS2
[DHIS2] Batch 9: Got 50 org units from DHIS2
[DHIS2] Batch 10: Got 50 org units from DHIS2
[DHIS2] Batch 11: Got 50 org units from DHIS2
[DHIS2] Batch 12: Got 50 org units from DHIS2
[DHIS2] Batch 13: Got 50 org units from DHIS2
[DHIS2] Batch 14: Got 50 org units from DHIS2
[DHIS2] Batch 15: Got 50 org units from DHIS2
[DHIS2] Batch 16: Got 50 org units from DHIS2
[DHIS2] Batch 17: Got 50 org units from DHIS2
[DHIS2] Batch 18: Got 50 org units from DHIS2
[DHIS2] Batch 19: Got 50 org units from DHIS2
[DHIS2] Batch 20: Got 50 org units from DHIS2
[DHIS2] Batch 21: Got 50 org units from DHIS2
[DHIS2] Batch 22: Got 50 org units from DHIS2
[DHIS2] Batch 23: Got 42 org units from DHIS2
[DHIS2] Total org unit names available: 1145 after 2 iterations
[DHIS2] Sample hierarchy for QpXYf9Wb3CQ: {'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Kitgum District', 'level_4': 'Labongo Akwang Subcounty', 'level_5': 'Pajimo Military Health Centre II', 'level_6': None}
[DHIS2]   QpXYf9Wb3CQ: filled levels = ['level_1', 'level_2', 'level_3', 'level_4', 'level_5']
[DHIS2]   a9ZI6jNBqXx: filled levels = ['level_1', 'level_2', 'level_3', 'level_4', 'level_5']
[DHIS2]   acQJJL9aUo0: filled levels = ['level_1', 'level_2', 'level_3', 'level_4']
[DHIS2] Fetched hierarchy for 1142 org units
[DHIS2] Sample hierarchy for QpXYf9Wb3CQ: {'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Kitgum District', 'level_4': 'Labongo Akwang Subcounty', 'level_5': 'Pajimo Military Health Centre II', 'level_6': None}
[DHIS2] Calling DHIS2ResponseNormalizer.normalize with:
[DHIS2]   - endpoint: analytics
[DHIS2]   - pivot: True
[DHIS2]   - org_unit_hierarchy: 1142 entries
[DHIS2]   - org_unit_level_names: {3: 'District', 5: 'Health Facility', 1: 'National', 2: 'Region', 4: 'Sub County/Town Council/Div'}
[DHIS2] normalize_analytics: pivot=True, using WIDE/PIVOTED format
[DHIS2] PIVOT CONSTRUCTION:
[DHIS2]   data_elements (UIDs): ['AuAOIfCuBUp', 'BWZFz9RJRPI', 'D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'gHjJrtw9vQX', 'pRZrTLDN7Ge', 'wUDxFVBapIc']
[DHIS2]   data_element_list (sorted UIDs): ['AuAOIfCuBUp', 'BWZFz9RJRPI', 'D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'gHjJrtw9vQX', 'pRZrTLDN7Ge', 'wUDxFVBapIc']
[DHIS2]   col_names (SANITIZED): ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Row 0: OU=AA8TRyfTwtn, hierarchy_info={'level_1': 'MOH - Uganda', 'level_2': 'Ankole', 'level_3': 'Rwampara District', 'level_4': 'Mwizi Subcounty', 'level_5': None, 'level_6': None}
[DHIS2] Row 1: OU=AJxamlmKn2x, hierarchy_info={'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Amuru District', 'level_4': 'Lamogi Subcounty', 'level_5': 'Keyo Health Centre II', 'level_6': None}
[DHIS2] Row 2: OU=ALL4sSTGBRn, hierarchy_info={'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Gulu District', 'level_4': 'Owalo Subcounty', 'level_5': None, 'level_6': None}
[DHIS2] Normalized columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized row count: 4437
[DHIS2] First row: ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
[DHIS2] _set_description: original=['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], sanitized=['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], types=['String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String']2025-12-18 13:23:05,417:INFO:superset.db_engine_specs.dhis2_dialect:Normalized 4437 rows with 14 columns for endpoint analytics
2025-12-18 13:23:05,417:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API returned 4437 rows
2025-12-18 13:23:05,437:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() - Row count: 4437
2025-12-18 13:23:05,437:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 13:23:05,437:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names length: 14
2025-12-18 13:23:05,437:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values count: 14
2025-12-18 13:23:05,437:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values: ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
2025-12-18 13:23:05,437:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 0 (Period): 2020 -> 2020 (STRING)
2025-12-18 13:23:05,437:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (National): 'MOH - Uganda...' -> STRING (non-numeric detected)
2025-12-18 13:23:05,438:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (National): MOH - Uganda (PROCESSED)
2025-12-18 13:23:05,438:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (Region): 'Ankole...' -> STRING (non-numeric detected)
2025-12-18 13:23:05,438:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (Region): Ankole (PROCESSED)
2025-12-18 13:23:05,438:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (District): 'Rwampara District...' -> STRING (non-numeric detected)
2025-12-18 13:23:05,438:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (District): Rwampara District (PROCESSED)
2025-12-18 13:23:05,438:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (Sub_County_Town_Council_Div): 'Mwizi Subcounty...' -> STRING (non-numeric detected)
2025-12-18 13:23:05,438:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (Sub_County_Town_Council_Div): Mwizi Subcounty (PROCESSED)
2025-12-18 13:23:05,450:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() returning 4437 rows with 14 columns each
2025-12-18 13:23:05,450:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Got 4437 rows from cursor
2025-12-18 13:23:05,450:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: First row: ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
2025-12-18 13:23:05,450:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 13:23:05,450:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Types from cursor: ['String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String']
2025-12-18 13:23:05,491:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: DataFrame created with 4437 rows, 14 columns
2025-12-18 13:23:05,491:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 13:23:05,492:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes BEFORE fix: {'Period': dtype('O'), 'National': dtype('O'), 'Region': dtype('O'), 'District': dtype('O'), 'Sub_County_Town_Council_Div': dtype('O'), 'Health_Facility': dtype('O'), '108_EP01a_2_Malaria_Total_Deaths': dtype('O'), '108_EP01a_1_Malaria_Total_Cases': dtype('O'), '105_EP01b_Malaria_Total': dtype('O'), '105_EP01a_Suspected_fever': dtype('O'), '105_EP01d_Malaria_cases_treated': dtype('O'), '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths': dtype('O'), '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases': dtype('O'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('O')}
2025-12-18 13:23:05,500:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Period' to object dtype (dimension)
2025-12-18 13:23:05,501:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'National' as dimension (contains non-numeric string: 'MOH - Uganda...')
2025-12-18 13:23:05,501:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'National' to object dtype (dimension)
2025-12-18 13:23:05,502:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'Region' as dimension (contains non-numeric string: 'Ankole...')
2025-12-18 13:23:05,502:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Region' to object dtype (dimension)
2025-12-18 13:23:05,502:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'District' as dimension (contains non-numeric string: 'Rwampara District...')
2025-12-18 13:23:05,502:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'District' to object dtype (dimension)
2025-12-18 13:23:05,503:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'Sub_County_Town_Council_Div' as dimension (contains non-numeric string: 'Mwizi Subcounty...')
2025-12-18 13:23:05,503:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Sub_County_Town_Council_Div' to object dtype (dimension)
2025-12-18 13:23:05,503:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'Health_Facility' as dimension (contains non-numeric string: 'Keyo Health Centre II...')
2025-12-18 13:23:05,503:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Health_Facility' to object dtype (dimension)
2025-12-18 13:23:05,505:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes AFTER fix: {'Period': dtype('O'), 'National': dtype('O'), 'Region': dtype('O'), 'District': dtype('O'), 'Sub_County_Town_Council_Div': dtype('O'), 'Health_Facility': dtype('O'), '108_EP01a_2_Malaria_Total_Deaths': dtype('O'), '108_EP01a_1_Malaria_Total_Cases': dtype('O'), '105_EP01b_Malaria_Total': dtype('O'), '105_EP01a_Suspected_fever': dtype('O'), '105_EP01d_Malaria_cases_treated': dtype('O'), '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths': dtype('O'), '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases': dtype('O'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('O')}
2025-12-18 13:23:05,505:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: First row: {'Period': '2020', 'National': 'MOH - Uganda', 'Region': 'Ankole', 'District': 'Rwampara District', 'Sub_County_Town_Council_Div': 'Mwizi Subcounty', 'Health_Facility': None, '108_EP01a_2_Malaria_Total_Deaths': None, '108_EP01a_1_Malaria_Total_Cases': 3, '105_EP01b_Malaria_Total': 1580, '105_EP01a_Suspected_fever': 6695, '105_EP01d_Malaria_cases_treated': 1560, '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths': None, '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases': 3, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 1579}
2025-12-18 13:23:05,512:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] BEFORE assign_column_label:
2025-12-18 13:23:05,512:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4437, 14)
2025-12-18 13:23:05,512:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 13:23:05,512:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['District', 'SUM(105-EP01b. Malaria Total)']
2025-12-18 13:23:05,512:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: False
2025-12-18 13:23:05,512:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Period': '2020', 'National': 'MOH - Uganda', 'Region': 'Ankole', 'District': 'Rwampara District', 'Sub_County_Town_Council_Div': 'Mwizi Subcounty', 'Health_Facility': None, '108_EP01a_2_Malaria_Total_Deaths': None, '108_EP01a_1_Malaria_Total_Cases': 3, '105_EP01b_Malaria_Total': 1580, '105_EP01a_Suspected_fever': 6695, '105_EP01d_Malaria_cases_treated': 1560, '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths': None, '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases': 3, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 1579}
2025-12-18 13:23:05,513:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Column truncation needed: df has 14 columns, expected 2
2025-12-18 13:23:05,513:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   DataFrame actual columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 13:23:05,513:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Expected columns: ['District', 'SUM(105-EP01b. Malaria Total)']
2025-12-18 13:23:05,513:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] âœ“ Selecting columns BY NAME (matched all expected columns)
2025-12-18 13:23:05,513:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Column mapping: {'District': 'District', 'SUM(105-EP01b. Malaria Total)': '105_EP01b_Malaria_Total'}
2025-12-18 13:23:05,517:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] Column Selection âœ“ SUCCESS - method=BY_NAME, datasource=analytics 20251217-3246
2025-12-18 13:23:05,517:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['District', 'SUM(105-EP01b. Malaria Total)']
2025-12-18 13:23:05,517:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   tried_by_name=True, success=True, fallback=False
2025-12-18 13:23:05,517:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Assigning column labels: ['District', 'SUM(105-EP01b. Malaria Total)']
2025-12-18 13:23:05,517:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] AFTER assign_column_label:
2025-12-18 13:23:05,518:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4437, 2)
2025-12-18 13:23:05,518:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['District', 'SUM(105-EP01b. Malaria Total)']
2025-12-18 13:23:05,518:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['District', 'SUM(105-EP01b. Malaria Total)']
2025-12-18 13:23:05,518:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: True
2025-12-18 13:23:05,518:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'District': 'Rwampara District', 'SUM(105-EP01b. Malaria Total)': 1580}
2025-12-18 13:23:05,541:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:23:05] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-18 13:23:05,690:ERROR:superset.models.helpers:[METRICS-TRACE] Processing 1 metrics
2025-12-18 13:23:05,691:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 0: adhoc - SUM(105-EP01b. Malaria Total)
2025-12-18 13:23:05,691:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105-EP01b. Malaria Total)
2025-12-18 13:23:05,691:ERROR:superset.models.helpers:[METRICS-TRACE] Total metrics added: 1
2025-12-18 13:23:05,692:ERROR:superset.models.helpers:[METRICS-TRACE] Before dedup: 1 select_exprs + 1 metrics_exprs
2025-12-18 13:23:05,692:ERROR:superset.models.helpers:[METRICS-TRACE] After dedup: 2 total select_exprs
2025-12-18 13:23:05,692:INFO:superset.models.helpers:[COLUMN_TRACE] SQL Query Building:
2025-12-18 13:23:05,692:INFO:superset.models.helpers:[COLUMN_TRACE]   columns: ['District']
2025-12-18 13:23:05,692:INFO:superset.models.helpers:[COLUMN_TRACE]   metrics: [{'aggregate': 'SUM', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01b_Malaria_Total', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 40, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'column', 'type_generic': 0, 'uuid': '5da7ec93-b44e-48b9-8004-7d62a62c5ac0', 'verbose_name': '105-EP01b. Malaria Total', 'warning_markdown': None}, 'datasourceWarning': False, 'expressionType': 'SIMPLE', 'hasCustomLabel': False, 'label': 'SUM(105-EP01b. Malaria Total)', 'optionName': 'metric_k9q7silao1_oi8evqrbvi', 'sqlExpression': None}]
2025-12-18 13:23:05,692:INFO:superset.models.helpers:[COLUMN_TRACE]   groupby: []
2025-12-18 13:23:05,692:INFO:superset.models.helpers:[COLUMN_TRACE]   labels_expected: ['District', 'SUM(105-EP01b. Malaria Total)']
2025-12-18 13:23:05,692:INFO:superset.models.helpers:[COLUMN_TRACE]   select_exprs count: 2
2025-12-18 13:23:05,692:INFO:superset.models.helpers:[COLUMN_TRACE]     [0] key=District, name=District, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-18 13:23:05,692:INFO:superset.models.helpers:[COLUMN_TRACE]     [1] key=SUM(105-EP01b. Malaria Total), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-18 13:23:05,693:INFO:superset.connectors.sqla.models:[DHIS2] get_from_clause for virtual dataset 4: analytics 20251217-3246
2025-12-18 13:23:05,693:INFO:superset.connectors.sqla.models:[DHIS2] Full SQL stored: SELECT * FROM analytics
/* DHIS2: table=analytics&dx=JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&pe=LAST_5_YEARS&ou=F1o6qBSx783;SUvODYOcaVf&ouMode=DESCENDANTS */
2025-12-18 13:23:05,693:INFO:superset.connectors.sqla.models:[DHIS2] Loaded params from extra field: table=analytics&dx=JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&pe=LAST_5_YEARS&ou=F1o6qBSx783;SUvO
2025-12-18 13:23:05,695:INFO:superset.connectors.sqla.models:[DHIS2] Cached params with key: dhis2_params_4_analytics
2025-12-18 13:23:05,695:INFO:superset.connectors.sqla.models:[DHIS2] Stored params in Flask g for DHIS2 table: analytics
2025-12-18 13:23:05,701:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Query execution in connectors/sqla/models.py:
2025-12-18 13:23:05,701:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   SQL (first 500 chars): SELECT "District", sum("105_EP01b_Malaria_Total") AS sum_1 
FROM (SELECT * FROM analytics
/* DHIS2: table=analytics&dx=JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&pe=LAST_5_YEARS&ou=F1o6qBSx783;SUvODYOcaVf&ouMode=DESCENDANTS */
) AS virtual_table GROUP BY "District" ORDER BY sum("105_EP01b_Malaria_Total") DESC
 LIMIT 10000
2025-12-18 13:23:05,702:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   labels_expected: ['District', 'SUM(105-EP01b. Malaria Total)']
2025-12-18 13:23:05,705:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 connection initialized: https://tests.dhis2.hispuganda.org/hmis/api
2025-12-18 13:23:05,706:INFO:superset.db_engine_specs.dhis2_dialect:Executing DHIS2 query: SELECT
  "District",
  SUM("105_EP01b_Malaria_Total") AS sum_1
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "District"
ORDER BY
  SUM("105_EP01b_Malaria_Total") DESC
LIMIT 10000
2025-12-18 13:23:05,706:INFO:superset.db_engine_specs.dhis2_dialect:Parsed endpoint: analytics
2025-12-18 13:23:05,706:INFO:superset.db_engine_specs.dhis2_dialect:Using stored parameters from Flask g for table: analytics
2025-12-18 13:23:05,706:INFO:superset.db_engine_specs.dhis2_dialect:Query params: {'table': 'analytics', 'dx': 'JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX', 'pe': 'LAST_5_YEARS', 'ou': 'F1o6qBSx783;SUvODYOcaVf', 'ouMode': 'DESCENDANTS'}
2025-12-18 13:23:05,706:INFO:superset.db_engine_specs.dhis2_dialect:Period dimension detected - omitting startDate/endDate (DHIS2 API rule)
2025-12-18 13:23:05,707:INFO:superset.db_engine_specs.dhis2_dialect:Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dx': 'JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX', 'pe': 'LAST_5_YEARS', 'ou': 'F1o6qBSx783;SUvODYOcaVf', 'ouMode': 'DESCENDANTS'}
2025-12-18 13:23:06,549:INFO:superset.db_engine_specs.dhis2_dialect:Fetched org unit levels: {3: 'District', 5: 'Health Facility', 1: 'National', 2: 'Region', 4: 'Sub County/Town Council/Div'}
2025-12-18 13:23:06,597:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:23:06] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 13:23:07,470:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Using all_levels scope: ['LEVEL-3', 'LEVEL-4', 'LEVEL-5']
2025-12-18 13:23:07,470:INFO:superset.db_engine_specs.dhis2_dialect:Converted dx/pe/ou to dimension parameter: dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX;pe:LAST_5_YEARS;ou:F1o6qBSx783;SUvODYOcaVf;LEVEL-3;LEVEL-4;LEVEL-5
2025-12-18 13:23:07,470:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API request (cache miss): https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&dimension=pe:LAST_5_YEARS&dimension=ou:F1o6qBSx783;SUvODYOcaVf;LEVEL-3;LEVEL-4;LEVEL-5
2025-12-18 13:23:17,421:INFO:superset.db_engine_specs.dhis2_cache:[DHIS2 Cache] SET: analytics (ttl=3600s, key=dhis2:4a1c3321:analytics:5362e2052855...)
2025-12-18 13:23:17,421:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2 Cache] Stored response for analytics
2025-12-18 13:23:17,429:INFO:superset.db_engine_specs.dhis2_dialect:Using wide/pivoted format for analytics
2025-12-18 13:23:18,328:INFO:superset.db_engine_specs.dhis2_dialect:Fetched org unit levels: {3: 'District', 5: 'Health Facility', 1: 'National', 2: 'Region', 4: 'Sub County/Town Council/Div'}
2025-12-18 13:23:18,329:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] _fetch_org_unit_hierarchy: Fetching 1142 unique org units in batches...
2025-12-18 13:23:39,879:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Fetched 1142 org units, found 301 parent IDs
2025-12-18 13:23:39,880:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Iteration 1: Fetching 2 missing parent org units...
2025-12-18 13:23:40,798:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Iteration 2: Fetching 1 missing parent org units...
2025-12-18 13:23:41,716:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total org unit names available: 1145
2025-12-18 13:23:41,725:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Sample hierarchy for QpXYf9Wb3CQ: {'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Kitgum District', 'level_4': 'Labongo Akwang Subcounty', 'level_5': 'Pajimo Military Health Centre II', 'level_6': None}
2025-12-18 13:23:41,725:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] _fetch_org_unit_hierarchy completed: 1142 org units with hierarchy
2025-12-18 13:23:41,726:INFO:superset.db_engine_specs.dhis2_dialect:normalize_analytics called with pivot=True, returning WIDE format
2025-12-18 13:23:41,747:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column construction - data_elements: ['AuAOIfCuBUp', 'BWZFz9RJRPI', 'D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'gHjJrtw9vQX', 'pRZrTLDN7Ge', 'wUDxFVBapIc']
2025-12-18 13:23:41,747:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column names constructed (SANITIZED): ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 13:23:41,749:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] FIRST ROW CONSTRUCTION:
2025-12-18 13:23:41,749:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   Period (index 0): 2020
2025-12-18 13:23:41,749:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   108-EP01a.2. Malaria Total (Deaths) (index 6): None
2025-12-18 13:23:41,749:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   108-EP01a.1. Malaria Total (Cases) (index 7): 3
2025-12-18 13:23:41,749:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01b. Malaria Total (index 8): 1580
2025-12-18 13:23:41,749:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01a. Suspected fever (index 9): 6695
2025-12-18 13:23:41,749:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01d. Malaria cases treated (index 10): 1560
2025-12-18 13:23:41,749:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   108-EP01b.2. Malaria Confirmed (Microscopic &RDT) (Deaths) (index 11): None
2025-12-18 13:23:41,749:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   108-EP01b.1. Malaria Confirmed (Microscopic &RDT) (Cases) (index 12): 3
2025-12-18 13:23:41,749:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01c. Malaria Confirmed (B/s and RDT Positive) (index 13): 1579
2025-12-18 13:23:41,759:INFO:superset.db_engine_specs.dhis2_dialect:First pivoted row - Period: '2020'
2025-12-18 13:23:41,759:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total pivoted rows: 4437, columns: 14

[DHIS2] Transformed rows count: 4437
[DHIS2] First transformed row: ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
[DHIS2] Fetched 4437 rows
[DHIS2] fetchall() called - returning 4437 rows
[DHIS2] fetchall() - First row type: <class 'tuple'>
[DHIS2] fetchall() - First row (original): ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
[DHIS2] fetchall() - Column count from description: 14
[DHIS2] fetchall() - First row (fixed types): ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
[DHIS2] fetchall() - Type enforcement: dimensions=STRING, measures=FLOAT
[DHIS2] Executing query: SELECT
  "District",
  SUM("105_EP01b_Malaria_Total") AS sum_1
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "District"
ORDER BY
  SUM("105_EP01b_Malaria_Total") DESC
LIMIT 10000
[DHIS2] Parsed endpoint: analytics
[DHIS2] Found params in Flask g for analytics: table=analytics&dx=JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7
[DHIS2] Query params: {'table': 'analytics', 'dx': 'JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX', 'pe': 'LAST_5_YEARS', 'ou': 'F1o6qBSx783;SUvODYOcaVf', 'ouMode': 'DESCENDANTS'}
[DHIS2] Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dx': 'JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX', 'pe': 'LAST_5_YEARS', 'ou': 'F1o6qBSx783;SUvODYOcaVf', 'ouMode': 'DESCENDANTS'}
[DHIS2] Using all_levels scope: ['LEVEL-3', 'LEVEL-4', 'LEVEL-5']
[DHIS2] ðŸ”„ CACHE MISS - API request URL: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&dimension=pe:LAST_5_YEARS&dimension=ou:F1o6qBSx783;SUvODYOcaVf;LEVEL-3;LEVEL-4;LEVEL-5
[DHIS2] Raw API response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Raw DHIS2 rows count: 22727
[DHIS2] First raw row: ['JhvC7ZR9hUe', '2022', 'C0RSe3EWBqU', '246166']
[DHIS2] âœ… Cached response for analytics (API took 11701.5ms)
[DHIS2] Parsing response for endpoint: analytics
[DHIS2] Response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Response sample: {'headers': [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}], 'metaDat
[DHIS2] Using WIDE/PIVOTED format (Period, Level_1_Name, Level_2_Name, ..., DX1, DX2, ...) for analytics
[DHIS2] Analytics headers: [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}]
[DHIS2] Found 'ou' column at index 2
[DHIS2] Processing 22727 rows to extract org unit IDs
[DHIS2] Extracted 1142 unique org unit IDs from rows
[DHIS2] Found 1142 unique org units in analytics response
[DHIS2] Fetching hierarchy for 1142 org units...
[DHIS2] _fetch_org_unit_hierarchy: Fetching 1142 unique org units
[DHIS2] Batch 1: Got 50 org units from DHIS2
[DHIS2]   OU: SFDIr8urO72, name=Alim Health Centre II, level=5, parent=ayMSTn5sz80
[DHIS2]   OU: P2sdfoxH0a7, name=Angaya Health Centre III, level=5, parent=Anb2BySBeLP
[DHIS2]   OU: arbBXd1KN8n, name=Awere Health Centre III, level=5, parent=OkLwuZ0WpVb
[DHIS2] Batch 2: Got 50 org units from DHIS2
[DHIS2] Batch 3: Got 50 org units from DHIS2
[DHIS2] Batch 4: Got 50 org units from DHIS2
[DHIS2] Batch 5: Got 50 org units from DHIS2
[DHIS2] Batch 6: Got 50 org units from DHIS2
[DHIS2] Batch 7: Got 50 org units from DHIS2
[DHIS2] Batch 8: Got 50 org units from DHIS2
[DHIS2] Batch 9: Got 50 org units from DHIS2
[DHIS2] Batch 10: Got 50 org units from DHIS2
[DHIS2] Batch 11: Got 50 org units from DHIS2
[DHIS2] Batch 12: Got 50 org units from DHIS2
[DHIS2] Batch 13: Got 50 org units from DHIS2
[DHIS2] Batch 14: Got 50 org units from DHIS2
[DHIS2] Batch 15: Got 50 org units from DHIS2
[DHIS2] Batch 16: Got 50 org units from DHIS2
[DHIS2] Batch 17: Got 50 org units from DHIS2
[DHIS2] Batch 18: Got 50 org units from DHIS2
[DHIS2] Batch 19: Got 50 org units from DHIS2
[DHIS2] Batch 20: Got 50 org units from DHIS2
[DHIS2] Batch 21: Got 50 org units from DHIS2
[DHIS2] Batch 22: Got 50 org units from DHIS2
[DHIS2] Batch 23: Got 42 org units from DHIS2
[DHIS2] Total org unit names available: 1145 after 2 iterations
[DHIS2] Sample hierarchy for QpXYf9Wb3CQ: {'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Kitgum District', 'level_4': 'Labongo Akwang Subcounty', 'level_5': 'Pajimo Military Health Centre II', 'level_6': None}
[DHIS2]   QpXYf9Wb3CQ: filled levels = ['level_1', 'level_2', 'level_3', 'level_4', 'level_5']
[DHIS2]   a9ZI6jNBqXx: filled levels = ['level_1', 'level_2', 'level_3', 'level_4', 'level_5']
[DHIS2]   acQJJL9aUo0: filled levels = ['level_1', 'level_2', 'level_3', 'level_4']
[DHIS2] Fetched hierarchy for 1142 org units
[DHIS2] Sample hierarchy for QpXYf9Wb3CQ: {'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Kitgum District', 'level_4': 'Labongo Akwang Subcounty', 'level_5': 'Pajimo Military Health Centre II', 'level_6': None}
[DHIS2] Calling DHIS2ResponseNormalizer.normalize with:
[DHIS2]   - endpoint: analytics
[DHIS2]   - pivot: True
[DHIS2]   - org_unit_hierarchy: 1142 entries
[DHIS2]   - org_unit_level_names: {3: 'District', 5: 'Health Facility', 1: 'National', 2: 'Region', 4: 'Sub County/Town Council/Div'}
[DHIS2] normalize_analytics: pivot=True, using WIDE/PIVOTED format
[DHIS2] PIVOT CONSTRUCTION:
[DHIS2]   data_elements (UIDs): ['AuAOIfCuBUp', 'BWZFz9RJRPI', 'D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'gHjJrtw9vQX', 'pRZrTLDN7Ge', 'wUDxFVBapIc']
[DHIS2]   data_element_list (sorted UIDs): ['AuAOIfCuBUp', 'BWZFz9RJRPI', 'D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'gHjJrtw9vQX', 'pRZrTLDN7Ge', 'wUDxFVBapIc']
[DHIS2]   col_names (SANITIZED): ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Row 0: OU=AA8TRyfTwtn, hierarchy_info={'level_1': 'MOH - Uganda', 'level_2': 'Ankole', 'level_3': 'Rwampara District', 'level_4': 'Mwizi Subcounty', 'level_5': None, 'level_6': None}
[DHIS2] Row 1: OU=AJxamlmKn2x, hierarchy_info={'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Amuru District', 'level_4': 'Lamogi Subcounty', 'level_5': 'Keyo Health Centre II', 'level_6': None}
[DHIS2] Row 2: OU=ALL4sSTGBRn, hierarchy_info={'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Gulu District', 'level_4': 'Owalo Subcounty', 'level_5': None, 'level_6': None}
[DHIS2] Normalized columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']2025-12-18 13:23:41,760:INFO:superset.db_engine_specs.dhis2_dialect:Normalized 4437 rows with 14 columns for endpoint analytics
2025-12-18 13:23:41,760:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API returned 4437 rows
2025-12-18 13:23:41,771:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() - Row count: 4437
2025-12-18 13:23:41,772:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 13:23:41,772:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names length: 14
2025-12-18 13:23:41,772:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values count: 14
2025-12-18 13:23:41,772:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values: ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
2025-12-18 13:23:41,772:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 0 (Period): 2020 -> 2020 (STRING)
2025-12-18 13:23:41,772:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (National): 'MOH - Uganda...' -> STRING (non-numeric detected)
2025-12-18 13:23:41,772:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (National): MOH - Uganda (PROCESSED)
2025-12-18 13:23:41,772:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (Region): 'Ankole...' -> STRING (non-numeric detected)
2025-12-18 13:23:41,772:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (Region): Ankole (PROCESSED)
2025-12-18 13:23:41,772:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (District): 'Rwampara District...' -> STRING (non-numeric detected)
2025-12-18 13:23:41,772:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (District): Rwampara District (PROCESSED)
2025-12-18 13:23:41,772:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (Sub_County_Town_Council_Div): 'Mwizi Subcounty...' -> STRING (non-numeric detected)
2025-12-18 13:23:41,772:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (Sub_County_Town_Council_Div): Mwizi Subcounty (PROCESSED)
2025-12-18 13:23:41,785:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() returning 4437 rows with 14 columns each
2025-12-18 13:23:41,785:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Got 4437 rows from cursor
2025-12-18 13:23:41,785:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: First row: ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
2025-12-18 13:23:41,786:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 13:23:41,786:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Types from cursor: ['String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String']
2025-12-18 13:23:41,793:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: DataFrame created with 4437 rows, 14 columns
2025-12-18 13:23:41,793:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 13:23:41,793:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes BEFORE fix: {'Period': dtype('O'), 'National': dtype('O'), 'Region': dtype('O'), 'District': dtype('O'), 'Sub_County_Town_Council_Div': dtype('O'), 'Health_Facility': dtype('O'), '108_EP01a_2_Malaria_Total_Deaths': dtype('O'), '108_EP01a_1_Malaria_Total_Cases': dtype('O'), '105_EP01b_Malaria_Total': dtype('O'), '105_EP01a_Suspected_fever': dtype('O'), '105_EP01d_Malaria_cases_treated': dtype('O'), '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths': dtype('O'), '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases': dtype('O'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('O')}
2025-12-18 13:23:41,794:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Period' to object dtype (dimension)
2025-12-18 13:23:41,794:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'National' as dimension (contains non-numeric string: 'MOH - Uganda...')
2025-12-18 13:23:41,795:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'National' to object dtype (dimension)
2025-12-18 13:23:41,795:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'Region' as dimension (contains non-numeric string: 'Ankole...')
2025-12-18 13:23:41,795:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Region' to object dtype (dimension)
2025-12-18 13:23:41,795:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'District' as dimension (contains non-numeric string: 'Rwampara District...')
2025-12-18 13:23:41,796:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'District' to object dtype (dimension)
2025-12-18 13:23:41,796:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'Sub_County_Town_Council_Div' as dimension (contains non-numeric string: 'Mwizi Subcounty...')
2025-12-18 13:23:41,796:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Sub_County_Town_Council_Div' to object dtype (dimension)
2025-12-18 13:23:41,796:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'Health_Facility' as dimension (contains non-numeric string: 'Keyo Health Centre II...')
2025-12-18 13:23:41,796:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Health_Facility' to object dtype (dimension)
2025-12-18 13:23:41,798:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes AFTER fix: {'Period': dtype('O'), 'National': dtype('O'), 'Region': dtype('O'), 'District': dtype('O'), 'Sub_County_Town_Council_Div': dtype('O'), 'Health_Facility': dtype('O'), '108_EP01a_2_Malaria_Total_Deaths': dtype('O'), '108_EP01a_1_Malaria_Total_Cases': dtype('O'), '105_EP01b_Malaria_Total': dtype('O'), '105_EP01a_Suspected_fever': dtype('O'), '105_EP01d_Malaria_cases_treated': dtype('O'), '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths': dtype('O'), '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases': dtype('O'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('O')}
2025-12-18 13:23:41,798:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: First row: {'Period': '2020', 'National': 'MOH - Uganda', 'Region': 'Ankole', 'District': 'Rwampara District', 'Sub_County_Town_Council_Div': 'Mwizi Subcounty', 'Health_Facility': None, '108_EP01a_2_Malaria_Total_Deaths': None, '108_EP01a_1_Malaria_Total_Cases': 3, '105_EP01b_Malaria_Total': 1580, '105_EP01a_Suspected_fever': 6695, '105_EP01d_Malaria_cases_treated': 1560, '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths': None, '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases': 3, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 1579}
2025-12-18 13:23:41,801:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] BEFORE assign_column_label:
2025-12-18 13:23:41,801:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4437, 14)
2025-12-18 13:23:41,801:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 13:23:41,801:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['District', 'SUM(105-EP01b. Malaria Total)']
2025-12-18 13:23:41,801:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: False
2025-12-18 13:23:41,801:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Period': '2020', 'National': 'MOH - Uganda', 'Region': 'Ankole', 'District': 'Rwampara District', 'Sub_County_Town_Council_Div': 'Mwizi Subcounty', 'Health_Facility': None, '108_EP01a_2_Malaria_Total_Deaths': None, '108_EP01a_1_Malaria_Total_Cases': 3, '105_EP01b_Malaria_Total': 1580, '105_EP01a_Suspected_fever': 6695, '105_EP01d_Malaria_cases_treated': 1560, '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths': None, '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases': 3, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 1579}
2025-12-18 13:23:41,801:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Column truncation needed: df has 14 columns, expected 2
2025-12-18 13:23:41,801:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   DataFrame actual columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 13:23:41,801:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Expected columns: ['District', 'SUM(105-EP01b. Malaria Total)']
2025-12-18 13:23:41,801:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] âœ“ Selecting columns BY NAME (matched all expected columns)
2025-12-18 13:23:41,801:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Column mapping: {'District': 'District', 'SUM(105-EP01b. Malaria Total)': '105_EP01b_Malaria_Total'}
2025-12-18 13:23:41,802:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] Column Selection âœ“ SUCCESS - method=BY_NAME, datasource=analytics 20251217-3246
2025-12-18 13:23:41,802:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['District', 'SUM(105-EP01b. Malaria Total)']
2025-12-18 13:23:41,802:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   tried_by_name=True, success=True, fallback=False
2025-12-18 13:23:41,802:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Assigning column labels: ['District', 'SUM(105-EP01b. Malaria Total)']
2025-12-18 13:23:41,802:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] AFTER assign_column_label:
2025-12-18 13:23:41,802:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4437, 2)
2025-12-18 13:23:41,802:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['District', 'SUM(105-EP01b. Malaria Total)']
2025-12-18 13:23:41,802:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['District', 'SUM(105-EP01b. Malaria Total)']
2025-12-18 13:23:41,802:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: True
2025-12-18 13:23:41,802:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'District': 'Rwampara District', 'SUM(105-EP01b. Malaria Total)': 1580}
2025-12-18 13:23:41,819:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:23:41] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-18 13:24:09,508:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:24:09] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 13:24:18,064:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:24:18] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 13:24:27,174:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:24:27] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 13:24:30,951:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:24:30] "[31m[1mPOST /api/v1/chart/data HTTP/1.1[0m" 400 -
2025-12-18 13:24:30,953:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:24:30] "[31m[1mPOST /api/v1/chart/data HTTP/1.1[0m" 400 -
2025-12-18 13:24:31,863:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:24:31] "PUT /api/v1/explore/form_data/ULWSeaI5Yyo?tab_id=2 HTTP/1.1" 200 -
2025-12-18 13:24:32,032:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:24:32] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 13:41:40,799:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:41:40] "[31m[1mPOST /api/v1/chart/data HTTP/1.1[0m" 400 -
2025-12-18 13:41:40,800:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:41:40] "[31m[1mPOST /api/v1/chart/data HTTP/1.1[0m" 400 -
2025-12-18 13:41:41,332:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:41:41] "PUT /api/v1/explore/form_data/ULWSeaI5Yyo?tab_id=2 HTTP/1.1" 200 -
2025-12-18 13:41:41,842:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:41:41] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 13:41:42,503:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:41:42] "[31m[1mPOST /api/v1/chart/data HTTP/1.1[0m" 400 -
2025-12-18 13:41:42,518:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:41:42] "[31m[1mPOST /api/v1/chart/data HTTP/1.1[0m" 400 -
2025-12-18 13:41:43,394:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:41:43] "PUT /api/v1/explore/form_data/ULWSeaI5Yyo?tab_id=2 HTTP/1.1" 200 -
2025-12-18 13:41:43,562:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:41:43] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 13:43:15,366:INFO:werkzeug: * Detected change in '/Users/stephocay/projects/hispuganda/superset/superset/common/query_object.py', reloading

[DHIS2] Normalized row count: 4437
[DHIS2] First row: ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
[DHIS2] _set_description: original=['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], sanitized=['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], types=['String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String']
[DHIS2] Transformed rows count: 4437
[DHIS2] First transformed row: ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
[DHIS2] Fetched 4437 rows
[DHIS2] fetchall() called - returning 4437 rows
[DHIS2] fetchall() - First row type: <class 'tuple'>
[DHIS2] fetchall() - First row (original): ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
[DHIS2] fetchall() - Column count from description: 14
[DHIS2] fetchall() - First row (fixed types): ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
[DHIS2] fetchall() - Type enforcement: dimensions=STRING, measures=FLOAT
2025-12-18 13:43:16,958:INFO:werkzeug: * Restarting with watchdog (fsevents)
Loaded your LOCAL configuration at [/Users/stephocay/projects/hispuganda/superset/superset_config.py]
2025-12-18 13:43:19,043:INFO:superset.init_public_dashboards:[Embedded Dashboard] Initialization complete. Total dashboards processed: 1
2025-12-18 13:43:19,044:INFO:alembic.runtime.migration:Context impl SQLiteImpl.
2025-12-18 13:43:19,044:INFO:alembic.runtime.migration:Will assume non-transactional DDL.
2025-12-18 13:43:19,203:INFO:superset.app:Pending database migrations: run 'superset db upgrade'
2025-12-18 13:43:19,597:WARNING:werkzeug: * Debugger is active!
2025-12-18 13:43:19,607:INFO:werkzeug: * Debugger PIN: 114-810-287
2025-12-18 13:43:29,756:WARNING:superset.common.query_object:[DUPLICATE_LABELS] metric_names=['SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))'], column_names=['District', 'District'], duplicates=['District']
2025-12-18 13:43:29,756:WARNING:superset.common.query_object:[DUPLICATE_LABELS] metric_names=['SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))'], column_names=['District', 'District'], duplicates=['District']
2025-12-18 13:43:29,765:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:43:29] "[31m[1mPOST /api/v1/chart/data HTTP/1.1[0m" 400 -
2025-12-18 13:43:29,766:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:43:29] "[31m[1mPOST /api/v1/chart/data HTTP/1.1[0m" 400 -
2025-12-18 13:43:30,639:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:43:30] "PUT /api/v1/explore/form_data/ULWSeaI5Yyo?tab_id=2 HTTP/1.1" 200 -
2025-12-18 13:43:30,775:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:43:30] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 13:43:30,905:WARNING:superset.common.query_object:[DUPLICATE_LABELS] metric_names=['SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))'], column_names=['District', 'District'], duplicates=['District']
2025-12-18 13:43:30,906:WARNING:superset.common.query_object:[DUPLICATE_LABELS] metric_names=['SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))'], column_names=['District', 'District'], duplicates=['District']
2025-12-18 13:43:30,908:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:43:30] "[31m[1mPOST /api/v1/chart/data HTTP/1.1[0m" 400 -
2025-12-18 13:43:30,910:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:43:30] "[31m[1mPOST /api/v1/chart/data HTTP/1.1[0m" 400 -
2025-12-18 13:43:31,877:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:43:31] "PUT /api/v1/explore/form_data/ULWSeaI5Yyo?tab_id=2 HTTP/1.1" 200 -
2025-12-18 13:43:31,916:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:43:31] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 13:47:24,312:INFO:werkzeug: * Detected change in '/Users/stephocay/projects/hispuganda/superset/superset/common/query_object.py', reloading
2025-12-18 13:47:24,969:INFO:werkzeug: * Restarting with watchdog (fsevents)
Loaded your LOCAL configuration at [/Users/stephocay/projects/hispuganda/superset/superset_config.py]
2025-12-18 13:47:26,986:INFO:superset.init_public_dashboards:[Embedded Dashboard] Initialization complete. Total dashboards processed: 1
2025-12-18 13:47:26,987:INFO:alembic.runtime.migration:Context impl SQLiteImpl.
2025-12-18 13:47:26,987:INFO:alembic.runtime.migration:Will assume non-transactional DDL.
2025-12-18 13:47:27,097:INFO:superset.app:Pending database migrations: run 'superset db upgrade'
2025-12-18 13:47:27,496:WARNING:werkzeug: * Debugger is active!
2025-12-18 13:47:27,506:INFO:werkzeug: * Debugger PIN: 114-810-287
2025-12-18 13:47:27,573:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:47:27] "[31m[1mPOST /api/v1/chart/data HTTP/1.1[0m" 400 -
2025-12-18 13:47:27,574:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:47:27] "PUT /api/v1/explore/form_data/ULWSeaI5Yyo?tab_id=2 HTTP/1.1" 200 -
2025-12-18 13:47:27,580:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:47:27] "[31m[1mPOST /api/v1/chart/data HTTP/1.1[0m" 400 -
2025-12-18 13:47:28,613:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 13:47:28] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 14:02:12,085:INFO:werkzeug: * Detected change in '/Users/stephocay/projects/hispuganda/superset/superset/common/query_object.py', reloading
2025-12-18 14:02:13,335:INFO:werkzeug: * Restarting with watchdog (fsevents)
Loaded your LOCAL configuration at [/Users/stephocay/projects/hispuganda/superset/superset_config.py]
2025-12-18 14:02:14,766:INFO:superset.init_public_dashboards:[Embedded Dashboard] Initialization complete. Total dashboards processed: 1
2025-12-18 14:02:14,767:INFO:alembic.runtime.migration:Context impl SQLiteImpl.
2025-12-18 14:02:14,767:INFO:alembic.runtime.migration:Will assume non-transactional DDL.
2025-12-18 14:02:14,874:INFO:superset.app:Pending database migrations: run 'superset db upgrade'
2025-12-18 14:02:15,235:WARNING:werkzeug: * Debugger is active!
2025-12-18 14:02:15,245:INFO:werkzeug: * Debugger PIN: 114-810-287
2025-12-18 14:03:25,584:INFO:werkzeug: * Detected change in '/Users/stephocay/projects/hispuganda/superset/superset/utils/core.py', reloading
2025-12-18 14:03:26,282:INFO:werkzeug: * Restarting with watchdog (fsevents)
Loaded your LOCAL configuration at [/Users/stephocay/projects/hispuganda/superset/superset_config.py]
2025-12-18 14:03:27,862:INFO:superset.init_public_dashboards:[Embedded Dashboard] Initialization complete. Total dashboards processed: 1
2025-12-18 14:03:27,863:INFO:alembic.runtime.migration:Context impl SQLiteImpl.
2025-12-18 14:03:27,863:INFO:alembic.runtime.migration:Will assume non-transactional DDL.
2025-12-18 14:03:28,011:INFO:superset.app:Pending database migrations: run 'superset db upgrade'
2025-12-18 14:03:28,436:WARNING:werkzeug: * Debugger is active!
2025-12-18 14:03:28,449:INFO:werkzeug: * Debugger PIN: 114-810-287
2025-12-18 14:06:07,618:INFO:werkzeug: * Detected change in '/Users/stephocay/projects/hispuganda/superset/superset/common/query_object.py', reloading
2025-12-18 14:06:08,810:INFO:werkzeug: * Restarting with watchdog (fsevents)
Loaded your LOCAL configuration at [/Users/stephocay/projects/hispuganda/superset/superset_config.py]
2025-12-18 14:06:11,017:INFO:superset.init_public_dashboards:[Embedded Dashboard] Initialization complete. Total dashboards processed: 1
2025-12-18 14:06:11,018:INFO:alembic.runtime.migration:Context impl SQLiteImpl.
2025-12-18 14:06:11,018:INFO:alembic.runtime.migration:Will assume non-transactional DDL.
2025-12-18 14:06:11,303:INFO:superset.app:Pending database migrations: run 'superset db upgrade'
2025-12-18 14:06:11,769:WARNING:werkzeug: * Debugger is active!
2025-12-18 14:06:11,779:INFO:werkzeug: * Debugger PIN: 114-810-287
2025-12-18 14:10:59,041:INFO:superset.common.query_object:[QueryObject] Removed 1 duplicate column(s): ['District']. Original count: 2, New count: 1
2025-12-18 14:10:59,041:INFO:superset.common.query_object:[QueryObject] Removed 1 duplicate column(s): ['District']. Original count: 2, New count: 1
2025-12-18 14:10:59,053:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:10:59] "[31m[1mPOST /api/v1/chart/data HTTP/1.1[0m" 400 -
2025-12-18 14:10:59,054:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:10:59] "[31m[1mPOST /api/v1/chart/data HTTP/1.1[0m" 400 -
2025-12-18 14:10:59,893:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:10:59] "PUT /api/v1/explore/form_data/ULWSeaI5Yyo?tab_id=2 HTTP/1.1" 200 -
2025-12-18 14:11:00,068:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:11:00] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 14:11:00,221:INFO:superset.common.query_object:[QueryObject] Removed 1 duplicate column(s): ['District']. Original count: 2, New count: 1
2025-12-18 14:11:00,230:INFO:superset.common.query_object:[QueryObject] Removed 1 duplicate column(s): ['District']. Original count: 2, New count: 1
2025-12-18 14:11:00,263:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:11:00] "[31m[1mPOST /api/v1/chart/data HTTP/1.1[0m" 400 -
2025-12-18 14:11:00,270:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:11:00] "[31m[1mPOST /api/v1/chart/data HTTP/1.1[0m" 400 -
2025-12-18 14:11:01,221:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:11:01] "PUT /api/v1/explore/form_data/ULWSeaI5Yyo?tab_id=2 HTTP/1.1" 200 -
2025-12-18 14:11:01,290:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:11:01] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 14:11:07,642:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:11:07] "GET /explore/?form_data_key=ULWSeaI5Yyo&datasource_type=table&datasource_id=4 HTTP/1.1" 200 -
2025-12-18 14:11:11,022:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:11:11] "GET /api/v1/database/?q=(filters:!((col:allow_file_upload,opr:upload_is_enabled,value:!t))) HTTP/1.1" 200 -
2025-12-18 14:11:11,245:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:11:11] "GET /api/v1/database/?q=(filters:!((col:database_name,opr:neq,value:examples))) HTTP/1.1" 200 -
2025-12-18 14:11:11,850:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:11:11] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 14:11:13,840:INFO:superset.db_engine_specs.dhis2:[DHIS2] get_parameters_from_uri called
2025-12-18 14:11:13,846:ERROR:superset.db_engine_specs.dhis2:[DHIS2] Failed to extract parameters from URI: 'URL' object has no attribute 'decode'
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/superset/db_engine_specs/dhis2.py", line 361, in get_parameters_from_uri
    parsed = urlparse(uri)
             ^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/urllib/parse.py", line 394, in urlparse
    url, scheme, _coerce_result = _coerce_args(url, scheme)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/urllib/parse.py", line 133, in _coerce_args
    return _decode_args(args) + (_encode_result,)
           ^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/urllib/parse.py", line 117, in _decode_args
    return tuple(x.decode(encoding, errors) if x else '' for x in args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/urllib/parse.py", line 117, in <genexpr>
    return tuple(x.decode(encoding, errors) if x else '' for x in args)
                 ^^^^^^^^
AttributeError: 'URL' object has no attribute 'decode'
2025-12-18 14:11:13,964:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:11:13] "GET /api/v1/explore/?form_data_key=ULWSeaI5Yyo&datasource_type=table&datasource_id=4 HTTP/1.1" 200 -
2025-12-18 14:11:15,508:INFO:superset.common.query_object:[QueryObject] Removed 1 duplicate column(s): ['District']. Original count: 2, New count: 1
2025-12-18 14:11:15,554:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:11:15] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 14:11:15,566:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:11:15] "[31m[1mPOST /api/v1/chart/data HTTP/1.1[0m" 400 -
2025-12-18 14:11:15,594:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:11:15] "[35m[1mPOST /api/v1/explore/form_data?tab_id=2 HTTP/1.1[0m" 201 -
2025-12-18 14:11:15,691:INFO:superset.common.query_object:[QueryObject] Removed 1 duplicate column(s): ['District']. Original count: 2, New count: 1
2025-12-18 14:11:15,695:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:11:15] "[31m[1mPOST /api/v1/chart/data HTTP/1.1[0m" 400 -
2025-12-18 14:11:16,929:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:11:16] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 14:11:43,654:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:11:43] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 14:11:44,898:INFO:superset.common.query_object:[QueryObject] Removed 1 duplicate column(s): ['District']. Original count: 2, New count: 1
2025-12-18 14:11:44,904:INFO:superset.common.query_object:[QueryObject] Removed 1 duplicate column(s): ['District']. Original count: 2, New count: 1
2025-12-18 14:11:44,924:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:11:44] "[31m[1mPOST /api/v1/chart/data HTTP/1.1[0m" 400 -
2025-12-18 14:11:44,925:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:11:44] "[31m[1mPOST /api/v1/chart/data HTTP/1.1[0m" 400 -
2025-12-18 14:11:45,844:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:11:45] "PUT /api/v1/explore/form_data/ULWSeaI5Yyo?tab_id=2 HTTP/1.1" 200 -
2025-12-18 14:11:45,947:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:11:45] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 14:11:52,455:INFO:superset.databases.api:[DHIS2 Chart Data] Received SQL: SELECT * FROM analytics
/* DHIS2: table=analytics&dx=JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&pe=LAST_5_YEARS&ou=F1o6qBSx783;SUvODYOcaVf&ouMode=D...
2025-12-18 14:11:52,455:INFO:superset.databases.api:[DHIS2 Chart Data] Requested columns: []
2025-12-18 14:11:52,456:INFO:superset.databases.api:[DHIS2 Chart Data] Parsed params: {'table': 'analytics', 'dx': 'JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX', 'pe': 'LAST_5_YEARS', 'ou': 'F1o6qBSx783;SUvODYOcaVf', 'ouMode': 'DESCENDANTS'}
2025-12-18 14:11:52,456:INFO:superset.databases.api:[DHIS2 Chart Data] ouMode=DESCENDANTS, data_level_scope=all_levels, include_children=True
2025-12-18 14:11:52,456:INFO:superset.databases.api:[DHIS2 Chart Data] Expanded periods: ['2025', '2024', '2023', '2022', '2021']
2025-12-18 14:11:52,461:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 connection initialized: https://tests.dhis2.hispuganda.org/hmis/api
2025-12-18 14:11:52,461:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching org unit levels from: https://tests.dhis2.hispuganda.org/hmis/api/organisationUnitLevels.json?paging=false&fields=id,level,name
2025-12-18 14:11:53,280:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetched 5 org unit levels
2025-12-18 14:11:53,280:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Level 3 -> 'District'
2025-12-18 14:11:53,280:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Level 5 -> 'Health Facility'
2025-12-18 14:11:53,280:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Level 1 -> 'National'
2025-12-18 14:11:53,280:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Level 2 -> 'Region'
2025-12-18 14:11:53,280:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Level 4 -> 'Sub County/Town Council/Div'
2025-12-18 14:11:53,281:INFO:superset.databases.api:[DHIS2 Chart Data] Fetched level_names: {3: 'District', 5: 'Health Facility', 1: 'National', 2: 'Region', 4: 'Sub County/Town Council/Div'}
2025-12-18 14:11:53,281:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching display names for 8 DX items
2025-12-18 14:11:53,281:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Trying dataElements: https://tests.dhis2.hispuganda.org/hmis/api/dataElements.json?filter=id:in:[JhvC7ZR9hUe,D9A0afrTYPw,wUDxFVBapIc,QHnwKs2OUZv,BWZFz9RJRPI,AuAOIfCuBUp,pRZrTLDN7Ge,gHjJrtw9vQX]&fields=id,name,displayName&paging=false
2025-12-18 14:11:54,223:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Found 8 items in dataElements
2025-12-18 14:11:54,223:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] DX: JhvC7ZR9hUe -> '105-EP01a. Suspected fever'
2025-12-18 14:11:54,224:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] DX: D9A0afrTYPw -> '105-EP01b. Malaria Total'
2025-12-18 14:11:54,224:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] DX: wUDxFVBapIc -> '105-EP01c. Malaria Confirmed (B/s and RDT Positive)'
2025-12-18 14:11:54,224:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] DX: QHnwKs2OUZv -> '105-EP01d. Malaria cases treated'
2025-12-18 14:11:54,224:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] DX: BWZFz9RJRPI -> '108-EP01a.1. Malaria Total (Cases)'
2025-12-18 14:11:54,224:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] DX: AuAOIfCuBUp -> '108-EP01a.2. Malaria Total (Deaths)'
2025-12-18 14:11:54,224:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] DX: pRZrTLDN7Ge -> '108-EP01b.1. Malaria Confirmed (Microscopic &RDT) (Cases)'
2025-12-18 14:11:54,224:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] DX: gHjJrtw9vQX -> '108-EP01b.2. Malaria Confirmed (Microscopic &RDT) (Deaths)'
2025-12-18 14:11:54,224:INFO:superset.databases.api:[DHIS2 Chart Data] Fetched dx_names: {'JhvC7ZR9hUe': '105-EP01a. Suspected fever', 'D9A0afrTYPw': '105-EP01b. Malaria Total', 'wUDxFVBapIc': '105-EP01c. Malaria Confirmed (B/s and RDT Positive)', 'QHnwKs2OUZv': '105-EP01d. Malaria cases treated', 'BWZFz9RJRPI': '108-EP01a.1. Malaria Total (Cases)', 'AuAOIfCuBUp': '108-EP01a.2. Malaria Total (Deaths)', 'pRZrTLDN7Ge': '108-EP01b.1. Malaria Confirmed (Microscopic &RDT) (Cases)', 'gHjJrtw9vQX': '108-EP01b.2. Malaria Confirmed (Microscopic &RDT) (Deaths)'}
2025-12-18 14:11:54,224:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] fetch_org_units_with_ancestors called for 2 IDs: ['F1o6qBSx783', 'SUvODYOcaVf']...
2025-12-18 14:11:54,224:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching org units batch 1/1
2025-12-18 14:11:55,103:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetched 2 org units, found 1 ancestor IDs from paths
2025-12-18 14:11:55,103:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching 1 missing ancestors
2025-12-18 14:11:55,966:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Final result: 3 names, 3 levels, 3 parents
2025-12-18 14:11:55,967:INFO:superset.databases.api:[DHIS2 Chart Data] Fetched 3 org units with ancestors
2025-12-18 14:11:55,967:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Max selected level: 2, Data scope: all_levels
2025-12-18 14:11:55,967:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Added LEVEL-3 for all_levels scope
2025-12-18 14:11:55,967:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Added LEVEL-4 for all_levels scope
2025-12-18 14:11:55,967:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Added LEVEL-5 for all_levels scope
2025-12-18 14:11:55,967:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Built ou dimension: F1o6qBSx783;SUvODYOcaVf;LEVEL-3;LEVEL-4;LEVEL-5
2025-12-18 14:11:55,967:INFO:superset.databases.api:[DHIS2 Chart Data] Built ou_dimension: F1o6qBSx783;SUvODYOcaVf;LEVEL-3;LEVEL-4;LEVEL-5
2025-12-18 14:11:55,967:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Building hierarchy for 2 org units
2025-12-18 14:11:55,967:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] ou_names has 3 entries, ou_levels has 3 entries, ou_parents has 3 entries
2025-12-18 14:11:55,967:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Sample: id=F1o6qBSx783, name=Ankole, level=2, parent=akV6429SUqu
2025-12-18 14:11:55,967:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Built hierarchy: 2 entries, 2 with ancestors, 0 empty
2025-12-18 14:11:55,967:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Sample hierarchy for F1o6qBSx783: {'level': 2, 'ancestors_by_level': {2: 'F1o6qBSx783', 1: 'akV6429SUqu'}}
2025-12-18 14:11:55,967:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Level range: 1 to 2
2025-12-18 14:11:55,985:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 connection initialized: https://tests.dhis2.hispuganda.org/hmis/api
2025-12-18 14:11:55,985:INFO:superset.databases.api:[DHIS2 Chart Data] Fetching analytics data with ou_mode=DESCENDANTS...
2025-12-18 14:11:55,986:INFO:superset.db_engine_specs.dhis2_dialect:[Analytics API] Using custom ou dimension: F1o6qBSx783;SUvODYOcaVf;LEVEL-3;LEVEL-4;LEVEL-5
2025-12-18 14:11:55,986:INFO:superset.db_engine_specs.dhis2_dialect:[Analytics API] Using ouMode=DESCENDANTS
2025-12-18 14:11:55,986:INFO:superset.db_engine_specs.dhis2_dialect:[Analytics API] Fetching from https://tests.dhis2.hispuganda.org/hmis/api/analytics with de_ids=['JhvC7ZR9hUe', 'D9A0afrTYPw', 'wUDxFVBapIc', 'QHnwKs2OUZv', 'BWZFz9RJRPI', 'AuAOIfCuBUp', 'pRZrTLDN7Ge', 'gHjJrtw9vQX'], period_ids=['2025', '2024', '2023', '2022', '2021'], ou_ids=['F1o6qBSx783', 'SUvODYOcaVf'], ou_mode=DESCENDANTS
2025-12-18 14:11:58,205:INFO:superset.db_engine_specs.dhis2_dialect:[Analytics API] Response status: success, keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
2025-12-18 14:11:58,206:INFO:superset.db_engine_specs.dhis2_dialect:[Analytics API] Found 16953 raw rows from analytics
2025-12-18 14:11:58,206:INFO:superset.db_engine_specs.dhis2_dialect:[Analytics API] Column indices: dx=0, pe=1, ou=2, value=3
2025-12-18 14:11:58,214:INFO:superset.db_engine_specs.dhis2_dialect:[Analytics API] Pivoted 16953 rows into 3319 unique ou/period combinations
2025-12-18 14:11:58,215:INFO:superset.databases.api:[DHIS2 Chart Data] Total rows from analytics: 3319
2025-12-18 14:11:58,217:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] fetch_org_units_with_ancestors called for 50 IDs: ['oC75kRES5l1', 'Pp5WSDc9OCY', 'Yt5KV7Q0Zp4', 'VV5c8F4HVjw', 'pkhPSHZSnr3']...
2025-12-18 14:11:58,217:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching org units batch 1/1
2025-12-18 14:11:59,176:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetched 50 org units, found 53 ancestor IDs from paths
2025-12-18 14:11:59,176:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching 49 missing ancestors
2025-12-18 14:12:00,159:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Final result: 99 names, 99 levels, 99 parents
2025-12-18 14:12:00,159:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] fetch_org_units_with_ancestors called for 50 IDs: ['Lu7D9BapOxL', 'jkd1XWIp0ZR', 'SBdOpwhkd9j', 'a7lnM83DJGy', 'wMiApjHnWVa']...
2025-12-18 14:12:00,160:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching org units batch 1/1
2025-12-18 14:12:01,132:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetched 50 org units, found 53 ancestor IDs from paths
2025-12-18 14:12:01,133:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching 49 missing ancestors
2025-12-18 14:12:02,127:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Final result: 99 names, 99 levels, 99 parents
2025-12-18 14:12:02,129:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] fetch_org_units_with_ancestors called for 50 IDs: ['UZYxp87I4oX', 'fT98rg0rZFy', 'gEJIdy608EI', 'GIz8taDO0sL', 'DJRzqJrw6hs']...
2025-12-18 14:12:02,129:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching org units batch 1/1
2025-12-18 14:12:03,546:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetched 50 org units, found 57 ancestor IDs from paths
2025-12-18 14:12:03,546:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching 57 missing ancestors
2025-12-18 14:12:05,517:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Final result: 107 names, 107 levels, 107 parents
2025-12-18 14:12:05,518:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] fetch_org_units_with_ancestors called for 50 IDs: ['a4QeS81YJ8z', 'b24YFQUhFfF', 'v3o2Btd8dsv', 'j0I9qHOtVIw', 'p1DN5s8Iw8F']...
2025-12-18 14:12:05,518:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching org units batch 1/1
2025-12-18 14:12:06,467:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetched 50 org units, found 55 ancestor IDs from paths
2025-12-18 14:12:06,467:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching 52 missing ancestors
2025-12-18 14:12:08,318:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Final result: 102 names, 102 levels, 102 parents
2025-12-18 14:12:08,318:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] fetch_org_units_with_ancestors called for 50 IDs: ['OoSjd5RuEQb', 'fS71jg1WYPk', 'p0bIifvmV47', 'OelY0OuJRrh', 'aJNgqIuVpYF']...
2025-12-18 14:12:08,319:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching org units batch 1/1
2025-12-18 14:12:09,326:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetched 50 org units, found 59 ancestor IDs from paths
2025-12-18 14:12:09,326:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching 55 missing ancestors
2025-12-18 14:12:11,122:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Final result: 105 names, 105 levels, 105 parents
2025-12-18 14:12:11,123:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] fetch_org_units_with_ancestors called for 50 IDs: ['rKGazd2JbUJ', 'iQFlnFR0d3Q', 'NImJbGuvUS6', 'h2IH7DjeJ21', 'ND2A0GOnnnY']...
2025-12-18 14:12:11,123:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching org units batch 1/1
2025-12-18 14:12:12,063:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetched 50 org units, found 58 ancestor IDs from paths
2025-12-18 14:12:12,063:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching 57 missing ancestors
2025-12-18 14:12:14,069:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Final result: 107 names, 107 levels, 107 parents
2025-12-18 14:12:14,069:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] fetch_org_units_with_ancestors called for 50 IDs: ['deqUOFQ4Gqn', 'L2U4GtsXEpx', 'a8UqcJq7pdF', 'aKwOiCIvmn5', 'N00TPmBoIls']...
2025-12-18 14:12:14,069:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching org units batch 1/1
2025-12-18 14:12:15,004:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetched 50 org units, found 60 ancestor IDs from paths
2025-12-18 14:12:15,005:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching 59 missing ancestors
2025-12-18 14:12:16,975:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Final result: 109 names, 109 levels, 109 parents
2025-12-18 14:12:16,976:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] fetch_org_units_with_ancestors called for 50 IDs: ['Dk1SkAipwsf', 'e2i5c23d8cq', 'zzl9JUHMQY1', 'KJ7aFxkGCAs', 'RefkDqDX6jq']...
2025-12-18 14:12:16,976:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching org units batch 1/1
2025-12-18 14:12:17,963:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetched 50 org units, found 56 ancestor IDs from paths
2025-12-18 14:12:17,963:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching 53 missing ancestors
2025-12-18 14:12:20,174:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Final result: 103 names, 103 levels, 103 parents
2025-12-18 14:12:20,175:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] fetch_org_units_with_ancestors called for 50 IDs: ['J7hNSRvyUFC', 'aWs3wHPQRRC', 'FGnMVMPBCLN', 'aG2AogxcfRK', 'BMyjKocJfay']...
2025-12-18 14:12:20,176:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching org units batch 1/1
2025-12-18 14:12:21,447:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetched 50 org units, found 56 ancestor IDs from paths
2025-12-18 14:12:21,447:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching 54 missing ancestors
2025-12-18 14:12:23,197:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Final result: 104 names, 104 levels, 104 parents
2025-12-18 14:12:23,198:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] fetch_org_units_with_ancestors called for 50 IDs: ['OnV3pblY9FU', 'eg7f1iNIImj', 'mQjzjx2Vi2y', 'MCcHPIPGtCo', 'aUm6tfxcMHp']...
2025-12-18 14:12:23,199:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching org units batch 1/1
2025-12-18 14:12:24,162:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetched 50 org units, found 58 ancestor IDs from paths
2025-12-18 14:12:24,163:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching 57 missing ancestors
2025-12-18 14:12:26,889:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Final result: 107 names, 107 levels, 107 parents
2025-12-18 14:12:26,890:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] fetch_org_units_with_ancestors called for 50 IDs: ['nfcZPqAomrp', 'EJCiKQCS6WT', 'wAhWIDAZWJ6', 'USWKUPzsxnQ', 'GhrSbqvL2At']...
2025-12-18 14:12:26,890:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching org units batch 1/1
2025-12-18 14:12:27,847:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetched 50 org units, found 56 ancestor IDs from paths
2025-12-18 14:12:27,847:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching 54 missing ancestors
2025-12-18 14:12:31,151:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Final result: 104 names, 104 levels, 104 parents
2025-12-18 14:12:31,153:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] fetch_org_units_with_ancestors called for 50 IDs: ['q7s1d5LzgWc', 'SjgN0hN7sBY', 'COHtAqML4yd', 'OArnksuH9WD', 'ftLtvhHg24p']...
2025-12-18 14:12:31,153:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching org units batch 1/1
2025-12-18 14:12:32,185:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetched 50 org units, found 56 ancestor IDs from paths
2025-12-18 14:12:32,185:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching 55 missing ancestors
2025-12-18 14:12:34,007:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Final result: 105 names, 105 levels, 105 parents
2025-12-18 14:12:34,007:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] fetch_org_units_with_ancestors called for 50 IDs: ['U2iprp1G39M', 'qOIHRAbHyeu', 'sO5sVDlQBUW', 'Qf74g7IuA7j', 'vuUCvVvETWp']...
2025-12-18 14:12:34,007:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching org units batch 1/1
2025-12-18 14:12:35,296:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetched 50 org units, found 55 ancestor IDs from paths
2025-12-18 14:12:35,296:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching 52 missing ancestors
2025-12-18 14:12:37,089:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Final result: 102 names, 102 levels, 102 parents
2025-12-18 14:12:37,089:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] fetch_org_units_with_ancestors called for 50 IDs: ['YasMLjFTmRD', 'iWJI9r3QCDh', 'QL6CPNbpOcH', 'FNTxj1oKTQd', 'tsugXWRXwGu']...
2025-12-18 14:12:37,089:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching org units batch 1/1
2025-12-18 14:12:38,032:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetched 50 org units, found 50 ancestor IDs from paths
2025-12-18 14:12:38,032:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching 45 missing ancestors
2025-12-18 14:12:39,013:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Final result: 95 names, 95 levels, 95 parents
2025-12-18 14:12:39,014:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] fetch_org_units_with_ancestors called for 50 IDs: ['a1QYwgYBhMH', 'UEKVlvKXJAC', 'UGeQEBwyWhV', 'f8JtBXP4GBx', 'R8KkhIkIqWE']...
2025-12-18 14:12:39,014:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching org units batch 1/1
2025-12-18 14:12:40,006:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetched 50 org units, found 60 ancestor IDs from paths
2025-12-18 14:12:40,006:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching 59 missing ancestors
2025-12-18 14:12:43,578:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Final result: 109 names, 109 levels, 109 parents
2025-12-18 14:12:43,579:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] fetch_org_units_with_ancestors called for 50 IDs: ['hhz818sQTkO', 'tGCoh0Vsdhj', 'ZpJgSAyZtkl', 's21e0ARLfsE', 'YRDyruTW7wl']...
2025-12-18 14:12:43,579:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching org units batch 1/1
2025-12-18 14:12:44,565:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetched 50 org units, found 61 ancestor IDs from paths
2025-12-18 14:12:44,565:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching 61 missing ancestors
2025-12-18 14:12:46,366:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Final result: 111 names, 111 levels, 111 parents
2025-12-18 14:12:46,367:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] fetch_org_units_with_ancestors called for 50 IDs: ['z7zg0AlCyHn', 'Avn1mi6BJ58', 'rk5itnVaCHU', 'arxX2Sx69qM', 'czEXg5E8wiX']...
2025-12-18 14:12:46,367:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching org units batch 1/1
2025-12-18 14:12:47,461:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetched 50 org units, found 53 ancestor IDs from paths
2025-12-18 14:12:47,461:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching 52 missing ancestors
2025-12-18 14:12:49,329:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Final result: 102 names, 102 levels, 102 parents
2025-12-18 14:12:49,330:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] fetch_org_units_with_ancestors called for 50 IDs: ['K26vPVPCdhj', 'RPWh7oVz9kg', 'rR2AOks4tG6', 'fnse10SronT', 'UKx3LcUsiuz']...
2025-12-18 14:12:49,330:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching org units batch 1/1
2025-12-18 14:12:50,277:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetched 50 org units, found 64 ancestor IDs from paths
2025-12-18 14:12:50,278:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching 60 missing ancestors
2025-12-18 14:12:52,315:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Final result: 110 names, 110 levels, 110 parents
2025-12-18 14:12:52,316:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] fetch_org_units_with_ancestors called for 50 IDs: ['akpD9KoxPcB', 'H3WUcWzPtWb', 'aXiw1i9etPS', 'pTX9sgiNkqB', 'ZA35ZIXly1S']...
2025-12-18 14:12:52,316:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching org units batch 1/1
2025-12-18 14:12:53,331:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetched 50 org units, found 55 ancestor IDs from paths
2025-12-18 14:12:53,332:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching 52 missing ancestors
2025-12-18 14:12:55,193:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Final result: 102 names, 102 levels, 102 parents
2025-12-18 14:12:55,194:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] fetch_org_units_with_ancestors called for 50 IDs: ['vLujVIJd0j7', 'av9D2n2epXS', 'gnahoaxeI4D', 'aUTx89Nc5z1', 'knT6WKTr4lg']...
2025-12-18 14:12:55,194:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching org units batch 1/1
2025-12-18 14:12:56,153:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetched 50 org units, found 61 ancestor IDs from paths
2025-12-18 14:12:56,153:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching 59 missing ancestors
2025-12-18 14:12:57,918:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Final result: 109 names, 109 levels, 109 parents
2025-12-18 14:12:57,919:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] fetch_org_units_with_ancestors called for 50 IDs: ['o3GWM4VVhQy', 'DIMOQ6yYdSD', 'x5X8VtL2T0e', 'ahIE2es9s39', 'N5mmOltRto8']...
2025-12-18 14:12:57,919:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching org units batch 1/1
2025-12-18 14:12:58,853:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetched 50 org units, found 56 ancestor IDs from paths
2025-12-18 14:12:58,853:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching 53 missing ancestors
2025-12-18 14:13:00,679:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Final result: 103 names, 103 levels, 103 parents
2025-12-18 14:13:00,680:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] fetch_org_units_with_ancestors called for 50 IDs: ['I0Dnu8MNpI6', 'i7JbInoEb2D', 'qjHlE1v9LP6', 'lcG09Rsc1lW', 'DPDFR2NSNL4']...
2025-12-18 14:13:00,680:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching org units batch 1/1
2025-12-18 14:13:01,617:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetched 50 org units, found 51 ancestor IDs from paths
2025-12-18 14:13:01,617:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching 49 missing ancestors
2025-12-18 14:13:02,532:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Final result: 99 names, 99 levels, 99 parents
2025-12-18 14:13:02,532:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] fetch_org_units_with_ancestors called for 29 IDs: ['KFix5BxgoTl', 'eDCF6iUjWqr', 'B9cu6kigJ6f', 'g63Rmtc2Wu8', 'Rwjn2kDDgwf']...
2025-12-18 14:13:02,532:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching org units batch 1/1
2025-12-18 14:13:03,417:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetched 29 org units, found 42 ancestor IDs from paths
2025-12-18 14:13:03,417:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Fetching 42 missing ancestors
2025-12-18 14:13:04,354:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Final result: 71 names, 71 levels, 71 parents
2025-12-18 14:13:04,355:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Building hierarchy for 1129 org units
2025-12-18 14:13:04,355:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] ou_names has 1132 entries, ou_levels has 1132 entries, ou_parents has 1132 entries
2025-12-18 14:13:04,355:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Sample: id=oC75kRES5l1, name=J&T Medical Health Centre II, level=5, parent=C8KGSaxhXaQ
2025-12-18 14:13:04,359:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Built hierarchy: 1129 entries, 1129 with ancestors, 0 empty
2025-12-18 14:13:04,359:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Sample hierarchy for oC75kRES5l1: {'level': 5, 'ancestors_by_level': {5: 'oC75kRES5l1', 4: 'C8KGSaxhXaQ', 3: 'UaR7OHycj8c', 2: 'F1o6qBSx783', 1: 'akV6429SUqu'}}
2025-12-18 14:13:04,360:INFO:superset.databases.dhis2_preview_utils:[DHIS2 Utils] Level range: 1 to 5
2025-12-18 14:13:04,370:INFO:superset.databases.api:[DHIS2 Chart Data] Processed 100 rows
2025-12-18 14:13:04,371:INFO:superset.databases.api:[DHIS2 Chart Data] Returning 100 rows, 15 columns
2025-12-18 14:13:04,381:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:13:04] "POST /api/v1/database/2/dhis2_chart_data/ HTTP/1.1" 200 -
2025-12-18 14:13:19,306:INFO:werkzeug: * Detected change in '/Users/stephocay/projects/hispuganda/superset/superset/common/query_object.py', reloading
2025-12-18 14:13:20,115:INFO:werkzeug: * Restarting with watchdog (fsevents)
Loaded your LOCAL configuration at [/Users/stephocay/projects/hispuganda/superset/superset_config.py]
2025-12-18 14:13:22,027:INFO:superset.init_public_dashboards:[Embedded Dashboard] Initialization complete. Total dashboards processed: 1
2025-12-18 14:13:22,028:INFO:alembic.runtime.migration:Context impl SQLiteImpl.
2025-12-18 14:13:22,028:INFO:alembic.runtime.migration:Will assume non-transactional DDL.
2025-12-18 14:13:22,206:INFO:superset.app:Pending database migrations: run 'superset db upgrade'
2025-12-18 14:13:22,636:WARNING:werkzeug: * Debugger is active!
2025-12-18 14:13:22,645:INFO:werkzeug: * Debugger PIN: 114-810-287
2025-12-18 14:13:51,950:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1458, in dispatch_request
    self.raise_routing_exception(req)
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/app.py", line 1440, in raise_routing_exception
    raise request.routing_exception  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/flask/ctx.py", line 353, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stephocay/projects/hispuganda/superset/.venv/lib/python3.11/site-packages/werkzeug/routing/map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-12-18 14:13:51,957:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:13:51] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-12-18 14:14:35,781:INFO:superset.common.query_object:[QueryObject] Removed 1 duplicate column(s): ['District']. Original count: 2, New count: 1
2025-12-18 14:14:35,960:ERROR:superset.models.helpers:[METRICS-TRACE] Processing 2 metrics
2025-12-18 14:14:35,960:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 0: adhoc - SUM(105-EP01b. Malaria Total)
2025-12-18 14:14:35,960:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105-EP01b. Malaria Total)
2025-12-18 14:14:35,960:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 1: adhoc - SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))
2025-12-18 14:14:35,960:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))
2025-12-18 14:14:35,960:ERROR:superset.models.helpers:[METRICS-TRACE] Total metrics added: 2
2025-12-18 14:14:35,962:ERROR:superset.models.helpers:[METRICS-TRACE] Before dedup: 1 select_exprs + 2 metrics_exprs
2025-12-18 14:14:35,962:ERROR:superset.models.helpers:[METRICS-TRACE] After dedup: 3 total select_exprs
2025-12-18 14:14:35,962:INFO:superset.models.helpers:[COLUMN_TRACE] SQL Query Building:
2025-12-18 14:14:35,962:INFO:superset.models.helpers:[COLUMN_TRACE]   columns: [{'timeGrain': None, 'columnType': 'BASE_AXIS', 'sqlExpression': 'District', 'label': 'District', 'expressionType': 'SQL'}]
2025-12-18 14:14:35,962:INFO:superset.models.helpers:[COLUMN_TRACE]   metrics: [{'aggregate': 'SUM', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01b_Malaria_Total', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 40, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'FLOAT', 'type_generic': 0, 'uuid': '5da7ec93-b44e-48b9-8004-7d62a62c5ac0', 'verbose_name': '105-EP01b. Malaria Total', 'warning_markdown': None}, 'datasourceWarning': False, 'expressionType': 'SIMPLE', 'hasCustomLabel': False, 'label': 'SUM(105-EP01b. Malaria Total)', 'optionName': 'metric_k9q7silao1_oi8evqrbvi', 'sqlExpression': None}, {'aggregate': 'SUM', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 41, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'column', 'type_generic': 0, 'uuid': 'c71fe8aa-92db-4107-a95b-2c7d99fa828a', 'verbose_name': '105-EP01c. Malaria Confirmed (B/s and RDT Positive)', 'warning_markdown': None}, 'datasourceWarning': False, 'expressionType': 'SIMPLE', 'hasCustomLabel': False, 'label': 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))', 'optionName': 'metric_oj8hdui9ylq_nue3d0up82', 'sqlExpression': None}]
2025-12-18 14:14:35,962:INFO:superset.models.helpers:[COLUMN_TRACE]   groupby: []
2025-12-18 14:14:35,962:INFO:superset.models.helpers:[COLUMN_TRACE]   labels_expected: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:14:35,962:INFO:superset.models.helpers:[COLUMN_TRACE]   select_exprs count: 3
2025-12-18 14:14:35,962:INFO:superset.models.helpers:[COLUMN_TRACE]     [0] key=District, name=District, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-18 14:14:35,962:INFO:superset.models.helpers:[COLUMN_TRACE]     [1] key=SUM(105-EP01b. Malaria Total), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-18 14:14:35,962:INFO:superset.models.helpers:[COLUMN_TRACE]     [2] key=SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive)), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-18 14:14:35,962:INFO:superset.connectors.sqla.models:[DHIS2] get_from_clause for virtual dataset 4: analytics 20251217-3246
2025-12-18 14:14:35,962:INFO:superset.connectors.sqla.models:[DHIS2] Full SQL stored: SELECT * FROM analytics
/* DHIS2: table=analytics&dx=JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&pe=LAST_5_YEARS&ou=F1o6qBSx783;SUvODYOcaVf&ouMode=DESCENDANTS */
2025-12-18 14:14:35,962:INFO:superset.connectors.sqla.models:[DHIS2] Loaded params from extra field: table=analytics&dx=JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&pe=LAST_5_YEARS&ou=F1o6qBSx783;SUvO
2025-12-18 14:14:35,963:INFO:superset.connectors.sqla.models:[DHIS2] Cached params with key: dhis2_params_4_analytics
2025-12-18 14:14:35,963:INFO:superset.connectors.sqla.models:[DHIS2] Stored params in Flask g for DHIS2 table: analytics
2025-12-18 14:14:35,966:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Query execution in connectors/sqla/models.py:
2025-12-18 14:14:35,966:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   SQL (first 500 chars): SELECT "District", sum("105_EP01b_Malaria_Total") AS sum_1, sum("105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive") AS sum_2 
FROM (SELECT * FROM analytics
/* DHIS2: table=analytics&dx=JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&pe=LAST_5_YEARS&ou=F1o6qBSx783;SUvODYOcaVf&ouMode=DESCENDANTS */
) AS virtual_table GROUP BY "District" ORDER BY sum("105_EP01b_Malaria_Total") DESC
 LIMIT 10000
2025-12-18 14:14:35,966:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   labels_expected: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:14:35,967:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 connection initialized: https://tests.dhis2.hispuganda.org/hmis/api
2025-12-18 14:14:35,968:INFO:superset.db_engine_specs.dhis2_dialect:Executing DHIS2 query: SELECT
  "District",
  SUM("105_EP01b_Malaria_Total") AS sum_1,
  SUM("105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive") AS sum_2
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "District"
ORDER BY
  SUM("105_EP01b_Malaria_Total") DESC
LIMIT 10000
2025-12-18 14:14:35,968:INFO:superset.db_engine_specs.dhis2_dialect:Parsed endpoint: analytics
2025-12-18 14:14:35,968:INFO:superset.db_engine_specs.dhis2_dialect:Using stored parameters from Flask g for table: analytics
2025-12-18 14:14:35,968:INFO:superset.db_engine_specs.dhis2_dialect:Query params: {'table': 'analytics', 'dx': 'JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX', 'pe': 'LAST_5_YEARS', 'ou': 'F1o6qBSx783;SUvODYOcaVf', 'ouMode': 'DESCENDANTS'}
2025-12-18 14:14:35,968:INFO:superset.db_engine_specs.dhis2_dialect:Period dimension detected - omitting startDate/endDate (DHIS2 API rule)
2025-12-18 14:14:35,968:INFO:superset.db_engine_specs.dhis2_dialect:Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dx': 'JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX', 'pe': 'LAST_5_YEARS', 'ou': 'F1o6qBSx783;SUvODYOcaVf', 'ouMode': 'DESCENDANTS'}
2025-12-18 14:14:35,968:INFO:superset.db_engine_specs.dhis2_cache:[DHIS2 Cache] FileSystem backend initialized: /Users/stephocay/projects/hispuganda/superset/superset_home/dhis2_cache
2025-12-18 14:14:35,968:INFO:superset.db_engine_specs.dhis2_cache:[DHIS2 Cache] Using FileSystem backend
2025-12-18 14:14:36,447:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:14:36] "PUT /api/v1/explore/form_data/ULWSeaI5Yyo?tab_id=2 HTTP/1.1" 200 -
2025-12-18 14:14:36,816:INFO:superset.db_engine_specs.dhis2_dialect:Fetched org unit levels: {3: 'District', 5: 'Health Facility', 1: 'National', 2: 'Region', 4: 'Sub County/Town Council/Div'}
2025-12-18 14:14:37,643:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Using all_levels scope: ['LEVEL-3', 'LEVEL-4', 'LEVEL-5']
2025-12-18 14:14:37,643:INFO:superset.db_engine_specs.dhis2_dialect:Converted dx/pe/ou to dimension parameter: dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX;pe:LAST_5_YEARS;ou:F1o6qBSx783;SUvODYOcaVf;LEVEL-3;LEVEL-4;LEVEL-5
2025-12-18 14:14:37,644:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API request (cache miss): https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&dimension=pe:LAST_5_YEARS&dimension=ou:F1o6qBSx783;SUvODYOcaVf;LEVEL-3;LEVEL-4;LEVEL-5
2025-12-18 14:15:04,055:INFO:superset.db_engine_specs.dhis2_cache:[DHIS2 Cache] SET: analytics (ttl=3600s, key=dhis2:4a1c3321:analytics:5362e2052855...)
2025-12-18 14:15:04,056:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2 Cache] Stored response for analytics
2025-12-18 14:15:04,062:INFO:superset.db_engine_specs.dhis2_dialect:Using wide/pivoted format for analytics
2025-12-18 14:15:06,346:INFO:superset.db_engine_specs.dhis2_dialect:Fetched org unit levels: {3: 'District', 5: 'Health Facility', 1: 'National', 2: 'Region', 4: 'Sub County/Town Council/Div'}
2025-12-18 14:15:06,350:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] _fetch_org_unit_hierarchy: Fetching 1142 unique org units in batches...
2025-12-18 14:15:36,776:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:15:36] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 14:15:40,905:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Fetched 1142 org units, found 301 parent IDs
2025-12-18 14:15:40,905:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Iteration 1: Fetching 2 missing parent org units...
2025-12-18 14:15:41,756:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Iteration 2: Fetching 1 missing parent org units...
2025-12-18 14:15:42,558:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total org unit names available: 1145
2025-12-18 14:15:42,563:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Sample hierarchy for a9NzDoLn9kz: {'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Kitgum District', 'level_4': 'Pager Division', 'level_5': None, 'level_6': None}
2025-12-18 14:15:42,563:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] _fetch_org_unit_hierarchy completed: 1142 org units with hierarchy
2025-12-18 14:15:42,563:INFO:superset.db_engine_specs.dhis2_dialect:normalize_analytics called with pivot=True, returning WIDE format
2025-12-18 14:15:42,578:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column construction - data_elements: ['AuAOIfCuBUp', 'BWZFz9RJRPI', 'D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'gHjJrtw9vQX', 'pRZrTLDN7Ge', 'wUDxFVBapIc']
2025-12-18 14:15:42,578:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column names constructed (SANITIZED): ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:15:42,579:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] FIRST ROW CONSTRUCTION:
2025-12-18 14:15:42,579:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   Period (index 0): 2020
2025-12-18 14:15:42,579:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   108-EP01a.2. Malaria Total (Deaths) (index 6): None
2025-12-18 14:15:42,579:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   108-EP01a.1. Malaria Total (Cases) (index 7): 3
2025-12-18 14:15:42,579:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01b. Malaria Total (index 8): 1580
2025-12-18 14:15:42,579:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01a. Suspected fever (index 9): 6695
2025-12-18 14:15:42,579:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01d. Malaria cases treated (index 10): 1560
2025-12-18 14:15:42,579:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   108-EP01b.2. Malaria Confirmed (Microscopic &RDT) (Deaths) (index 11): None
2025-12-18 14:15:42,579:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   108-EP01b.1. Malaria Confirmed (Microscopic &RDT) (Cases) (index 12): 3
2025-12-18 14:15:42,580:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01c. Malaria Confirmed (B/s and RDT Positive) (index 13): 1579
2025-12-18 14:15:42,587:INFO:superset.db_engine_specs.dhis2_dialect:First pivoted row - Period: '2020'
2025-12-18 14:15:42,587:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total pivoted rows: 4437, columns: 14
[DHIS2] Executing query: SELECT
  "District",
  SUM("105_EP01b_Malaria_Total") AS sum_1,
  SUM("105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive") AS sum_2
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "District"
ORDER BY
  SUM("105_EP01b_Malaria_Total") DESC
LIMIT 10000
[DHIS2] Parsed endpoint: analytics
[DHIS2] Found params in Flask g for analytics: table=analytics&dx=JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7
[DHIS2] Query params: {'table': 'analytics', 'dx': 'JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX', 'pe': 'LAST_5_YEARS', 'ou': 'F1o6qBSx783;SUvODYOcaVf', 'ouMode': 'DESCENDANTS'}
[DHIS2] Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dx': 'JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX', 'pe': 'LAST_5_YEARS', 'ou': 'F1o6qBSx783;SUvODYOcaVf', 'ouMode': 'DESCENDANTS'}
[DHIS2] Using all_levels scope: ['LEVEL-3', 'LEVEL-4', 'LEVEL-5']
[DHIS2] ðŸ”„ CACHE MISS - API request URL: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&dimension=pe:LAST_5_YEARS&dimension=ou:F1o6qBSx783;SUvODYOcaVf;LEVEL-3;LEVEL-4;LEVEL-5
[DHIS2] Raw API response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Raw DHIS2 rows count: 22727
[DHIS2] First raw row: ['JhvC7ZR9hUe', '2022', 'C0RSe3EWBqU', '246166']
[DHIS2] âœ… Cached response for analytics (API took 28078.9ms)
[DHIS2] Parsing response for endpoint: analytics
[DHIS2] Response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Response sample: {'headers': [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}], 'metaDat
[DHIS2] Using WIDE/PIVOTED format (Period, Level_1_Name, Level_2_Name, ..., DX1, DX2, ...) for analytics
[DHIS2] Analytics headers: [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}]
[DHIS2] Found 'ou' column at index 2
[DHIS2] Processing 22727 rows to extract org unit IDs
[DHIS2] Extracted 1142 unique org unit IDs from rows
[DHIS2] Found 1142 unique org units in analytics response
[DHIS2] Fetching hierarchy for 1142 org units...
[DHIS2] _fetch_org_unit_hierarchy: Fetching 1142 unique org units
[DHIS2] Batch 1: Got 50 org units from DHIS2
[DHIS2]   OU: wNunka5Y2uu, name=Acholi-Bur Subcounty, level=4, parent=aBrjuZk0W31
[DHIS2]   OU: FihNC5KfGJV, name=Adilang Subcounty, level=4, parent=ztIyIYAzFKp
[DHIS2]   OU: HSBjlZdFpWn, name=Ajan Subcounty, level=4, parent=aBrjuZk0W31
[DHIS2] Batch 2: Got 50 org units from DHIS2
[DHIS2] Batch 3: Got 50 org units from DHIS2
[DHIS2] Batch 4: Got 50 org units from DHIS2
[DHIS2] Batch 5: Got 50 org units from DHIS2
[DHIS2] Batch 6: Got 50 org units from DHIS2
[DHIS2] Batch 7: Got 50 org units from DHIS2
[DHIS2] Batch 8: Got 50 org units from DHIS2
[DHIS2] Batch 9: Got 50 org units from DHIS2
[DHIS2] Batch 10: Got 50 org units from DHIS2
[DHIS2] Batch 11: Got 50 org units from DHIS2
[DHIS2] Batch 12: Got 50 org units from DHIS2
[DHIS2] Batch 13: Got 50 org units from DHIS2
[DHIS2] Batch 14: Got 50 org units from DHIS2
[DHIS2] Batch 15: Got 50 org units from DHIS2
[DHIS2] Batch 16: Got 50 org units from DHIS2
[DHIS2] Batch 17: Got 50 org units from DHIS2
[DHIS2] Batch 18: Got 50 org units from DHIS2
[DHIS2] Batch 19: Got 50 org units from DHIS2
[DHIS2] Batch 20: Got 50 org units from DHIS2
[DHIS2] Batch 21: Got 50 org units from DHIS2
[DHIS2] Batch 22: Got 50 org units from DHIS2
[DHIS2] Batch 23: Got 42 org units from DHIS2
[DHIS2] Total org unit names available: 1145 after 2 iterations
[DHIS2] Sample hierarchy for a9NzDoLn9kz: {'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Kitgum District', 'level_4': 'Pager Division', 'level_5': None, 'level_6': None}
[DHIS2]   a9NzDoLn9kz: filled levels = ['level_1', 'level_2', 'level_3', 'level_4']
[DHIS2]   aFgrVHVDqoZ: filled levels = ['level_1', 'level_2', 'level_3', 'level_4', 'level_5']
[DHIS2]   fxHApp8UtpE: filled levels = ['level_1', 'level_2', 'level_3', 'level_4', 'level_5']
[DHIS2] Fetched hierarchy for 1142 org units
[DHIS2] Sample hierarchy for a9NzDoLn9kz: {'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Kitgum District', 'level_4': 'Pager Division', 'level_5': None, 'level_6': None}
[DHIS2] Calling DHIS2ResponseNormalizer.normalize with:
[DHIS2]   - endpoint: analytics
[DHIS2]   - pivot: True
[DHIS2]   - org_unit_hierarchy: 1142 entries
[DHIS2]   - org_unit_level_names: {3: 'District', 5: 'Health Facility', 1: 'National', 2: 'Region', 4: 'Sub County/Town Council/Div'}
[DHIS2] normalize_analytics: pivot=True, using WIDE/PIVOTED format
[DHIS2] PIVOT CONSTRUCTION:
[DHIS2]   data_elements (UIDs): ['AuAOIfCuBUp', 'BWZFz9RJRPI', 'D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'gHjJrtw9vQX', 'pRZrTLDN7Ge', 'wUDxFVBapIc']
[DHIS2]   data_element_list (sorted UIDs): ['AuAOIfCuBUp', 'BWZFz9RJRPI', 'D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'gHjJrtw9vQX', 'pRZrTLDN7Ge', 'wUDxFVBapIc']
[DHIS2]   col_names (SANITIZED): ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Row 0: OU=AA8TRyfTwtn, hierarchy_info={'level_1': 'MOH - Uganda', 'level_2': 'Ankole', 'level_3': 'Rwampara District', 'level_4': 'Mwizi Subcounty', 'level_5': None, 'level_6': None}
[DHIS2] Row 1: OU=AJxamlmKn2x, hierarchy_info={'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Amuru District', 'level_4': 'Lamogi Subcounty', 'level_5': 'Keyo Health Centre II', 'level_6': None}
[DHIS2] Row 2: OU=ALL4sSTGBRn, hierarchy_info={'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Gulu District', 'level_4': 'Owalo Subcounty', 'level_5': None, 'level_6': None}
[DHIS2] Normalized columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized row count: 4437
[DHIS2] First row: ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
[DHIS2] _set_description: original=['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], sanitized=['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], types=['String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String']2025-12-18 14:15:42,588:INFO:superset.db_engine_specs.dhis2_dialect:Normalized 4437 rows with 14 columns for endpoint analytics
2025-12-18 14:15:42,588:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API returned 4437 rows
2025-12-18 14:15:42,594:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() - Row count: 4437
2025-12-18 14:15:42,594:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:15:42,594:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names length: 14
2025-12-18 14:15:42,594:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values count: 14
2025-12-18 14:15:42,594:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values: ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
2025-12-18 14:15:42,594:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 0 (Period): 2020 -> 2020 (STRING)
2025-12-18 14:15:42,594:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (National): 'MOH - Uganda...' -> STRING (non-numeric detected)
2025-12-18 14:15:42,594:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (National): MOH - Uganda (PROCESSED)
2025-12-18 14:15:42,594:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (Region): 'Ankole...' -> STRING (non-numeric detected)
2025-12-18 14:15:42,594:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (Region): Ankole (PROCESSED)
2025-12-18 14:15:42,594:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (District): 'Rwampara District...' -> STRING (non-numeric detected)
2025-12-18 14:15:42,594:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (District): Rwampara District (PROCESSED)
2025-12-18 14:15:42,595:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (Sub_County_Town_Council_Div): 'Mwizi Subcounty...' -> STRING (non-numeric detected)
2025-12-18 14:15:42,595:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (Sub_County_Town_Council_Div): Mwizi Subcounty (PROCESSED)
2025-12-18 14:15:42,607:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() returning 4437 rows with 14 columns each
2025-12-18 14:15:42,607:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Got 4437 rows from cursor
2025-12-18 14:15:42,608:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: First row: ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
2025-12-18 14:15:42,608:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:15:42,608:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Types from cursor: ['String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String']
2025-12-18 14:15:42,621:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: DataFrame created with 4437 rows, 14 columns
2025-12-18 14:15:42,621:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:15:42,622:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes BEFORE fix: {'Period': dtype('O'), 'National': dtype('O'), 'Region': dtype('O'), 'District': dtype('O'), 'Sub_County_Town_Council_Div': dtype('O'), 'Health_Facility': dtype('O'), '108_EP01a_2_Malaria_Total_Deaths': dtype('O'), '108_EP01a_1_Malaria_Total_Cases': dtype('O'), '105_EP01b_Malaria_Total': dtype('O'), '105_EP01a_Suspected_fever': dtype('O'), '105_EP01d_Malaria_cases_treated': dtype('O'), '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths': dtype('O'), '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases': dtype('O'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('O')}
2025-12-18 14:15:42,625:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Period' to object dtype (dimension)
2025-12-18 14:15:42,625:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'National' as dimension (contains non-numeric string: 'MOH - Uganda...')
2025-12-18 14:15:42,626:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'National' to object dtype (dimension)
2025-12-18 14:15:42,626:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'Region' as dimension (contains non-numeric string: 'Ankole...')
2025-12-18 14:15:42,626:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Region' to object dtype (dimension)
2025-12-18 14:15:42,626:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'District' as dimension (contains non-numeric string: 'Rwampara District...')
2025-12-18 14:15:42,626:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'District' to object dtype (dimension)
2025-12-18 14:15:42,627:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'Sub_County_Town_Council_Div' as dimension (contains non-numeric string: 'Mwizi Subcounty...')
2025-12-18 14:15:42,627:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Sub_County_Town_Council_Div' to object dtype (dimension)
2025-12-18 14:15:42,627:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'Health_Facility' as dimension (contains non-numeric string: 'Keyo Health Centre II...')
2025-12-18 14:15:42,627:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Health_Facility' to object dtype (dimension)
2025-12-18 14:15:42,629:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes AFTER fix: {'Period': dtype('O'), 'National': dtype('O'), 'Region': dtype('O'), 'District': dtype('O'), 'Sub_County_Town_Council_Div': dtype('O'), 'Health_Facility': dtype('O'), '108_EP01a_2_Malaria_Total_Deaths': dtype('O'), '108_EP01a_1_Malaria_Total_Cases': dtype('O'), '105_EP01b_Malaria_Total': dtype('O'), '105_EP01a_Suspected_fever': dtype('O'), '105_EP01d_Malaria_cases_treated': dtype('O'), '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths': dtype('O'), '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases': dtype('O'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('O')}
2025-12-18 14:15:42,629:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: First row: {'Period': '2020', 'National': 'MOH - Uganda', 'Region': 'Ankole', 'District': 'Rwampara District', 'Sub_County_Town_Council_Div': 'Mwizi Subcounty', 'Health_Facility': None, '108_EP01a_2_Malaria_Total_Deaths': None, '108_EP01a_1_Malaria_Total_Cases': 3, '105_EP01b_Malaria_Total': 1580, '105_EP01a_Suspected_fever': 6695, '105_EP01d_Malaria_cases_treated': 1560, '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths': None, '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases': 3, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 1579}
2025-12-18 14:15:42,632:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] BEFORE assign_column_label:
2025-12-18 14:15:42,632:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4437, 14)
2025-12-18 14:15:42,632:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:15:42,633:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:15:42,633:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: False
2025-12-18 14:15:42,633:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Period': '2020', 'National': 'MOH - Uganda', 'Region': 'Ankole', 'District': 'Rwampara District', 'Sub_County_Town_Council_Div': 'Mwizi Subcounty', 'Health_Facility': None, '108_EP01a_2_Malaria_Total_Deaths': None, '108_EP01a_1_Malaria_Total_Cases': 3, '105_EP01b_Malaria_Total': 1580, '105_EP01a_Suspected_fever': 6695, '105_EP01d_Malaria_cases_treated': 1560, '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths': None, '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases': 3, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 1579}
2025-12-18 14:15:42,633:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Column truncation needed: df has 14 columns, expected 3
2025-12-18 14:15:42,633:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   DataFrame actual columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:15:42,633:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Expected columns: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:15:42,633:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] âœ“ Selecting columns BY NAME (matched all expected columns)
2025-12-18 14:15:42,633:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Column mapping: {'District': 'District', 'SUM(105-EP01b. Malaria Total)': '105_EP01b_Malaria_Total', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))': '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'}
2025-12-18 14:15:42,635:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] Column Selection âœ“ SUCCESS - method=BY_NAME, datasource=analytics 20251217-3246
2025-12-18 14:15:42,635:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:15:42,635:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   tried_by_name=True, success=True, fallback=False
2025-12-18 14:15:42,635:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Assigning column labels: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:15:42,635:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] AFTER assign_column_label:
2025-12-18 14:15:42,635:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4437, 3)
2025-12-18 14:15:42,635:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:15:42,635:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:15:42,635:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: True
2025-12-18 14:15:42,635:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'District': 'Rwampara District', 'SUM(105-EP01b. Malaria Total)': 1580, 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))': 1579}
2025-12-18 14:15:42,640:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING] Auto-sanitizing wrapped aggregate: 'SUM(105-EP01b. Malaria Total)' -> 'SUM(105_EP01b_Malaria_Total)'
2025-12-18 14:15:42,640:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING] Auto-sanitizing wrapped aggregate: 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))' -> 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)'
2025-12-18 14:15:42,640:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] DataFrame columns: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:15:42,640:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Aggregates: {'SUM(105-EP01b. Malaria Total)': {'operator': 'mean', 'column': 'SUM(105_EP01b_Malaria_Total)'}, 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))': {'operator': 'mean', 'column': 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)'}}
2025-12-18 14:15:42,640:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105-EP01b. Malaria Total)', column='SUM(105_EP01b_Malaria_Total)'
2025-12-18 14:15:42,640:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Column 'SUM(105_EP01b_Malaria_Total)' not found directly. Checking if aggregate name 'SUM(105-EP01b. Malaria Total)' is in DataFrame...
2025-12-18 14:15:42,640:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Found aggregate name 'SUM(105-EP01b. Malaria Total)' in DataFrame! Using name as column.
2025-12-18 14:15:42,640:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))', column='SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)'
2025-12-18 14:15:42,640:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Column 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)' not found directly. Checking if aggregate name 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))' is in DataFrame...
2025-12-18 14:15:42,640:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Found aggregate name 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))' in DataFrame! Using name as column.
2025-12-18 14:15:42,667:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:15:42] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-18 14:16:08,258:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:16:08] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 14:16:08,320:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:16:08] "GET /api/v1/database/?q=(filters:!((col:allow_file_upload,opr:upload_is_enabled,value:!t))) HTTP/1.1" 200 -
2025-12-18 14:16:08,351:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:16:08] "GET /api/v1/database/?q=(filters:!((col:allow_file_upload,opr:upload_is_enabled,value:!t))) HTTP/1.1" 200 -
2025-12-18 14:16:08,433:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:16:08] "GET /api/v1/database/?q=(filters:!((col:database_name,opr:neq,value:examples))) HTTP/1.1" 200 -
2025-12-18 14:16:08,451:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:16:08] "GET /api/v1/database/?q=(filters:!((col:database_name,opr:neq,value:examples))) HTTP/1.1" 200 -
2025-12-18 14:17:25,548:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:17:25] "GET /explore/?form_data_key=ULWSeaI5Yyo&datasource_type=table&datasource_id=4 HTTP/1.1" 200 -
2025-12-18 14:17:26,636:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:17:26] "GET /api/v1/database/?q=(filters:!((col:allow_file_upload,opr:upload_is_enabled,value:!t))) HTTP/1.1" 200 -
2025-12-18 14:17:26,689:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:17:26] "GET /api/v1/database/?q=(filters:!((col:database_name,opr:neq,value:examples))) HTTP/1.1" 200 -
2025-12-18 14:17:27,166:INFO:superset.db_engine_specs.dhis2:[DHIS2] get_parameters_from_uri called
2025-12-18 14:17:27,167:ERROR:superset.db_engine_specs.dhis2:[DHIS2] Failed to extract parameters from URI: 'URL' object has no attribute 'decode'
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/superset/db_engine_specs/dhis2.py", line 361, in get_parameters_from_uri
    parsed = urlparse(uri)
             ^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/urllib/parse.py", line 394, in urlparse
    url, scheme, _coerce_result = _coerce_args(url, scheme)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/urllib/parse.py", line 133, in _coerce_args
    return _decode_args(args) + (_encode_result,)
           ^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/urllib/parse.py", line 117, in _decode_args
    return tuple(x.decode(encoding, errors) if x else '' for x in args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/urllib/parse.py", line 117, in <genexpr>
    return tuple(x.decode(encoding, errors) if x else '' for x in args)
                 ^^^^^^^^
AttributeError: 'URL' object has no attribute 'decode'
2025-12-18 14:17:27,175:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:17:27] "GET /api/v1/explore/?form_data_key=ULWSeaI5Yyo&datasource_type=table&datasource_id=4 HTTP/1.1" 200 -
2025-12-18 14:17:27,848:INFO:superset.common.query_object:[QueryObject] Removed 1 duplicate column(s): ['District']. Original count: 2, New count: 1
2025-12-18 14:17:27,853:ERROR:superset.models.helpers:[METRICS-TRACE] Processing 2 metrics
2025-12-18 14:17:27,853:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 0: adhoc - SUM(105-EP01b. Malaria Total)
2025-12-18 14:17:27,853:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105-EP01b. Malaria Total)
2025-12-18 14:17:27,853:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 1: adhoc - SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))
2025-12-18 14:17:27,853:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))
2025-12-18 14:17:27,853:ERROR:superset.models.helpers:[METRICS-TRACE] Total metrics added: 2
2025-12-18 14:17:27,854:ERROR:superset.models.helpers:[METRICS-TRACE] Before dedup: 1 select_exprs + 2 metrics_exprs
2025-12-18 14:17:27,855:ERROR:superset.models.helpers:[METRICS-TRACE] After dedup: 3 total select_exprs
2025-12-18 14:17:27,855:INFO:superset.models.helpers:[COLUMN_TRACE] SQL Query Building:
2025-12-18 14:17:27,855:INFO:superset.models.helpers:[COLUMN_TRACE]   columns: [{'columnType': 'BASE_AXIS', 'sqlExpression': 'District', 'label': 'District', 'expressionType': 'SQL'}]
2025-12-18 14:17:27,855:INFO:superset.models.helpers:[COLUMN_TRACE]   metrics: [{'aggregate': 'SUM', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01b_Malaria_Total', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 40, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'FLOAT', 'type_generic': 0, 'uuid': '5da7ec93-b44e-48b9-8004-7d62a62c5ac0', 'verbose_name': '105-EP01b. Malaria Total', 'warning_markdown': None}, 'datasourceWarning': False, 'expressionType': 'SIMPLE', 'hasCustomLabel': False, 'label': 'SUM(105-EP01b. Malaria Total)', 'optionName': 'metric_k9q7silao1_oi8evqrbvi', 'sqlExpression': None}, {'aggregate': 'SUM', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 41, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'column', 'type_generic': 0, 'uuid': 'c71fe8aa-92db-4107-a95b-2c7d99fa828a', 'verbose_name': '105-EP01c. Malaria Confirmed (B/s and RDT Positive)', 'warning_markdown': None}, 'datasourceWarning': False, 'expressionType': 'SIMPLE', 'hasCustomLabel': False, 'label': 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))', 'optionName': 'metric_oj8hdui9ylq_nue3d0up82', 'sqlExpression': None}]
2025-12-18 14:17:27,855:INFO:superset.models.helpers:[COLUMN_TRACE]   groupby: []
2025-12-18 14:17:27,855:INFO:superset.models.helpers:[COLUMN_TRACE]   labels_expected: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:17:27,855:INFO:superset.models.helpers:[COLUMN_TRACE]   select_exprs count: 3
2025-12-18 14:17:27,855:INFO:superset.models.helpers:[COLUMN_TRACE]     [0] key=District, name=District, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-18 14:17:27,855:INFO:superset.models.helpers:[COLUMN_TRACE]     [1] key=SUM(105-EP01b. Malaria Total), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-18 14:17:27,855:INFO:superset.models.helpers:[COLUMN_TRACE]     [2] key=SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive)), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-18 14:17:27,855:INFO:superset.connectors.sqla.models:[DHIS2] get_from_clause for virtual dataset 4: analytics 20251217-3246
2025-12-18 14:17:27,855:INFO:superset.connectors.sqla.models:[DHIS2] Full SQL stored: SELECT * FROM analytics
/* DHIS2: table=analytics&dx=JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&pe=LAST_5_YEARS&ou=F1o6qBSx783;SUvODYOcaVf&ouMode=DESCENDANTS */
2025-12-18 14:17:27,855:INFO:superset.connectors.sqla.models:[DHIS2] Loaded params from extra field: table=analytics&dx=JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&pe=LAST_5_YEARS&ou=F1o6qBSx783;SUvO
2025-12-18 14:17:27,856:INFO:superset.connectors.sqla.models:[DHIS2] Cached params with key: dhis2_params_4_analytics
2025-12-18 14:17:27,856:INFO:superset.connectors.sqla.models:[DHIS2] Stored params in Flask g for DHIS2 table: analytics
2025-12-18 14:17:27,859:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Query execution in connectors/sqla/models.py:
2025-12-18 14:17:27,859:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   SQL (first 500 chars): SELECT "District", sum("105_EP01b_Malaria_Total") AS sum_1, sum("105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive") AS sum_2 
FROM (SELECT * FROM analytics
/* DHIS2: table=analytics&dx=JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&pe=LAST_5_YEARS&ou=F1o6qBSx783;SUvODYOcaVf&ouMode=DESCENDANTS */
) AS virtual_table GROUP BY "District" ORDER BY sum("105_EP01b_Malaria_Total") DESC
 LIMIT 10000
2025-12-18 14:17:27,859:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   labels_expected: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:17:27,860:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 connection initialized: https://tests.dhis2.hispuganda.org/hmis/api
2025-12-18 14:17:27,861:INFO:superset.db_engine_specs.dhis2_dialect:Executing DHIS2 query: SELECT
  "District",
  SUM("105_EP01b_Malaria_Total") AS sum_1,
  SUM("105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive") AS sum_2
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "District"
ORDER BY
  SUM("105_EP01b_Malaria_Total") DESC
LIMIT 10000
2025-12-18 14:17:27,861:INFO:superset.db_engine_specs.dhis2_dialect:Parsed endpoint: analytics
2025-12-18 14:17:27,861:INFO:superset.db_engine_specs.dhis2_dialect:Using stored parameters from Flask g for table: analytics
2025-12-18 14:17:27,861:INFO:superset.db_engine_specs.dhis2_dialect:Query params: {'table': 'analytics', 'dx': 'JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX', 'pe': 'LAST_5_YEARS', 'ou': 'F1o6qBSx783;SUvODYOcaVf', 'ouMode': 'DESCENDANTS'}
2025-12-18 14:17:27,861:INFO:superset.db_engine_specs.dhis2_dialect:Period dimension detected - omitting startDate/endDate (DHIS2 API rule)
2025-12-18 14:17:27,861:INFO:superset.db_engine_specs.dhis2_dialect:Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dx': 'JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX', 'pe': 'LAST_5_YEARS', 'ou': 'F1o6qBSx783;SUvODYOcaVf', 'ouMode': 'DESCENDANTS'}
2025-12-18 14:17:28,403:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:17:28] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 14:17:28,480:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:17:28] "[35m[1mPOST /api/v1/explore/form_data?tab_id=2 HTTP/1.1[0m" 201 -
2025-12-18 14:17:28,686:INFO:superset.db_engine_specs.dhis2_dialect:Fetched org unit levels: {3: 'District', 5: 'Health Facility', 1: 'National', 2: 'Region', 4: 'Sub County/Town Council/Div'}
2025-12-18 14:17:29,537:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Using all_levels scope: ['LEVEL-3', 'LEVEL-4', 'LEVEL-5']
2025-12-18 14:17:29,537:INFO:superset.db_engine_specs.dhis2_dialect:Converted dx/pe/ou to dimension parameter: dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX;pe:LAST_5_YEARS;ou:F1o6qBSx783;SUvODYOcaVf;LEVEL-3;LEVEL-4;LEVEL-5
2025-12-18 14:17:29,537:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API request (cache miss): https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&dimension=pe:LAST_5_YEARS&dimension=ou:F1o6qBSx783;SUvODYOcaVf;LEVEL-3;LEVEL-4;LEVEL-5
2025-12-18 14:17:32,441:INFO:superset.db_engine_specs.dhis2_cache:[DHIS2 Cache] SET: analytics (ttl=3600s, key=dhis2:4a1c3321:analytics:5362e2052855...)
2025-12-18 14:17:32,441:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2 Cache] Stored response for analytics
2025-12-18 14:17:32,449:INFO:superset.db_engine_specs.dhis2_dialect:Using wide/pivoted format for analytics
2025-12-18 14:17:33,627:INFO:superset.db_engine_specs.dhis2_dialect:Fetched org unit levels: {3: 'District', 5: 'Health Facility', 1: 'National', 2: 'Region', 4: 'Sub County/Town Council/Div'}
2025-12-18 14:17:33,629:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] _fetch_org_unit_hierarchy: Fetching 1142 unique org units in batches...
2025-12-18 14:17:56,927:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Fetched 1142 org units, found 301 parent IDs
2025-12-18 14:17:56,928:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Iteration 1: Fetching 2 missing parent org units...
2025-12-18 14:17:57,858:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Iteration 2: Fetching 1 missing parent org units...
2025-12-18 14:17:58,888:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total org unit names available: 1145
2025-12-18 14:17:58,892:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Sample hierarchy for a9NzDoLn9kz: {'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Kitgum District', 'level_4': 'Pager Division', 'level_5': None, 'level_6': None}
2025-12-18 14:17:58,892:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] _fetch_org_unit_hierarchy completed: 1142 org units with hierarchy
2025-12-18 14:17:58,893:INFO:superset.db_engine_specs.dhis2_dialect:normalize_analytics called with pivot=True, returning WIDE format
2025-12-18 14:17:58,917:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column construction - data_elements: ['AuAOIfCuBUp', 'BWZFz9RJRPI', 'D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'gHjJrtw9vQX', 'pRZrTLDN7Ge', 'wUDxFVBapIc']
2025-12-18 14:17:58,918:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column names constructed (SANITIZED): ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:17:58,919:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] FIRST ROW CONSTRUCTION:
2025-12-18 14:17:58,919:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   Period (index 0): 2020
2025-12-18 14:17:58,919:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   108-EP01a.2. Malaria Total (Deaths) (index 6): None
2025-12-18 14:17:58,919:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   108-EP01a.1. Malaria Total (Cases) (index 7): 3
2025-12-18 14:17:58,919:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01b. Malaria Total (index 8): 1580
2025-12-18 14:17:58,920:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01a. Suspected fever (index 9): 6695
2025-12-18 14:17:58,920:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01d. Malaria cases treated (index 10): 1560
2025-12-18 14:17:58,920:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   108-EP01b.2. Malaria Confirmed (Microscopic &RDT) (Deaths) (index 11): None
2025-12-18 14:17:58,920:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   108-EP01b.1. Malaria Confirmed (Microscopic &RDT) (Cases) (index 12): 3
2025-12-18 14:17:58,920:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01c. Malaria Confirmed (B/s and RDT Positive) (index 13): 1579
2025-12-18 14:17:58,929:INFO:superset.db_engine_specs.dhis2_dialect:First pivoted row - Period: '2020'
2025-12-18 14:17:58,929:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total pivoted rows: 4437, columns: 14

[DHIS2] Transformed rows count: 4437
[DHIS2] First transformed row: ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
[DHIS2] Fetched 4437 rows
[DHIS2] fetchall() called - returning 4437 rows
[DHIS2] fetchall() - First row type: <class 'tuple'>
[DHIS2] fetchall() - First row (original): ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
[DHIS2] fetchall() - Column count from description: 14
[DHIS2] fetchall() - First row (fixed types): ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
[DHIS2] fetchall() - Type enforcement: dimensions=STRING, measures=FLOAT
[DHIS2] Executing query: SELECT
  "District",
  SUM("105_EP01b_Malaria_Total") AS sum_1,
  SUM("105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive") AS sum_2
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "District"
ORDER BY
  SUM("105_EP01b_Malaria_Total") DESC
LIMIT 10000
[DHIS2] Parsed endpoint: analytics
[DHIS2] Found params in Flask g for analytics: table=analytics&dx=JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7
[DHIS2] Query params: {'table': 'analytics', 'dx': 'JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX', 'pe': 'LAST_5_YEARS', 'ou': 'F1o6qBSx783;SUvODYOcaVf', 'ouMode': 'DESCENDANTS'}
[DHIS2] Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dx': 'JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX', 'pe': 'LAST_5_YEARS', 'ou': 'F1o6qBSx783;SUvODYOcaVf', 'ouMode': 'DESCENDANTS'}
[DHIS2] Using all_levels scope: ['LEVEL-3', 'LEVEL-4', 'LEVEL-5']
[DHIS2] ðŸ”„ CACHE MISS - API request URL: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&dimension=pe:LAST_5_YEARS&dimension=ou:F1o6qBSx783;SUvODYOcaVf;LEVEL-3;LEVEL-4;LEVEL-5
[DHIS2] Raw API response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Raw DHIS2 rows count: 22727
[DHIS2] First raw row: ['JhvC7ZR9hUe', '2022', 'C0RSe3EWBqU', '246166']
[DHIS2] âœ… Cached response for analytics (API took 4569.4ms)
[DHIS2] Parsing response for endpoint: analytics
[DHIS2] Response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Response sample: {'headers': [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}], 'metaDat
[DHIS2] Using WIDE/PIVOTED format (Period, Level_1_Name, Level_2_Name, ..., DX1, DX2, ...) for analytics
[DHIS2] Analytics headers: [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}]
[DHIS2] Found 'ou' column at index 2
[DHIS2] Processing 22727 rows to extract org unit IDs
[DHIS2] Extracted 1142 unique org unit IDs from rows
[DHIS2] Found 1142 unique org units in analytics response
[DHIS2] Fetching hierarchy for 1142 org units...
[DHIS2] _fetch_org_unit_hierarchy: Fetching 1142 unique org units
[DHIS2] Batch 1: Got 50 org units from DHIS2
[DHIS2]   OU: wNunka5Y2uu, name=Acholi-Bur Subcounty, level=4, parent=aBrjuZk0W31
[DHIS2]   OU: FihNC5KfGJV, name=Adilang Subcounty, level=4, parent=ztIyIYAzFKp
[DHIS2]   OU: HSBjlZdFpWn, name=Ajan Subcounty, level=4, parent=aBrjuZk0W31
[DHIS2] Batch 2: Got 50 org units from DHIS2
[DHIS2] Batch 3: Got 50 org units from DHIS2
[DHIS2] Batch 4: Got 50 org units from DHIS2
[DHIS2] Batch 5: Got 50 org units from DHIS2
[DHIS2] Batch 6: Got 50 org units from DHIS2
[DHIS2] Batch 7: Got 50 org units from DHIS2
[DHIS2] Batch 8: Got 50 org units from DHIS2
[DHIS2] Batch 9: Got 50 org units from DHIS2
[DHIS2] Batch 10: Got 50 org units from DHIS2
[DHIS2] Batch 11: Got 50 org units from DHIS2
[DHIS2] Batch 12: Got 50 org units from DHIS2
[DHIS2] Batch 13: Got 50 org units from DHIS2
[DHIS2] Batch 14: Got 50 org units from DHIS2
[DHIS2] Batch 15: Got 50 org units from DHIS2
[DHIS2] Batch 16: Got 50 org units from DHIS2
[DHIS2] Batch 17: Got 50 org units from DHIS2
[DHIS2] Batch 18: Got 50 org units from DHIS2
[DHIS2] Batch 19: Got 50 org units from DHIS2
[DHIS2] Batch 20: Got 50 org units from DHIS2
[DHIS2] Batch 21: Got 50 org units from DHIS2
[DHIS2] Batch 22: Got 50 org units from DHIS2
[DHIS2] Batch 23: Got 42 org units from DHIS2
[DHIS2] Total org unit names available: 1145 after 2 iterations
[DHIS2] Sample hierarchy for a9NzDoLn9kz: {'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Kitgum District', 'level_4': 'Pager Division', 'level_5': None, 'level_6': None}
[DHIS2]   a9NzDoLn9kz: filled levels = ['level_1', 'level_2', 'level_3', 'level_4']
[DHIS2]   aFgrVHVDqoZ: filled levels = ['level_1', 'level_2', 'level_3', 'level_4', 'level_5']
[DHIS2]   fxHApp8UtpE: filled levels = ['level_1', 'level_2', 'level_3', 'level_4', 'level_5']
[DHIS2] Fetched hierarchy for 1142 org units
[DHIS2] Sample hierarchy for a9NzDoLn9kz: {'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Kitgum District', 'level_4': 'Pager Division', 'level_5': None, 'level_6': None}
[DHIS2] Calling DHIS2ResponseNormalizer.normalize with:
[DHIS2]   - endpoint: analytics
[DHIS2]   - pivot: True
[DHIS2]   - org_unit_hierarchy: 1142 entries
[DHIS2]   - org_unit_level_names: {3: 'District', 5: 'Health Facility', 1: 'National', 2: 'Region', 4: 'Sub County/Town Council/Div'}
[DHIS2] normalize_analytics: pivot=True, using WIDE/PIVOTED format
[DHIS2] PIVOT CONSTRUCTION:
[DHIS2]   data_elements (UIDs): ['AuAOIfCuBUp', 'BWZFz9RJRPI', 'D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'gHjJrtw9vQX', 'pRZrTLDN7Ge', 'wUDxFVBapIc']
[DHIS2]   data_element_list (sorted UIDs): ['AuAOIfCuBUp', 'BWZFz9RJRPI', 'D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'gHjJrtw9vQX', 'pRZrTLDN7Ge', 'wUDxFVBapIc']
[DHIS2]   col_names (SANITIZED): ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Row 0: OU=AA8TRyfTwtn, hierarchy_info={'level_1': 'MOH - Uganda', 'level_2': 'Ankole', 'level_3': 'Rwampara District', 'level_4': 'Mwizi Subcounty', 'level_5': None, 'level_6': None}
[DHIS2] Row 1: OU=AJxamlmKn2x, hierarchy_info={'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Amuru District', 'level_4': 'Lamogi Subcounty', 'level_5': 'Keyo Health Centre II', 'level_6': None}
[DHIS2] Row 2: OU=ALL4sSTGBRn, hierarchy_info={'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Gulu District', 'level_4': 'Owalo Subcounty', 'level_5': None, 'level_6': None}
[DHIS2] Normalized columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']2025-12-18 14:17:58,930:INFO:superset.db_engine_specs.dhis2_dialect:Normalized 4437 rows with 14 columns for endpoint analytics
2025-12-18 14:17:58,930:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API returned 4437 rows
2025-12-18 14:17:58,946:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() - Row count: 4437
2025-12-18 14:17:58,946:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:17:58,946:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names length: 14
2025-12-18 14:17:58,946:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values count: 14
2025-12-18 14:17:58,946:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values: ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
2025-12-18 14:17:58,946:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 0 (Period): 2020 -> 2020 (STRING)
2025-12-18 14:17:58,946:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (National): 'MOH - Uganda...' -> STRING (non-numeric detected)
2025-12-18 14:17:58,946:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (National): MOH - Uganda (PROCESSED)
2025-12-18 14:17:58,946:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (Region): 'Ankole...' -> STRING (non-numeric detected)
2025-12-18 14:17:58,946:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (Region): Ankole (PROCESSED)
2025-12-18 14:17:58,946:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (District): 'Rwampara District...' -> STRING (non-numeric detected)
2025-12-18 14:17:58,946:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (District): Rwampara District (PROCESSED)
2025-12-18 14:17:58,946:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (Sub_County_Town_Council_Div): 'Mwizi Subcounty...' -> STRING (non-numeric detected)
2025-12-18 14:17:58,946:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (Sub_County_Town_Council_Div): Mwizi Subcounty (PROCESSED)
2025-12-18 14:17:58,958:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() returning 4437 rows with 14 columns each
2025-12-18 14:17:58,958:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Got 4437 rows from cursor
2025-12-18 14:17:58,959:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: First row: ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
2025-12-18 14:17:58,959:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:17:58,959:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Types from cursor: ['String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String']
2025-12-18 14:17:58,979:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: DataFrame created with 4437 rows, 14 columns
2025-12-18 14:17:58,979:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:17:58,980:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes BEFORE fix: {'Period': dtype('O'), 'National': dtype('O'), 'Region': dtype('O'), 'District': dtype('O'), 'Sub_County_Town_Council_Div': dtype('O'), 'Health_Facility': dtype('O'), '108_EP01a_2_Malaria_Total_Deaths': dtype('O'), '108_EP01a_1_Malaria_Total_Cases': dtype('O'), '105_EP01b_Malaria_Total': dtype('O'), '105_EP01a_Suspected_fever': dtype('O'), '105_EP01d_Malaria_cases_treated': dtype('O'), '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths': dtype('O'), '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases': dtype('O'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('O')}
2025-12-18 14:17:58,984:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Period' to object dtype (dimension)
2025-12-18 14:17:58,985:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'National' as dimension (contains non-numeric string: 'MOH - Uganda...')
2025-12-18 14:17:58,985:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'National' to object dtype (dimension)
2025-12-18 14:17:58,985:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'Region' as dimension (contains non-numeric string: 'Ankole...')
2025-12-18 14:17:58,986:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Region' to object dtype (dimension)
2025-12-18 14:17:58,986:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'District' as dimension (contains non-numeric string: 'Rwampara District...')
2025-12-18 14:17:58,986:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'District' to object dtype (dimension)
2025-12-18 14:17:58,986:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'Sub_County_Town_Council_Div' as dimension (contains non-numeric string: 'Mwizi Subcounty...')
2025-12-18 14:17:58,986:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Sub_County_Town_Council_Div' to object dtype (dimension)
2025-12-18 14:17:58,987:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'Health_Facility' as dimension (contains non-numeric string: 'Keyo Health Centre II...')
2025-12-18 14:17:58,987:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Health_Facility' to object dtype (dimension)
2025-12-18 14:17:58,988:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes AFTER fix: {'Period': dtype('O'), 'National': dtype('O'), 'Region': dtype('O'), 'District': dtype('O'), 'Sub_County_Town_Council_Div': dtype('O'), 'Health_Facility': dtype('O'), '108_EP01a_2_Malaria_Total_Deaths': dtype('O'), '108_EP01a_1_Malaria_Total_Cases': dtype('O'), '105_EP01b_Malaria_Total': dtype('O'), '105_EP01a_Suspected_fever': dtype('O'), '105_EP01d_Malaria_cases_treated': dtype('O'), '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths': dtype('O'), '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases': dtype('O'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('O')}
2025-12-18 14:17:58,988:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: First row: {'Period': '2020', 'National': 'MOH - Uganda', 'Region': 'Ankole', 'District': 'Rwampara District', 'Sub_County_Town_Council_Div': 'Mwizi Subcounty', 'Health_Facility': None, '108_EP01a_2_Malaria_Total_Deaths': None, '108_EP01a_1_Malaria_Total_Cases': 3, '105_EP01b_Malaria_Total': 1580, '105_EP01a_Suspected_fever': 6695, '105_EP01d_Malaria_cases_treated': 1560, '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths': None, '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases': 3, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 1579}
2025-12-18 14:17:58,991:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] BEFORE assign_column_label:
2025-12-18 14:17:58,991:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4437, 14)
2025-12-18 14:17:58,992:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:17:58,992:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:17:58,992:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: False
2025-12-18 14:17:58,992:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Period': '2020', 'National': 'MOH - Uganda', 'Region': 'Ankole', 'District': 'Rwampara District', 'Sub_County_Town_Council_Div': 'Mwizi Subcounty', 'Health_Facility': None, '108_EP01a_2_Malaria_Total_Deaths': None, '108_EP01a_1_Malaria_Total_Cases': 3, '105_EP01b_Malaria_Total': 1580, '105_EP01a_Suspected_fever': 6695, '105_EP01d_Malaria_cases_treated': 1560, '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths': None, '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases': 3, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 1579}
2025-12-18 14:17:58,992:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Column truncation needed: df has 14 columns, expected 3
2025-12-18 14:17:58,992:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   DataFrame actual columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:17:58,992:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Expected columns: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:17:58,992:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] âœ“ Selecting columns BY NAME (matched all expected columns)
2025-12-18 14:17:58,992:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Column mapping: {'District': 'District', 'SUM(105-EP01b. Malaria Total)': '105_EP01b_Malaria_Total', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))': '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'}
2025-12-18 14:17:58,994:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] Column Selection âœ“ SUCCESS - method=BY_NAME, datasource=analytics 20251217-3246
2025-12-18 14:17:58,994:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:17:58,994:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   tried_by_name=True, success=True, fallback=False
2025-12-18 14:17:58,994:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Assigning column labels: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:17:58,994:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] AFTER assign_column_label:
2025-12-18 14:17:58,994:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4437, 3)
2025-12-18 14:17:58,994:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:17:58,994:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:17:58,994:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: True
2025-12-18 14:17:58,994:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'District': 'Rwampara District', 'SUM(105-EP01b. Malaria Total)': 1580, 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))': 1579}
2025-12-18 14:17:59,003:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING] Auto-sanitizing wrapped aggregate: 'SUM(105-EP01b. Malaria Total)' -> 'SUM(105_EP01b_Malaria_Total)'
2025-12-18 14:17:59,003:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING] Auto-sanitizing wrapped aggregate: 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))' -> 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)'
2025-12-18 14:17:59,003:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] DataFrame columns: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:17:59,003:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Aggregates: {'SUM(105-EP01b. Malaria Total)': {'operator': 'mean', 'column': 'SUM(105_EP01b_Malaria_Total)'}, 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))': {'operator': 'mean', 'column': 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)'}}
2025-12-18 14:17:59,004:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105-EP01b. Malaria Total)', column='SUM(105_EP01b_Malaria_Total)'
2025-12-18 14:17:59,004:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Column 'SUM(105_EP01b_Malaria_Total)' not found directly. Checking if aggregate name 'SUM(105-EP01b. Malaria Total)' is in DataFrame...
2025-12-18 14:17:59,004:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Found aggregate name 'SUM(105-EP01b. Malaria Total)' in DataFrame! Using name as column.
2025-12-18 14:17:59,004:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))', column='SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)'
2025-12-18 14:17:59,004:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Column 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)' not found directly. Checking if aggregate name 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))' is in DataFrame...
2025-12-18 14:17:59,004:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Found aggregate name 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))' in DataFrame! Using name as column.
2025-12-18 14:17:59,027:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:17:59] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-18 14:17:59,120:INFO:superset.common.query_object:[QueryObject] Removed 1 duplicate column(s): ['District']. Original count: 2, New count: 1
2025-12-18 14:17:59,128:ERROR:superset.models.helpers:[METRICS-TRACE] Processing 2 metrics
2025-12-18 14:17:59,128:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 0: adhoc - SUM(105-EP01b. Malaria Total)
2025-12-18 14:17:59,128:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105-EP01b. Malaria Total)
2025-12-18 14:17:59,129:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 1: adhoc - SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))
2025-12-18 14:17:59,129:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))
2025-12-18 14:17:59,129:ERROR:superset.models.helpers:[METRICS-TRACE] Total metrics added: 2
2025-12-18 14:17:59,130:ERROR:superset.models.helpers:[METRICS-TRACE] Before dedup: 1 select_exprs + 2 metrics_exprs
2025-12-18 14:17:59,130:ERROR:superset.models.helpers:[METRICS-TRACE] After dedup: 3 total select_exprs
2025-12-18 14:17:59,130:INFO:superset.models.helpers:[COLUMN_TRACE] SQL Query Building:
2025-12-18 14:17:59,130:INFO:superset.models.helpers:[COLUMN_TRACE]   columns: [{'columnType': 'BASE_AXIS', 'sqlExpression': 'District', 'label': 'District', 'expressionType': 'SQL'}]
2025-12-18 14:17:59,130:INFO:superset.models.helpers:[COLUMN_TRACE]   metrics: [{'aggregate': 'SUM', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01b_Malaria_Total', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 40, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'FLOAT', 'type_generic': 0, 'uuid': '5da7ec93-b44e-48b9-8004-7d62a62c5ac0', 'verbose_name': '105-EP01b. Malaria Total', 'warning_markdown': None}, 'datasourceWarning': False, 'expressionType': 'SIMPLE', 'hasCustomLabel': False, 'label': 'SUM(105-EP01b. Malaria Total)', 'optionName': 'metric_k9q7silao1_oi8evqrbvi', 'sqlExpression': None}, {'aggregate': 'SUM', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 41, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'column', 'type_generic': 0, 'uuid': 'c71fe8aa-92db-4107-a95b-2c7d99fa828a', 'verbose_name': '105-EP01c. Malaria Confirmed (B/s and RDT Positive)', 'warning_markdown': None}, 'datasourceWarning': False, 'expressionType': 'SIMPLE', 'hasCustomLabel': False, 'label': 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))', 'optionName': 'metric_oj8hdui9ylq_nue3d0up82', 'sqlExpression': None}]
2025-12-18 14:17:59,130:INFO:superset.models.helpers:[COLUMN_TRACE]   groupby: []
2025-12-18 14:17:59,130:INFO:superset.models.helpers:[COLUMN_TRACE]   labels_expected: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:17:59,130:INFO:superset.models.helpers:[COLUMN_TRACE]   select_exprs count: 3
2025-12-18 14:17:59,130:INFO:superset.models.helpers:[COLUMN_TRACE]     [0] key=District, name=District, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-18 14:17:59,130:INFO:superset.models.helpers:[COLUMN_TRACE]     [1] key=SUM(105-EP01b. Malaria Total), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-18 14:17:59,130:INFO:superset.models.helpers:[COLUMN_TRACE]     [2] key=SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive)), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-18 14:17:59,130:INFO:superset.connectors.sqla.models:[DHIS2] get_from_clause for virtual dataset 4: analytics 20251217-3246
2025-12-18 14:17:59,130:INFO:superset.connectors.sqla.models:[DHIS2] Full SQL stored: SELECT * FROM analytics
/* DHIS2: table=analytics&dx=JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&pe=LAST_5_YEARS&ou=F1o6qBSx783;SUvODYOcaVf&ouMode=DESCENDANTS */
2025-12-18 14:17:59,130:INFO:superset.connectors.sqla.models:[DHIS2] Loaded params from extra field: table=analytics&dx=JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&pe=LAST_5_YEARS&ou=F1o6qBSx783;SUvO
2025-12-18 14:17:59,131:INFO:superset.connectors.sqla.models:[DHIS2] Cached params with key: dhis2_params_4_analytics
2025-12-18 14:17:59,131:INFO:superset.connectors.sqla.models:[DHIS2] Stored params in Flask g for DHIS2 table: analytics
2025-12-18 14:17:59,133:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Query execution in connectors/sqla/models.py:
2025-12-18 14:17:59,133:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   SQL (first 500 chars): SELECT "District", sum("105_EP01b_Malaria_Total") AS sum_1, sum("105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive") AS sum_2 
FROM (SELECT * FROM analytics
/* DHIS2: table=analytics&dx=JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&pe=LAST_5_YEARS&ou=F1o6qBSx783;SUvODYOcaVf&ouMode=DESCENDANTS */
) AS virtual_table GROUP BY "District" ORDER BY sum("105_EP01b_Malaria_Total") DESC
 LIMIT 10000
2025-12-18 14:17:59,133:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   labels_expected: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:17:59,134:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 connection initialized: https://tests.dhis2.hispuganda.org/hmis/api
2025-12-18 14:17:59,135:INFO:superset.db_engine_specs.dhis2_dialect:Executing DHIS2 query: SELECT
  "District",
  SUM("105_EP01b_Malaria_Total") AS sum_1,
  SUM("105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive") AS sum_2
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "District"
ORDER BY
  SUM("105_EP01b_Malaria_Total") DESC
LIMIT 10000
2025-12-18 14:17:59,135:INFO:superset.db_engine_specs.dhis2_dialect:Parsed endpoint: analytics
2025-12-18 14:17:59,135:INFO:superset.db_engine_specs.dhis2_dialect:Using stored parameters from Flask g for table: analytics
2025-12-18 14:17:59,135:INFO:superset.db_engine_specs.dhis2_dialect:Query params: {'table': 'analytics', 'dx': 'JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX', 'pe': 'LAST_5_YEARS', 'ou': 'F1o6qBSx783;SUvODYOcaVf', 'ouMode': 'DESCENDANTS'}
2025-12-18 14:17:59,135:INFO:superset.db_engine_specs.dhis2_dialect:Period dimension detected - omitting startDate/endDate (DHIS2 API rule)
2025-12-18 14:17:59,135:INFO:superset.db_engine_specs.dhis2_dialect:Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dx': 'JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX', 'pe': 'LAST_5_YEARS', 'ou': 'F1o6qBSx783;SUvODYOcaVf', 'ouMode': 'DESCENDANTS'}
2025-12-18 14:17:59,946:INFO:superset.db_engine_specs.dhis2_dialect:Fetched org unit levels: {3: 'District', 5: 'Health Facility', 1: 'National', 2: 'Region', 4: 'Sub County/Town Council/Div'}
2025-12-18 14:18:00,044:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:18:00] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 14:18:00,828:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Using all_levels scope: ['LEVEL-3', 'LEVEL-4', 'LEVEL-5']
2025-12-18 14:18:00,828:INFO:superset.db_engine_specs.dhis2_dialect:Converted dx/pe/ou to dimension parameter: dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX;pe:LAST_5_YEARS;ou:F1o6qBSx783;SUvODYOcaVf;LEVEL-3;LEVEL-4;LEVEL-5
2025-12-18 14:18:00,828:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API request (cache miss): https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&dimension=pe:LAST_5_YEARS&dimension=ou:F1o6qBSx783;SUvODYOcaVf;LEVEL-3;LEVEL-4;LEVEL-5
2025-12-18 14:18:04,646:INFO:superset.db_engine_specs.dhis2_cache:[DHIS2 Cache] SET: analytics (ttl=3600s, key=dhis2:4a1c3321:analytics:5362e2052855...)
2025-12-18 14:18:04,647:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2 Cache] Stored response for analytics
2025-12-18 14:18:04,655:INFO:superset.db_engine_specs.dhis2_dialect:Using wide/pivoted format for analytics
2025-12-18 14:18:05,533:INFO:superset.db_engine_specs.dhis2_dialect:Fetched org unit levels: {3: 'District', 5: 'Health Facility', 1: 'National', 2: 'Region', 4: 'Sub County/Town Council/Div'}
2025-12-18 14:18:05,535:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] _fetch_org_unit_hierarchy: Fetching 1142 unique org units in batches...
2025-12-18 14:18:25,651:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Fetched 1142 org units, found 301 parent IDs
2025-12-18 14:18:25,651:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Iteration 1: Fetching 2 missing parent org units...
2025-12-18 14:18:26,515:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Iteration 2: Fetching 1 missing parent org units...
2025-12-18 14:18:27,436:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total org unit names available: 1145
2025-12-18 14:18:27,442:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Sample hierarchy for a9NzDoLn9kz: {'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Kitgum District', 'level_4': 'Pager Division', 'level_5': None, 'level_6': None}
2025-12-18 14:18:27,442:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] _fetch_org_unit_hierarchy completed: 1142 org units with hierarchy
2025-12-18 14:18:27,443:INFO:superset.db_engine_specs.dhis2_dialect:normalize_analytics called with pivot=True, returning WIDE format

[DHIS2] Normalized row count: 4437
[DHIS2] First row: ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
[DHIS2] _set_description: original=['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], sanitized=['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], types=['String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String']
[DHIS2] Transformed rows count: 4437
[DHIS2] First transformed row: ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
[DHIS2] Fetched 4437 rows
[DHIS2] fetchall() called - returning 4437 rows
[DHIS2] fetchall() - First row type: <class 'tuple'>
[DHIS2] fetchall() - First row (original): ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
[DHIS2] fetchall() - Column count from description: 14
[DHIS2] fetchall() - First row (fixed types): ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
[DHIS2] fetchall() - Type enforcement: dimensions=STRING, measures=FLOAT
[DHIS2] Executing query: SELECT
  "District",
  SUM("105_EP01b_Malaria_Total") AS sum_1,
  SUM("105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive") AS sum_2
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "District"
ORDER BY
  SUM("105_EP01b_Malaria_Total") DESC
LIMIT 10000
[DHIS2] Parsed endpoint: analytics
[DHIS2] Found params in Flask g for analytics: table=analytics&dx=JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7
[DHIS2] Query params: {'table': 'analytics', 'dx': 'JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX', 'pe': 'LAST_5_YEARS', 'ou': 'F1o6qBSx783;SUvODYOcaVf', 'ouMode': 'DESCENDANTS'}
[DHIS2] Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dx': 'JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX', 'pe': 'LAST_5_YEARS', 'ou': 'F1o6qBSx783;SUvODYOcaVf', 'ouMode': 'DESCENDANTS'}
[DHIS2] Using all_levels scope: ['LEVEL-3', 'LEVEL-4', 'LEVEL-5']
[DHIS2] ðŸ”„ CACHE MISS - API request URL: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&dimension=pe:LAST_5_YEARS&dimension=ou:F1o6qBSx783;SUvODYOcaVf;LEVEL-3;LEVEL-4;LEVEL-5
[DHIS2] Raw API response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Raw DHIS2 rows count: 22727
[DHIS2] First raw row: ['JhvC7ZR9hUe', '2022', 'C0RSe3EWBqU', '246166']
[DHIS2] âœ… Cached response for analytics (API took 5503.6ms)
[DHIS2] Parsing response for endpoint: analytics
[DHIS2] Response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Response sample: {'headers': [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}], 'metaDat
[DHIS2] Using WIDE/PIVOTED format (Period, Level_1_Name, Level_2_Name, ..., DX1, DX2, ...) for analytics
[DHIS2] Analytics headers: [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}]
[DHIS2] Found 'ou' column at index 2
[DHIS2] Processing 22727 rows to extract org unit IDs
[DHIS2] Extracted 1142 unique org unit IDs from rows
[DHIS2] Found 1142 unique org units in analytics response
[DHIS2] Fetching hierarchy for 1142 org units...
[DHIS2] _fetch_org_unit_hierarchy: Fetching 1142 unique org units
[DHIS2] Batch 1: Got 50 org units from DHIS2
[DHIS2]   OU: wNunka5Y2uu, name=Acholi-Bur Subcounty, level=4, parent=aBrjuZk0W31
[DHIS2]   OU: FihNC5KfGJV, name=Adilang Subcounty, level=4, parent=ztIyIYAzFKp
[DHIS2]   OU: HSBjlZdFpWn, name=Ajan Subcounty, level=4, parent=aBrjuZk0W31
[DHIS2] Batch 2: Got 50 org units from DHIS2
[DHIS2] Batch 3: Got 50 org units from DHIS2
[DHIS2] Batch 4: Got 50 org units from DHIS2
[DHIS2] Batch 5: Got 50 org units from DHIS2
[DHIS2] Batch 6: Got 50 org units from DHIS2
[DHIS2] Batch 7: Got 50 org units from DHIS2
[DHIS2] Batch 8: Got 50 org units from DHIS2
[DHIS2] Batch 9: Got 50 org units from DHIS2
[DHIS2] Batch 10: Got 50 org units from DHIS2
[DHIS2] Batch 11: Got 50 org units from DHIS2
[DHIS2] Batch 12: Got 50 org units from DHIS2
[DHIS2] Batch 13: Got 50 org units from DHIS2
[DHIS2] Batch 14: Got 50 org units from DHIS2
[DHIS2] Batch 15: Got 50 org units from DHIS2
[DHIS2] Batch 16: Got 50 org units from DHIS2
[DHIS2] Batch 17: Got 50 org units from DHIS2
[DHIS2] Batch 18: Got 50 org units from DHIS2
[DHIS2] Batch 19: Got 50 org units from DHIS2
[DHIS2] Batch 20: Got 50 org units from DHIS2
[DHIS2] Batch 21: Got 50 org units from DHIS2
[DHIS2] Batch 22: Got 50 org units from DHIS2
[DHIS2] Batch 23: Got 42 org units from DHIS2
[DHIS2] Total org unit names available: 1145 after 2 iterations
[DHIS2] Sample hierarchy for a9NzDoLn9kz: {'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Kitgum District', 'level_4': 'Pager Division', 'level_5': None, 'level_6': None}
[DHIS2]   a9NzDoLn9kz: filled levels = ['level_1', 'level_2', 'level_3', 'level_4']
[DHIS2]   aFgrVHVDqoZ: filled levels = ['level_1', 'level_2', 'level_3', 'level_4', 'level_5']
[DHIS2]   fxHApp8UtpE: filled levels = ['level_1', 'level_2', 'level_3', 'level_4', 'level_5']
[DHIS2] Fetched hierarchy for 1142 org units
[DHIS2] Sample hierarchy for a9NzDoLn9kz: {'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Kitgum District', 'level_4': 'Pager Division', 'level_5': None, 'level_6': None}
[DHIS2] Calling DHIS2ResponseNormalizer.normalize with:
[DHIS2]   - endpoint: analytics
[DHIS2]   - pivot: True
[DHIS2]   - org_unit_hierarchy: 1142 entries
[DHIS2]   - org_unit_level_names: {3: 'District', 5: 'Health Facility', 1: 'National', 2: 'Region', 4: 'Sub County/Town Council/Div'}
[DHIS2] normalize_analytics: pivot=True, using WIDE/PIVOTED format
[DHIS2] PIVOT CONSTRUCTION:
[DHIS2]   data_elements (UIDs): ['AuAOIfCuBUp', 'BWZFz9RJRPI', 'D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'gHjJrtw9vQX', 'pRZrTLDN7Ge', 'wUDxFVBapIc']
[DHIS2]   data_element_list (sorted UIDs): ['AuAOIfCuBUp', 'BWZFz9RJRPI', 'D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'gHjJrtw9vQX', 'pRZrTLDN7Ge', 'wUDxFVBapIc']
[DHIS2]   col_names (SANITIZED): ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']2025-12-18 14:18:27,455:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column construction - data_elements: ['AuAOIfCuBUp', 'BWZFz9RJRPI', 'D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'gHjJrtw9vQX', 'pRZrTLDN7Ge', 'wUDxFVBapIc']
2025-12-18 14:18:27,455:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column names constructed (SANITIZED): ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:18:27,457:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] FIRST ROW CONSTRUCTION:
2025-12-18 14:18:27,457:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   Period (index 0): 2020
2025-12-18 14:18:27,457:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   108-EP01a.2. Malaria Total (Deaths) (index 6): None
2025-12-18 14:18:27,457:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   108-EP01a.1. Malaria Total (Cases) (index 7): 3
2025-12-18 14:18:27,457:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01b. Malaria Total (index 8): 1580
2025-12-18 14:18:27,457:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01a. Suspected fever (index 9): 6695
2025-12-18 14:18:27,457:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01d. Malaria cases treated (index 10): 1560
2025-12-18 14:18:27,457:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   108-EP01b.2. Malaria Confirmed (Microscopic &RDT) (Deaths) (index 11): None
2025-12-18 14:18:27,457:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   108-EP01b.1. Malaria Confirmed (Microscopic &RDT) (Cases) (index 12): 3
2025-12-18 14:18:27,457:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01c. Malaria Confirmed (B/s and RDT Positive) (index 13): 1579
2025-12-18 14:18:27,467:INFO:superset.db_engine_specs.dhis2_dialect:First pivoted row - Period: '2020'
2025-12-18 14:18:27,467:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total pivoted rows: 4437, columns: 14
2025-12-18 14:18:27,468:INFO:superset.db_engine_specs.dhis2_dialect:Normalized 4437 rows with 14 columns for endpoint analytics
2025-12-18 14:18:27,468:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API returned 4437 rows
2025-12-18 14:18:27,480:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() - Row count: 4437
2025-12-18 14:18:27,481:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:18:27,481:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names length: 14
2025-12-18 14:18:27,481:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values count: 14
2025-12-18 14:18:27,481:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values: ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
2025-12-18 14:18:27,481:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 0 (Period): 2020 -> 2020 (STRING)
2025-12-18 14:18:27,481:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (National): 'MOH - Uganda...' -> STRING (non-numeric detected)
2025-12-18 14:18:27,481:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (National): MOH - Uganda (PROCESSED)
2025-12-18 14:18:27,481:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (Region): 'Ankole...' -> STRING (non-numeric detected)
2025-12-18 14:18:27,481:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (Region): Ankole (PROCESSED)
2025-12-18 14:18:27,481:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (District): 'Rwampara District...' -> STRING (non-numeric detected)
2025-12-18 14:18:27,481:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (District): Rwampara District (PROCESSED)
2025-12-18 14:18:27,481:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (Sub_County_Town_Council_Div): 'Mwizi Subcounty...' -> STRING (non-numeric detected)
2025-12-18 14:18:27,481:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (Sub_County_Town_Council_Div): Mwizi Subcounty (PROCESSED)
2025-12-18 14:18:27,498:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() returning 4437 rows with 14 columns each
2025-12-18 14:18:27,498:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Got 4437 rows from cursor
2025-12-18 14:18:27,498:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: First row: ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
2025-12-18 14:18:27,498:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:18:27,498:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Types from cursor: ['String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String']
2025-12-18 14:18:27,504:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: DataFrame created with 4437 rows, 14 columns
2025-12-18 14:18:27,504:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:18:27,504:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes BEFORE fix: {'Period': dtype('O'), 'National': dtype('O'), 'Region': dtype('O'), 'District': dtype('O'), 'Sub_County_Town_Council_Div': dtype('O'), 'Health_Facility': dtype('O'), '108_EP01a_2_Malaria_Total_Deaths': dtype('O'), '108_EP01a_1_Malaria_Total_Cases': dtype('O'), '105_EP01b_Malaria_Total': dtype('O'), '105_EP01a_Suspected_fever': dtype('O'), '105_EP01d_Malaria_cases_treated': dtype('O'), '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths': dtype('O'), '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases': dtype('O'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('O')}
2025-12-18 14:18:27,506:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Period' to object dtype (dimension)
2025-12-18 14:18:27,507:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'National' as dimension (contains non-numeric string: 'MOH - Uganda...')
2025-12-18 14:18:27,507:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'National' to object dtype (dimension)
2025-12-18 14:18:27,507:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'Region' as dimension (contains non-numeric string: 'Ankole...')
2025-12-18 14:18:27,507:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Region' to object dtype (dimension)
2025-12-18 14:18:27,507:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'District' as dimension (contains non-numeric string: 'Rwampara District...')
2025-12-18 14:18:27,508:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'District' to object dtype (dimension)
2025-12-18 14:18:27,508:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'Sub_County_Town_Council_Div' as dimension (contains non-numeric string: 'Mwizi Subcounty...')
2025-12-18 14:18:27,508:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Sub_County_Town_Council_Div' to object dtype (dimension)
2025-12-18 14:18:27,508:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'Health_Facility' as dimension (contains non-numeric string: 'Keyo Health Centre II...')
2025-12-18 14:18:27,508:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Health_Facility' to object dtype (dimension)
2025-12-18 14:18:27,510:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes AFTER fix: {'Period': dtype('O'), 'National': dtype('O'), 'Region': dtype('O'), 'District': dtype('O'), 'Sub_County_Town_Council_Div': dtype('O'), 'Health_Facility': dtype('O'), '108_EP01a_2_Malaria_Total_Deaths': dtype('O'), '108_EP01a_1_Malaria_Total_Cases': dtype('O'), '105_EP01b_Malaria_Total': dtype('O'), '105_EP01a_Suspected_fever': dtype('O'), '105_EP01d_Malaria_cases_treated': dtype('O'), '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths': dtype('O'), '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases': dtype('O'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('O')}
2025-12-18 14:18:27,510:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: First row: {'Period': '2020', 'National': 'MOH - Uganda', 'Region': 'Ankole', 'District': 'Rwampara District', 'Sub_County_Town_Council_Div': 'Mwizi Subcounty', 'Health_Facility': None, '108_EP01a_2_Malaria_Total_Deaths': None, '108_EP01a_1_Malaria_Total_Cases': 3, '105_EP01b_Malaria_Total': 1580, '105_EP01a_Suspected_fever': 6695, '105_EP01d_Malaria_cases_treated': 1560, '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths': None, '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases': 3, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 1579}
2025-12-18 14:18:27,513:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] BEFORE assign_column_label:
2025-12-18 14:18:27,513:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4437, 14)
2025-12-18 14:18:27,513:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:18:27,513:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:18:27,513:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: False
2025-12-18 14:18:27,513:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Period': '2020', 'National': 'MOH - Uganda', 'Region': 'Ankole', 'District': 'Rwampara District', 'Sub_County_Town_Council_Div': 'Mwizi Subcounty', 'Health_Facility': None, '108_EP01a_2_Malaria_Total_Deaths': None, '108_EP01a_1_Malaria_Total_Cases': 3, '105_EP01b_Malaria_Total': 1580, '105_EP01a_Suspected_fever': 6695, '105_EP01d_Malaria_cases_treated': 1560, '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths': None, '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases': 3, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 1579}
2025-12-18 14:18:27,513:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Column truncation needed: df has 14 columns, expected 3
2025-12-18 14:18:27,513:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   DataFrame actual columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:18:27,513:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Expected columns: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:18:27,513:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] âœ“ Selecting columns BY NAME (matched all expected columns)
2025-12-18 14:18:27,513:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Column mapping: {'District': 'District', 'SUM(105-EP01b. Malaria Total)': '105_EP01b_Malaria_Total', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))': '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'}
2025-12-18 14:18:27,514:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] Column Selection âœ“ SUCCESS - method=BY_NAME, datasource=analytics 20251217-3246
2025-12-18 14:18:27,514:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:18:27,514:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   tried_by_name=True, success=True, fallback=False
2025-12-18 14:18:27,514:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Assigning column labels: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:18:27,514:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] AFTER assign_column_label:
2025-12-18 14:18:27,514:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4437, 3)
2025-12-18 14:18:27,514:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:18:27,514:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:18:27,514:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: True
2025-12-18 14:18:27,514:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'District': 'Rwampara District', 'SUM(105-EP01b. Malaria Total)': 1580, 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))': 1579}
2025-12-18 14:18:27,519:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING] Auto-sanitizing wrapped aggregate: 'SUM(105-EP01b. Malaria Total)' -> 'SUM(105_EP01b_Malaria_Total)'
2025-12-18 14:18:27,519:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING] Auto-sanitizing wrapped aggregate: 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))' -> 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)'
2025-12-18 14:18:27,519:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] DataFrame columns: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:18:27,519:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Aggregates: {'SUM(105-EP01b. Malaria Total)': {'operator': 'mean', 'column': 'SUM(105_EP01b_Malaria_Total)'}, 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))': {'operator': 'mean', 'column': 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)'}}
2025-12-18 14:18:27,519:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105-EP01b. Malaria Total)', column='SUM(105_EP01b_Malaria_Total)'
2025-12-18 14:18:27,519:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Column 'SUM(105_EP01b_Malaria_Total)' not found directly. Checking if aggregate name 'SUM(105-EP01b. Malaria Total)' is in DataFrame...
2025-12-18 14:18:27,519:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Found aggregate name 'SUM(105-EP01b. Malaria Total)' in DataFrame! Using name as column.
2025-12-18 14:18:27,519:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))', column='SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)'
2025-12-18 14:18:27,519:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Column 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)' not found directly. Checking if aggregate name 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))' is in DataFrame...
2025-12-18 14:18:27,519:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Found aggregate name 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))' in DataFrame! Using name as column.
2025-12-18 14:18:27,572:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:18:27] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-18 14:18:43,351:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:18:43] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 14:18:50,181:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:18:50] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 14:18:51,801:INFO:superset.common.query_object:[QueryObject] Removed 1 duplicate column(s): ['District']. Original count: 2, New count: 1
2025-12-18 14:18:51,847:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:18:51] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-18 14:18:52,526:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:18:52] "PUT /api/v1/explore/form_data/ULWSeaI5Yyo?tab_id=2 HTTP/1.1" 200 -
2025-12-18 14:18:52,867:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:18:52] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 14:21:51,082:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:21:51] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 14:21:52,820:INFO:superset.common.query_object:[QueryObject] Removed 1 duplicate column(s): ['District']. Original count: 2, New count: 1
2025-12-18 14:21:52,820:INFO:superset.common.query_object:[QueryObject] Removed 1 duplicate column(s): ['District']. Original count: 2, New count: 1
2025-12-18 14:21:52,849:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:21:52] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-18 14:21:52,850:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:21:52] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-18 14:21:54,653:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:21:54] "PUT /api/v1/explore/form_data/ULWSeaI5Yyo?tab_id=2 HTTP/1.1" 200 -
2025-12-18 14:21:55,123:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:21:55] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 14:22:11,942:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:22:11] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 14:22:13,730:INFO:superset.common.query_object:[QueryObject] Removed 1 duplicate column(s): ['District']. Original count: 2, New count: 1
2025-12-18 14:22:13,731:INFO:superset.common.query_object:[QueryObject] Removed 1 duplicate column(s): ['District']. Original count: 2, New count: 1
2025-12-18 14:22:13,756:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:22:13] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-18 14:22:13,758:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:22:13] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-18 14:22:14,820:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:22:14] "PUT /api/v1/explore/form_data/ULWSeaI5Yyo?tab_id=2 HTTP/1.1" 200 -
2025-12-18 14:22:15,828:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:22:15] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 14:22:20,474:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:22:20] "PUT /api/v1/explore/form_data/ULWSeaI5Yyo?tab_id=2 HTTP/1.1" 200 -
2025-12-18 14:22:24,531:INFO:superset.common.query_object:[QueryObject] Removed 1 duplicate column(s): ['District']. Original count: 2, New count: 1
2025-12-18 14:22:24,554:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:22:24] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-18 14:22:25,128:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:22:25] "PUT /api/v1/explore/form_data/ULWSeaI5Yyo?tab_id=2 HTTP/1.1" 200 -
2025-12-18 14:22:25,567:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:22:25] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 14:22:49,370:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:22:49] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 14:22:51,369:INFO:superset.common.query_object:[QueryObject] Removed 1 duplicate column(s): ['District']. Original count: 2, New count: 1
2025-12-18 14:22:51,372:INFO:superset.common.query_object:[QueryObject] Removed 1 duplicate column(s): ['District']. Original count: 2, New count: 1
2025-12-18 14:22:51,397:ERROR:superset.models.helpers:[METRICS-TRACE] Processing 2 metrics
2025-12-18 14:22:51,397:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 0: adhoc - SUM(105-EP01b. Malaria Total)
2025-12-18 14:22:51,398:ERROR:superset.models.helpers:[METRICS-TRACE] Processing 2 metrics
2025-12-18 14:22:51,398:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105-EP01b. Malaria Total)
2025-12-18 14:22:51,398:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 0: adhoc - SUM(105-EP01b. Malaria Total)
2025-12-18 14:22:51,399:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 1: adhoc - SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))
2025-12-18 14:22:51,399:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105-EP01b. Malaria Total)
2025-12-18 14:22:51,399:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 1: adhoc - SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))
2025-12-18 14:22:51,399:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))
2025-12-18 14:22:51,400:ERROR:superset.models.helpers:[METRICS-TRACE] Total metrics added: 2
2025-12-18 14:22:51,399:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))
2025-12-18 14:22:51,410:ERROR:superset.models.helpers:[METRICS-TRACE] Before dedup: 1 select_exprs + 2 metrics_exprs
2025-12-18 14:22:51,410:ERROR:superset.models.helpers:[METRICS-TRACE] Total metrics added: 2
2025-12-18 14:22:51,411:ERROR:superset.models.helpers:[METRICS-TRACE] After dedup: 3 total select_exprs
2025-12-18 14:22:51,411:INFO:superset.models.helpers:[COLUMN_TRACE] SQL Query Building:
2025-12-18 14:22:51,412:INFO:superset.models.helpers:[COLUMN_TRACE]   columns: [{'columnType': 'BASE_AXIS', 'sqlExpression': 'District', 'label': 'District', 'expressionType': 'SQL'}]
2025-12-18 14:22:51,412:INFO:superset.models.helpers:[COLUMN_TRACE]   metrics: [{'aggregate': 'SUM', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01b_Malaria_Total', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 40, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'FLOAT', 'type_generic': 0, 'uuid': '5da7ec93-b44e-48b9-8004-7d62a62c5ac0', 'verbose_name': '105-EP01b. Malaria Total', 'warning_markdown': None}, 'datasourceWarning': False, 'expressionType': 'SIMPLE', 'hasCustomLabel': False, 'label': 'SUM(105-EP01b. Malaria Total)', 'optionName': 'metric_k9q7silao1_oi8evqrbvi', 'sqlExpression': None}, {'aggregate': 'SUM', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 41, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'column', 'type_generic': 0, 'uuid': 'c71fe8aa-92db-4107-a95b-2c7d99fa828a', 'verbose_name': '105-EP01c. Malaria Confirmed (B/s and RDT Positive)', 'warning_markdown': None}, 'datasourceWarning': False, 'expressionType': 'SIMPLE', 'hasCustomLabel': False, 'label': 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))', 'optionName': 'metric_oj8hdui9ylq_nue3d0up82', 'sqlExpression': None}]
2025-12-18 14:22:51,412:INFO:superset.models.helpers:[COLUMN_TRACE]   groupby: []
2025-12-18 14:22:51,412:INFO:superset.models.helpers:[COLUMN_TRACE]   labels_expected: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:22:51,412:INFO:superset.models.helpers:[COLUMN_TRACE]   select_exprs count: 3
2025-12-18 14:22:51,411:ERROR:superset.models.helpers:[METRICS-TRACE] Before dedup: 1 select_exprs + 2 metrics_exprs
2025-12-18 14:22:51,412:INFO:superset.models.helpers:[COLUMN_TRACE]     [0] key=District, name=District, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-18 14:22:51,412:INFO:superset.models.helpers:[COLUMN_TRACE]     [1] key=SUM(105-EP01b. Malaria Total), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-18 14:22:51,412:INFO:superset.models.helpers:[COLUMN_TRACE]     [2] key=SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive)), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-18 14:22:51,412:ERROR:superset.models.helpers:[METRICS-TRACE] After dedup: 3 total select_exprs
2025-12-18 14:22:51,412:INFO:superset.models.helpers:[COLUMN_TRACE] SQL Query Building:
2025-12-18 14:22:51,412:INFO:superset.models.helpers:[COLUMN_TRACE]   columns: [{'columnType': 'BASE_AXIS', 'sqlExpression': 'District', 'label': 'District', 'expressionType': 'SQL'}]
2025-12-18 14:22:51,413:INFO:superset.models.helpers:[COLUMN_TRACE]   metrics: [{'aggregate': 'SUM', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01b_Malaria_Total', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 40, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'FLOAT', 'type_generic': 0, 'uuid': '5da7ec93-b44e-48b9-8004-7d62a62c5ac0', 'verbose_name': '105-EP01b. Malaria Total', 'warning_markdown': None}, 'datasourceWarning': False, 'expressionType': 'SIMPLE', 'hasCustomLabel': False, 'label': 'SUM(105-EP01b. Malaria Total)', 'optionName': 'metric_k9q7silao1_oi8evqrbvi', 'sqlExpression': None}, {'aggregate': 'SUM', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 41, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'column', 'type_generic': 0, 'uuid': 'c71fe8aa-92db-4107-a95b-2c7d99fa828a', 'verbose_name': '105-EP01c. Malaria Confirmed (B/s and RDT Positive)', 'warning_markdown': None}, 'datasourceWarning': False, 'expressionType': 'SIMPLE', 'hasCustomLabel': False, 'label': 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))', 'optionName': 'metric_oj8hdui9ylq_nue3d0up82', 'sqlExpression': None}]
2025-12-18 14:22:51,413:INFO:superset.models.helpers:[COLUMN_TRACE]   groupby: []
2025-12-18 14:22:51,413:INFO:superset.models.helpers:[COLUMN_TRACE]   labels_expected: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:22:51,413:INFO:superset.models.helpers:[COLUMN_TRACE]   select_exprs count: 3
2025-12-18 14:22:51,413:INFO:superset.models.helpers:[COLUMN_TRACE]     [0] key=District, name=District, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-18 14:22:51,413:INFO:superset.models.helpers:[COLUMN_TRACE]     [1] key=SUM(105-EP01b. Malaria Total), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-18 14:22:51,413:INFO:superset.models.helpers:[COLUMN_TRACE]     [2] key=SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive)), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-18 14:22:51,412:INFO:superset.connectors.sqla.models:[DHIS2] get_from_clause for virtual dataset 4: analytics 20251217-3246
2025-12-18 14:22:51,413:INFO:superset.connectors.sqla.models:[DHIS2] get_from_clause for virtual dataset 4: analytics 20251217-3246
2025-12-18 14:22:51,413:INFO:superset.connectors.sqla.models:[DHIS2] Full SQL stored: SELECT * FROM analytics
/* DHIS2: table=analytics&dx=JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&pe=LAST_5_YEARS&ou=F1o6qBSx783;SUvODYOcaVf&ouMode=DESCENDANTS */
2025-12-18 14:22:51,413:INFO:superset.connectors.sqla.models:[DHIS2] Full SQL stored: SELECT * FROM analytics
/* DHIS2: table=analytics&dx=JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&pe=LAST_5_YEARS&ou=F1o6qBSx783;SUvODYOcaVf&ouMode=DESCENDANTS */
2025-12-18 14:22:51,413:INFO:superset.connectors.sqla.models:[DHIS2] Loaded params from extra field: table=analytics&dx=JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&pe=LAST_5_YEARS&ou=F1o6qBSx783;SUvO
2025-12-18 14:22:51,413:INFO:superset.connectors.sqla.models:[DHIS2] Loaded params from extra field: table=analytics&dx=JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&pe=LAST_5_YEARS&ou=F1o6qBSx783;SUvO
2025-12-18 14:22:51,414:INFO:superset.connectors.sqla.models:[DHIS2] Cached params with key: dhis2_params_4_analytics
2025-12-18 14:22:51,415:INFO:superset.connectors.sqla.models:[DHIS2] Stored params in Flask g for DHIS2 table: analytics
2025-12-18 14:22:51,414:INFO:superset.connectors.sqla.models:[DHIS2] Cached params with key: dhis2_params_4_analytics
2025-12-18 14:22:51,419:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Query execution in connectors/sqla/models.py:
2025-12-18 14:22:51,419:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   SQL (first 500 chars): SELECT "District", sum("105_EP01b_Malaria_Total") AS sum_1, sum("105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive") AS sum_2 
FROM (SELECT * FROM analytics
/* DHIS2: table=analytics&dx=JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&pe=LAST_5_YEARS&ou=F1o6qBSx783;SUvODYOcaVf&ouMode=DESCENDANTS */
) AS virtual_table GROUP BY "District" ORDER BY sum("105_EP01b_Malaria_Total") DESC
 LIMIT 10000
2025-12-18 14:22:51,419:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   labels_expected: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:22:51,419:INFO:superset.connectors.sqla.models:[DHIS2] Stored params in Flask g for DHIS2 table: analytics
2025-12-18 14:22:51,422:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 connection initialized: https://tests.dhis2.hispuganda.org/hmis/api
2025-12-18 14:22:51,422:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Query execution in connectors/sqla/models.py:
2025-12-18 14:22:51,423:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   SQL (first 500 chars): SELECT "District", sum("105_EP01b_Malaria_Total") AS sum_1, sum("105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive") AS sum_2 
FROM (SELECT * FROM analytics
/* DHIS2: table=analytics&dx=JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&pe=LAST_5_YEARS&ou=F1o6qBSx783;SUvODYOcaVf&ouMode=DESCENDANTS */
) AS virtual_table GROUP BY "District" ORDER BY sum("105_EP01b_Malaria_Total") DESC
 LIMIT 10000
2025-12-18 14:22:51,423:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   labels_expected: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:22:51,423:INFO:superset.db_engine_specs.dhis2_dialect:Executing DHIS2 query: SELECT
  "District",
  SUM("105_EP01b_Malaria_Total") AS sum_1,
  SUM("105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive") AS sum_2
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "District"
ORDER BY
  SUM("105_EP01b_Malaria_Total") DESC
LIMIT 10000
2025-12-18 14:22:51,425:INFO:superset.db_engine_specs.dhis2_dialect:Parsed endpoint: analytics
2025-12-18 14:22:51,425:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 connection initialized: https://tests.dhis2.hispuganda.org/hmis/api
2025-12-18 14:22:51,425:INFO:superset.db_engine_specs.dhis2_dialect:Using stored parameters from Flask g for table: analytics
2025-12-18 14:22:51,425:INFO:superset.db_engine_specs.dhis2_dialect:Query params: {'table': 'analytics', 'dx': 'JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX', 'pe': 'LAST_5_YEARS', 'ou': 'F1o6qBSx783;SUvODYOcaVf', 'ouMode': 'DESCENDANTS'}
2025-12-18 14:22:51,425:INFO:superset.db_engine_specs.dhis2_dialect:Executing DHIS2 query: SELECT
  "District",
  SUM("105_EP01b_Malaria_Total") AS sum_1,
  SUM("105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive") AS sum_2
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "District"
ORDER BY
  SUM("105_EP01b_Malaria_Total") DESC
LIMIT 10000
2025-12-18 14:22:51,426:INFO:superset.db_engine_specs.dhis2_dialect:Parsed endpoint: analytics
2025-12-18 14:22:51,426:INFO:superset.db_engine_specs.dhis2_dialect:Using stored parameters from Flask g for table: analytics
2025-12-18 14:22:51,426:INFO:superset.db_engine_specs.dhis2_dialect:Query params: {'table': 'analytics', 'dx': 'JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX', 'pe': 'LAST_5_YEARS', 'ou': 'F1o6qBSx783;SUvODYOcaVf', 'ouMode': 'DESCENDANTS'}
2025-12-18 14:22:51,426:INFO:superset.db_engine_specs.dhis2_dialect:Period dimension detected - omitting startDate/endDate (DHIS2 API rule)
2025-12-18 14:22:51,426:INFO:superset.db_engine_specs.dhis2_dialect:Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dx': 'JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX', 'pe': 'LAST_5_YEARS', 'ou': 'F1o6qBSx783;SUvODYOcaVf', 'ouMode': 'DESCENDANTS'}
2025-12-18 14:22:51,426:INFO:superset.db_engine_specs.dhis2_dialect:Period dimension detected - omitting startDate/endDate (DHIS2 API rule)
2025-12-18 14:22:51,427:INFO:superset.db_engine_specs.dhis2_dialect:Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dx': 'JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX', 'pe': 'LAST_5_YEARS', 'ou': 'F1o6qBSx783;SUvODYOcaVf', 'ouMode': 'DESCENDANTS'}
2025-12-18 14:22:52,086:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:22:52] "PUT /api/v1/explore/form_data/ULWSeaI5Yyo?tab_id=2 HTTP/1.1" 200 -
2025-12-18 14:22:52,295:INFO:superset.db_engine_specs.dhis2_dialect:Fetched org unit levels: {3: 'District', 5: 'Health Facility', 1: 'National', 2: 'Region', 4: 'Sub County/Town Council/Div'}
2025-12-18 14:22:52,296:INFO:superset.db_engine_specs.dhis2_dialect:Fetched org unit levels: {3: 'District', 5: 'Health Facility', 1: 'National', 2: 'Region', 4: 'Sub County/Town Council/Div'}
2025-12-18 14:22:53,185:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Using all_levels scope: ['LEVEL-3', 'LEVEL-4', 'LEVEL-5']
2025-12-18 14:22:53,185:INFO:superset.db_engine_specs.dhis2_dialect:Converted dx/pe/ou to dimension parameter: dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX;pe:LAST_5_YEARS;ou:F1o6qBSx783;SUvODYOcaVf;LEVEL-3;LEVEL-4;LEVEL-5
2025-12-18 14:22:53,185:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API request (cache miss): https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&dimension=pe:LAST_5_YEARS&dimension=ou:F1o6qBSx783;SUvODYOcaVf;LEVEL-3;LEVEL-4;LEVEL-5
2025-12-18 14:22:54,273:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Using all_levels scope: ['LEVEL-3', 'LEVEL-4', 'LEVEL-5']
2025-12-18 14:22:54,273:INFO:superset.db_engine_specs.dhis2_dialect:Converted dx/pe/ou to dimension parameter: dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX;pe:LAST_5_YEARS;ou:F1o6qBSx783;SUvODYOcaVf;LEVEL-3;LEVEL-4;LEVEL-5
2025-12-18 14:22:54,273:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API request (cache miss): https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&dimension=pe:LAST_5_YEARS&dimension=ou:F1o6qBSx783;SUvODYOcaVf;LEVEL-3;LEVEL-4;LEVEL-5
2025-12-18 14:22:55,936:INFO:superset.db_engine_specs.dhis2_cache:[DHIS2 Cache] SET: analytics (ttl=3600s, key=dhis2:4a1c3321:analytics:5362e2052855...)
2025-12-18 14:22:55,936:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2 Cache] Stored response for analytics
2025-12-18 14:22:55,941:INFO:superset.db_engine_specs.dhis2_dialect:Using wide/pivoted format for analytics
2025-12-18 14:22:57,157:INFO:superset.db_engine_specs.dhis2_dialect:Fetched org unit levels: {3: 'District', 5: 'Health Facility', 1: 'National', 2: 'Region', 4: 'Sub County/Town Council/Div'}
2025-12-18 14:22:57,160:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] _fetch_org_unit_hierarchy: Fetching 1142 unique org units in batches...
2025-12-18 14:22:57,313:INFO:superset.db_engine_specs.dhis2_cache:[DHIS2 Cache] SET: analytics (ttl=3600s, key=dhis2:4a1c3321:analytics:5362e2052855...)
2025-12-18 14:22:57,313:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2 Cache] Stored response for analytics

[DHIS2] Row 0: OU=AA8TRyfTwtn, hierarchy_info={'level_1': 'MOH - Uganda', 'level_2': 'Ankole', 'level_3': 'Rwampara District', 'level_4': 'Mwizi Subcounty', 'level_5': None, 'level_6': None}
[DHIS2] Row 1: OU=AJxamlmKn2x, hierarchy_info={'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Amuru District', 'level_4': 'Lamogi Subcounty', 'level_5': 'Keyo Health Centre II', 'level_6': None}
[DHIS2] Row 2: OU=ALL4sSTGBRn, hierarchy_info={'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Gulu District', 'level_4': 'Owalo Subcounty', 'level_5': None, 'level_6': None}
[DHIS2] Normalized columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized row count: 4437
[DHIS2] First row: ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
[DHIS2] _set_description: original=['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], sanitized=['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], types=['String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String']
[DHIS2] Transformed rows count: 4437
[DHIS2] First transformed row: ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
[DHIS2] Fetched 4437 rows
[DHIS2] fetchall() called - returning 4437 rows
[DHIS2] fetchall() - First row type: <class 'tuple'>
[DHIS2] fetchall() - First row (original): ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
[DHIS2] fetchall() - Column count from description: 14
[DHIS2] fetchall() - First row (fixed types): ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
[DHIS2] fetchall() - Type enforcement: dimensions=STRING, measures=FLOAT
[DHIS2] Executing query: SELECT
  "District",
  SUM("105_EP01b_Malaria_Total") AS sum_1,
  SUM("105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive") AS sum_2
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "District"
ORDER BY
  SUM("105_EP01b_Malaria_Total") DESC
LIMIT 10000
[DHIS2] Parsed endpoint: analytics
[DHIS2] Found params in Flask g for analytics: table=analytics&dx=JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7
[DHIS2] Executing query: SELECT
  "District",
  SUM("105_EP01b_Malaria_Total") AS sum_1,
  SUM("105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive") AS sum_2
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "District"
ORDER BY
  SUM("105_EP01b_Malaria_Total") DESC
LIMIT 10000
[DHIS2] Query params: {'table': 'analytics', 'dx': 'JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX', 'pe': 'LAST_5_YEARS', 'ou': 'F1o6qBSx783;SUvODYOcaVf', 'ouMode': 'DESCENDANTS'}
[DHIS2] Parsed endpoint: analytics
[DHIS2] Found params in Flask g for analytics: table=analytics&dx=JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7
[DHIS2] Query params: {'table': 'analytics', 'dx': 'JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX', 'pe': 'LAST_5_YEARS', 'ou': 'F1o6qBSx783;SUvODYOcaVf', 'ouMode': 'DESCENDANTS'}
[DHIS2] Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dx': 'JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX', 'pe': 'LAST_5_YEARS', 'ou': 'F1o6qBSx783;SUvODYOcaVf', 'ouMode': 'DESCENDANTS'}
[DHIS2] Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dx': 'JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX', 'pe': 'LAST_5_YEARS', 'ou': 'F1o6qBSx783;SUvODYOcaVf', 'ouMode': 'DESCENDANTS'}
[DHIS2] Using all_levels scope: ['LEVEL-3', 'LEVEL-4', 'LEVEL-5']
[DHIS2] ðŸ”„ CACHE MISS - API request URL: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&dimension=pe:LAST_5_YEARS&dimension=ou:F1o6qBSx783;SUvODYOcaVf;LEVEL-3;LEVEL-4;LEVEL-5
[DHIS2] Using all_levels scope: ['LEVEL-3', 'LEVEL-4', 'LEVEL-5']
[DHIS2] ðŸ”„ CACHE MISS - API request URL: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&dimension=pe:LAST_5_YEARS&dimension=ou:F1o6qBSx783;SUvODYOcaVf;LEVEL-3;LEVEL-4;LEVEL-5
[DHIS2] Raw API response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Raw DHIS2 rows count: 22727
[DHIS2] First raw row: ['JhvC7ZR9hUe', '2022', 'C0RSe3EWBqU', '246166']
[DHIS2] âœ… Cached response for analytics (API took 4501.0ms)
[DHIS2] Parsing response for endpoint: analytics
[DHIS2] Response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Response sample: {'headers': [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}], 'metaDat
[DHIS2] Using WIDE/PIVOTED format (Period, Level_1_Name, Level_2_Name, ..., DX1, DX2, ...) for analytics
[DHIS2] Analytics headers: [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}]
[DHIS2] Found 'ou' column at index 2
[DHIS2] Processing 22727 rows to extract org unit IDs
[DHIS2] Extracted 1142 unique org unit IDs from rows
[DHIS2] Found 1142 unique org units in analytics response
[DHIS2] Fetching hierarchy for 1142 org units...
[DHIS2] _fetch_org_unit_hierarchy: Fetching 1142 unique org units
[DHIS2] Raw API response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Raw DHIS2 rows count: 22727
[DHIS2] First raw row: ['JhvC7ZR9hUe', '2022', 'C0RSe3EWBqU', '246166']
[DHIS2] âœ… Cached response for analytics (API took 5879.9ms)
[DHIS2] Parsing response for endpoint: analytics
[DHIS2] Response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Response sample: {'headers': [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}], 'metaDat2025-12-18 14:22:57,318:INFO:superset.db_engine_specs.dhis2_dialect:Using wide/pivoted format for analytics
2025-12-18 14:22:58,193:INFO:superset.db_engine_specs.dhis2_dialect:Fetched org unit levels: {3: 'District', 5: 'Health Facility', 1: 'National', 2: 'Region', 4: 'Sub County/Town Council/Div'}
2025-12-18 14:22:58,194:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] _fetch_org_unit_hierarchy: Fetching 1142 unique org units in batches...
2025-12-18 14:23:16,759:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Fetched 1142 org units, found 301 parent IDs
2025-12-18 14:23:16,759:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Iteration 1: Fetching 2 missing parent org units...
2025-12-18 14:23:17,621:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Iteration 2: Fetching 1 missing parent org units...
2025-12-18 14:23:17,840:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Fetched 1142 org units, found 301 parent IDs
2025-12-18 14:23:17,840:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Iteration 1: Fetching 2 missing parent org units...
2025-12-18 14:23:18,478:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total org unit names available: 1145
2025-12-18 14:23:18,480:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Sample hierarchy for a9NzDoLn9kz: {'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Kitgum District', 'level_4': 'Pager Division', 'level_5': None, 'level_6': None}
2025-12-18 14:23:18,480:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] _fetch_org_unit_hierarchy completed: 1142 org units with hierarchy
2025-12-18 14:23:18,480:INFO:superset.db_engine_specs.dhis2_dialect:normalize_analytics called with pivot=True, returning WIDE format
2025-12-18 14:23:18,492:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column construction - data_elements: ['AuAOIfCuBUp', 'BWZFz9RJRPI', 'D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'gHjJrtw9vQX', 'pRZrTLDN7Ge', 'wUDxFVBapIc']
2025-12-18 14:23:18,492:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column names constructed (SANITIZED): ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:23:18,494:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] FIRST ROW CONSTRUCTION:
2025-12-18 14:23:18,494:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   Period (index 0): 2020
2025-12-18 14:23:18,494:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   108-EP01a.2. Malaria Total (Deaths) (index 6): None
2025-12-18 14:23:18,494:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   108-EP01a.1. Malaria Total (Cases) (index 7): 3
2025-12-18 14:23:18,494:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01b. Malaria Total (index 8): 1580
2025-12-18 14:23:18,494:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01a. Suspected fever (index 9): 6695
2025-12-18 14:23:18,494:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01d. Malaria cases treated (index 10): 1560
2025-12-18 14:23:18,494:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   108-EP01b.2. Malaria Confirmed (Microscopic &RDT) (Deaths) (index 11): None
2025-12-18 14:23:18,494:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   108-EP01b.1. Malaria Confirmed (Microscopic &RDT) (Cases) (index 12): 3
2025-12-18 14:23:18,494:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01c. Malaria Confirmed (B/s and RDT Positive) (index 13): 1579
2025-12-18 14:23:18,501:INFO:superset.db_engine_specs.dhis2_dialect:First pivoted row - Period: '2020'
2025-12-18 14:23:18,501:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total pivoted rows: 4437, columns: 14
2025-12-18 14:23:18,502:INFO:superset.db_engine_specs.dhis2_dialect:Normalized 4437 rows with 14 columns for endpoint analytics
2025-12-18 14:23:18,502:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API returned 4437 rows
2025-12-18 14:23:18,513:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() - Row count: 4437

[DHIS2] Using WIDE/PIVOTED format (Period, Level_1_Name, Level_2_Name, ..., DX1, DX2, ...) for analytics
[DHIS2] Batch 1: Got 50 org units from DHIS2
[DHIS2]   OU: wNunka5Y2uu, name=Acholi-Bur Subcounty, level=4, parent=aBrjuZk0W31
[DHIS2]   OU: FihNC5KfGJV, name=Adilang Subcounty, level=4, parent=ztIyIYAzFKp
[DHIS2]   OU: HSBjlZdFpWn, name=Ajan Subcounty, level=4, parent=aBrjuZk0W31
[DHIS2] Analytics headers: [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}]
[DHIS2] Found 'ou' column at index 2
[DHIS2] Processing 22727 rows to extract org unit IDs
[DHIS2] Extracted 1142 unique org unit IDs from rows
[DHIS2] Found 1142 unique org units in analytics response
[DHIS2] Fetching hierarchy for 1142 org units...
[DHIS2] _fetch_org_unit_hierarchy: Fetching 1142 unique org units
[DHIS2] Batch 2: Got 50 org units from DHIS2
[DHIS2] Batch 1: Got 50 org units from DHIS2
[DHIS2]   OU: wNunka5Y2uu, name=Acholi-Bur Subcounty, level=4, parent=aBrjuZk0W31
[DHIS2]   OU: FihNC5KfGJV, name=Adilang Subcounty, level=4, parent=ztIyIYAzFKp
[DHIS2]   OU: HSBjlZdFpWn, name=Ajan Subcounty, level=4, parent=aBrjuZk0W31
[DHIS2] Batch 3: Got 50 org units from DHIS2
[DHIS2] Batch 2: Got 50 org units from DHIS2
[DHIS2] Batch 4: Got 50 org units from DHIS2
[DHIS2] Batch 3: Got 50 org units from DHIS2
[DHIS2] Batch 5: Got 50 org units from DHIS2
[DHIS2] Batch 4: Got 50 org units from DHIS2
[DHIS2] Batch 6: Got 50 org units from DHIS2
[DHIS2] Batch 5: Got 50 org units from DHIS2
[DHIS2] Batch 7: Got 50 org units from DHIS2
[DHIS2] Batch 6: Got 50 org units from DHIS2
[DHIS2] Batch 8: Got 50 org units from DHIS2
[DHIS2] Batch 7: Got 50 org units from DHIS2
[DHIS2] Batch 9: Got 50 org units from DHIS2
[DHIS2] Batch 8: Got 50 org units from DHIS2
[DHIS2] Batch 10: Got 50 org units from DHIS2
[DHIS2] Batch 9: Got 50 org units from DHIS2
[DHIS2] Batch 11: Got 50 org units from DHIS2
[DHIS2] Batch 10: Got 50 org units from DHIS2
[DHIS2] Batch 12: Got 50 org units from DHIS2
[DHIS2] Batch 11: Got 50 org units from DHIS2
[DHIS2] Batch 13: Got 50 org units from DHIS2
[DHIS2] Batch 12: Got 50 org units from DHIS2
[DHIS2] Batch 14: Got 50 org units from DHIS2
[DHIS2] Batch 13: Got 50 org units from DHIS2
[DHIS2] Batch 15: Got 50 org units from DHIS2
[DHIS2] Batch 14: Got 50 org units from DHIS2
[DHIS2] Batch 16: Got 50 org units from DHIS2
[DHIS2] Batch 15: Got 50 org units from DHIS2
[DHIS2] Batch 17: Got 50 org units from DHIS2
[DHIS2] Batch 16: Got 50 org units from DHIS2
[DHIS2] Batch 18: Got 50 org units from DHIS2
[DHIS2] Batch 17: Got 50 org units from DHIS2
[DHIS2] Batch 19: Got 50 org units from DHIS2
[DHIS2] Batch 18: Got 50 org units from DHIS2
[DHIS2] Batch 20: Got 50 org units from DHIS2
[DHIS2] Batch 19: Got 50 org units from DHIS2
[DHIS2] Batch 21: Got 50 org units from DHIS2
[DHIS2] Batch 20: Got 50 org units from DHIS2
[DHIS2] Batch 22: Got 50 org units from DHIS2
[DHIS2] Batch 21: Got 50 org units from DHIS2
[DHIS2] Batch 23: Got 42 org units from DHIS2
[DHIS2] Batch 22: Got 50 org units from DHIS2
[DHIS2] Batch 23: Got 42 org units from DHIS2
[DHIS2] Total org unit names available: 1145 after 2 iterations
[DHIS2] Sample hierarchy for a9NzDoLn9kz: {'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Kitgum District', 'level_4': 'Pager Division', 'level_5': None, 'level_6': None}
[DHIS2]   a9NzDoLn9kz: filled levels = ['level_1', 'level_2', 'level_3', 'level_4']
[DHIS2]   aFgrVHVDqoZ: filled levels = ['level_1', 'level_2', 'level_3', 'level_4', 'level_5']
[DHIS2]   fxHApp8UtpE: filled levels = ['level_1', 'level_2', 'level_3', 'level_4', 'level_5']
[DHIS2] Fetched hierarchy for 1142 org units
[DHIS2] Sample hierarchy for a9NzDoLn9kz: {'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Kitgum District', 'level_4': 'Pager Division', 'level_5': None, 'level_6': None}
[DHIS2] Calling DHIS2ResponseNormalizer.normalize with:
[DHIS2]   - endpoint: analytics
[DHIS2]   - pivot: True
[DHIS2]   - org_unit_hierarchy: 1142 entries
[DHIS2]   - org_unit_level_names: {3: 'District', 5: 'Health Facility', 1: 'National', 2: 'Region', 4: 'Sub County/Town Council/Div'}
[DHIS2] normalize_analytics: pivot=True, using WIDE/PIVOTED format
[DHIS2] PIVOT CONSTRUCTION:
[DHIS2]   data_elements (UIDs): ['AuAOIfCuBUp', 'BWZFz9RJRPI', 'D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'gHjJrtw9vQX', 'pRZrTLDN7Ge', 'wUDxFVBapIc']
[DHIS2]   data_element_list (sorted UIDs): ['AuAOIfCuBUp', 'BWZFz9RJRPI', 'D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'gHjJrtw9vQX', 'pRZrTLDN7Ge', 'wUDxFVBapIc']
[DHIS2]   col_names (SANITIZED): ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Row 0: OU=AA8TRyfTwtn, hierarchy_info={'level_1': 'MOH - Uganda', 'level_2': 'Ankole', 'level_3': 'Rwampara District', 'level_4': 'Mwizi Subcounty', 'level_5': None, 'level_6': None}
[DHIS2] Row 1: OU=AJxamlmKn2x, hierarchy_info={'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Amuru District', 'level_4': 'Lamogi Subcounty', 'level_5': 'Keyo Health Centre II', 'level_6': None}
[DHIS2] Row 2: OU=ALL4sSTGBRn, hierarchy_info={'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Gulu District', 'level_4': 'Owalo Subcounty', 'level_5': None, 'level_6': None}
[DHIS2] Normalized columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized row count: 4437
[DHIS2] First row: ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
[DHIS2] _set_description: original=['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], sanitized=['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], types=['String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String']
[DHIS2] Transformed rows count: 4437
[DHIS2] First transformed row: ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
[DHIS2] Fetched 4437 rows
[DHIS2] fetchall() called - returning 4437 rows
[DHIS2] fetchall() - First row type: <class 'tuple'>
[DHIS2] fetchall() - First row (original): ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
[DHIS2] fetchall() - Column count from description: 14
2025-12-18 14:23:18,513:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:23:18,513:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names length: 14
2025-12-18 14:23:18,513:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values count: 14
2025-12-18 14:23:18,513:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values: ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
2025-12-18 14:23:18,513:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 0 (Period): 2020 -> 2020 (STRING)
2025-12-18 14:23:18,513:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (National): 'MOH - Uganda...' -> STRING (non-numeric detected)
2025-12-18 14:23:18,513:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (National): MOH - Uganda (PROCESSED)
2025-12-18 14:23:18,513:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (Region): 'Ankole...' -> STRING (non-numeric detected)
2025-12-18 14:23:18,513:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (Region): Ankole (PROCESSED)
2025-12-18 14:23:18,513:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (District): 'Rwampara District...' -> STRING (non-numeric detected)
2025-12-18 14:23:18,513:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (District): Rwampara District (PROCESSED)
2025-12-18 14:23:18,513:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (Sub_County_Town_Council_Div): 'Mwizi Subcounty...' -> STRING (non-numeric detected)
2025-12-18 14:23:18,513:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (Sub_County_Town_Council_Div): Mwizi Subcounty (PROCESSED)
2025-12-18 14:23:18,525:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() returning 4437 rows with 14 columns each
2025-12-18 14:23:18,526:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Got 4437 rows from cursor
2025-12-18 14:23:18,526:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: First row: ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
2025-12-18 14:23:18,526:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:23:18,526:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Types from cursor: ['String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String']
2025-12-18 14:23:18,531:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: DataFrame created with 4437 rows, 14 columns
2025-12-18 14:23:18,531:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:23:18,531:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes BEFORE fix: {'Period': dtype('O'), 'National': dtype('O'), 'Region': dtype('O'), 'District': dtype('O'), 'Sub_County_Town_Council_Div': dtype('O'), 'Health_Facility': dtype('O'), '108_EP01a_2_Malaria_Total_Deaths': dtype('O'), '108_EP01a_1_Malaria_Total_Cases': dtype('O'), '105_EP01b_Malaria_Total': dtype('O'), '105_EP01a_Suspected_fever': dtype('O'), '105_EP01d_Malaria_cases_treated': dtype('O'), '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths': dtype('O'), '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases': dtype('O'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('O')}
2025-12-18 14:23:18,532:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Period' to object dtype (dimension)
2025-12-18 14:23:18,532:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'National' as dimension (contains non-numeric string: 'MOH - Uganda...')
2025-12-18 14:23:18,532:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'National' to object dtype (dimension)
2025-12-18 14:23:18,532:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'Region' as dimension (contains non-numeric string: 'Ankole...')
2025-12-18 14:23:18,533:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Region' to object dtype (dimension)
2025-12-18 14:23:18,533:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'District' as dimension (contains non-numeric string: 'Rwampara District...')
2025-12-18 14:23:18,533:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'District' to object dtype (dimension)
2025-12-18 14:23:18,533:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'Sub_County_Town_Council_Div' as dimension (contains non-numeric string: 'Mwizi Subcounty...')
2025-12-18 14:23:18,533:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Sub_County_Town_Council_Div' to object dtype (dimension)
2025-12-18 14:23:18,533:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'Health_Facility' as dimension (contains non-numeric string: 'Keyo Health Centre II...')
2025-12-18 14:23:18,534:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Health_Facility' to object dtype (dimension)
2025-12-18 14:23:18,535:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes AFTER fix: {'Period': dtype('O'), 'National': dtype('O'), 'Region': dtype('O'), 'District': dtype('O'), 'Sub_County_Town_Council_Div': dtype('O'), 'Health_Facility': dtype('O'), '108_EP01a_2_Malaria_Total_Deaths': dtype('O'), '108_EP01a_1_Malaria_Total_Cases': dtype('O'), '105_EP01b_Malaria_Total': dtype('O'), '105_EP01a_Suspected_fever': dtype('O'), '105_EP01d_Malaria_cases_treated': dtype('O'), '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths': dtype('O'), '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases': dtype('O'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('O')}
2025-12-18 14:23:18,535:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: First row: {'Period': '2020', 'National': 'MOH - Uganda', 'Region': 'Ankole', 'District': 'Rwampara District', 'Sub_County_Town_Council_Div': 'Mwizi Subcounty', 'Health_Facility': None, '108_EP01a_2_Malaria_Total_Deaths': None, '108_EP01a_1_Malaria_Total_Cases': 3, '105_EP01b_Malaria_Total': 1580, '105_EP01a_Suspected_fever': 6695, '105_EP01d_Malaria_cases_treated': 1560, '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths': None, '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases': 3, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 1579}
2025-12-18 14:23:18,537:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] BEFORE assign_column_label:
2025-12-18 14:23:18,537:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4437, 14)
2025-12-18 14:23:18,537:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:23:18,537:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:23:18,538:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: False
2025-12-18 14:23:18,538:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Period': '2020', 'National': 'MOH - Uganda', 'Region': 'Ankole', 'District': 'Rwampara District', 'Sub_County_Town_Council_Div': 'Mwizi Subcounty', 'Health_Facility': None, '108_EP01a_2_Malaria_Total_Deaths': None, '108_EP01a_1_Malaria_Total_Cases': 3, '105_EP01b_Malaria_Total': 1580, '105_EP01a_Suspected_fever': 6695, '105_EP01d_Malaria_cases_treated': 1560, '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths': None, '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases': 3, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 1579}
2025-12-18 14:23:18,539:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Column truncation needed: df has 14 columns, expected 3
2025-12-18 14:23:18,539:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   DataFrame actual columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:23:18,539:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Expected columns: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:23:18,539:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] âœ“ Selecting columns BY NAME (matched all expected columns)
2025-12-18 14:23:18,539:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Column mapping: {'District': 'District', 'SUM(105-EP01b. Malaria Total)': '105_EP01b_Malaria_Total', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))': '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'}
2025-12-18 14:23:18,539:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] Column Selection âœ“ SUCCESS - method=BY_NAME, datasource=analytics 20251217-3246
2025-12-18 14:23:18,539:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:23:18,539:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   tried_by_name=True, success=True, fallback=False
2025-12-18 14:23:18,539:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Assigning column labels: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:23:18,540:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] AFTER assign_column_label:
2025-12-18 14:23:18,540:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4437, 3)
2025-12-18 14:23:18,540:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:23:18,540:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:23:18,540:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: True
2025-12-18 14:23:18,540:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'District': 'Rwampara District', 'SUM(105-EP01b. Malaria Total)': 1580, 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))': 1579}
2025-12-18 14:23:18,543:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING] Auto-sanitizing wrapped aggregate: 'SUM(105-EP01b. Malaria Total)' -> 'SUM(105_EP01b_Malaria_Total)'
2025-12-18 14:23:18,544:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING] Auto-sanitizing wrapped aggregate: 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))' -> 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)'
2025-12-18 14:23:18,544:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] DataFrame columns: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:23:18,544:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Aggregates: {'SUM(105-EP01b. Malaria Total)': {'operator': 'mean', 'column': 'SUM(105_EP01b_Malaria_Total)'}, 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))': {'operator': 'mean', 'column': 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)'}}
2025-12-18 14:23:18,544:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105-EP01b. Malaria Total)', column='SUM(105_EP01b_Malaria_Total)'
2025-12-18 14:23:18,544:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Column 'SUM(105_EP01b_Malaria_Total)' not found directly. Checking if aggregate name 'SUM(105-EP01b. Malaria Total)' is in DataFrame...
2025-12-18 14:23:18,544:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Found aggregate name 'SUM(105-EP01b. Malaria Total)' in DataFrame! Using name as column.
2025-12-18 14:23:18,544:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))', column='SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)'
2025-12-18 14:23:18,544:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Column 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)' not found directly. Checking if aggregate name 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))' is in DataFrame...
2025-12-18 14:23:18,544:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Found aggregate name 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))' in DataFrame! Using name as column.
2025-12-18 14:23:18,558:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:23:18] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-18 14:23:18,736:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Iteration 2: Fetching 1 missing parent org units...
2025-12-18 14:23:19,590:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total org unit names available: 1145
2025-12-18 14:23:19,593:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Sample hierarchy for a9NzDoLn9kz: {'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Kitgum District', 'level_4': 'Pager Division', 'level_5': None, 'level_6': None}
2025-12-18 14:23:19,593:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] _fetch_org_unit_hierarchy completed: 1142 org units with hierarchy
2025-12-18 14:23:19,593:INFO:superset.db_engine_specs.dhis2_dialect:normalize_analytics called with pivot=True, returning WIDE format
2025-12-18 14:23:19,619:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column construction - data_elements: ['AuAOIfCuBUp', 'BWZFz9RJRPI', 'D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'gHjJrtw9vQX', 'pRZrTLDN7Ge', 'wUDxFVBapIc']
2025-12-18 14:23:19,619:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column names constructed (SANITIZED): ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:23:19,621:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] FIRST ROW CONSTRUCTION:
2025-12-18 14:23:19,621:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   Period (index 0): 2020
2025-12-18 14:23:19,621:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   108-EP01a.2. Malaria Total (Deaths) (index 6): None
2025-12-18 14:23:19,621:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   108-EP01a.1. Malaria Total (Cases) (index 7): 3
2025-12-18 14:23:19,621:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01b. Malaria Total (index 8): 1580
2025-12-18 14:23:19,621:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01a. Suspected fever (index 9): 6695
2025-12-18 14:23:19,621:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01d. Malaria cases treated (index 10): 1560
2025-12-18 14:23:19,621:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   108-EP01b.2. Malaria Confirmed (Microscopic &RDT) (Deaths) (index 11): None
2025-12-18 14:23:19,621:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   108-EP01b.1. Malaria Confirmed (Microscopic &RDT) (Cases) (index 12): 3
2025-12-18 14:23:19,621:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01c. Malaria Confirmed (B/s and RDT Positive) (index 13): 1579
2025-12-18 14:23:19,635:INFO:superset.db_engine_specs.dhis2_dialect:First pivoted row - Period: '2020'
2025-12-18 14:23:19,635:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total pivoted rows: 4437, columns: 14
2025-12-18 14:23:19,636:INFO:superset.db_engine_specs.dhis2_dialect:Normalized 4437 rows with 14 columns for endpoint analytics
2025-12-18 14:23:19,636:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API returned 4437 rows
2025-12-18 14:23:19,643:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() - Row count: 4437
2025-12-18 14:23:19,643:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:23:19,643:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names length: 14
2025-12-18 14:23:19,644:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values count: 14
2025-12-18 14:23:19,644:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values: ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
2025-12-18 14:23:19,644:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 0 (Period): 2020 -> 2020 (STRING)
2025-12-18 14:23:19,644:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (National): 'MOH - Uganda...' -> STRING (non-numeric detected)
2025-12-18 14:23:19,644:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (National): MOH - Uganda (PROCESSED)
2025-12-18 14:23:19,644:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (Region): 'Ankole...' -> STRING (non-numeric detected)
2025-12-18 14:23:19,644:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (Region): Ankole (PROCESSED)
2025-12-18 14:23:19,644:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (District): 'Rwampara District...' -> STRING (non-numeric detected)
2025-12-18 14:23:19,644:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (District): Rwampara District (PROCESSED)
2025-12-18 14:23:19,644:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (Sub_County_Town_Council_Div): 'Mwizi Subcounty...' -> STRING (non-numeric detected)
2025-12-18 14:23:19,644:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (Sub_County_Town_Council_Div): Mwizi Subcounty (PROCESSED)
2025-12-18 14:23:19,662:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() returning 4437 rows with 14 columns each
2025-12-18 14:23:19,662:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Got 4437 rows from cursor
2025-12-18 14:23:19,662:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: First row: ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
2025-12-18 14:23:19,662:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:23:19,662:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Types from cursor: ['String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String']
2025-12-18 14:23:19,666:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: DataFrame created with 4437 rows, 14 columns
2025-12-18 14:23:19,667:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:23:19,667:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes BEFORE fix: {'Period': dtype('O'), 'National': dtype('O'), 'Region': dtype('O'), 'District': dtype('O'), 'Sub_County_Town_Council_Div': dtype('O'), 'Health_Facility': dtype('O'), '108_EP01a_2_Malaria_Total_Deaths': dtype('O'), '108_EP01a_1_Malaria_Total_Cases': dtype('O'), '105_EP01b_Malaria_Total': dtype('O'), '105_EP01a_Suspected_fever': dtype('O'), '105_EP01d_Malaria_cases_treated': dtype('O'), '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths': dtype('O'), '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases': dtype('O'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('O')}
2025-12-18 14:23:19,667:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Period' to object dtype (dimension)
2025-12-18 14:23:19,667:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'National' as dimension (contains non-numeric string: 'MOH - Uganda...')
2025-12-18 14:23:19,667:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'National' to object dtype (dimension)
2025-12-18 14:23:19,668:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'Region' as dimension (contains non-numeric string: 'Ankole...')
2025-12-18 14:23:19,668:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Region' to object dtype (dimension)
2025-12-18 14:23:19,668:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'District' as dimension (contains non-numeric string: 'Rwampara District...')
2025-12-18 14:23:19,668:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'District' to object dtype (dimension)
2025-12-18 14:23:19,668:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'Sub_County_Town_Council_Div' as dimension (contains non-numeric string: 'Mwizi Subcounty...')
2025-12-18 14:23:19,668:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Sub_County_Town_Council_Div' to object dtype (dimension)
2025-12-18 14:23:19,669:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'Health_Facility' as dimension (contains non-numeric string: 'Keyo Health Centre II...')
2025-12-18 14:23:19,669:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Health_Facility' to object dtype (dimension)
2025-12-18 14:23:19,670:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes AFTER fix: {'Period': dtype('O'), 'National': dtype('O'), 'Region': dtype('O'), 'District': dtype('O'), 'Sub_County_Town_Council_Div': dtype('O'), 'Health_Facility': dtype('O'), '108_EP01a_2_Malaria_Total_Deaths': dtype('O'), '108_EP01a_1_Malaria_Total_Cases': dtype('O'), '105_EP01b_Malaria_Total': dtype('O'), '105_EP01a_Suspected_fever': dtype('O'), '105_EP01d_Malaria_cases_treated': dtype('O'), '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths': dtype('O'), '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases': dtype('O'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('O')}
2025-12-18 14:23:19,670:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: First row: {'Period': '2020', 'National': 'MOH - Uganda', 'Region': 'Ankole', 'District': 'Rwampara District', 'Sub_County_Town_Council_Div': 'Mwizi Subcounty', 'Health_Facility': None, '108_EP01a_2_Malaria_Total_Deaths': None, '108_EP01a_1_Malaria_Total_Cases': 3, '105_EP01b_Malaria_Total': 1580, '105_EP01a_Suspected_fever': 6695, '105_EP01d_Malaria_cases_treated': 1560, '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths': None, '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases': 3, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 1579}
2025-12-18 14:23:19,677:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] BEFORE assign_column_label:
2025-12-18 14:23:19,677:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4437, 14)
2025-12-18 14:23:19,677:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:23:19,677:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:23:19,677:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: False
2025-12-18 14:23:19,677:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Period': '2020', 'National': 'MOH - Uganda', 'Region': 'Ankole', 'District': 'Rwampara District', 'Sub_County_Town_Council_Div': 'Mwizi Subcounty', 'Health_Facility': None, '108_EP01a_2_Malaria_Total_Deaths': None, '108_EP01a_1_Malaria_Total_Cases': 3, '105_EP01b_Malaria_Total': 1580, '105_EP01a_Suspected_fever': 6695, '105_EP01d_Malaria_cases_treated': 1560, '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths': None, '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases': 3, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 1579}
2025-12-18 14:23:19,677:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Column truncation needed: df has 14 columns, expected 3
2025-12-18 14:23:19,677:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   DataFrame actual columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:23:19,677:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Expected columns: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:23:19,677:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] âœ“ Selecting columns BY NAME (matched all expected columns)
2025-12-18 14:23:19,677:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Column mapping: {'District': 'District', 'SUM(105-EP01b. Malaria Total)': '105_EP01b_Malaria_Total', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))': '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'}
2025-12-18 14:23:19,679:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] Column Selection âœ“ SUCCESS - method=BY_NAME, datasource=analytics 20251217-3246
2025-12-18 14:23:19,679:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:23:19,679:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   tried_by_name=True, success=True, fallback=False
2025-12-18 14:23:19,679:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Assigning column labels: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:23:19,679:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] AFTER assign_column_label:
2025-12-18 14:23:19,679:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4437, 3)
2025-12-18 14:23:19,680:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:23:19,680:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:23:19,680:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: True
2025-12-18 14:23:19,681:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'District': 'Rwampara District', 'SUM(105-EP01b. Malaria Total)': 1580, 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))': 1579}
2025-12-18 14:23:19,686:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING] Auto-sanitizing wrapped aggregate: 'SUM(105-EP01b. Malaria Total)' -> 'SUM(105_EP01b_Malaria_Total)'
2025-12-18 14:23:19,686:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING] Auto-sanitizing wrapped aggregate: 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))' -> 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)'
2025-12-18 14:23:19,686:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] DataFrame columns: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:23:19,686:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Aggregates: {'SUM(105-EP01b. Malaria Total)': {'operator': 'mean', 'column': 'SUM(105_EP01b_Malaria_Total)'}, 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))': {'operator': 'mean', 'column': 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)'}}
2025-12-18 14:23:19,686:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105-EP01b. Malaria Total)', column='SUM(105_EP01b_Malaria_Total)'
2025-12-18 14:23:19,686:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Column 'SUM(105_EP01b_Malaria_Total)' not found directly. Checking if aggregate name 'SUM(105-EP01b. Malaria Total)' is in DataFrame...
2025-12-18 14:23:19,686:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Found aggregate name 'SUM(105-EP01b. Malaria Total)' in DataFrame! Using name as column.
2025-12-18 14:23:19,686:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))', column='SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)'
2025-12-18 14:23:19,686:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Column 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)' not found directly. Checking if aggregate name 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))' is in DataFrame...
2025-12-18 14:23:19,686:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Found aggregate name 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))' in DataFrame! Using name as column.
2025-12-18 14:23:19,717:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:23:19] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-18 14:23:22,243:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:23:22] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 14:23:26,830:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:23:26] "GET /api/v1/database/?q=(filters:!((col:database_name,opr:neq,value:examples))) HTTP/1.1" 200 -
2025-12-18 14:23:26,831:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:23:26] "GET /api/v1/database/?q=(filters:!((col:allow_file_upload,opr:upload_is_enabled,value:!t))) HTTP/1.1" 200 -
2025-12-18 14:23:26,858:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:23:26] "GET /api/v1/database/?q=(filters:!((col:allow_file_upload,opr:upload_is_enabled,value:!t))) HTTP/1.1" 200 -
2025-12-18 14:23:26,859:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:23:26] "GET /api/v1/database/?q=(filters:!((col:database_name,opr:neq,value:examples))) HTTP/1.1" 200 -
2025-12-18 14:23:27,715:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:23:27] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 14:24:07,492:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:24:07] "GET /explore/?form_data_key=ULWSeaI5Yyo&datasource_type=table&datasource_id=4 HTTP/1.1" 200 -
2025-12-18 14:24:10,500:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:24:10] "GET /api/v1/database/?q=(filters:!((col:allow_file_upload,opr:upload_is_enabled,value:!t))) HTTP/1.1" 200 -
2025-12-18 14:24:10,584:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:24:10] "GET /api/v1/database/?q=(filters:!((col:database_name,opr:neq,value:examples))) HTTP/1.1" 200 -
2025-12-18 14:24:11,530:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:24:11] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 14:24:11,541:INFO:superset.db_engine_specs.dhis2:[DHIS2] get_parameters_from_uri called
2025-12-18 14:24:11,541:ERROR:superset.db_engine_specs.dhis2:[DHIS2] Failed to extract parameters from URI: 'URL' object has no attribute 'decode'
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/superset/db_engine_specs/dhis2.py", line 361, in get_parameters_from_uri
    parsed = urlparse(uri)
             ^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/urllib/parse.py", line 394, in urlparse
    url, scheme, _coerce_result = _coerce_args(url, scheme)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/urllib/parse.py", line 133, in _coerce_args
    return _decode_args(args) + (_encode_result,)
           ^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/urllib/parse.py", line 117, in _decode_args
    return tuple(x.decode(encoding, errors) if x else '' for x in args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/urllib/parse.py", line 117, in <genexpr>
    return tuple(x.decode(encoding, errors) if x else '' for x in args)
                 ^^^^^^^^
AttributeError: 'URL' object has no attribute 'decode'
2025-12-18 14:24:11,548:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:24:11] "GET /api/v1/explore/?form_data_key=ULWSeaI5Yyo&datasource_type=table&datasource_id=4 HTTP/1.1" 200 -
2025-12-18 14:24:12,180:INFO:superset.common.query_object:[QueryObject] Removed 1 duplicate column(s): ['District']. Original count: 2, New count: 1
2025-12-18 14:24:12,186:ERROR:superset.models.helpers:[METRICS-TRACE] Processing 2 metrics
2025-12-18 14:24:12,186:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 0: adhoc - SUM(105-EP01b. Malaria Total)
2025-12-18 14:24:12,187:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105-EP01b. Malaria Total)
2025-12-18 14:24:12,187:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 1: adhoc - SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))
2025-12-18 14:24:12,187:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))
2025-12-18 14:24:12,187:ERROR:superset.models.helpers:[METRICS-TRACE] Total metrics added: 2
2025-12-18 14:24:12,189:ERROR:superset.models.helpers:[METRICS-TRACE] Before dedup: 1 select_exprs + 2 metrics_exprs
2025-12-18 14:24:12,189:ERROR:superset.models.helpers:[METRICS-TRACE] After dedup: 3 total select_exprs
2025-12-18 14:24:12,189:INFO:superset.models.helpers:[COLUMN_TRACE] SQL Query Building:
2025-12-18 14:24:12,189:INFO:superset.models.helpers:[COLUMN_TRACE]   columns: [{'timeGrain': None, 'columnType': 'BASE_AXIS', 'sqlExpression': 'District', 'label': 'District', 'expressionType': 'SQL'}]
2025-12-18 14:24:12,189:INFO:superset.models.helpers:[COLUMN_TRACE]   metrics: [{'aggregate': 'SUM', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01b_Malaria_Total', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 40, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'FLOAT', 'type_generic': 0, 'uuid': '5da7ec93-b44e-48b9-8004-7d62a62c5ac0', 'verbose_name': '105-EP01b. Malaria Total', 'warning_markdown': None}, 'datasourceWarning': False, 'expressionType': 'SIMPLE', 'hasCustomLabel': False, 'label': 'SUM(105-EP01b. Malaria Total)', 'optionName': 'metric_k9q7silao1_oi8evqrbvi', 'sqlExpression': None}, {'aggregate': 'SUM', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 41, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'column', 'type_generic': 0, 'uuid': 'c71fe8aa-92db-4107-a95b-2c7d99fa828a', 'verbose_name': '105-EP01c. Malaria Confirmed (B/s and RDT Positive)', 'warning_markdown': None}, 'datasourceWarning': False, 'expressionType': 'SIMPLE', 'hasCustomLabel': False, 'label': 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))', 'optionName': 'metric_oj8hdui9ylq_nue3d0up82', 'sqlExpression': None}]
2025-12-18 14:24:12,189:INFO:superset.models.helpers:[COLUMN_TRACE]   groupby: []
2025-12-18 14:24:12,189:INFO:superset.models.helpers:[COLUMN_TRACE]   labels_expected: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:24:12,189:INFO:superset.models.helpers:[COLUMN_TRACE]   select_exprs count: 3
2025-12-18 14:24:12,189:INFO:superset.models.helpers:[COLUMN_TRACE]     [0] key=District, name=District, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-18 14:24:12,189:INFO:superset.models.helpers:[COLUMN_TRACE]     [1] key=SUM(105-EP01b. Malaria Total), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-18 14:24:12,189:INFO:superset.models.helpers:[COLUMN_TRACE]     [2] key=SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive)), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-18 14:24:12,189:INFO:superset.connectors.sqla.models:[DHIS2] get_from_clause for virtual dataset 4: analytics 20251217-3246
2025-12-18 14:24:12,189:INFO:superset.connectors.sqla.models:[DHIS2] Full SQL stored: SELECT * FROM analytics
/* DHIS2: table=analytics&dx=JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&pe=LAST_5_YEARS&ou=F1o6qBSx783;SUvODYOcaVf&ouMode=DESCENDANTS */
2025-12-18 14:24:12,189:INFO:superset.connectors.sqla.models:[DHIS2] Loaded params from extra field: table=analytics&dx=JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&pe=LAST_5_YEARS&ou=F1o6qBSx783;SUvO
2025-12-18 14:24:12,190:INFO:superset.connectors.sqla.models:[DHIS2] Cached params with key: dhis2_params_4_analytics
2025-12-18 14:24:12,190:INFO:superset.connectors.sqla.models:[DHIS2] Stored params in Flask g for DHIS2 table: analytics
2025-12-18 14:24:12,193:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Query execution in connectors/sqla/models.py:
2025-12-18 14:24:12,193:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   SQL (first 500 chars): SELECT "District", sum("105_EP01b_Malaria_Total") AS sum_1, sum("105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive") AS sum_2 
FROM (SELECT * FROM analytics
/* DHIS2: table=analytics&dx=JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&pe=LAST_5_YEARS&ou=F1o6qBSx783;SUvODYOcaVf&ouMode=DESCENDANTS */
) AS virtual_table GROUP BY "District" ORDER BY sum("105_EP01b_Malaria_Total") DESC
 LIMIT 10000
2025-12-18 14:24:12,193:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   labels_expected: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:24:12,195:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 connection initialized: https://tests.dhis2.hispuganda.org/hmis/api
2025-12-18 14:24:12,196:INFO:superset.db_engine_specs.dhis2_dialect:Executing DHIS2 query: SELECT
  "District",
  SUM("105_EP01b_Malaria_Total") AS sum_1,
  SUM("105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive") AS sum_2
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "District"
ORDER BY
  SUM("105_EP01b_Malaria_Total") DESC
LIMIT 10000
2025-12-18 14:24:12,196:INFO:superset.db_engine_specs.dhis2_dialect:Parsed endpoint: analytics
2025-12-18 14:24:12,196:INFO:superset.db_engine_specs.dhis2_dialect:Using stored parameters from Flask g for table: analytics
2025-12-18 14:24:12,197:INFO:superset.db_engine_specs.dhis2_dialect:Query params: {'table': 'analytics', 'dx': 'JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX', 'pe': 'LAST_5_YEARS', 'ou': 'F1o6qBSx783;SUvODYOcaVf', 'ouMode': 'DESCENDANTS'}
2025-12-18 14:24:12,197:INFO:superset.db_engine_specs.dhis2_dialect:Period dimension detected - omitting startDate/endDate (DHIS2 API rule)
2025-12-18 14:24:12,197:INFO:superset.db_engine_specs.dhis2_dialect:Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dx': 'JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX', 'pe': 'LAST_5_YEARS', 'ou': 'F1o6qBSx783;SUvODYOcaVf', 'ouMode': 'DESCENDANTS'}
2025-12-18 14:24:12,766:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:24:12] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 14:24:12,816:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:24:12] "[35m[1mPOST /api/v1/explore/form_data?tab_id=2 HTTP/1.1[0m" 201 -
2025-12-18 14:24:13,120:INFO:superset.db_engine_specs.dhis2_dialect:Fetched org unit levels: {3: 'District', 5: 'Health Facility', 1: 'National', 2: 'Region', 4: 'Sub County/Town Council/Div'}
2025-12-18 14:24:13,990:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Using all_levels scope: ['LEVEL-3', 'LEVEL-4', 'LEVEL-5']
2025-12-18 14:24:13,990:INFO:superset.db_engine_specs.dhis2_dialect:Converted dx/pe/ou to dimension parameter: dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX;pe:LAST_5_YEARS;ou:F1o6qBSx783;SUvODYOcaVf;LEVEL-3;LEVEL-4;LEVEL-5
2025-12-18 14:24:13,990:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API request (cache miss): https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&dimension=pe:LAST_5_YEARS&dimension=ou:F1o6qBSx783;SUvODYOcaVf;LEVEL-3;LEVEL-4;LEVEL-5
2025-12-18 14:24:17,579:INFO:superset.db_engine_specs.dhis2_cache:[DHIS2 Cache] SET: analytics (ttl=3600s, key=dhis2:4a1c3321:analytics:5362e2052855...)
2025-12-18 14:24:17,581:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2 Cache] Stored response for analytics
2025-12-18 14:24:17,600:INFO:superset.db_engine_specs.dhis2_dialect:Using wide/pivoted format for analytics
2025-12-18 14:24:18,463:INFO:superset.db_engine_specs.dhis2_dialect:Fetched org unit levels: {3: 'District', 5: 'Health Facility', 1: 'National', 2: 'Region', 4: 'Sub County/Town Council/Div'}
[DHIS2] fetchall() - First row (fixed types): ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
[DHIS2] fetchall() - Type enforcement: dimensions=STRING, measures=FLOAT
[DHIS2] Total org unit names available: 1145 after 2 iterations
[DHIS2] Sample hierarchy for a9NzDoLn9kz: {'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Kitgum District', 'level_4': 'Pager Division', 'level_5': None, 'level_6': None}
[DHIS2]   a9NzDoLn9kz: filled levels = ['level_1', 'level_2', 'level_3', 'level_4']
[DHIS2]   aFgrVHVDqoZ: filled levels = ['level_1', 'level_2', 'level_3', 'level_4', 'level_5']
[DHIS2]   fxHApp8UtpE: filled levels = ['level_1', 'level_2', 'level_3', 'level_4', 'level_5']
[DHIS2] Fetched hierarchy for 1142 org units
[DHIS2] Sample hierarchy for a9NzDoLn9kz: {'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Kitgum District', 'level_4': 'Pager Division', 'level_5': None, 'level_6': None}
[DHIS2] Calling DHIS2ResponseNormalizer.normalize with:
[DHIS2]   - endpoint: analytics
[DHIS2]   - pivot: True
[DHIS2]   - org_unit_hierarchy: 1142 entries
[DHIS2]   - org_unit_level_names: {3: 'District', 5: 'Health Facility', 1: 'National', 2: 'Region', 4: 'Sub County/Town Council/Div'}
[DHIS2] normalize_analytics: pivot=True, using WIDE/PIVOTED format
[DHIS2] PIVOT CONSTRUCTION:
[DHIS2]   data_elements (UIDs): ['AuAOIfCuBUp', 'BWZFz9RJRPI', 'D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'gHjJrtw9vQX', 'pRZrTLDN7Ge', 'wUDxFVBapIc']
[DHIS2]   data_element_list (sorted UIDs): ['AuAOIfCuBUp', 'BWZFz9RJRPI', 'D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'gHjJrtw9vQX', 'pRZrTLDN7Ge', 'wUDxFVBapIc']
[DHIS2]   col_names (SANITIZED): ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Row 0: OU=AA8TRyfTwtn, hierarchy_info={'level_1': 'MOH - Uganda', 'level_2': 'Ankole', 'level_3': 'Rwampara District', 'level_4': 'Mwizi Subcounty', 'level_5': None, 'level_6': None}
[DHIS2] Row 1: OU=AJxamlmKn2x, hierarchy_info={'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Amuru District', 'level_4': 'Lamogi Subcounty', 'level_5': 'Keyo Health Centre II', 'level_6': None}
[DHIS2] Row 2: OU=ALL4sSTGBRn, hierarchy_info={'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Gulu District', 'level_4': 'Owalo Subcounty', 'level_5': None, 'level_6': None}
[DHIS2] Normalized columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized row count: 4437
[DHIS2] First row: ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
[DHIS2] _set_description: original=['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], sanitized=['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], types=['String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String']
[DHIS2] Transformed rows count: 4437
[DHIS2] First transformed row: ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
[DHIS2] Fetched 4437 rows
[DHIS2] fetchall() called - returning 4437 rows
[DHIS2] fetchall() - First row type: <class 'tuple'>
[DHIS2] fetchall() - First row (original): ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
[DHIS2] fetchall() - Column count from description: 14
[DHIS2] fetchall() - First row (fixed types): ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
[DHIS2] fetchall() - Type enforcement: dimensions=STRING, measures=FLOAT
[DHIS2] Executing query: SELECT
  "District",
  SUM("105_EP01b_Malaria_Total") AS sum_1,
  SUM("105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive") AS sum_2
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "District"
ORDER BY
  SUM("105_EP01b_Malaria_Total") DESC
LIMIT 10000
[DHIS2] Parsed endpoint: analytics
[DHIS2] Found params in Flask g for analytics: table=analytics&dx=JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7
[DHIS2] Query params: {'table': 'analytics', 'dx': 'JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX', 'pe': 'LAST_5_YEARS', 'ou': 'F1o6qBSx783;SUvODYOcaVf', 'ouMode': 'DESCENDANTS'}
[DHIS2] Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dx': 'JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX', 'pe': 'LAST_5_YEARS', 'ou': 'F1o6qBSx783;SUvODYOcaVf', 'ouMode': 'DESCENDANTS'}
[DHIS2] Using all_levels scope: ['LEVEL-3', 'LEVEL-4', 'LEVEL-5']
[DHIS2] ðŸ”„ CACHE MISS - API request URL: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&dimension=pe:LAST_5_YEARS&dimension=ou:F1o6qBSx783;SUvODYOcaVf;LEVEL-3;LEVEL-4;LEVEL-5
[DHIS2] Raw API response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Raw DHIS2 rows count: 22727
[DHIS2] First raw row: ['JhvC7ZR9hUe', '2022', 'C0RSe3EWBqU', '246166']
[DHIS2] âœ… Cached response for analytics (API took 5362.5ms)
[DHIS2] Parsing response for endpoint: analytics
[DHIS2] Response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Response sample: {'headers': [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}], 'metaDat
[DHIS2] Using WIDE/PIVOTED format (Period, Level_1_Name, Level_2_Name, ..., DX1, DX2, ...) for analytics
[DHIS2] Analytics headers: [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}]
[DHIS2] Found 'ou' column at index 2
[DHIS2] Processing 22727 rows to extract org unit IDs2025-12-18 14:24:18,469:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] _fetch_org_unit_hierarchy: Fetching 1142 unique org units in batches...
2025-12-18 14:24:37,587:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:24:37] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 14:24:39,518:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Fetched 1142 org units, found 301 parent IDs
2025-12-18 14:24:39,518:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Iteration 1: Fetching 2 missing parent org units...
2025-12-18 14:24:40,387:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Iteration 2: Fetching 1 missing parent org units...
2025-12-18 14:24:41,388:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total org unit names available: 1145
2025-12-18 14:24:41,392:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Sample hierarchy for a9NzDoLn9kz: {'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Kitgum District', 'level_4': 'Pager Division', 'level_5': None, 'level_6': None}
2025-12-18 14:24:41,392:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] _fetch_org_unit_hierarchy completed: 1142 org units with hierarchy
2025-12-18 14:24:41,393:INFO:superset.db_engine_specs.dhis2_dialect:normalize_analytics called with pivot=True, returning WIDE format
2025-12-18 14:24:41,426:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column construction - data_elements: ['AuAOIfCuBUp', 'BWZFz9RJRPI', 'D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'gHjJrtw9vQX', 'pRZrTLDN7Ge', 'wUDxFVBapIc']
2025-12-18 14:24:41,426:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column names constructed (SANITIZED): ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:24:41,427:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] FIRST ROW CONSTRUCTION:
2025-12-18 14:24:41,427:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   Period (index 0): 2020
2025-12-18 14:24:41,427:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   108-EP01a.2. Malaria Total (Deaths) (index 6): None
2025-12-18 14:24:41,427:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   108-EP01a.1. Malaria Total (Cases) (index 7): 3
2025-12-18 14:24:41,428:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01b. Malaria Total (index 8): 1580
2025-12-18 14:24:41,428:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01a. Suspected fever (index 9): 6695
2025-12-18 14:24:41,428:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01d. Malaria cases treated (index 10): 1560
2025-12-18 14:24:41,428:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   108-EP01b.2. Malaria Confirmed (Microscopic &RDT) (Deaths) (index 11): None
2025-12-18 14:24:41,428:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   108-EP01b.1. Malaria Confirmed (Microscopic &RDT) (Cases) (index 12): 3
2025-12-18 14:24:41,428:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01c. Malaria Confirmed (B/s and RDT Positive) (index 13): 1579
2025-12-18 14:24:41,438:INFO:superset.db_engine_specs.dhis2_dialect:First pivoted row - Period: '2020'
2025-12-18 14:24:41,438:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total pivoted rows: 4437, columns: 14
2025-12-18 14:24:41,438:INFO:superset.db_engine_specs.dhis2_dialect:Normalized 4437 rows with 14 columns for endpoint analytics
2025-12-18 14:24:41,438:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API returned 4437 rows
2025-12-18 14:24:41,455:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() - Row count: 4437
2025-12-18 14:24:41,455:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:24:41,455:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names length: 14
2025-12-18 14:24:41,455:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values count: 14
2025-12-18 14:24:41,455:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values: ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
2025-12-18 14:24:41,455:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 0 (Period): 2020 -> 2020 (STRING)
2025-12-18 14:24:41,455:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (National): 'MOH - Uganda...' -> STRING (non-numeric detected)
2025-12-18 14:24:41,455:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (National): MOH - Uganda (PROCESSED)
2025-12-18 14:24:41,455:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (Region): 'Ankole...' -> STRING (non-numeric detected)
2025-12-18 14:24:41,455:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (Region): Ankole (PROCESSED)
2025-12-18 14:24:41,455:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (District): 'Rwampara District...' -> STRING (non-numeric detected)
2025-12-18 14:24:41,455:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (District): Rwampara District (PROCESSED)
2025-12-18 14:24:41,455:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (Sub_County_Town_Council_Div): 'Mwizi Subcounty...' -> STRING (non-numeric detected)
2025-12-18 14:24:41,455:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (Sub_County_Town_Council_Div): Mwizi Subcounty (PROCESSED)
2025-12-18 14:24:41,468:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() returning 4437 rows with 14 columns each
2025-12-18 14:24:41,469:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Got 4437 rows from cursor
2025-12-18 14:24:41,469:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: First row: ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
2025-12-18 14:24:41,469:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:24:41,469:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Types from cursor: ['String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String']
2025-12-18 14:24:41,489:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: DataFrame created with 4437 rows, 14 columns
2025-12-18 14:24:41,489:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:24:41,491:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes BEFORE fix: {'Period': dtype('O'), 'National': dtype('O'), 'Region': dtype('O'), 'District': dtype('O'), 'Sub_County_Town_Council_Div': dtype('O'), 'Health_Facility': dtype('O'), '108_EP01a_2_Malaria_Total_Deaths': dtype('O'), '108_EP01a_1_Malaria_Total_Cases': dtype('O'), '105_EP01b_Malaria_Total': dtype('O'), '105_EP01a_Suspected_fever': dtype('O'), '105_EP01d_Malaria_cases_treated': dtype('O'), '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths': dtype('O'), '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases': dtype('O'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('O')}
2025-12-18 14:24:41,495:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Period' to object dtype (dimension)
2025-12-18 14:24:41,498:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'National' as dimension (contains non-numeric string: 'MOH - Uganda...')
2025-12-18 14:24:41,499:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'National' to object dtype (dimension)
2025-12-18 14:24:41,499:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'Region' as dimension (contains non-numeric string: 'Ankole...')
2025-12-18 14:24:41,499:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Region' to object dtype (dimension)
2025-12-18 14:24:41,500:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'District' as dimension (contains non-numeric string: 'Rwampara District...')
2025-12-18 14:24:41,500:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'District' to object dtype (dimension)
2025-12-18 14:24:41,500:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'Sub_County_Town_Council_Div' as dimension (contains non-numeric string: 'Mwizi Subcounty...')
2025-12-18 14:24:41,501:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Sub_County_Town_Council_Div' to object dtype (dimension)
2025-12-18 14:24:41,501:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'Health_Facility' as dimension (contains non-numeric string: 'Keyo Health Centre II...')
2025-12-18 14:24:41,501:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Health_Facility' to object dtype (dimension)
2025-12-18 14:24:41,503:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes AFTER fix: {'Period': dtype('O'), 'National': dtype('O'), 'Region': dtype('O'), 'District': dtype('O'), 'Sub_County_Town_Council_Div': dtype('O'), 'Health_Facility': dtype('O'), '108_EP01a_2_Malaria_Total_Deaths': dtype('O'), '108_EP01a_1_Malaria_Total_Cases': dtype('O'), '105_EP01b_Malaria_Total': dtype('O'), '105_EP01a_Suspected_fever': dtype('O'), '105_EP01d_Malaria_cases_treated': dtype('O'), '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths': dtype('O'), '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases': dtype('O'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('O')}
2025-12-18 14:24:41,503:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: First row: {'Period': '2020', 'National': 'MOH - Uganda', 'Region': 'Ankole', 'District': 'Rwampara District', 'Sub_County_Town_Council_Div': 'Mwizi Subcounty', 'Health_Facility': None, '108_EP01a_2_Malaria_Total_Deaths': None, '108_EP01a_1_Malaria_Total_Cases': 3, '105_EP01b_Malaria_Total': 1580, '105_EP01a_Suspected_fever': 6695, '105_EP01d_Malaria_cases_treated': 1560, '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths': None, '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases': 3, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 1579}
2025-12-18 14:24:41,508:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] BEFORE assign_column_label:
2025-12-18 14:24:41,508:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4437, 14)
2025-12-18 14:24:41,508:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:24:41,508:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:24:41,508:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: False
2025-12-18 14:24:41,508:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Period': '2020', 'National': 'MOH - Uganda', 'Region': 'Ankole', 'District': 'Rwampara District', 'Sub_County_Town_Council_Div': 'Mwizi Subcounty', 'Health_Facility': None, '108_EP01a_2_Malaria_Total_Deaths': None, '108_EP01a_1_Malaria_Total_Cases': 3, '105_EP01b_Malaria_Total': 1580, '105_EP01a_Suspected_fever': 6695, '105_EP01d_Malaria_cases_treated': 1560, '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths': None, '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases': 3, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 1579}
2025-12-18 14:24:41,508:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Column truncation needed: df has 14 columns, expected 3
2025-12-18 14:24:41,508:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   DataFrame actual columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:24:41,508:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Expected columns: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:24:41,509:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] âœ“ Selecting columns BY NAME (matched all expected columns)
2025-12-18 14:24:41,509:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Column mapping: {'District': 'District', 'SUM(105-EP01b. Malaria Total)': '105_EP01b_Malaria_Total', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))': '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'}
2025-12-18 14:24:41,511:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] Column Selection âœ“ SUCCESS - method=BY_NAME, datasource=analytics 20251217-3246
2025-12-18 14:24:41,511:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:24:41,511:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   tried_by_name=True, success=True, fallback=False
2025-12-18 14:24:41,511:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Assigning column labels: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:24:41,511:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] AFTER assign_column_label:
2025-12-18 14:24:41,511:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4437, 3)
2025-12-18 14:24:41,511:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:24:41,511:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:24:41,511:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: True
2025-12-18 14:24:41,511:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'District': 'Rwampara District', 'SUM(105-EP01b. Malaria Total)': 1580, 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))': 1579}
2025-12-18 14:24:41,521:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING] Auto-sanitizing wrapped aggregate: 'SUM(105-EP01b. Malaria Total)' -> 'SUM(105_EP01b_Malaria_Total)'
2025-12-18 14:24:41,521:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING] Auto-sanitizing wrapped aggregate: 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))' -> 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)'
2025-12-18 14:24:41,522:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] DataFrame columns: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:24:41,522:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Aggregates: {'SUM(105-EP01b. Malaria Total)': {'operator': 'mean', 'column': 'SUM(105_EP01b_Malaria_Total)'}, 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))': {'operator': 'mean', 'column': 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)'}}
2025-12-18 14:24:41,522:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105-EP01b. Malaria Total)', column='SUM(105_EP01b_Malaria_Total)'
2025-12-18 14:24:41,522:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Column 'SUM(105_EP01b_Malaria_Total)' not found directly. Checking if aggregate name 'SUM(105-EP01b. Malaria Total)' is in DataFrame...
2025-12-18 14:24:41,522:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Found aggregate name 'SUM(105-EP01b. Malaria Total)' in DataFrame! Using name as column.
2025-12-18 14:24:41,522:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))', column='SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)'
2025-12-18 14:24:41,522:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Column 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)' not found directly. Checking if aggregate name 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))' is in DataFrame...
2025-12-18 14:24:41,522:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Found aggregate name 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))' in DataFrame! Using name as column.
2025-12-18 14:24:41,560:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:24:41] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-18 14:24:41,654:INFO:superset.common.query_object:[QueryObject] Removed 1 duplicate column(s): ['District']. Original count: 2, New count: 1
2025-12-18 14:24:41,666:ERROR:superset.models.helpers:[METRICS-TRACE] Processing 2 metrics
2025-12-18 14:24:41,666:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 0: adhoc - SUM(105-EP01b. Malaria Total)
2025-12-18 14:24:41,667:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105-EP01b. Malaria Total)
2025-12-18 14:24:41,667:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 1: adhoc - SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))
2025-12-18 14:24:41,668:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))
2025-12-18 14:24:41,669:ERROR:superset.models.helpers:[METRICS-TRACE] Total metrics added: 2
2025-12-18 14:24:41,685:ERROR:superset.models.helpers:[METRICS-TRACE] Before dedup: 1 select_exprs + 2 metrics_exprs
2025-12-18 14:24:41,685:ERROR:superset.models.helpers:[METRICS-TRACE] After dedup: 3 total select_exprs
2025-12-18 14:24:41,685:INFO:superset.models.helpers:[COLUMN_TRACE] SQL Query Building:
2025-12-18 14:24:41,686:INFO:superset.models.helpers:[COLUMN_TRACE]   columns: [{'timeGrain': None, 'columnType': 'BASE_AXIS', 'sqlExpression': 'District', 'label': 'District', 'expressionType': 'SQL'}]
2025-12-18 14:24:41,686:INFO:superset.models.helpers:[COLUMN_TRACE]   metrics: [{'aggregate': 'SUM', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01b_Malaria_Total', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 40, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'FLOAT', 'type_generic': 0, 'uuid': '5da7ec93-b44e-48b9-8004-7d62a62c5ac0', 'verbose_name': '105-EP01b. Malaria Total', 'warning_markdown': None}, 'datasourceWarning': False, 'expressionType': 'SIMPLE', 'hasCustomLabel': False, 'label': 'SUM(105-EP01b. Malaria Total)', 'optionName': 'metric_k9q7silao1_oi8evqrbvi', 'sqlExpression': None}, {'aggregate': 'SUM', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 41, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'column', 'type_generic': 0, 'uuid': 'c71fe8aa-92db-4107-a95b-2c7d99fa828a', 'verbose_name': '105-EP01c. Malaria Confirmed (B/s and RDT Positive)', 'warning_markdown': None}, 'datasourceWarning': False, 'expressionType': 'SIMPLE', 'hasCustomLabel': False, 'label': 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))', 'optionName': 'metric_oj8hdui9ylq_nue3d0up82', 'sqlExpression': None}]
2025-12-18 14:24:41,686:INFO:superset.models.helpers:[COLUMN_TRACE]   groupby: []
2025-12-18 14:24:41,686:INFO:superset.models.helpers:[COLUMN_TRACE]   labels_expected: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:24:41,686:INFO:superset.models.helpers:[COLUMN_TRACE]   select_exprs count: 3
2025-12-18 14:24:41,686:INFO:superset.models.helpers:[COLUMN_TRACE]     [0] key=District, name=District, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-18 14:24:41,686:INFO:superset.models.helpers:[COLUMN_TRACE]     [1] key=SUM(105-EP01b. Malaria Total), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-18 14:24:41,686:INFO:superset.models.helpers:[COLUMN_TRACE]     [2] key=SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive)), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-18 14:24:41,686:INFO:superset.connectors.sqla.models:[DHIS2] get_from_clause for virtual dataset 4: analytics 20251217-3246
2025-12-18 14:24:41,687:INFO:superset.connectors.sqla.models:[DHIS2] Full SQL stored: SELECT * FROM analytics
/* DHIS2: table=analytics&dx=JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&pe=LAST_5_YEARS&ou=F1o6qBSx783;SUvODYOcaVf&ouMode=DESCENDANTS */
2025-12-18 14:24:41,687:INFO:superset.connectors.sqla.models:[DHIS2] Loaded params from extra field: table=analytics&dx=JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&pe=LAST_5_YEARS&ou=F1o6qBSx783;SUvO
2025-12-18 14:24:41,687:INFO:superset.connectors.sqla.models:[DHIS2] Cached params with key: dhis2_params_4_analytics
2025-12-18 14:24:41,688:INFO:superset.connectors.sqla.models:[DHIS2] Stored params in Flask g for DHIS2 table: analytics
2025-12-18 14:24:41,693:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Query execution in connectors/sqla/models.py:
2025-12-18 14:24:41,693:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   SQL (first 500 chars): SELECT "District", sum("105_EP01b_Malaria_Total") AS sum_1, sum("105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive") AS sum_2 
FROM (SELECT * FROM analytics
/* DHIS2: table=analytics&dx=JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&pe=LAST_5_YEARS&ou=F1o6qBSx783;SUvODYOcaVf&ouMode=DESCENDANTS */
) AS virtual_table GROUP BY "District" ORDER BY sum("105_EP01b_Malaria_Total") DESC
 LIMIT 10000
2025-12-18 14:24:41,693:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   labels_expected: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:24:41,697:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 connection initialized: https://tests.dhis2.hispuganda.org/hmis/api
2025-12-18 14:24:41,699:INFO:superset.db_engine_specs.dhis2_dialect:Executing DHIS2 query: SELECT
  "District",
  SUM("105_EP01b_Malaria_Total") AS sum_1,
  SUM("105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive") AS sum_2
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "District"
ORDER BY
  SUM("105_EP01b_Malaria_Total") DESC
LIMIT 10000
2025-12-18 14:24:41,700:INFO:superset.db_engine_specs.dhis2_dialect:Parsed endpoint: analytics
2025-12-18 14:24:41,700:INFO:superset.db_engine_specs.dhis2_dialect:Using stored parameters from Flask g for table: analytics
2025-12-18 14:24:41,700:INFO:superset.db_engine_specs.dhis2_dialect:Query params: {'table': 'analytics', 'dx': 'JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX', 'pe': 'LAST_5_YEARS', 'ou': 'F1o6qBSx783;SUvODYOcaVf', 'ouMode': 'DESCENDANTS'}
2025-12-18 14:24:41,701:INFO:superset.db_engine_specs.dhis2_dialect:Period dimension detected - omitting startDate/endDate (DHIS2 API rule)
2025-12-18 14:24:41,701:INFO:superset.db_engine_specs.dhis2_dialect:Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dx': 'JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX', 'pe': 'LAST_5_YEARS', 'ou': 'F1o6qBSx783;SUvODYOcaVf', 'ouMode': 'DESCENDANTS'}
2025-12-18 14:24:42,547:INFO:superset.db_engine_specs.dhis2_dialect:Fetched org unit levels: {3: 'District', 5: 'Health Facility', 1: 'National', 2: 'Region', 4: 'Sub County/Town Council/Div'}
2025-12-18 14:24:42,710:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:24:42] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 14:24:43,415:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Using all_levels scope: ['LEVEL-3', 'LEVEL-4', 'LEVEL-5']
2025-12-18 14:24:43,415:INFO:superset.db_engine_specs.dhis2_dialect:Converted dx/pe/ou to dimension parameter: dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX;pe:LAST_5_YEARS;ou:F1o6qBSx783;SUvODYOcaVf;LEVEL-3;LEVEL-4;LEVEL-5
2025-12-18 14:24:43,415:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API request (cache miss): https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&dimension=pe:LAST_5_YEARS&dimension=ou:F1o6qBSx783;SUvODYOcaVf;LEVEL-3;LEVEL-4;LEVEL-5
2025-12-18 14:24:44,397:ERROR:superset.models.helpers:[METRICS-TRACE] Processing 2 metrics
2025-12-18 14:24:44,397:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 0: adhoc - SUM(105-EP01b. Malaria Total)
2025-12-18 14:24:44,398:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105-EP01b. Malaria Total)
2025-12-18 14:24:44,398:ERROR:superset.models.helpers:[METRICS-TRACE] Processing 2 metrics
2025-12-18 14:24:44,398:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 1: adhoc - SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))
2025-12-18 14:24:44,398:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 0: adhoc - SUM(105-EP01b. Malaria Total)
2025-12-18 14:24:44,399:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))
2025-12-18 14:24:44,399:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105-EP01b. Malaria Total)
2025-12-18 14:24:44,399:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 1: adhoc - SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))
2025-12-18 14:24:44,399:ERROR:superset.models.helpers:[METRICS-TRACE] Total metrics added: 2
2025-12-18 14:24:44,399:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))
2025-12-18 14:24:44,400:ERROR:superset.models.helpers:[METRICS-TRACE] Before dedup: 1 select_exprs + 2 metrics_exprs
2025-12-18 14:24:44,400:ERROR:superset.models.helpers:[METRICS-TRACE] Total metrics added: 2
2025-12-18 14:24:44,400:ERROR:superset.models.helpers:[METRICS-TRACE] After dedup: 3 total select_exprs
2025-12-18 14:24:44,401:ERROR:superset.models.helpers:[METRICS-TRACE] Before dedup: 1 select_exprs + 2 metrics_exprs
2025-12-18 14:24:44,401:INFO:superset.models.helpers:[COLUMN_TRACE] SQL Query Building:
2025-12-18 14:24:44,401:ERROR:superset.models.helpers:[METRICS-TRACE] After dedup: 3 total select_exprs
2025-12-18 14:24:44,401:INFO:superset.models.helpers:[COLUMN_TRACE]   columns: [{'timeGrain': None, 'columnType': 'BASE_AXIS', 'sqlExpression': 'District', 'label': 'District', 'expressionType': 'SQL'}]
2025-12-18 14:24:44,401:INFO:superset.models.helpers:[COLUMN_TRACE] SQL Query Building:
2025-12-18 14:24:44,401:INFO:superset.models.helpers:[COLUMN_TRACE]   metrics: [{'aggregate': 'SUM', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01b_Malaria_Total', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 40, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'FLOAT', 'type_generic': 0, 'uuid': '5da7ec93-b44e-48b9-8004-7d62a62c5ac0', 'verbose_name': '105-EP01b. Malaria Total', 'warning_markdown': None}, 'datasourceWarning': False, 'expressionType': 'SIMPLE', 'hasCustomLabel': False, 'label': 'SUM(105-EP01b. Malaria Total)', 'optionName': 'metric_k9q7silao1_oi8evqrbvi', 'sqlExpression': None}, {'aggregate': 'SUM', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 41, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'column', 'type_generic': 0, 'uuid': 'c71fe8aa-92db-4107-a95b-2c7d99fa828a', 'verbose_name': '105-EP01c. Malaria Confirmed (B/s and RDT Positive)', 'warning_markdown': None}, 'datasourceWarning': False, 'expressionType': 'SIMPLE', 'hasCustomLabel': False, 'label': 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))', 'optionName': 'metric_oj8hdui9ylq_nue3d0up82', 'sqlExpression': None}]
2025-12-18 14:24:44,401:INFO:superset.models.helpers:[COLUMN_TRACE]   columns: [{'timeGrain': None, 'columnType': 'BASE_AXIS', 'sqlExpression': 'District', 'label': 'District', 'expressionType': 'SQL'}]
2025-12-18 14:24:44,401:INFO:superset.models.helpers:[COLUMN_TRACE]   groupby: []
2025-12-18 14:24:44,401:INFO:superset.models.helpers:[COLUMN_TRACE]   metrics: [{'aggregate': 'SUM', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01b_Malaria_Total', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 40, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'FLOAT', 'type_generic': 0, 'uuid': '5da7ec93-b44e-48b9-8004-7d62a62c5ac0', 'verbose_name': '105-EP01b. Malaria Total', 'warning_markdown': None}, 'datasourceWarning': False, 'expressionType': 'SIMPLE', 'hasCustomLabel': False, 'label': 'SUM(105-EP01b. Malaria Total)', 'optionName': 'metric_k9q7silao1_oi8evqrbvi', 'sqlExpression': None}, {'aggregate': 'SUM', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 41, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'column', 'type_generic': 0, 'uuid': 'c71fe8aa-92db-4107-a95b-2c7d99fa828a', 'verbose_name': '105-EP01c. Malaria Confirmed (B/s and RDT Positive)', 'warning_markdown': None}, 'datasourceWarning': False, 'expressionType': 'SIMPLE', 'hasCustomLabel': False, 'label': 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))', 'optionName': 'metric_oj8hdui9ylq_nue3d0up82', 'sqlExpression': None}]
2025-12-18 14:24:44,401:INFO:superset.models.helpers:[COLUMN_TRACE]   labels_expected: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:24:44,401:INFO:superset.models.helpers:[COLUMN_TRACE]   groupby: []
2025-12-18 14:24:44,401:INFO:superset.models.helpers:[COLUMN_TRACE]   select_exprs count: 3
2025-12-18 14:24:44,401:INFO:superset.models.helpers:[COLUMN_TRACE]   labels_expected: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:24:44,402:INFO:superset.models.helpers:[COLUMN_TRACE]     [0] key=District, name=District, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-18 14:24:44,402:INFO:superset.models.helpers:[COLUMN_TRACE]   select_exprs count: 3
2025-12-18 14:24:44,402:INFO:superset.models.helpers:[COLUMN_TRACE]     [1] key=SUM(105-EP01b. Malaria Total), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-18 14:24:44,402:INFO:superset.models.helpers:[COLUMN_TRACE]     [0] key=District, name=District, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-18 14:24:44,402:INFO:superset.models.helpers:[COLUMN_TRACE]     [2] key=SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive)), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-18 14:24:44,402:INFO:superset.models.helpers:[COLUMN_TRACE]     [1] key=SUM(105-EP01b. Malaria Total), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-18 14:24:44,402:INFO:superset.models.helpers:[COLUMN_TRACE]     [2] key=SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive)), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-18 14:24:44,402:INFO:superset.connectors.sqla.models:[DHIS2] get_from_clause for virtual dataset 4: analytics 20251217-3246
2025-12-18 14:24:44,402:INFO:superset.connectors.sqla.models:[DHIS2] Full SQL stored: SELECT * FROM analytics
/* DHIS2: table=analytics&dx=JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&pe=LAST_5_YEARS&ou=F1o6qBSx783;SUvODYOcaVf&ouMode=DESCENDANTS */
2025-12-18 14:24:44,402:INFO:superset.connectors.sqla.models:[DHIS2] get_from_clause for virtual dataset 4: analytics 20251217-3246
2025-12-18 14:24:44,402:INFO:superset.connectors.sqla.models:[DHIS2] Full SQL stored: SELECT * FROM analytics
/* DHIS2: table=analytics&dx=JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&pe=LAST_5_YEARS&ou=F1o6qBSx783;SUvODYOcaVf&ouMode=DESCENDANTS */
2025-12-18 14:24:44,402:INFO:superset.connectors.sqla.models:[DHIS2] Loaded params from extra field: table=analytics&dx=JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&pe=LAST_5_YEARS&ou=F1o6qBSx783;SUvO
2025-12-18 14:24:44,402:INFO:superset.connectors.sqla.models:[DHIS2] Loaded params from extra field: table=analytics&dx=JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&pe=LAST_5_YEARS&ou=F1o6qBSx783;SUvO
2025-12-18 14:24:44,403:INFO:superset.connectors.sqla.models:[DHIS2] Cached params with key: dhis2_params_4_analytics
2025-12-18 14:24:44,403:INFO:superset.connectors.sqla.models:[DHIS2] Stored params in Flask g for DHIS2 table: analytics
2025-12-18 14:24:44,406:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Query execution in connectors/sqla/models.py:
2025-12-18 14:24:44,406:INFO:superset.connectors.sqla.models:[DHIS2] Cached params with key: dhis2_params_4_analytics
2025-12-18 14:24:44,406:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   SQL (first 500 chars): SELECT "District", sum("105_EP01b_Malaria_Total") AS sum_1, sum("105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive") AS sum_2 
FROM (SELECT * FROM analytics
/* DHIS2: table=analytics&dx=JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&pe=LAST_5_YEARS&ou=F1o6qBSx783;SUvODYOcaVf&ouMode=DESCENDANTS */
) AS virtual_table GROUP BY "District" ORDER BY sum("105_EP01b_Malaria_Total") DESC
 LIMIT 10000
2025-12-18 14:24:44,406:INFO:superset.connectors.sqla.models:[DHIS2] Stored params in Flask g for DHIS2 table: analytics
2025-12-18 14:24:44,406:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   labels_expected: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:24:44,409:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Query execution in connectors/sqla/models.py:
2025-12-18 14:24:44,409:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   SQL (first 500 chars): SELECT "District", sum("105_EP01b_Malaria_Total") AS sum_1, sum("105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive") AS sum_2 
FROM (SELECT * FROM analytics
/* DHIS2: table=analytics&dx=JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&pe=LAST_5_YEARS&ou=F1o6qBSx783;SUvODYOcaVf&ouMode=DESCENDANTS */
) AS virtual_table GROUP BY "District" ORDER BY sum("105_EP01b_Malaria_Total") DESC
 LIMIT 10000
2025-12-18 14:24:44,410:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 connection initialized: https://tests.dhis2.hispuganda.org/hmis/api
2025-12-18 14:24:44,410:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   labels_expected: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:24:44,410:INFO:superset.db_engine_specs.dhis2_dialect:Executing DHIS2 query: SELECT
  "District",
  SUM("105_EP01b_Malaria_Total") AS sum_1,
  SUM("105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive") AS sum_2
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "District"
ORDER BY
  SUM("105_EP01b_Malaria_Total") DESC
LIMIT 10000
2025-12-18 14:24:44,412:INFO:superset.db_engine_specs.dhis2_dialect:Parsed endpoint: analytics

[DHIS2] Extracted 1142 unique org unit IDs from rows
[DHIS2] Found 1142 unique org units in analytics response
[DHIS2] Fetching hierarchy for 1142 org units...
[DHIS2] _fetch_org_unit_hierarchy: Fetching 1142 unique org units
[DHIS2] Batch 1: Got 50 org units from DHIS2
[DHIS2]   OU: wNunka5Y2uu, name=Acholi-Bur Subcounty, level=4, parent=aBrjuZk0W31
[DHIS2]   OU: FihNC5KfGJV, name=Adilang Subcounty, level=4, parent=ztIyIYAzFKp
[DHIS2]   OU: HSBjlZdFpWn, name=Ajan Subcounty, level=4, parent=aBrjuZk0W31
[DHIS2] Batch 2: Got 50 org units from DHIS2
[DHIS2] Batch 3: Got 50 org units from DHIS2
[DHIS2] Batch 4: Got 50 org units from DHIS2
[DHIS2] Batch 5: Got 50 org units from DHIS2
[DHIS2] Batch 6: Got 50 org units from DHIS2
[DHIS2] Batch 7: Got 50 org units from DHIS2
[DHIS2] Batch 8: Got 50 org units from DHIS2
[DHIS2] Batch 9: Got 50 org units from DHIS2
[DHIS2] Batch 10: Got 50 org units from DHIS2
[DHIS2] Batch 11: Got 50 org units from DHIS2
[DHIS2] Batch 12: Got 50 org units from DHIS2
[DHIS2] Batch 13: Got 50 org units from DHIS2
[DHIS2] Batch 14: Got 50 org units from DHIS2
[DHIS2] Batch 15: Got 50 org units from DHIS2
[DHIS2] Batch 16: Got 50 org units from DHIS2
[DHIS2] Batch 17: Got 50 org units from DHIS2
[DHIS2] Batch 18: Got 50 org units from DHIS2
[DHIS2] Batch 19: Got 50 org units from DHIS2
[DHIS2] Batch 20: Got 50 org units from DHIS2
[DHIS2] Batch 21: Got 50 org units from DHIS2
[DHIS2] Batch 22: Got 50 org units from DHIS2
[DHIS2] Batch 23: Got 42 org units from DHIS2
[DHIS2] Total org unit names available: 1145 after 2 iterations
[DHIS2] Sample hierarchy for a9NzDoLn9kz: {'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Kitgum District', 'level_4': 'Pager Division', 'level_5': None, 'level_6': None}
[DHIS2]   a9NzDoLn9kz: filled levels = ['level_1', 'level_2', 'level_3', 'level_4']
[DHIS2]   aFgrVHVDqoZ: filled levels = ['level_1', 'level_2', 'level_3', 'level_4', 'level_5']
[DHIS2]   fxHApp8UtpE: filled levels = ['level_1', 'level_2', 'level_3', 'level_4', 'level_5']
[DHIS2] Fetched hierarchy for 1142 org units
[DHIS2] Sample hierarchy for a9NzDoLn9kz: {'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Kitgum District', 'level_4': 'Pager Division', 'level_5': None, 'level_6': None}
[DHIS2] Calling DHIS2ResponseNormalizer.normalize with:
[DHIS2]   - endpoint: analytics
[DHIS2]   - pivot: True
[DHIS2]   - org_unit_hierarchy: 1142 entries
[DHIS2]   - org_unit_level_names: {3: 'District', 5: 'Health Facility', 1: 'National', 2: 'Region', 4: 'Sub County/Town Council/Div'}
[DHIS2] normalize_analytics: pivot=True, using WIDE/PIVOTED format
[DHIS2] PIVOT CONSTRUCTION:
[DHIS2]   data_elements (UIDs): ['AuAOIfCuBUp', 'BWZFz9RJRPI', 'D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'gHjJrtw9vQX', 'pRZrTLDN7Ge', 'wUDxFVBapIc']
[DHIS2]   data_element_list (sorted UIDs): ['AuAOIfCuBUp', 'BWZFz9RJRPI', 'D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'gHjJrtw9vQX', 'pRZrTLDN7Ge', 'wUDxFVBapIc']
[DHIS2]   col_names (SANITIZED): ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Row 0: OU=AA8TRyfTwtn, hierarchy_info={'level_1': 'MOH - Uganda', 'level_2': 'Ankole', 'level_3': 'Rwampara District', 'level_4': 'Mwizi Subcounty', 'level_5': None, 'level_6': None}
[DHIS2] Row 1: OU=AJxamlmKn2x, hierarchy_info={'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Amuru District', 'level_4': 'Lamogi Subcounty', 'level_5': 'Keyo Health Centre II', 'level_6': None}
[DHIS2] Row 2: OU=ALL4sSTGBRn, hierarchy_info={'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Gulu District', 'level_4': 'Owalo Subcounty', 'level_5': None, 'level_6': None}
[DHIS2] Normalized columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized row count: 4437
[DHIS2] First row: ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
[DHIS2] _set_description: original=['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], sanitized=['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], types=['String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String']
[DHIS2] Transformed rows count: 4437
[DHIS2] First transformed row: ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
[DHIS2] Fetched 4437 rows
[DHIS2] fetchall() called - returning 4437 rows
[DHIS2] fetchall() - First row type: <class 'tuple'>
[DHIS2] fetchall() - First row (original): ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
[DHIS2] fetchall() - Column count from description: 14
[DHIS2] fetchall() - First row (fixed types): ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
[DHIS2] fetchall() - Type enforcement: dimensions=STRING, measures=FLOAT
[DHIS2] Executing query: SELECT
  "District",
  SUM("105_EP01b_Malaria_Total") AS sum_1,
  SUM("105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive") AS sum_2
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "District"
ORDER BY
  SUM("105_EP01b_Malaria_Total") DESC
LIMIT 10000
[DHIS2] Parsed endpoint: analytics
[DHIS2] Found params in Flask g for analytics: table=analytics&dx=JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7
[DHIS2] Query params: {'table': 'analytics', 'dx': 'JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX', 'pe': 'LAST_5_YEARS', 'ou': 'F1o6qBSx783;SUvODYOcaVf', 'ouMode': 'DESCENDANTS'}
[DHIS2] Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dx': 'JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX', 'pe': 'LAST_5_YEARS', 'ou': 'F1o6qBSx783;SUvODYOcaVf', 'ouMode': 'DESCENDANTS'}
[DHIS2] Using all_levels scope: ['LEVEL-3', 'LEVEL-4', 'LEVEL-5']
[DHIS2] ðŸ”„ CACHE MISS - API request URL: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&dimension=pe:LAST_5_YEARS&dimension=ou:F1o6qBSx783;SUvODYOcaVf;LEVEL-3;LEVEL-4;LEVEL-5
[DHIS2] Executing query: SELECT
  "District",
  SUM("105_EP01b_Malaria_Total") AS sum_1,
  SUM("105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive") AS sum_2
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "District"
ORDER BY
  SUM("105_EP01b_Malaria_Total") DESC
LIMIT 10000
[DHIS2] Parsed endpoint: analytics
[DHIS2] Found params in Flask g for analytics: table=analytics&dx=JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN72025-12-18 14:24:44,412:INFO:superset.db_engine_specs.dhis2_dialect:Using stored parameters from Flask g for table: analytics
2025-12-18 14:24:44,412:INFO:superset.db_engine_specs.dhis2_dialect:Query params: {'table': 'analytics', 'dx': 'JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX', 'pe': 'LAST_5_YEARS', 'ou': 'F1o6qBSx783;SUvODYOcaVf', 'ouMode': 'DESCENDANTS'}
2025-12-18 14:24:44,412:INFO:superset.db_engine_specs.dhis2_dialect:Period dimension detected - omitting startDate/endDate (DHIS2 API rule)
2025-12-18 14:24:44,412:INFO:superset.db_engine_specs.dhis2_dialect:Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dx': 'JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX', 'pe': 'LAST_5_YEARS', 'ou': 'F1o6qBSx783;SUvODYOcaVf', 'ouMode': 'DESCENDANTS'}
2025-12-18 14:24:44,418:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 connection initialized: https://tests.dhis2.hispuganda.org/hmis/api
2025-12-18 14:24:44,419:INFO:superset.db_engine_specs.dhis2_dialect:Executing DHIS2 query: SELECT
  "District",
  SUM("105_EP01b_Malaria_Total") AS sum_1,
  SUM("105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive") AS sum_2
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "District"
ORDER BY
  SUM("105_EP01b_Malaria_Total") DESC
LIMIT 10000
2025-12-18 14:24:44,419:INFO:superset.db_engine_specs.dhis2_dialect:Parsed endpoint: analytics
2025-12-18 14:24:44,419:INFO:superset.db_engine_specs.dhis2_dialect:Using stored parameters from Flask g for table: analytics
2025-12-18 14:24:44,419:INFO:superset.db_engine_specs.dhis2_dialect:Query params: {'table': 'analytics', 'dx': 'JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX', 'pe': 'LAST_5_YEARS', 'ou': 'F1o6qBSx783;SUvODYOcaVf', 'ouMode': 'DESCENDANTS'}
2025-12-18 14:24:44,419:INFO:superset.db_engine_specs.dhis2_dialect:Period dimension detected - omitting startDate/endDate (DHIS2 API rule)
2025-12-18 14:24:44,419:INFO:superset.db_engine_specs.dhis2_dialect:Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dx': 'JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX', 'pe': 'LAST_5_YEARS', 'ou': 'F1o6qBSx783;SUvODYOcaVf', 'ouMode': 'DESCENDANTS'}
2025-12-18 14:24:45,329:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:24:45] "PUT /api/v1/explore/form_data/ULWSeaI5Yyo?tab_id=2 HTTP/1.1" 200 -
2025-12-18 14:24:45,470:INFO:superset.db_engine_specs.dhis2_dialect:Fetched org unit levels: {3: 'District', 5: 'Health Facility', 1: 'National', 2: 'Region', 4: 'Sub County/Town Council/Div'}
2025-12-18 14:24:45,470:INFO:superset.db_engine_specs.dhis2_dialect:Fetched org unit levels: {3: 'District', 5: 'Health Facility', 1: 'National', 2: 'Region', 4: 'Sub County/Town Council/Div'}
2025-12-18 14:24:46,180:INFO:superset.db_engine_specs.dhis2_cache:[DHIS2 Cache] SET: analytics (ttl=3600s, key=dhis2:4a1c3321:analytics:5362e2052855...)
2025-12-18 14:24:46,180:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2 Cache] Stored response for analytics
2025-12-18 14:24:46,186:INFO:superset.db_engine_specs.dhis2_dialect:Using wide/pivoted format for analytics
2025-12-18 14:24:46,533:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Using all_levels scope: ['LEVEL-3', 'LEVEL-4', 'LEVEL-5']
2025-12-18 14:24:46,534:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Using all_levels scope: ['LEVEL-3', 'LEVEL-4', 'LEVEL-5']
2025-12-18 14:24:46,534:INFO:superset.db_engine_specs.dhis2_dialect:Converted dx/pe/ou to dimension parameter: dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX;pe:LAST_5_YEARS;ou:F1o6qBSx783;SUvODYOcaVf;LEVEL-3;LEVEL-4;LEVEL-5
2025-12-18 14:24:46,534:INFO:superset.db_engine_specs.dhis2_dialect:Converted dx/pe/ou to dimension parameter: dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX;pe:LAST_5_YEARS;ou:F1o6qBSx783;SUvODYOcaVf;LEVEL-3;LEVEL-4;LEVEL-5
2025-12-18 14:24:46,534:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API request (cache miss): https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&dimension=pe:LAST_5_YEARS&dimension=ou:F1o6qBSx783;SUvODYOcaVf;LEVEL-3;LEVEL-4;LEVEL-5
2025-12-18 14:24:46,534:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API request (cache miss): https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&dimension=pe:LAST_5_YEARS&dimension=ou:F1o6qBSx783;SUvODYOcaVf;LEVEL-3;LEVEL-4;LEVEL-5
2025-12-18 14:24:47,007:INFO:superset.db_engine_specs.dhis2_dialect:Fetched org unit levels: {3: 'District', 5: 'Health Facility', 1: 'National', 2: 'Region', 4: 'Sub County/Town Council/Div'}
2025-12-18 14:24:47,009:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] _fetch_org_unit_hierarchy: Fetching 1142 unique org units in batches...
2025-12-18 14:24:49,847:INFO:superset.db_engine_specs.dhis2_cache:[DHIS2 Cache] SET: analytics (ttl=3600s, key=dhis2:4a1c3321:analytics:5362e2052855...)
2025-12-18 14:24:49,847:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2 Cache] Stored response for analytics
2025-12-18 14:24:49,853:INFO:superset.db_engine_specs.dhis2_dialect:Using wide/pivoted format for analytics
2025-12-18 14:24:50,355:INFO:superset.db_engine_specs.dhis2_cache:[DHIS2 Cache] SET: analytics (ttl=3600s, key=dhis2:4a1c3321:analytics:5362e2052855...)
2025-12-18 14:24:50,355:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2 Cache] Stored response for analytics
2025-12-18 14:24:50,360:INFO:superset.db_engine_specs.dhis2_dialect:Using wide/pivoted format for analytics
2025-12-18 14:24:50,797:INFO:superset.db_engine_specs.dhis2_dialect:Fetched org unit levels: {3: 'District', 5: 'Health Facility', 1: 'National', 2: 'Region', 4: 'Sub County/Town Council/Div'}
2025-12-18 14:24:50,799:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] _fetch_org_unit_hierarchy: Fetching 1142 unique org units in batches...
2025-12-18 14:24:51,253:INFO:superset.db_engine_specs.dhis2_dialect:Fetched org unit levels: {3: 'District', 5: 'Health Facility', 1: 'National', 2: 'Region', 4: 'Sub County/Town Council/Div'}

[DHIS2] Query params: {'table': 'analytics', 'dx': 'JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX', 'pe': 'LAST_5_YEARS', 'ou': 'F1o6qBSx783;SUvODYOcaVf', 'ouMode': 'DESCENDANTS'}
[DHIS2] Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dx': 'JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX', 'pe': 'LAST_5_YEARS', 'ou': 'F1o6qBSx783;SUvODYOcaVf', 'ouMode': 'DESCENDANTS'}
[DHIS2] Executing query: SELECT
  "District",
  SUM("105_EP01b_Malaria_Total") AS sum_1,
  SUM("105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive") AS sum_2
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "District"
ORDER BY
  SUM("105_EP01b_Malaria_Total") DESC
LIMIT 10000
[DHIS2] Parsed endpoint: analytics
[DHIS2] Found params in Flask g for analytics: table=analytics&dx=JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7
[DHIS2] Query params: {'table': 'analytics', 'dx': 'JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX', 'pe': 'LAST_5_YEARS', 'ou': 'F1o6qBSx783;SUvODYOcaVf', 'ouMode': 'DESCENDANTS'}
[DHIS2] Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dx': 'JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX', 'pe': 'LAST_5_YEARS', 'ou': 'F1o6qBSx783;SUvODYOcaVf', 'ouMode': 'DESCENDANTS'}
[DHIS2] Raw API response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Raw DHIS2 rows count: 22727
[DHIS2] First raw row: ['JhvC7ZR9hUe', '2022', 'C0RSe3EWBqU', '246166']
[DHIS2] âœ… Cached response for analytics (API took 4466.3ms)
[DHIS2] Parsing response for endpoint: analytics
[DHIS2] Response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Response sample: {'headers': [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}], 'metaDat
[DHIS2] Using WIDE/PIVOTED format (Period, Level_1_Name, Level_2_Name, ..., DX1, DX2, ...) for analytics
[DHIS2] Using all_levels scope: ['LEVEL-3', 'LEVEL-4', 'LEVEL-5']
[DHIS2] Using all_levels scope: ['LEVEL-3', 'LEVEL-4', 'LEVEL-5']
[DHIS2] ðŸ”„ CACHE MISS - API request URL: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&dimension=pe:LAST_5_YEARS&dimension=ou:F1o6qBSx783;SUvODYOcaVf;LEVEL-3;LEVEL-4;LEVEL-5
[DHIS2] ðŸ”„ CACHE MISS - API request URL: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&dimension=pe:LAST_5_YEARS&dimension=ou:F1o6qBSx783;SUvODYOcaVf;LEVEL-3;LEVEL-4;LEVEL-5
[DHIS2] Analytics headers: [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}]
[DHIS2] Found 'ou' column at index 2
[DHIS2] Processing 22727 rows to extract org unit IDs
[DHIS2] Extracted 1142 unique org unit IDs from rows
[DHIS2] Found 1142 unique org units in analytics response
[DHIS2] Fetching hierarchy for 1142 org units...
[DHIS2] _fetch_org_unit_hierarchy: Fetching 1142 unique org units
[DHIS2] Batch 1: Got 50 org units from DHIS2
[DHIS2]   OU: wNunka5Y2uu, name=Acholi-Bur Subcounty, level=4, parent=aBrjuZk0W31
[DHIS2]   OU: FihNC5KfGJV, name=Adilang Subcounty, level=4, parent=ztIyIYAzFKp
[DHIS2]   OU: HSBjlZdFpWn, name=Ajan Subcounty, level=4, parent=aBrjuZk0W31
[DHIS2] Batch 2: Got 50 org units from DHIS2
[DHIS2] Raw API response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Raw DHIS2 rows count: 22727
[DHIS2] First raw row: ['JhvC7ZR9hUe', '2022', 'C0RSe3EWBqU', '246166']
[DHIS2] âœ… Cached response for analytics (API took 5419.9ms)
[DHIS2] Parsing response for endpoint: analytics
[DHIS2] Response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Response sample: {'headers': [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}], 'metaDat
[DHIS2] Using WIDE/PIVOTED format (Period, Level_1_Name, Level_2_Name, ..., DX1, DX2, ...) for analytics
[DHIS2] Raw API response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Raw DHIS2 rows count: 22727
[DHIS2] First raw row: ['JhvC7ZR9hUe', '2022', 'C0RSe3EWBqU', '246166']
[DHIS2] âœ… Cached response for analytics (API took 5937.4ms)
[DHIS2] Parsing response for endpoint: analytics
[DHIS2] Response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Response sample: {'headers': [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}], 'metaDat
[DHIS2] Using WIDE/PIVOTED format (Period, Level_1_Name, Level_2_Name, ..., DX1, DX2, ...) for analytics
[DHIS2] Batch 3: Got 50 org units from DHIS2
[DHIS2] Analytics headers: [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}]
[DHIS2] Found 'ou' column at index 2
[DHIS2] Processing 22727 rows to extract org unit IDs
[DHIS2] Extracted 1142 unique org unit IDs from rows
[DHIS2] Found 1142 unique org units in analytics response
[DHIS2] Fetching hierarchy for 1142 org units...
[DHIS2] _fetch_org_unit_hierarchy: Fetching 1142 unique org units
[DHIS2] Analytics headers: [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}]
[DHIS2] Found 'ou' column at index 2
[DHIS2] Processing 22727 rows to extract org unit IDs
[DHIS2] Extracted 1142 unique org unit IDs from rows
[DHIS2] Found 1142 unique org units in analytics response2025-12-18 14:24:51,256:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] _fetch_org_unit_hierarchy: Fetching 1142 unique org units in batches...
2025-12-18 14:25:07,890:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Fetched 1142 org units, found 301 parent IDs
2025-12-18 14:25:07,893:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Iteration 1: Fetching 2 missing parent org units...
2025-12-18 14:25:08,721:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Iteration 2: Fetching 1 missing parent org units...
2025-12-18 14:25:09,565:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total org unit names available: 1145
2025-12-18 14:25:09,573:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Sample hierarchy for a9NzDoLn9kz: {'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Kitgum District', 'level_4': 'Pager Division', 'level_5': None, 'level_6': None}
2025-12-18 14:25:09,573:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] _fetch_org_unit_hierarchy completed: 1142 org units with hierarchy
2025-12-18 14:25:09,574:INFO:superset.db_engine_specs.dhis2_dialect:normalize_analytics called with pivot=True, returning WIDE format
2025-12-18 14:25:09,608:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column construction - data_elements: ['AuAOIfCuBUp', 'BWZFz9RJRPI', 'D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'gHjJrtw9vQX', 'pRZrTLDN7Ge', 'wUDxFVBapIc']
2025-12-18 14:25:09,608:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column names constructed (SANITIZED): ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:25:09,609:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] FIRST ROW CONSTRUCTION:
2025-12-18 14:25:09,609:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   Period (index 0): 2020
2025-12-18 14:25:09,609:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   108-EP01a.2. Malaria Total (Deaths) (index 6): None
2025-12-18 14:25:09,609:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   108-EP01a.1. Malaria Total (Cases) (index 7): 3
2025-12-18 14:25:09,609:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01b. Malaria Total (index 8): 1580
2025-12-18 14:25:09,609:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01a. Suspected fever (index 9): 6695
2025-12-18 14:25:09,609:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01d. Malaria cases treated (index 10): 1560
2025-12-18 14:25:09,609:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   108-EP01b.2. Malaria Confirmed (Microscopic &RDT) (Deaths) (index 11): None
2025-12-18 14:25:09,609:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   108-EP01b.1. Malaria Confirmed (Microscopic &RDT) (Cases) (index 12): 3
2025-12-18 14:25:09,609:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01c. Malaria Confirmed (B/s and RDT Positive) (index 13): 1579
2025-12-18 14:25:09,623:INFO:superset.db_engine_specs.dhis2_dialect:First pivoted row - Period: '2020'
2025-12-18 14:25:09,624:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total pivoted rows: 4437, columns: 14
2025-12-18 14:25:09,625:INFO:superset.db_engine_specs.dhis2_dialect:Normalized 4437 rows with 14 columns for endpoint analytics
2025-12-18 14:25:09,626:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API returned 4437 rows
2025-12-18 14:25:09,698:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() - Row count: 4437
2025-12-18 14:25:09,698:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:25:09,698:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names length: 14
2025-12-18 14:25:09,698:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values count: 14
2025-12-18 14:25:09,698:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values: ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
2025-12-18 14:25:09,698:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 0 (Period): 2020 -> 2020 (STRING)
2025-12-18 14:25:09,698:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (National): 'MOH - Uganda...' -> STRING (non-numeric detected)
2025-12-18 14:25:09,698:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (National): MOH - Uganda (PROCESSED)
2025-12-18 14:25:09,698:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (Region): 'Ankole...' -> STRING (non-numeric detected)
2025-12-18 14:25:09,698:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (Region): Ankole (PROCESSED)
2025-12-18 14:25:09,698:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (District): 'Rwampara District...' -> STRING (non-numeric detected)
2025-12-18 14:25:09,698:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (District): Rwampara District (PROCESSED)
2025-12-18 14:25:09,698:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (Sub_County_Town_Council_Div): 'Mwizi Subcounty...' -> STRING (non-numeric detected)
2025-12-18 14:25:09,698:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (Sub_County_Town_Council_Div): Mwizi Subcounty (PROCESSED)

[DHIS2] Fetching hierarchy for 1142 org units...
[DHIS2] _fetch_org_unit_hierarchy: Fetching 1142 unique org units
[DHIS2] Batch 4: Got 50 org units from DHIS2
[DHIS2] Batch 1: Got 50 org units from DHIS2
[DHIS2]   OU: wNunka5Y2uu, name=Acholi-Bur Subcounty, level=4, parent=aBrjuZk0W31
[DHIS2]   OU: FihNC5KfGJV, name=Adilang Subcounty, level=4, parent=ztIyIYAzFKp
[DHIS2]   OU: HSBjlZdFpWn, name=Ajan Subcounty, level=4, parent=aBrjuZk0W31
[DHIS2] Batch 1: Got 50 org units from DHIS2
[DHIS2]   OU: wNunka5Y2uu, name=Acholi-Bur Subcounty, level=4, parent=aBrjuZk0W31
[DHIS2]   OU: FihNC5KfGJV, name=Adilang Subcounty, level=4, parent=ztIyIYAzFKp
[DHIS2]   OU: HSBjlZdFpWn, name=Ajan Subcounty, level=4, parent=aBrjuZk0W31
[DHIS2] Batch 5: Got 50 org units from DHIS2
[DHIS2] Batch 2: Got 50 org units from DHIS2
[DHIS2] Batch 2: Got 50 org units from DHIS2
[DHIS2] Batch 6: Got 50 org units from DHIS2
[DHIS2] Batch 3: Got 50 org units from DHIS2
[DHIS2] Batch 3: Got 50 org units from DHIS2
[DHIS2] Batch 7: Got 50 org units from DHIS2
[DHIS2] Batch 4: Got 50 org units from DHIS2
[DHIS2] Batch 4: Got 50 org units from DHIS2
[DHIS2] Batch 8: Got 50 org units from DHIS2
[DHIS2] Batch 5: Got 50 org units from DHIS2
[DHIS2] Batch 5: Got 50 org units from DHIS2
[DHIS2] Batch 9: Got 50 org units from DHIS2
[DHIS2] Batch 6: Got 50 org units from DHIS2
[DHIS2] Batch 6: Got 50 org units from DHIS2
[DHIS2] Batch 10: Got 50 org units from DHIS2
[DHIS2] Batch 7: Got 50 org units from DHIS2
[DHIS2] Batch 7: Got 50 org units from DHIS2
[DHIS2] Batch 11: Got 50 org units from DHIS2
[DHIS2] Batch 8: Got 50 org units from DHIS2
[DHIS2] Batch 8: Got 50 org units from DHIS2
[DHIS2] Batch 12: Got 50 org units from DHIS2
[DHIS2] Batch 9: Got 50 org units from DHIS2
[DHIS2] Batch 9: Got 50 org units from DHIS2
[DHIS2] Batch 13: Got 50 org units from DHIS2
[DHIS2] Batch 10: Got 50 org units from DHIS2
[DHIS2] Batch 10: Got 50 org units from DHIS2
[DHIS2] Batch 14: Got 50 org units from DHIS2
[DHIS2] Batch 11: Got 50 org units from DHIS2
[DHIS2] Batch 11: Got 50 org units from DHIS2
[DHIS2] Batch 15: Got 50 org units from DHIS2
[DHIS2] Batch 12: Got 50 org units from DHIS2
[DHIS2] Batch 12: Got 50 org units from DHIS2
[DHIS2] Batch 16: Got 50 org units from DHIS2
[DHIS2] Batch 13: Got 50 org units from DHIS2
[DHIS2] Batch 13: Got 50 org units from DHIS2
[DHIS2] Batch 17: Got 50 org units from DHIS2
[DHIS2] Batch 14: Got 50 org units from DHIS2
[DHIS2] Batch 14: Got 50 org units from DHIS2
[DHIS2] Batch 18: Got 50 org units from DHIS2
[DHIS2] Batch 15: Got 50 org units from DHIS2
[DHIS2] Batch 15: Got 50 org units from DHIS2
[DHIS2] Batch 19: Got 50 org units from DHIS2
[DHIS2] Batch 16: Got 50 org units from DHIS2
[DHIS2] Batch 16: Got 50 org units from DHIS2
[DHIS2] Batch 20: Got 50 org units from DHIS2
[DHIS2] Batch 17: Got 50 org units from DHIS2
[DHIS2] Batch 17: Got 50 org units from DHIS2
[DHIS2] Batch 21: Got 50 org units from DHIS2
[DHIS2] Batch 18: Got 50 org units from DHIS2
[DHIS2] Batch 18: Got 50 org units from DHIS2
[DHIS2] Batch 22: Got 50 org units from DHIS2
[DHIS2] Batch 19: Got 50 org units from DHIS2
[DHIS2] Batch 19: Got 50 org units from DHIS2
[DHIS2] Batch 23: Got 42 org units from DHIS2
[DHIS2] Batch 20: Got 50 org units from DHIS2
[DHIS2] Batch 20: Got 50 org units from DHIS2
[DHIS2] Batch 21: Got 50 org units from DHIS2
[DHIS2] Batch 21: Got 50 org units from DHIS2
[DHIS2] Total org unit names available: 1145 after 2 iterations
[DHIS2] Sample hierarchy for a9NzDoLn9kz: {'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Kitgum District', 'level_4': 'Pager Division', 'level_5': None, 'level_6': None}
[DHIS2]   a9NzDoLn9kz: filled levels = ['level_1', 'level_2', 'level_3', 'level_4']
[DHIS2]   aFgrVHVDqoZ: filled levels = ['level_1', 'level_2', 'level_3', 'level_4', 'level_5']
[DHIS2]   fxHApp8UtpE: filled levels = ['level_1', 'level_2', 'level_3', 'level_4', 'level_5']
[DHIS2] Fetched hierarchy for 1142 org units
[DHIS2] Sample hierarchy for a9NzDoLn9kz: {'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Kitgum District', 'level_4': 'Pager Division', 'level_5': None, 'level_6': None}
[DHIS2] Calling DHIS2ResponseNormalizer.normalize with:
[DHIS2]   - endpoint: analytics
[DHIS2]   - pivot: True
[DHIS2]   - org_unit_hierarchy: 1142 entries
[DHIS2]   - org_unit_level_names: {3: 'District', 5: 'Health Facility', 1: 'National', 2: 'Region', 4: 'Sub County/Town Council/Div'}
[DHIS2] normalize_analytics: pivot=True, using WIDE/PIVOTED format
[DHIS2] PIVOT CONSTRUCTION:
[DHIS2]   data_elements (UIDs): ['AuAOIfCuBUp', 'BWZFz9RJRPI', 'D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'gHjJrtw9vQX', 'pRZrTLDN7Ge', 'wUDxFVBapIc']
[DHIS2]   data_element_list (sorted UIDs): ['AuAOIfCuBUp', 'BWZFz9RJRPI', 'D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'gHjJrtw9vQX', 'pRZrTLDN7Ge', 'wUDxFVBapIc']
[DHIS2]   col_names (SANITIZED): ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Row 0: OU=AA8TRyfTwtn, hierarchy_info={'level_1': 'MOH - Uganda', 'level_2': 'Ankole', 'level_3': 'Rwampara District', 'level_4': 'Mwizi Subcounty', 'level_5': None, 'level_6': None}
[DHIS2] Row 1: OU=AJxamlmKn2x, hierarchy_info={'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Amuru District', 'level_4': 'Lamogi Subcounty', 'level_5': 'Keyo Health Centre II', 'level_6': None}
[DHIS2] Row 2: OU=ALL4sSTGBRn, hierarchy_info={'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Gulu District', 'level_4': 'Owalo Subcounty', 'level_5': None, 'level_6': None}
[DHIS2] Normalized columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized row count: 4437
[DHIS2] First row: ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
[DHIS2] _set_description: original=['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], sanitized=['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], types=['String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String']
[DHIS2] Transformed rows count: 4437
[DHIS2] First transformed row: ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
[DHIS2] Fetched 4437 rows
[DHIS2] fetchall() called - returning 4437 rows
[DHIS2] fetchall() - First row type: <class 'tuple'>
[DHIS2] fetchall() - First row (original): ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
[DHIS2] fetchall() - Column count from description: 14
[DHIS2] fetchall() - First row (fixed types): ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)2025-12-18 14:25:09,712:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() returning 4437 rows with 14 columns each
2025-12-18 14:25:09,712:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Got 4437 rows from cursor
2025-12-18 14:25:09,712:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: First row: ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
2025-12-18 14:25:09,712:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:25:09,712:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Types from cursor: ['String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String']
2025-12-18 14:25:09,736:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: DataFrame created with 4437 rows, 14 columns
2025-12-18 14:25:09,736:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:25:09,737:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes BEFORE fix: {'Period': dtype('O'), 'National': dtype('O'), 'Region': dtype('O'), 'District': dtype('O'), 'Sub_County_Town_Council_Div': dtype('O'), 'Health_Facility': dtype('O'), '108_EP01a_2_Malaria_Total_Deaths': dtype('O'), '108_EP01a_1_Malaria_Total_Cases': dtype('O'), '105_EP01b_Malaria_Total': dtype('O'), '105_EP01a_Suspected_fever': dtype('O'), '105_EP01d_Malaria_cases_treated': dtype('O'), '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths': dtype('O'), '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases': dtype('O'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('O')}
2025-12-18 14:25:09,739:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Period' to object dtype (dimension)
2025-12-18 14:25:09,739:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'National' as dimension (contains non-numeric string: 'MOH - Uganda...')
2025-12-18 14:25:09,739:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'National' to object dtype (dimension)
2025-12-18 14:25:09,739:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'Region' as dimension (contains non-numeric string: 'Ankole...')
2025-12-18 14:25:09,740:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Region' to object dtype (dimension)
2025-12-18 14:25:09,740:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'District' as dimension (contains non-numeric string: 'Rwampara District...')
2025-12-18 14:25:09,740:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'District' to object dtype (dimension)
2025-12-18 14:25:09,740:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'Sub_County_Town_Council_Div' as dimension (contains non-numeric string: 'Mwizi Subcounty...')
2025-12-18 14:25:09,741:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Sub_County_Town_Council_Div' to object dtype (dimension)
2025-12-18 14:25:09,741:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'Health_Facility' as dimension (contains non-numeric string: 'Keyo Health Centre II...')
2025-12-18 14:25:09,741:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Health_Facility' to object dtype (dimension)
2025-12-18 14:25:09,743:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes AFTER fix: {'Period': dtype('O'), 'National': dtype('O'), 'Region': dtype('O'), 'District': dtype('O'), 'Sub_County_Town_Council_Div': dtype('O'), 'Health_Facility': dtype('O'), '108_EP01a_2_Malaria_Total_Deaths': dtype('O'), '108_EP01a_1_Malaria_Total_Cases': dtype('O'), '105_EP01b_Malaria_Total': dtype('O'), '105_EP01a_Suspected_fever': dtype('O'), '105_EP01d_Malaria_cases_treated': dtype('O'), '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths': dtype('O'), '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases': dtype('O'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('O')}
2025-12-18 14:25:09,743:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: First row: {'Period': '2020', 'National': 'MOH - Uganda', 'Region': 'Ankole', 'District': 'Rwampara District', 'Sub_County_Town_Council_Div': 'Mwizi Subcounty', 'Health_Facility': None, '108_EP01a_2_Malaria_Total_Deaths': None, '108_EP01a_1_Malaria_Total_Cases': 3, '105_EP01b_Malaria_Total': 1580, '105_EP01a_Suspected_fever': 6695, '105_EP01d_Malaria_cases_treated': 1560, '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths': None, '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases': 3, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 1579}
2025-12-18 14:25:09,745:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] BEFORE assign_column_label:
2025-12-18 14:25:09,746:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4437, 14)
2025-12-18 14:25:09,746:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:25:09,746:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:25:09,746:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: False
2025-12-18 14:25:09,746:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Period': '2020', 'National': 'MOH - Uganda', 'Region': 'Ankole', 'District': 'Rwampara District', 'Sub_County_Town_Council_Div': 'Mwizi Subcounty', 'Health_Facility': None, '108_EP01a_2_Malaria_Total_Deaths': None, '108_EP01a_1_Malaria_Total_Cases': 3, '105_EP01b_Malaria_Total': 1580, '105_EP01a_Suspected_fever': 6695, '105_EP01d_Malaria_cases_treated': 1560, '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths': None, '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases': 3, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 1579}
2025-12-18 14:25:09,746:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Column truncation needed: df has 14 columns, expected 3
2025-12-18 14:25:09,746:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   DataFrame actual columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:25:09,746:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Expected columns: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:25:09,746:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] âœ“ Selecting columns BY NAME (matched all expected columns)
2025-12-18 14:25:09,746:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Column mapping: {'District': 'District', 'SUM(105-EP01b. Malaria Total)': '105_EP01b_Malaria_Total', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))': '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'}
2025-12-18 14:25:09,748:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] Column Selection âœ“ SUCCESS - method=BY_NAME, datasource=analytics 20251217-3246
2025-12-18 14:25:09,748:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:25:09,748:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   tried_by_name=True, success=True, fallback=False
2025-12-18 14:25:09,748:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Assigning column labels: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:25:09,748:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] AFTER assign_column_label:
2025-12-18 14:25:09,748:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4437, 3)
2025-12-18 14:25:09,748:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:25:09,748:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:25:09,748:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: True
2025-12-18 14:25:09,748:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'District': 'Rwampara District', 'SUM(105-EP01b. Malaria Total)': 1580, 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))': 1579}
2025-12-18 14:25:09,757:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING] Auto-sanitizing wrapped aggregate: 'SUM(105-EP01b. Malaria Total)' -> 'SUM(105_EP01b_Malaria_Total)'
2025-12-18 14:25:09,757:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING] Auto-sanitizing wrapped aggregate: 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))' -> 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)'
2025-12-18 14:25:09,757:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] DataFrame columns: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:25:09,757:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Aggregates: {'SUM(105-EP01b. Malaria Total)': {'operator': 'mean', 'column': 'SUM(105_EP01b_Malaria_Total)'}, 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))': {'operator': 'mean', 'column': 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)'}}
2025-12-18 14:25:09,757:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105-EP01b. Malaria Total)', column='SUM(105_EP01b_Malaria_Total)'
2025-12-18 14:25:09,757:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Column 'SUM(105_EP01b_Malaria_Total)' not found directly. Checking if aggregate name 'SUM(105-EP01b. Malaria Total)' is in DataFrame...
2025-12-18 14:25:09,757:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Found aggregate name 'SUM(105-EP01b. Malaria Total)' in DataFrame! Using name as column.
2025-12-18 14:25:09,758:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))', column='SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)'
2025-12-18 14:25:09,758:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Column 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)' not found directly. Checking if aggregate name 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))' is in DataFrame...
2025-12-18 14:25:09,758:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Found aggregate name 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))' in DataFrame! Using name as column.
2025-12-18 14:25:09,775:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:25:09] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-18 14:25:10,967:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Fetched 1142 org units, found 301 parent IDs
2025-12-18 14:25:10,967:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Iteration 1: Fetching 2 missing parent org units...
2025-12-18 14:25:11,300:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Fetched 1142 org units, found 301 parent IDs
2025-12-18 14:25:11,300:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Iteration 1: Fetching 2 missing parent org units...
2025-12-18 14:25:11,818:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Iteration 2: Fetching 1 missing parent org units...
2025-12-18 14:25:12,122:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Iteration 2: Fetching 1 missing parent org units...
2025-12-18 14:25:12,731:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total org unit names available: 1145
2025-12-18 14:25:12,743:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Sample hierarchy for a9NzDoLn9kz: {'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Kitgum District', 'level_4': 'Pager Division', 'level_5': None, 'level_6': None}
2025-12-18 14:25:12,743:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] _fetch_org_unit_hierarchy completed: 1142 org units with hierarchy
2025-12-18 14:25:12,744:INFO:superset.db_engine_specs.dhis2_dialect:normalize_analytics called with pivot=True, returning WIDE format
2025-12-18 14:25:12,769:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column construction - data_elements: ['AuAOIfCuBUp', 'BWZFz9RJRPI', 'D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'gHjJrtw9vQX', 'pRZrTLDN7Ge', 'wUDxFVBapIc']
2025-12-18 14:25:12,769:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column names constructed (SANITIZED): ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:25:12,770:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] FIRST ROW CONSTRUCTION:
2025-12-18 14:25:12,770:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   Period (index 0): 2020
2025-12-18 14:25:12,771:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   108-EP01a.2. Malaria Total (Deaths) (index 6): None
2025-12-18 14:25:12,771:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   108-EP01a.1. Malaria Total (Cases) (index 7): 3
2025-12-18 14:25:12,771:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01b. Malaria Total (index 8): 1580
2025-12-18 14:25:12,771:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01a. Suspected fever (index 9): 6695
2025-12-18 14:25:12,771:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01d. Malaria cases treated (index 10): 1560
2025-12-18 14:25:12,771:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   108-EP01b.2. Malaria Confirmed (Microscopic &RDT) (Deaths) (index 11): None
2025-12-18 14:25:12,771:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   108-EP01b.1. Malaria Confirmed (Microscopic &RDT) (Cases) (index 12): 3
2025-12-18 14:25:12,771:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01c. Malaria Confirmed (B/s and RDT Positive) (index 13): 1579
2025-12-18 14:25:12,781:INFO:superset.db_engine_specs.dhis2_dialect:First pivoted row - Period: '2020'
2025-12-18 14:25:12,781:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total pivoted rows: 4437, columns: 14
2025-12-18 14:25:12,782:INFO:superset.db_engine_specs.dhis2_dialect:Normalized 4437 rows with 14 columns for endpoint analytics
2025-12-18 14:25:12,782:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API returned 4437 rows
2025-12-18 14:25:12,797:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() - Row count: 4437
2025-12-18 14:25:12,797:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:25:12,797:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names length: 14
2025-12-18 14:25:12,797:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values count: 14
2025-12-18 14:25:12,798:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values: ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
2025-12-18 14:25:12,798:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 0 (Period): 2020 -> 2020 (STRING)
2025-12-18 14:25:12,798:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (National): 'MOH - Uganda...' -> STRING (non-numeric detected)
2025-12-18 14:25:12,798:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (National): MOH - Uganda (PROCESSED)
2025-12-18 14:25:12,798:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (Region): 'Ankole...' -> STRING (non-numeric detected)
2025-12-18 14:25:12,798:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (Region): Ankole (PROCESSED)
2025-12-18 14:25:12,798:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (District): 'Rwampara District...' -> STRING (non-numeric detected)
2025-12-18 14:25:12,798:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (District): Rwampara District (PROCESSED)
2025-12-18 14:25:12,798:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (Sub_County_Town_Council_Div): 'Mwizi Subcounty...' -> STRING (non-numeric detected)
2025-12-18 14:25:12,799:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (Sub_County_Town_Council_Div): Mwizi Subcounty (PROCESSED)
2025-12-18 14:25:12,811:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() returning 4437 rows with 14 columns each
2025-12-18 14:25:12,811:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Got 4437 rows from cursor
2025-12-18 14:25:12,811:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: First row: ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
2025-12-18 14:25:12,811:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:25:12,811:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Types from cursor: ['String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String']
2025-12-18 14:25:12,820:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: DataFrame created with 4437 rows, 14 columns
2025-12-18 14:25:12,820:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:25:12,821:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes BEFORE fix: {'Period': dtype('O'), 'National': dtype('O'), 'Region': dtype('O'), 'District': dtype('O'), 'Sub_County_Town_Council_Div': dtype('O'), 'Health_Facility': dtype('O'), '108_EP01a_2_Malaria_Total_Deaths': dtype('O'), '108_EP01a_1_Malaria_Total_Cases': dtype('O'), '105_EP01b_Malaria_Total': dtype('O'), '105_EP01a_Suspected_fever': dtype('O'), '105_EP01d_Malaria_cases_treated': dtype('O'), '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths': dtype('O'), '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases': dtype('O'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('O')}
2025-12-18 14:25:12,822:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Period' to object dtype (dimension)
2025-12-18 14:25:12,822:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'National' as dimension (contains non-numeric string: 'MOH - Uganda...')
2025-12-18 14:25:12,822:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'National' to object dtype (dimension)
2025-12-18 14:25:12,823:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'Region' as dimension (contains non-numeric string: 'Ankole...')
2025-12-18 14:25:12,823:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Region' to object dtype (dimension)
2025-12-18 14:25:12,823:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'District' as dimension (contains non-numeric string: 'Rwampara District...')
2025-12-18 14:25:12,824:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'District' to object dtype (dimension)
2025-12-18 14:25:12,824:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'Sub_County_Town_Council_Div' as dimension (contains non-numeric string: 'Mwizi Subcounty...')
2025-12-18 14:25:12,824:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Sub_County_Town_Council_Div' to object dtype (dimension)
2025-12-18 14:25:12,825:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'Health_Facility' as dimension (contains non-numeric string: 'Keyo Health Centre II...')
2025-12-18 14:25:12,825:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Health_Facility' to object dtype (dimension)
2025-12-18 14:25:12,827:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes AFTER fix: {'Period': dtype('O'), 'National': dtype('O'), 'Region': dtype('O'), 'District': dtype('O'), 'Sub_County_Town_Council_Div': dtype('O'), 'Health_Facility': dtype('O'), '108_EP01a_2_Malaria_Total_Deaths': dtype('O'), '108_EP01a_1_Malaria_Total_Cases': dtype('O'), '105_EP01b_Malaria_Total': dtype('O'), '105_EP01a_Suspected_fever': dtype('O'), '105_EP01d_Malaria_cases_treated': dtype('O'), '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths': dtype('O'), '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases': dtype('O'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('O')}
2025-12-18 14:25:12,827:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: First row: {'Period': '2020', 'National': 'MOH - Uganda', 'Region': 'Ankole', 'District': 'Rwampara District', 'Sub_County_Town_Council_Div': 'Mwizi Subcounty', 'Health_Facility': None, '108_EP01a_2_Malaria_Total_Deaths': None, '108_EP01a_1_Malaria_Total_Cases': 3, '105_EP01b_Malaria_Total': 1580, '105_EP01a_Suspected_fever': 6695, '105_EP01d_Malaria_cases_treated': 1560, '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths': None, '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases': 3, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 1579}
2025-12-18 14:25:12,831:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] BEFORE assign_column_label:
2025-12-18 14:25:12,831:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4437, 14)
2025-12-18 14:25:12,831:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:25:12,831:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:25:12,831:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: False
2025-12-18 14:25:12,831:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Period': '2020', 'National': 'MOH - Uganda', 'Region': 'Ankole', 'District': 'Rwampara District', 'Sub_County_Town_Council_Div': 'Mwizi Subcounty', 'Health_Facility': None, '108_EP01a_2_Malaria_Total_Deaths': None, '108_EP01a_1_Malaria_Total_Cases': 3, '105_EP01b_Malaria_Total': 1580, '105_EP01a_Suspected_fever': 6695, '105_EP01d_Malaria_cases_treated': 1560, '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths': None, '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases': 3, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 1579}
2025-12-18 14:25:12,831:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Column truncation needed: df has 14 columns, expected 3
2025-12-18 14:25:12,832:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   DataFrame actual columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:25:12,832:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Expected columns: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:25:12,832:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] âœ“ Selecting columns BY NAME (matched all expected columns)
2025-12-18 14:25:12,832:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Column mapping: {'District': 'District', 'SUM(105-EP01b. Malaria Total)': '105_EP01b_Malaria_Total', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))': '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'}
2025-12-18 14:25:12,832:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] Column Selection âœ“ SUCCESS - method=BY_NAME, datasource=analytics 20251217-3246
2025-12-18 14:25:12,832:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:25:12,832:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   tried_by_name=True, success=True, fallback=False
2025-12-18 14:25:12,833:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Assigning column labels: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:25:12,833:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] AFTER assign_column_label:
2025-12-18 14:25:12,833:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4437, 3)
2025-12-18 14:25:12,833:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:25:12,833:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:25:12,833:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: True
2025-12-18 14:25:12,833:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'District': 'Rwampara District', 'SUM(105-EP01b. Malaria Total)': 1580, 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))': 1579}
2025-12-18 14:25:12,838:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING] Auto-sanitizing wrapped aggregate: 'SUM(105-EP01b. Malaria Total)' -> 'SUM(105_EP01b_Malaria_Total)'
2025-12-18 14:25:12,838:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING] Auto-sanitizing wrapped aggregate: 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))' -> 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)'
2025-12-18 14:25:12,838:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] DataFrame columns: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:25:12,838:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Aggregates: {'SUM(105-EP01b. Malaria Total)': {'operator': 'mean', 'column': 'SUM(105_EP01b_Malaria_Total)'}, 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))': {'operator': 'mean', 'column': 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)'}}
2025-12-18 14:25:12,838:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105-EP01b. Malaria Total)', column='SUM(105_EP01b_Malaria_Total)'
2025-12-18 14:25:12,838:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Column 'SUM(105_EP01b_Malaria_Total)' not found directly. Checking if aggregate name 'SUM(105-EP01b. Malaria Total)' is in DataFrame...
2025-12-18 14:25:12,838:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Found aggregate name 'SUM(105-EP01b. Malaria Total)' in DataFrame! Using name as column.
2025-12-18 14:25:12,839:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))', column='SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)'
2025-12-18 14:25:12,839:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Column 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)' not found directly. Checking if aggregate name 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))' is in DataFrame...
2025-12-18 14:25:12,839:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Found aggregate name 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))' in DataFrame! Using name as column.
2025-12-18 14:25:12,856:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:25:12] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-18 14:25:13,084:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total org unit names available: 1145
2025-12-18 14:25:13,092:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Sample hierarchy for a9NzDoLn9kz: {'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Kitgum District', 'level_4': 'Pager Division', 'level_5': None, 'level_6': None}
2025-12-18 14:25:13,092:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] _fetch_org_unit_hierarchy completed: 1142 org units with hierarchy
2025-12-18 14:25:13,092:INFO:superset.db_engine_specs.dhis2_dialect:normalize_analytics called with pivot=True, returning WIDE format
2025-12-18 14:25:13,106:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column construction - data_elements: ['AuAOIfCuBUp', 'BWZFz9RJRPI', 'D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'gHjJrtw9vQX', 'pRZrTLDN7Ge', 'wUDxFVBapIc']
2025-12-18 14:25:13,106:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column names constructed (SANITIZED): ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:25:13,107:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] FIRST ROW CONSTRUCTION:
2025-12-18 14:25:13,107:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   Period (index 0): 2020
2025-12-18 14:25:13,107:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   108-EP01a.2. Malaria Total (Deaths) (index 6): None
2025-12-18 14:25:13,107:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   108-EP01a.1. Malaria Total (Cases) (index 7): 3
2025-12-18 14:25:13,107:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01b. Malaria Total (index 8): 1580
2025-12-18 14:25:13,107:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01a. Suspected fever (index 9): 6695
2025-12-18 14:25:13,107:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01d. Malaria cases treated (index 10): 1560
2025-12-18 14:25:13,107:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   108-EP01b.2. Malaria Confirmed (Microscopic &RDT) (Deaths) (index 11): None
2025-12-18 14:25:13,107:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   108-EP01b.1. Malaria Confirmed (Microscopic &RDT) (Cases) (index 12): 3
2025-12-18 14:25:13,107:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01c. Malaria Confirmed (B/s and RDT Positive) (index 13): 1579
2025-12-18 14:25:13,118:INFO:superset.db_engine_specs.dhis2_dialect:First pivoted row - Period: '2020'
2025-12-18 14:25:13,118:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total pivoted rows: 4437, columns: 14

[DHIS2] fetchall() - Type enforcement: dimensions=STRING, measures=FLOAT
[DHIS2] Batch 22: Got 50 org units from DHIS2
[DHIS2] Batch 22: Got 50 org units from DHIS2
[DHIS2] Batch 23: Got 42 org units from DHIS2
[DHIS2] Batch 23: Got 42 org units from DHIS2
[DHIS2] Total org unit names available: 1145 after 2 iterations
[DHIS2] Sample hierarchy for a9NzDoLn9kz: {'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Kitgum District', 'level_4': 'Pager Division', 'level_5': None, 'level_6': None}
[DHIS2]   a9NzDoLn9kz: filled levels = ['level_1', 'level_2', 'level_3', 'level_4']
[DHIS2]   aFgrVHVDqoZ: filled levels = ['level_1', 'level_2', 'level_3', 'level_4', 'level_5']
[DHIS2]   fxHApp8UtpE: filled levels = ['level_1', 'level_2', 'level_3', 'level_4', 'level_5']
[DHIS2] Fetched hierarchy for 1142 org units
[DHIS2] Sample hierarchy for a9NzDoLn9kz: {'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Kitgum District', 'level_4': 'Pager Division', 'level_5': None, 'level_6': None}
[DHIS2] Calling DHIS2ResponseNormalizer.normalize with:
[DHIS2]   - endpoint: analytics
[DHIS2]   - pivot: True
[DHIS2]   - org_unit_hierarchy: 1142 entries
[DHIS2]   - org_unit_level_names: {3: 'District', 5: 'Health Facility', 1: 'National', 2: 'Region', 4: 'Sub County/Town Council/Div'}
[DHIS2] normalize_analytics: pivot=True, using WIDE/PIVOTED format
[DHIS2] PIVOT CONSTRUCTION:
[DHIS2]   data_elements (UIDs): ['AuAOIfCuBUp', 'BWZFz9RJRPI', 'D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'gHjJrtw9vQX', 'pRZrTLDN7Ge', 'wUDxFVBapIc']
[DHIS2]   data_element_list (sorted UIDs): ['AuAOIfCuBUp', 'BWZFz9RJRPI', 'D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'gHjJrtw9vQX', 'pRZrTLDN7Ge', 'wUDxFVBapIc']
[DHIS2]   col_names (SANITIZED): ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Row 0: OU=AA8TRyfTwtn, hierarchy_info={'level_1': 'MOH - Uganda', 'level_2': 'Ankole', 'level_3': 'Rwampara District', 'level_4': 'Mwizi Subcounty', 'level_5': None, 'level_6': None}
[DHIS2] Row 1: OU=AJxamlmKn2x, hierarchy_info={'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Amuru District', 'level_4': 'Lamogi Subcounty', 'level_5': 'Keyo Health Centre II', 'level_6': None}
[DHIS2] Row 2: OU=ALL4sSTGBRn, hierarchy_info={'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Gulu District', 'level_4': 'Owalo Subcounty', 'level_5': None, 'level_6': None}
[DHIS2] Normalized columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized row count: 4437
[DHIS2] First row: ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
[DHIS2] _set_description: original=['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], sanitized=['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], types=['String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String']
[DHIS2] Transformed rows count: 4437
[DHIS2] First transformed row: ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
[DHIS2] Fetched 4437 rows
[DHIS2] fetchall() called - returning 4437 rows
[DHIS2] fetchall() - First row type: <class 'tuple'>
[DHIS2] fetchall() - First row (original): ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
[DHIS2] fetchall() - Column count from description: 14
[DHIS2] fetchall() - First row (fixed types): ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
[DHIS2] fetchall() - Type enforcement: dimensions=STRING, measures=FLOAT
[DHIS2] Total org unit names available: 1145 after 2 iterations
[DHIS2] Sample hierarchy for a9NzDoLn9kz: {'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Kitgum District', 'level_4': 'Pager Division', 'level_5': None, 'level_6': None}
[DHIS2]   a9NzDoLn9kz: filled levels = ['level_1', 'level_2', 'level_3', 'level_4']
[DHIS2]   aFgrVHVDqoZ: filled levels = ['level_1', 'level_2', 'level_3', 'level_4', 'level_5']
[DHIS2]   fxHApp8UtpE: filled levels = ['level_1', 'level_2', 'level_3', 'level_4', 'level_5']
[DHIS2] Fetched hierarchy for 1142 org units
[DHIS2] Sample hierarchy for a9NzDoLn9kz: {'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Kitgum District', 'level_4': 'Pager Division', 'level_5': None, 'level_6': None}
[DHIS2] Calling DHIS2ResponseNormalizer.normalize with:
[DHIS2]   - endpoint: analytics
[DHIS2]   - pivot: True
[DHIS2]   - org_unit_hierarchy: 1142 entries
[DHIS2]   - org_unit_level_names: {3: 'District', 5: 'Health Facility', 1: 'National', 2: 'Region', 4: 'Sub County/Town Council/Div'}
[DHIS2] normalize_analytics: pivot=True, using WIDE/PIVOTED format
[DHIS2] PIVOT CONSTRUCTION:
[DHIS2]   data_elements (UIDs): ['AuAOIfCuBUp', 'BWZFz9RJRPI', 'D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'gHjJrtw9vQX', 'pRZrTLDN7Ge', 'wUDxFVBapIc']
[DHIS2]   data_element_list (sorted UIDs): ['AuAOIfCuBUp', 'BWZFz9RJRPI', 'D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'gHjJrtw9vQX', 'pRZrTLDN7Ge', 'wUDxFVBapIc']
[DHIS2]   col_names (SANITIZED): ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Row 0: OU=AA8TRyfTwtn, hierarchy_info={'level_1': 'MOH - Uganda', 'level_2': 'Ankole', 'level_3': 'Rwampara District', 'level_4': 'Mwizi Subcounty', 'level_5': None, 'level_6': None}
[DHIS2] Row 1: OU=AJxamlmKn2x, hierarchy_info={'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Amuru District', 'level_4': 'Lamogi Subcounty', 'level_5': 'Keyo Health Centre II', 'level_6': None}
[DHIS2] Row 2: OU=ALL4sSTGBRn, hierarchy_info={'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Gulu District', 'level_4': 'Owalo Subcounty', 'level_5': None, 'level_6': None}
[DHIS2] Normalized columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized row count: 4437
[DHIS2] First row: ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)2025-12-18 14:25:13,118:INFO:superset.db_engine_specs.dhis2_dialect:Normalized 4437 rows with 14 columns for endpoint analytics
2025-12-18 14:25:13,119:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API returned 4437 rows
2025-12-18 14:25:13,128:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() - Row count: 4437
2025-12-18 14:25:13,128:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:25:13,128:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names length: 14
2025-12-18 14:25:13,128:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values count: 14
2025-12-18 14:25:13,128:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values: ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
2025-12-18 14:25:13,128:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 0 (Period): 2020 -> 2020 (STRING)
2025-12-18 14:25:13,128:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (National): 'MOH - Uganda...' -> STRING (non-numeric detected)
2025-12-18 14:25:13,128:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (National): MOH - Uganda (PROCESSED)
2025-12-18 14:25:13,128:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (Region): 'Ankole...' -> STRING (non-numeric detected)
2025-12-18 14:25:13,128:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (Region): Ankole (PROCESSED)
2025-12-18 14:25:13,128:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (District): 'Rwampara District...' -> STRING (non-numeric detected)
2025-12-18 14:25:13,128:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (District): Rwampara District (PROCESSED)
2025-12-18 14:25:13,128:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (Sub_County_Town_Council_Div): 'Mwizi Subcounty...' -> STRING (non-numeric detected)
2025-12-18 14:25:13,128:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (Sub_County_Town_Council_Div): Mwizi Subcounty (PROCESSED)
2025-12-18 14:25:13,141:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() returning 4437 rows with 14 columns each
2025-12-18 14:25:13,141:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Got 4437 rows from cursor
2025-12-18 14:25:13,141:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: First row: ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
2025-12-18 14:25:13,141:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:25:13,141:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Types from cursor: ['String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String']
2025-12-18 14:25:13,149:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: DataFrame created with 4437 rows, 14 columns
2025-12-18 14:25:13,154:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:25:13,155:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes BEFORE fix: {'Period': dtype('O'), 'National': dtype('O'), 'Region': dtype('O'), 'District': dtype('O'), 'Sub_County_Town_Council_Div': dtype('O'), 'Health_Facility': dtype('O'), '108_EP01a_2_Malaria_Total_Deaths': dtype('O'), '108_EP01a_1_Malaria_Total_Cases': dtype('O'), '105_EP01b_Malaria_Total': dtype('O'), '105_EP01a_Suspected_fever': dtype('O'), '105_EP01d_Malaria_cases_treated': dtype('O'), '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths': dtype('O'), '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases': dtype('O'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('O')}
2025-12-18 14:25:13,155:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Period' to object dtype (dimension)
2025-12-18 14:25:13,156:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'National' as dimension (contains non-numeric string: 'MOH - Uganda...')
2025-12-18 14:25:13,156:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'National' to object dtype (dimension)
2025-12-18 14:25:13,157:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'Region' as dimension (contains non-numeric string: 'Ankole...')
2025-12-18 14:25:13,157:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Region' to object dtype (dimension)
2025-12-18 14:25:13,157:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'District' as dimension (contains non-numeric string: 'Rwampara District...')
2025-12-18 14:25:13,158:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'District' to object dtype (dimension)
2025-12-18 14:25:13,158:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'Sub_County_Town_Council_Div' as dimension (contains non-numeric string: 'Mwizi Subcounty...')
2025-12-18 14:25:13,159:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Sub_County_Town_Council_Div' to object dtype (dimension)
2025-12-18 14:25:13,159:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'Health_Facility' as dimension (contains non-numeric string: 'Keyo Health Centre II...')
2025-12-18 14:25:13,159:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Health_Facility' to object dtype (dimension)
2025-12-18 14:25:13,161:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes AFTER fix: {'Period': dtype('O'), 'National': dtype('O'), 'Region': dtype('O'), 'District': dtype('O'), 'Sub_County_Town_Council_Div': dtype('O'), 'Health_Facility': dtype('O'), '108_EP01a_2_Malaria_Total_Deaths': dtype('O'), '108_EP01a_1_Malaria_Total_Cases': dtype('O'), '105_EP01b_Malaria_Total': dtype('O'), '105_EP01a_Suspected_fever': dtype('O'), '105_EP01d_Malaria_cases_treated': dtype('O'), '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths': dtype('O'), '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases': dtype('O'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('O')}
2025-12-18 14:25:13,161:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: First row: {'Period': '2020', 'National': 'MOH - Uganda', 'Region': 'Ankole', 'District': 'Rwampara District', 'Sub_County_Town_Council_Div': 'Mwizi Subcounty', 'Health_Facility': None, '108_EP01a_2_Malaria_Total_Deaths': None, '108_EP01a_1_Malaria_Total_Cases': 3, '105_EP01b_Malaria_Total': 1580, '105_EP01a_Suspected_fever': 6695, '105_EP01d_Malaria_cases_treated': 1560, '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths': None, '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases': 3, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 1579}
2025-12-18 14:25:13,167:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] BEFORE assign_column_label:
2025-12-18 14:25:13,167:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4437, 14)
2025-12-18 14:25:13,167:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:25:13,167:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:25:13,167:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: False
2025-12-18 14:25:13,167:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Period': '2020', 'National': 'MOH - Uganda', 'Region': 'Ankole', 'District': 'Rwampara District', 'Sub_County_Town_Council_Div': 'Mwizi Subcounty', 'Health_Facility': None, '108_EP01a_2_Malaria_Total_Deaths': None, '108_EP01a_1_Malaria_Total_Cases': 3, '105_EP01b_Malaria_Total': 1580, '105_EP01a_Suspected_fever': 6695, '105_EP01d_Malaria_cases_treated': 1560, '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths': None, '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases': 3, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 1579}
2025-12-18 14:25:13,167:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Column truncation needed: df has 14 columns, expected 3
2025-12-18 14:25:13,167:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   DataFrame actual columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:25:13,167:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Expected columns: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:25:13,167:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] âœ“ Selecting columns BY NAME (matched all expected columns)
2025-12-18 14:25:13,167:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Column mapping: {'District': 'District', 'SUM(105-EP01b. Malaria Total)': '105_EP01b_Malaria_Total', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))': '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'}
2025-12-18 14:25:13,167:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] Column Selection âœ“ SUCCESS - method=BY_NAME, datasource=analytics 20251217-3246
2025-12-18 14:25:13,167:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:25:13,167:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   tried_by_name=True, success=True, fallback=False
2025-12-18 14:25:13,167:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Assigning column labels: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:25:13,167:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] AFTER assign_column_label:
2025-12-18 14:25:13,167:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4437, 3)
2025-12-18 14:25:13,168:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:25:13,168:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:25:13,168:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: True
2025-12-18 14:25:13,168:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'District': 'Rwampara District', 'SUM(105-EP01b. Malaria Total)': 1580, 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))': 1579}
2025-12-18 14:25:13,171:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING] Auto-sanitizing wrapped aggregate: 'SUM(105-EP01b. Malaria Total)' -> 'SUM(105_EP01b_Malaria_Total)'
2025-12-18 14:25:13,171:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING] Auto-sanitizing wrapped aggregate: 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))' -> 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)'
2025-12-18 14:25:13,171:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] DataFrame columns: ['District', 'SUM(105-EP01b. Malaria Total)', 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))']
2025-12-18 14:25:13,171:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Aggregates: {'SUM(105-EP01b. Malaria Total)': {'operator': 'mean', 'column': 'SUM(105_EP01b_Malaria_Total)'}, 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))': {'operator': 'mean', 'column': 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)'}}
2025-12-18 14:25:13,171:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105-EP01b. Malaria Total)', column='SUM(105_EP01b_Malaria_Total)'
2025-12-18 14:25:13,171:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Column 'SUM(105_EP01b_Malaria_Total)' not found directly. Checking if aggregate name 'SUM(105-EP01b. Malaria Total)' is in DataFrame...
2025-12-18 14:25:13,171:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Found aggregate name 'SUM(105-EP01b. Malaria Total)' in DataFrame! Using name as column.
2025-12-18 14:25:13,171:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))', column='SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)'
2025-12-18 14:25:13,171:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Column 'SUM(105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive)' not found directly. Checking if aggregate name 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))' is in DataFrame...
2025-12-18 14:25:13,171:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Found aggregate name 'SUM(105-EP01c. Malaria Confirmed (B/s and RDT Positive))' in DataFrame! Using name as column.
2025-12-18 14:25:13,203:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:25:13] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-18 14:25:13,884:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:25:13] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 14:26:58,778:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:26:58] "GET /api/v1/dashboard/?q=(columns:!(id,dashboard_title),filters:!((col:dashboard_title,opr:ct,value:''),(col:owners,opr:rel_m_m,value:1)),order_column:dashboard_title,page:0,page_size:100) HTTP/1.1" 200 -
2025-12-18 14:27:01,862:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:27:01] "GET /api/v1/dashboard/1 HTTP/1.1" 200 -
2025-12-18 14:27:02,101:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:27:02] "[35m[1mPOST /api/v1/chart/ HTTP/1.1[0m" 201 -
2025-12-18 14:27:02,746:INFO:superset.db_engine_specs.dhis2:[DHIS2] get_parameters_from_uri called
2025-12-18 14:27:02,746:ERROR:superset.db_engine_specs.dhis2:[DHIS2] Failed to extract parameters from URI: 'URL' object has no attribute 'decode'
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/superset/db_engine_specs/dhis2.py", line 361, in get_parameters_from_uri
    parsed = urlparse(uri)
             ^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/urllib/parse.py", line 394, in urlparse
    url, scheme, _coerce_result = _coerce_args(url, scheme)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/urllib/parse.py", line 133, in _coerce_args
    return _decode_args(args) + (_encode_result,)
           ^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/urllib/parse.py", line 117, in _decode_args
    return tuple(x.decode(encoding, errors) if x else '' for x in args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/urllib/parse.py", line 117, in <genexpr>
    return tuple(x.decode(encoding, errors) if x else '' for x in args)
                 ^^^^^^^^
AttributeError: 'URL' object has no attribute 'decode'
2025-12-18 14:27:02,754:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:27:02] "GET /api/v1/dashboard/1 HTTP/1.1" 200 -
2025-12-18 14:27:02,783:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:27:02] "GET /api/v1/dashboard/1/charts HTTP/1.1" 200 -
2025-12-18 14:27:02,783:INFO:superset.db_engine_specs.dhis2:[DHIS2] get_parameters_from_uri called
2025-12-18 14:27:02,783:ERROR:superset.db_engine_specs.dhis2:[DHIS2] Failed to extract parameters from URI: 'URL' object has no attribute 'decode'
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/superset/db_engine_specs/dhis2.py", line 361, in get_parameters_from_uri
    parsed = urlparse(uri)
             ^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/urllib/parse.py", line 394, in urlparse
    url, scheme, _coerce_result = _coerce_args(url, scheme)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/urllib/parse.py", line 133, in _coerce_args
    return _decode_args(args) + (_encode_result,)
           ^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/urllib/parse.py", line 117, in _decode_args
    return tuple(x.decode(encoding, errors) if x else '' for x in args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/urllib/parse.py", line 117, in <genexpr>
    return tuple(x.decode(encoding, errors) if x else '' for x in args)
                 ^^^^^^^^
AttributeError: 'URL' object has no attribute 'decode'
2025-12-18 14:27:02,789:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:27:02] "GET /api/v1/dashboard/1/datasets HTTP/1.1" 200 -
2025-12-18 14:27:03,511:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:27:03] "GET /api/v1/dashboard/favorite_status/?q=!(1) HTTP/1.1" 200 -
2025-12-18 14:27:03,580:WARNING:superset.common.query_object:The field `groupby` is deprecated, please use `columns` instead.
2025-12-18 14:27:03,582:WARNING:superset.common.query_object:The field `columns` is already populated, replacing value with contents from `groupby`.
2025-12-18 14:27:03,587:WARNING:superset.common.query_object:[DUPLICATE_LABELS] Found duplicates! metric_names=['105_EP01b_Malaria_Total'] (count=1), column_names=['Region', '105_EP01b_Malaria_Total'] (count=2), all_labels=['105_EP01b_Malaria_Total', 'Region', '105_EP01b_Malaria_Total'] (count=3, unique=2), duplicates=['105_EP01b_Malaria_Total']
2025-12-18 14:27:03,609:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:27:03] "[31m[1mPOST /api/v1/chart/data?form_data={"slice_id":2}&dashboard_id=1 HTTP/1.1[0m" 400 -
2025-12-18 14:27:03,629:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:27:03] "GET /api/v1/dataset/1/drill_info/?q=(dashboard_id:1) HTTP/1.1" 200 -
2025-12-18 14:27:03,660:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:27:03] "GET /api/v1/dataset/4/drill_info/?q=(dashboard_id:1) HTTP/1.1" 200 -
2025-12-18 14:27:03,661:WARNING:superset.common.query_object:The field `groupby` is deprecated, please use `columns` instead.
2025-12-18 14:27:03,662:WARNING:superset.common.query_object:The field `columns` is already populated, replacing value with contents from `groupby`.
2025-12-18 14:27:03,673:ERROR:superset.models.helpers:[METRICS-TRACE] Processing 2 metrics
2025-12-18 14:27:03,673:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 0: adhoc - SUM(105_EP01b_Malaria_Total)
2025-12-18 14:27:03,675:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105_EP01b_Malaria_Total)
2025-12-18 14:27:03,675:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 1: adhoc - SUM(105_EP01a_Suspected_fever)
2025-12-18 14:27:03,675:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: SUM(105_EP01a_Suspected_fever)
2025-12-18 14:27:03,675:ERROR:superset.models.helpers:[METRICS-TRACE] Total metrics added: 2
2025-12-18 14:27:03,680:ERROR:superset.models.helpers:[METRICS-TRACE] Before dedup: 1 select_exprs + 2 metrics_exprs
2025-12-18 14:27:03,681:ERROR:superset.models.helpers:[METRICS-TRACE] After dedup: 3 total select_exprs
2025-12-18 14:27:03,683:INFO:superset.models.helpers:[COLUMN_TRACE] SQL Query Building:
2025-12-18 14:27:03,684:INFO:superset.models.helpers:[COLUMN_TRACE]   columns: [{'columnType': 'BASE_AXIS', 'sqlExpression': 'Region', 'label': 'Region', 'expressionType': 'SQL'}]
2025-12-18 14:27:03,685:INFO:superset.models.helpers:[COLUMN_TRACE]   metrics: [{'aggregate': 'SUM', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01b_Malaria_Total', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 7, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'INT', 'type_generic': 0, 'uuid': '941d42ad-73b1-47f0-8ecf-1d86fa5f9577', 'verbose_name': None, 'warning_markdown': None}, 'datasourceWarning': False, 'expressionType': 'SIMPLE', 'hasCustomLabel': False, 'label': 'SUM(105_EP01b_Malaria_Total)', 'optionName': 'metric_fl4980u6b0m_ix0zaazwlci', 'sqlExpression': None}, {'aggregate': 'SUM', 'column': {'advanced_data_type': None, 'certification_details': None, 'certified_by': None, 'column_name': '105_EP01a_Suspected_fever', 'description': None, 'expression': None, 'filterable': True, 'groupby': True, 'id': 8, 'is_certified': False, 'is_dttm': False, 'python_date_format': None, 'type': 'column', 'type_generic': 0, 'uuid': 'ad30c02c-72ba-4d52-8918-572e486aed71', 'verbose_name': None, 'warning_markdown': None}, 'datasourceWarning': False, 'expressionType': 'SIMPLE', 'hasCustomLabel': False, 'label': 'SUM(105_EP01a_Suspected_fever)', 'optionName': 'metric_2qm7jpfb5ad_2dx9i1wgyum', 'sqlExpression': None}]
2025-12-18 14:27:03,685:INFO:superset.models.helpers:[COLUMN_TRACE]   groupby: []
2025-12-18 14:27:03,685:INFO:superset.models.helpers:[COLUMN_TRACE]   labels_expected: ['Region', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)']
2025-12-18 14:27:03,686:INFO:superset.models.helpers:[COLUMN_TRACE]   select_exprs count: 3
2025-12-18 14:27:03,686:INFO:superset.models.helpers:[COLUMN_TRACE]     [0] key=Region, name=Region, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-18 14:27:03,686:INFO:superset.models.helpers:[COLUMN_TRACE]     [1] key=SUM(105_EP01b_Malaria_Total), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-18 14:27:03,686:INFO:superset.models.helpers:[COLUMN_TRACE]     [2] key=SUM(105_EP01a_Suspected_fever), name=sum, type=<class 'sqlalchemy.sql.functions.sum'>
2025-12-18 14:27:03,686:WARNING:superset.common.query_object:[DUPLICATE_LABELS] Found duplicates! metric_names=['105_EP01d_Malaria_cases_treated'] (count=1), column_names=['Region', '105_EP01d_Malaria_cases_treated'] (count=2), all_labels=['105_EP01d_Malaria_cases_treated', 'Region', '105_EP01d_Malaria_cases_treated'] (count=3, unique=2), duplicates=['105_EP01d_Malaria_cases_treated']
2025-12-18 14:27:03,686:INFO:superset.connectors.sqla.models:[DHIS2] get_from_clause for virtual dataset 1: analytics_LAST_YEAR_20251210
2025-12-18 14:27:03,693:INFO:superset.connectors.sqla.models:[DHIS2] Full SQL stored: SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_5_YEARS;ou:USER_ORGUNIT_CHILDREN;USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
2025-12-18 14:27:03,694:INFO:superset.connectors.sqla.models:[DHIS2] Loaded params from extra field: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_5_YEARS;ou:USER_ORGUNIT_CHILDREN;USER_ORGUNIT&displayProperty=NAM
2025-12-18 14:27:03,695:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:27:03] "[31m[1mPOST /api/v1/chart/data?form_data={"slice_id":3}&dashboard_id=1 HTTP/1.1[0m" 400 -
2025-12-18 14:27:03,704:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:27:03] "GET /api/v1/chart/2 HTTP/1.1" 200 -
2025-12-18 14:27:03,705:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:27:03] "POST /api/v1/chart/data?form_data={"slice_id":4}&dashboard_id=1 HTTP/1.1" 200 -
2025-12-18 14:27:03,706:INFO:superset.connectors.sqla.models:[DHIS2] Cached params with key: dhis2_params_1_analytics
2025-12-18 14:27:03,707:INFO:superset.connectors.sqla.models:[DHIS2] Stored params in Flask g for DHIS2 table: analytics
2025-12-18 14:27:03,712:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Query execution in connectors/sqla/models.py:
2025-12-18 14:27:03,713:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   SQL (first 500 chars): SELECT "Region", sum("105_EP01b_Malaria_Total") AS sum_1, sum("105_EP01a_Suspected_fever") AS sum_2 
FROM (SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_5_YEARS;ou:USER_ORGUNIT_CHILDREN;USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
) AS virtual_table GROUP BY "Region" ORDER BY sum("105_EP01b_Malaria_Total") DESC
 LIMIT 10000
2025-12-18 14:27:03,713:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   labels_expected: ['Region', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)']
2025-12-18 14:27:03,721:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 connection initialized: https://tests.dhis2.hispuganda.org/hmis/api
2025-12-18 14:27:03,722:INFO:superset.db_engine_specs.dhis2_dialect:Executing DHIS2 query: SELECT
  "Region",
  SUM("105_EP01b_Malaria_Total") AS sum_1,
  SUM("105_EP01a_Suspected_fever") AS sum_2
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "Region"
ORDER BY
  SUM("105_EP01b_Malaria_Total") DESC
LIMIT 10000
2025-12-18 14:27:03,722:INFO:superset.db_engine_specs.dhis2_dialect:Parsed endpoint: analytics
2025-12-18 14:27:03,722:INFO:superset.db_engine_specs.dhis2_dialect:Using stored parameters from Flask g for table: analytics
2025-12-18 14:27:03,722:INFO:superset.db_engine_specs.dhis2_dialect:Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_5_YEARS;ou:USER_ORGUNIT_CHILDREN;USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
2025-12-18 14:27:03,723:INFO:superset.db_engine_specs.dhis2_dialect:Period dimension detected - omitting startDate/endDate (DHIS2 API rule)
2025-12-18 14:27:03,723:INFO:superset.db_engine_specs.dhis2_dialect:Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_5_YEARS;ou:USER_ORGUNIT_CHILDREN;USER_ORGUNIT'}
2025-12-18 14:27:03,727:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API request (cache miss): https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_5_YEARS&dimension=ou:USER_ORGUNIT_CHILDREN;USER_ORGUNIT
2025-12-18 14:27:03,744:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:27:03] "GET /api/v1/chart/3 HTTP/1.1" 200 -
2025-12-18 14:27:03,818:ERROR:superset.models.helpers:[METRICS-TRACE] Processing 0 metrics
2025-12-18 14:27:03,824:ERROR:superset.models.helpers:[METRICS-TRACE] Total metrics added: 0
2025-12-18 14:27:03,824:ERROR:superset.models.helpers:[METRICS-TRACE] Before dedup: 1 select_exprs + 0 metrics_exprs
2025-12-18 14:27:03,824:ERROR:superset.models.helpers:[METRICS-TRACE] After dedup: 1 total select_exprs
2025-12-18 14:27:03,824:INFO:superset.models.helpers:[COLUMN_TRACE] SQL Query Building:
2025-12-18 14:27:03,824:INFO:superset.models.helpers:[COLUMN_TRACE]   columns: ['Period']
2025-12-18 14:27:03,825:INFO:superset.models.helpers:[COLUMN_TRACE]   metrics: []
2025-12-18 14:27:03,825:INFO:superset.models.helpers:[COLUMN_TRACE]   groupby: []
2025-12-18 14:27:03,825:INFO:superset.models.helpers:[COLUMN_TRACE]   labels_expected: ['Period']
2025-12-18 14:27:03,825:INFO:superset.models.helpers:[COLUMN_TRACE]   select_exprs count: 1
2025-12-18 14:27:03,826:INFO:superset.models.helpers:[COLUMN_TRACE]     [0] key=Period, name=Period, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-18 14:27:03,826:INFO:superset.connectors.sqla.models:[DHIS2] get_from_clause for virtual dataset 1: analytics_LAST_YEAR_20251210
2025-12-18 14:27:03,827:INFO:superset.connectors.sqla.models:[DHIS2] Full SQL stored: SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_5_YEARS;ou:USER_ORGUNIT_CHILDREN;USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
2025-12-18 14:27:03,828:INFO:superset.connectors.sqla.models:[DHIS2] Loaded params from extra field: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_5_YEARS;ou:USER_ORGUNIT_CHILDREN;USER_ORGUNIT&displayProperty=NAM
2025-12-18 14:27:03,832:INFO:superset.connectors.sqla.models:[DHIS2] Cached params with key: dhis2_params_1_analytics
2025-12-18 14:27:03,832:INFO:superset.connectors.sqla.models:[DHIS2] Stored params in Flask g for DHIS2 table: analytics
2025-12-18 14:27:03,834:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Query execution in connectors/sqla/models.py:
2025-12-18 14:27:03,834:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   SQL (first 500 chars): SELECT "Period" 
FROM (SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_5_YEARS;ou:USER_ORGUNIT_CHILDREN;USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
) AS virtual_table GROUP BY "Period" ORDER BY "Period" ASC
 LIMIT 1000
2025-12-18 14:27:03,836:ERROR:superset.models.helpers:[METRICS-TRACE] Processing 0 metrics
2025-12-18 14:27:03,837:ERROR:superset.models.helpers:[METRICS-TRACE] Total metrics added: 0
2025-12-18 14:27:03,837:ERROR:superset.models.helpers:[METRICS-TRACE] Processing 0 metrics
2025-12-18 14:27:03,836:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   labels_expected: ['Period']
2025-12-18 14:27:03,837:ERROR:superset.models.helpers:[METRICS-TRACE] Before dedup: 1 select_exprs + 0 metrics_exprs
2025-12-18 14:27:03,838:ERROR:superset.models.helpers:[METRICS-TRACE] Total metrics added: 0
2025-12-18 14:27:03,840:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 connection initialized: https://tests.dhis2.hispuganda.org/hmis/api
2025-12-18 14:27:03,841:ERROR:superset.models.helpers:[METRICS-TRACE] After dedup: 1 total select_exprs
2025-12-18 14:27:03,843:INFO:superset.models.helpers:[COLUMN_TRACE] SQL Query Building:
2025-12-18 14:27:03,842:INFO:superset.db_engine_specs.dhis2_dialect:Executing DHIS2 query: SELECT
  "Period"
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "Period"
ORDER BY
  "Period" ASC
LIMIT 1000
2025-12-18 14:27:03,841:ERROR:superset.models.helpers:[METRICS-TRACE] Before dedup: 1 select_exprs + 0 metrics_exprs
2025-12-18 14:27:03,843:INFO:superset.models.helpers:[COLUMN_TRACE]   columns: ['Region']
2025-12-18 14:27:03,844:INFO:superset.models.helpers:[COLUMN_TRACE]   metrics: []
2025-12-18 14:27:03,843:INFO:superset.db_engine_specs.dhis2_dialect:Parsed endpoint: analytics
2025-12-18 14:27:03,844:INFO:superset.db_engine_specs.dhis2_dialect:Using stored parameters from Flask g for table: analytics
2025-12-18 14:27:03,844:INFO:superset.db_engine_specs.dhis2_dialect:Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_5_YEARS;ou:USER_ORGUNIT_CHILDREN;USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
2025-12-18 14:27:03,844:INFO:superset.db_engine_specs.dhis2_dialect:Period dimension detected - omitting startDate/endDate (DHIS2 API rule)
2025-12-18 14:27:03,844:INFO:superset.db_engine_specs.dhis2_dialect:Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_5_YEARS;ou:USER_ORGUNIT_CHILDREN;USER_ORGUNIT'}
2025-12-18 14:27:03,844:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API request (cache miss): https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_5_YEARS&dimension=ou:USER_ORGUNIT_CHILDREN;USER_ORGUNIT
2025-12-18 14:27:03,844:INFO:superset.models.helpers:[COLUMN_TRACE]   groupby: []
2025-12-18 14:27:03,845:INFO:superset.models.helpers:[COLUMN_TRACE]   labels_expected: ['Region']
2025-12-18 14:27:03,847:INFO:superset.models.helpers:[COLUMN_TRACE]   select_exprs count: 1
2025-12-18 14:27:03,847:INFO:superset.models.helpers:[COLUMN_TRACE]     [0] key=Region, name=Region, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-18 14:27:03,843:ERROR:superset.models.helpers:[METRICS-TRACE] After dedup: 1 total select_exprs
2025-12-18 14:27:03,847:INFO:superset.models.helpers:[COLUMN_TRACE] SQL Query Building:
2025-12-18 14:27:03,847:INFO:superset.models.helpers:[COLUMN_TRACE]   columns: ['District']
2025-12-18 14:27:03,847:INFO:superset.models.helpers:[COLUMN_TRACE]   metrics: []
2025-12-18 14:27:03,847:INFO:superset.models.helpers:[COLUMN_TRACE]   groupby: []
2025-12-18 14:27:03,847:INFO:superset.models.helpers:[COLUMN_TRACE]   labels_expected: ['District']
2025-12-18 14:27:03,847:INFO:superset.connectors.sqla.models:[DHIS2] get_from_clause for virtual dataset 1: analytics_LAST_YEAR_20251210
2025-12-18 14:27:03,848:INFO:superset.connectors.sqla.models:[DHIS2] Full SQL stored: SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_5_YEARS;ou:USER_ORGUNIT_CHILDREN;USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
2025-12-18 14:27:03,848:INFO:superset.connectors.sqla.models:[DHIS2] Loaded params from extra field: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_5_YEARS;ou:USER_ORGUNIT_CHILDREN;USER_ORGUNIT&displayProperty=NAM
2025-12-18 14:27:03,847:INFO:superset.models.helpers:[COLUMN_TRACE]   select_exprs count: 1
2025-12-18 14:27:03,850:INFO:superset.models.helpers:[COLUMN_TRACE]     [0] key=District, name=District, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-18 14:27:03,851:INFO:superset.connectors.sqla.models:[DHIS2] get_from_clause for virtual dataset 1: analytics_LAST_YEAR_20251210
2025-12-18 14:27:03,851:INFO:superset.connectors.sqla.models:[DHIS2] Cached params with key: dhis2_params_1_analytics
2025-12-18 14:27:03,851:INFO:superset.connectors.sqla.models:[DHIS2] Full SQL stored: SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_5_YEARS;ou:USER_ORGUNIT_CHILDREN;USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
2025-12-18 14:27:03,852:INFO:superset.connectors.sqla.models:[DHIS2] Loaded params from extra field: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_5_YEARS;ou:USER_ORGUNIT_CHILDREN;USER_ORGUNIT&displayProperty=NAM
2025-12-18 14:27:03,852:INFO:superset.connectors.sqla.models:[DHIS2] Stored params in Flask g for DHIS2 table: analytics
2025-12-18 14:27:03,855:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Query execution in connectors/sqla/models.py:
2025-12-18 14:27:03,856:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   SQL (first 500 chars): SELECT "Region" 
FROM (SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_5_YEARS;ou:USER_ORGUNIT_CHILDREN;USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
) AS virtual_table GROUP BY "Region" ORDER BY "Region" ASC
 LIMIT 1000
2025-12-18 14:27:03,856:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   labels_expected: ['Region']
2025-12-18 14:27:03,858:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:27:03] "[35m[1mPOST /api/v1/dashboard/1/filter_state?tab_id=2 HTTP/1.1[0m" 201 -
2025-12-18 14:27:03,859:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 connection initialized: https://tests.dhis2.hispuganda.org/hmis/api
2025-12-18 14:27:03,859:INFO:superset.connectors.sqla.models:[DHIS2] Cached params with key: dhis2_params_1_analytics
2025-12-18 14:27:03,860:INFO:superset.connectors.sqla.models:[DHIS2] Stored params in Flask g for DHIS2 table: analytics
2025-12-18 14:27:03,860:INFO:superset.db_engine_specs.dhis2_dialect:Executing DHIS2 query: SELECT
  "Region"
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "Region"
ORDER BY
  "Region" ASC
LIMIT 1000
2025-12-18 14:27:03,865:INFO:superset.db_engine_specs.dhis2_dialect:Parsed endpoint: analytics
2025-12-18 14:27:03,865:INFO:superset.db_engine_specs.dhis2_dialect:Using stored parameters from Flask g for table: analytics
2025-12-18 14:27:03,865:INFO:superset.db_engine_specs.dhis2_dialect:Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_5_YEARS;ou:USER_ORGUNIT_CHILDREN;USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
2025-12-18 14:27:03,865:INFO:superset.db_engine_specs.dhis2_dialect:Period dimension detected - omitting startDate/endDate (DHIS2 API rule)
2025-12-18 14:27:03,865:INFO:superset.db_engine_specs.dhis2_dialect:Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_5_YEARS;ou:USER_ORGUNIT_CHILDREN;USER_ORGUNIT'}
2025-12-18 14:27:03,865:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API request (cache miss): https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_5_YEARS&dimension=ou:USER_ORGUNIT_CHILDREN;USER_ORGUNIT
2025-12-18 14:27:03,864:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Query execution in connectors/sqla/models.py:
2025-12-18 14:27:03,865:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   SQL (first 500 chars): SELECT "District" 
FROM (SELECT * FROM analytics
/* DHIS2: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_5_YEARS;ou:USER_ORGUNIT_CHILDREN;USER_ORGUNIT&displayProperty=NAME&skipMeta=false */
) AS virtual_table GROUP BY "District" ORDER BY "District" ASC
 LIMIT 1000
2025-12-18 14:27:03,865:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   labels_expected: ['District']
2025-12-18 14:27:03,869:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 connection initialized: https://tests.dhis2.hispuganda.org/hmis/api
2025-12-18 14:27:03,870:INFO:superset.db_engine_specs.dhis2_dialect:Executing DHIS2 query: SELECT
  "District"
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "District"
ORDER BY
  "District" ASC
LIMIT 1000
2025-12-18 14:27:03,871:INFO:superset.db_engine_specs.dhis2_dialect:Parsed endpoint: analytics
2025-12-18 14:27:03,871:INFO:superset.db_engine_specs.dhis2_dialect:Using stored parameters from Flask g for table: analytics
2025-12-18 14:27:03,871:INFO:superset.db_engine_specs.dhis2_dialect:Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_5_YEARS;ou:USER_ORGUNIT_CHILDREN;USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
2025-12-18 14:27:03,871:INFO:superset.db_engine_specs.dhis2_dialect:Period dimension detected - omitting startDate/endDate (DHIS2 API rule)
2025-12-18 14:27:03,871:INFO:superset.db_engine_specs.dhis2_dialect:Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_5_YEARS;ou:USER_ORGUNIT_CHILDREN;USER_ORGUNIT'}
2025-12-18 14:27:03,872:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API request (cache miss): https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_5_YEARS&dimension=ou:USER_ORGUNIT_CHILDREN;USER_ORGUNIT
2025-12-18 14:27:04,664:INFO:superset.db_engine_specs.dhis2_cache:[DHIS2 Cache] SET: analytics (ttl=3600s, key=dhis2:4a1c3321:analytics:a1595eab6fc2...)
2025-12-18 14:27:04,664:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2 Cache] Stored response for analytics
2025-12-18 14:27:04,664:INFO:superset.db_engine_specs.dhis2_dialect:Using wide/pivoted format for analytics
2025-12-18 14:27:04,796:INFO:superset.db_engine_specs.dhis2_cache:[DHIS2 Cache] SET: analytics (ttl=3600s, key=dhis2:4a1c3321:analytics:a1595eab6fc2...)
2025-12-18 14:27:04,796:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2 Cache] Stored response for analytics

[DHIS2] _set_description: original=['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], sanitized=['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], types=['String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String']
[DHIS2] Transformed rows count: 4437
[DHIS2] First transformed row: ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
[DHIS2] Fetched 4437 rows
[DHIS2] fetchall() called - returning 4437 rows
[DHIS2] fetchall() - First row type: <class 'tuple'>
[DHIS2] fetchall() - First row (original): ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
[DHIS2] fetchall() - Column count from description: 14
[DHIS2] fetchall() - First row (fixed types): ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
[DHIS2] fetchall() - Type enforcement: dimensions=STRING, measures=FLOAT
[DHIS2] Executing query: SELECT
  "Region",
  SUM("105_EP01b_Malaria_Total") AS sum_1,
  SUM("105_EP01a_Suspected_fever") AS sum_2
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "Region"
ORDER BY
  SUM("105_EP01b_Malaria_Total") DESC
LIMIT 10000
[DHIS2] Parsed endpoint: analytics
[DHIS2] Found params in Flask g for analytics: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_5_YEARS;ou:USER
[DHIS2] Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_5_YEARS;ou:USER_ORGUNIT_CHILDREN;USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
[DHIS2] Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_5_YEARS;ou:USER_ORGUNIT_CHILDREN;USER_ORGUNIT'}
[DHIS2] ðŸ”„ CACHE MISS - API request URL: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_5_YEARS&dimension=ou:USER_ORGUNIT_CHILDREN;USER_ORGUNIT
[DHIS2] Executing query: SELECT
  "Period"
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "Period"
ORDER BY
  "Period" ASC
LIMIT 1000
[DHIS2] Parsed endpoint: analytics
[DHIS2] Found params in Flask g for analytics: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_5_YEARS;ou:USER
[DHIS2] Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_5_YEARS;ou:USER_ORGUNIT_CHILDREN;USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
[DHIS2] Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_5_YEARS;ou:USER_ORGUNIT_CHILDREN;USER_ORGUNIT'}
[DHIS2] ðŸ”„ CACHE MISS - API request URL: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_5_YEARS&dimension=ou:USER_ORGUNIT_CHILDREN;USER_ORGUNIT
[DHIS2] Executing query: SELECT
  "Region"
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "Region"
ORDER BY
  "Region" ASC
LIMIT 1000
[DHIS2] Parsed endpoint: analytics
[DHIS2] Found params in Flask g for analytics: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_5_YEARS;ou:USER
[DHIS2] Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_5_YEARS;ou:USER_ORGUNIT_CHILDREN;USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
[DHIS2] Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_5_YEARS;ou:USER_ORGUNIT_CHILDREN;USER_ORGUNIT'}
[DHIS2] ðŸ”„ CACHE MISS - API request URL: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_5_YEARS&dimension=ou:USER_ORGUNIT_CHILDREN;USER_ORGUNIT
[DHIS2] Executing query: SELECT
  "District"
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "District"
ORDER BY
  "District" ASC
LIMIT 1000
[DHIS2] Parsed endpoint: analytics
[DHIS2] Found params in Flask g for analytics: table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_5_YEARS;ou:USER
[DHIS2] Query params: {'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_5_YEARS;ou:USER_ORGUNIT_CHILDREN;USER_ORGUNIT', 'displayProperty': 'NAME', 'skipMeta': 'false'}
[DHIS2] Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dimension': 'dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;pe:LAST_5_YEARS;ou:USER_ORGUNIT_CHILDREN;USER_ORGUNIT'}
[DHIS2] ðŸ”„ CACHE MISS - API request URL: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv&dimension=pe:LAST_5_YEARS&dimension=ou:USER_ORGUNIT_CHILDREN;USER_ORGUNIT
[DHIS2] Raw API response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Raw DHIS2 rows count: 256
[DHIS2] First raw row: ['wUDxFVBapIc', '2022', 'Dl9WvtvDs5V', '1171752']
[DHIS2] âœ… Cached response for analytics (API took 936.9ms)
[DHIS2] Parsing response for endpoint: analytics
[DHIS2] Response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Response sample: {'headers': [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}], 'metaDat
[DHIS2] Using WIDE/PIVOTED format (Period, Level_1_Name, Level_2_Name, ..., DX1, DX2, ...) for analytics
[DHIS2] Raw API response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Raw DHIS2 rows count: 256
[DHIS2] First raw row: ['wUDxFVBapIc', '2022', 'Dl9WvtvDs5V', '1171752']
[DHIS2] âœ… Cached response for analytics (API took 943.2ms)
[DHIS2] Parsing response for endpoint: analytics
[DHIS2] Response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Response sample: {'headers': [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}], 'metaDat
[DHIS2] Using WIDE/PIVOTED format (Period, Level_1_Name, Level_2_Name, ..., DX1, DX2, ...) for analytics2025-12-18 14:27:04,796:INFO:superset.db_engine_specs.dhis2_dialect:Using wide/pivoted format for analytics
2025-12-18 14:27:04,812:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:27:04] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 14:27:04,826:INFO:superset.db_engine_specs.dhis2_cache:[DHIS2 Cache] SET: analytics (ttl=3600s, key=dhis2:4a1c3321:analytics:a1595eab6fc2...)
2025-12-18 14:27:04,826:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2 Cache] Stored response for analytics
2025-12-18 14:27:04,826:INFO:superset.db_engine_specs.dhis2_dialect:Using wide/pivoted format for analytics
2025-12-18 14:27:04,868:INFO:superset.db_engine_specs.dhis2_cache:[DHIS2 Cache] SET: analytics (ttl=3600s, key=dhis2:4a1c3321:analytics:a1595eab6fc2...)
2025-12-18 14:27:04,868:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2 Cache] Stored response for analytics
2025-12-18 14:27:04,868:INFO:superset.db_engine_specs.dhis2_dialect:Using wide/pivoted format for analytics
2025-12-18 14:27:05,505:INFO:superset.db_engine_specs.dhis2_dialect:Fetched org unit levels: {3: 'District', 5: 'Health Facility', 1: 'National', 2: 'Region', 4: 'Sub County/Town Council/Div'}
2025-12-18 14:27:05,505:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] _fetch_org_unit_hierarchy: Fetching 16 unique org units in batches...
2025-12-18 14:27:05,625:INFO:superset.db_engine_specs.dhis2_dialect:Fetched org unit levels: {3: 'District', 5: 'Health Facility', 1: 'National', 2: 'Region', 4: 'Sub County/Town Council/Div'}
2025-12-18 14:27:05,626:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] _fetch_org_unit_hierarchy: Fetching 16 unique org units in batches...
2025-12-18 14:27:05,644:INFO:superset.db_engine_specs.dhis2_dialect:Fetched org unit levels: {3: 'District', 5: 'Health Facility', 1: 'National', 2: 'Region', 4: 'Sub County/Town Council/Div'}
2025-12-18 14:27:05,645:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] _fetch_org_unit_hierarchy: Fetching 16 unique org units in batches...
2025-12-18 14:27:05,974:INFO:superset.db_engine_specs.dhis2_dialect:Fetched org unit levels: {3: 'District', 5: 'Health Facility', 1: 'National', 2: 'Region', 4: 'Sub County/Town Council/Div'}
2025-12-18 14:27:05,974:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] _fetch_org_unit_hierarchy: Fetching 16 unique org units in batches...
2025-12-18 14:27:06,466:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Fetched 16 org units, found 1 parent IDs
2025-12-18 14:27:06,468:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total org unit names available: 16
2025-12-18 14:27:06,468:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Sample hierarchy for Dl9WvtvDs5V: {'level_1': 'MOH - Uganda', 'level_2': 'North Buganda', 'level_3': None, 'level_4': None, 'level_5': None, 'level_6': None}
2025-12-18 14:27:06,470:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] _fetch_org_unit_hierarchy completed: 16 org units with hierarchy
2025-12-18 14:27:06,470:INFO:superset.db_engine_specs.dhis2_dialect:normalize_analytics called with pivot=True, returning WIDE format
2025-12-18 14:27:06,471:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column construction - data_elements: ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
2025-12-18 14:27:06,472:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column names constructed (SANITIZED): ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:27:06,472:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] FIRST ROW CONSTRUCTION:
2025-12-18 14:27:06,472:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   Period (index 0): 2020
2025-12-18 14:27:06,472:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01b. Malaria Total (index 6): 2383427
2025-12-18 14:27:06,472:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01a. Suspected fever (index 7): 3351448
2025-12-18 14:27:06,472:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01d. Malaria cases treated (index 8): 4147148
2025-12-18 14:27:06,472:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01c. Malaria Confirmed (B/s and RDT Positive) (index 9): 2227465
2025-12-18 14:27:06,473:INFO:superset.db_engine_specs.dhis2_dialect:First pivoted row - Period: '2020'
2025-12-18 14:27:06,473:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total pivoted rows: 64, columns: 10

[DHIS2] Raw API response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Raw DHIS2 rows count: 256
[DHIS2] First raw row: ['wUDxFVBapIc', '2022', 'Dl9WvtvDs5V', '1171752']
[DHIS2] âœ… Cached response for analytics (API took 954.1ms)
[DHIS2] Parsing response for endpoint: analytics
[DHIS2] Response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Response sample: {'headers': [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}], 'metaDat
[DHIS2] Using WIDE/PIVOTED format (Period, Level_1_Name, Level_2_Name, ..., DX1, DX2, ...) for analytics
[DHIS2] Raw API response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Raw DHIS2 rows count: 256
[DHIS2] First raw row: ['wUDxFVBapIc', '2022', 'Dl9WvtvDs5V', '1171752']
[DHIS2] âœ… Cached response for analytics (API took 1002.3ms)
[DHIS2] Parsing response for endpoint: analytics
[DHIS2] Response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Response sample: {'headers': [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}], 'metaDat
[DHIS2] Using WIDE/PIVOTED format (Period, Level_1_Name, Level_2_Name, ..., DX1, DX2, ...) for analytics
[DHIS2] Analytics headers: [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}]
[DHIS2] Found 'ou' column at index 2
[DHIS2] Processing 256 rows to extract org unit IDs
[DHIS2] Extracted 16 unique org unit IDs from rows
[DHIS2] Found 16 unique org units in analytics response
[DHIS2] Fetching hierarchy for 16 org units...
[DHIS2] _fetch_org_unit_hierarchy: Fetching 16 unique org units
[DHIS2] Analytics headers: [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}]
[DHIS2] Found 'ou' column at index 2
[DHIS2] Processing 256 rows to extract org unit IDs
[DHIS2] Extracted 16 unique org unit IDs from rows
[DHIS2] Found 16 unique org units in analytics response
[DHIS2] Fetching hierarchy for 16 org units...
[DHIS2] _fetch_org_unit_hierarchy: Fetching 16 unique org units
[DHIS2] Analytics headers: [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}]
[DHIS2] Found 'ou' column at index 2
[DHIS2] Processing 256 rows to extract org unit IDs
[DHIS2] Extracted 16 unique org unit IDs from rows
[DHIS2] Found 16 unique org units in analytics response
[DHIS2] Fetching hierarchy for 16 org units...
[DHIS2] _fetch_org_unit_hierarchy: Fetching 16 unique org units
[DHIS2] Analytics headers: [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}]
[DHIS2] Found 'ou' column at index 2
[DHIS2] Processing 256 rows to extract org unit IDs
[DHIS2] Extracted 16 unique org unit IDs from rows
[DHIS2] Found 16 unique org units in analytics response
[DHIS2] Fetching hierarchy for 16 org units...
[DHIS2] _fetch_org_unit_hierarchy: Fetching 16 unique org units
[DHIS2] Batch 1: Got 16 org units from DHIS2
[DHIS2]   OU: SUvODYOcaVf, name=Acholi, level=2, parent=akV6429SUqu
[DHIS2]   OU: F1o6qBSx783, name=Ankole, level=2, parent=akV6429SUqu
[DHIS2]   OU: Dt6qdenPX1E, name=Bugisu, level=2, parent=akV6429SUqu
[DHIS2] Total org unit names available: 16 after 1 iterations
[DHIS2] Sample hierarchy for Dl9WvtvDs5V: {'level_1': 'MOH - Uganda', 'level_2': 'North Buganda', 'level_3': None, 'level_4': None, 'level_5': None, 'level_6': None}
[DHIS2]   Dl9WvtvDs5V: filled levels = ['level_1', 'level_2']
[DHIS2]   QBPg7KKCeoA: filled levels = ['level_1', 'level_2']
[DHIS2]   F1o6qBSx783: filled levels = ['level_1', 'level_2']
[DHIS2] Fetched hierarchy for 16 org units
[DHIS2] Sample hierarchy for Dl9WvtvDs5V: {'level_1': 'MOH - Uganda', 'level_2': 'North Buganda', 'level_3': None, 'level_4': None, 'level_5': None, 'level_6': None}
[DHIS2] Calling DHIS2ResponseNormalizer.normalize with:
[DHIS2]   - endpoint: analytics
[DHIS2]   - pivot: True
[DHIS2]   - org_unit_hierarchy: 16 entries
[DHIS2]   - org_unit_level_names: {3: 'District', 5: 'Health Facility', 1: 'National', 2: 'Region', 4: 'Sub County/Town Council/Div'}
[DHIS2] normalize_analytics: pivot=True, using WIDE/PIVOTED format
[DHIS2] PIVOT CONSTRUCTION:
[DHIS2]   data_elements (UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   data_element_list (sorted UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   col_names (SANITIZED): ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Row 0: OU=BD3XaQ7cQAp, hierarchy_info={'level_1': 'MOH - Uganda', 'level_2': 'West Nile', 'level_3': None, 'level_4': None, 'level_5': None, 'level_6': None}
[DHIS2] Row 1: OU=DWPnYhoqza0, hierarchy_info={'level_1': 'MOH - Uganda', 'level_2': 'Lango', 'level_3': None, 'level_4': None, 'level_5': None, 'level_6': None}
[DHIS2] Row 2: OU=Dl9WvtvDs5V, hierarchy_info={'level_1': 'MOH - Uganda', 'level_2': 'North Buganda', 'level_3': None, 'level_4': None, 'level_5': None, 'level_6': None}
[DHIS2] Normalized columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized row count: 64
[DHIS2] First row: ('2020', 'MOH - Uganda', 'West Nile', None, None, None, 2383427, 3351448, 4147148, 2227465)
[DHIS2] _set_description: original=['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], sanitized=['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], types=['String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String']2025-12-18 14:27:06,473:INFO:superset.db_engine_specs.dhis2_dialect:Normalized 64 rows with 10 columns for endpoint analytics
2025-12-18 14:27:06,474:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API returned 64 rows
2025-12-18 14:27:06,490:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Fetched 16 org units, found 1 parent IDs
2025-12-18 14:27:06,490:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total org unit names available: 16
2025-12-18 14:27:06,490:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Sample hierarchy for Dl9WvtvDs5V: {'level_1': 'MOH - Uganda', 'level_2': 'North Buganda', 'level_3': None, 'level_4': None, 'level_5': None, 'level_6': None}
2025-12-18 14:27:06,490:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] _fetch_org_unit_hierarchy completed: 16 org units with hierarchy
2025-12-18 14:27:06,495:INFO:superset.db_engine_specs.dhis2_dialect:normalize_analytics called with pivot=True, returning WIDE format
2025-12-18 14:27:06,495:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column construction - data_elements: ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
2025-12-18 14:27:06,495:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column names constructed (SANITIZED): ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:27:06,495:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] FIRST ROW CONSTRUCTION:
2025-12-18 14:27:06,495:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   Period (index 0): 2020
2025-12-18 14:27:06,496:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01b. Malaria Total (index 6): 2383427
2025-12-18 14:27:06,496:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01a. Suspected fever (index 7): 3351448
2025-12-18 14:27:06,496:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01d. Malaria cases treated (index 8): 4147148
2025-12-18 14:27:06,496:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01c. Malaria Confirmed (B/s and RDT Positive) (index 9): 2227465
2025-12-18 14:27:06,496:INFO:superset.db_engine_specs.dhis2_dialect:First pivoted row - Period: '2020'
2025-12-18 14:27:06,496:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total pivoted rows: 64, columns: 10
2025-12-18 14:27:06,496:INFO:superset.db_engine_specs.dhis2_dialect:Normalized 64 rows with 10 columns for endpoint analytics
2025-12-18 14:27:06,496:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API returned 64 rows
2025-12-18 14:27:06,514:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() - Row count: 64
2025-12-18 14:27:06,514:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:27:06,514:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names length: 10
2025-12-18 14:27:06,514:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values count: 10
2025-12-18 14:27:06,514:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values: ('2020', 'MOH - Uganda', 'West Nile', None, None, None, 2383427, 3351448, 4147148, 2227465)
2025-12-18 14:27:06,514:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 0 (Period): 2020 -> 2020 (STRING)
2025-12-18 14:27:06,514:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Fetched 16 org units, found 1 parent IDs
2025-12-18 14:27:06,515:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total org unit names available: 16
2025-12-18 14:27:06,514:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (National): 'MOH - Uganda...' -> STRING (non-numeric detected)
2025-12-18 14:27:06,515:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Sample hierarchy for Dl9WvtvDs5V: {'level_1': 'MOH - Uganda', 'level_2': 'North Buganda', 'level_3': None, 'level_4': None, 'level_5': None, 'level_6': None}
2025-12-18 14:27:06,515:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] _fetch_org_unit_hierarchy completed: 16 org units with hierarchy
2025-12-18 14:27:06,515:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (National): MOH - Uganda (PROCESSED)
2025-12-18 14:27:06,515:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (Region): 'West Nile...' -> STRING (non-numeric detected)
2025-12-18 14:27:06,515:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (Region): West Nile (PROCESSED)
2025-12-18 14:27:06,515:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (District): None (PROCESSED)
2025-12-18 14:27:06,515:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (Sub_County_Town_Council_Div): None (PROCESSED)
2025-12-18 14:27:06,515:INFO:superset.db_engine_specs.dhis2_dialect:normalize_analytics called with pivot=True, returning WIDE format
2025-12-18 14:27:06,515:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() returning 64 rows with 10 columns each
2025-12-18 14:27:06,516:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column construction - data_elements: ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
2025-12-18 14:27:06,517:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Got 64 rows from cursor
2025-12-18 14:27:06,518:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column names constructed (SANITIZED): ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:27:06,518:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: First row: ('2020', 'MOH - Uganda', 'West Nile', None, None, None, 2383427, 3351448, 4147148, 2227465)
2025-12-18 14:27:06,518:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] FIRST ROW CONSTRUCTION:
2025-12-18 14:27:06,518:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:27:06,518:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   Period (index 0): 2020
2025-12-18 14:27:06,519:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Types from cursor: ['String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String']
2025-12-18 14:27:06,519:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01b. Malaria Total (index 6): 2383427
2025-12-18 14:27:06,525:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01a. Suspected fever (index 7): 3351448
2025-12-18 14:27:06,525:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01d. Malaria cases treated (index 8): 4147148
2025-12-18 14:27:06,532:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01c. Malaria Confirmed (B/s and RDT Positive) (index 9): 2227465
2025-12-18 14:27:06,533:INFO:superset.db_engine_specs.dhis2_dialect:First pivoted row - Period: '2020'
2025-12-18 14:27:06,542:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total pivoted rows: 64, columns: 10
2025-12-18 14:27:06,542:INFO:superset.db_engine_specs.dhis2_dialect:Normalized 64 rows with 10 columns for endpoint analytics
2025-12-18 14:27:06,542:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API returned 64 rows
2025-12-18 14:27:06,556:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() - Row count: 64
2025-12-18 14:27:06,557:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:27:06,557:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names length: 10
2025-12-18 14:27:06,557:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values count: 10
2025-12-18 14:27:06,557:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values: ('2020', 'MOH - Uganda', 'West Nile', None, None, None, 2383427, 3351448, 4147148, 2227465)
2025-12-18 14:27:06,557:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 0 (Period): 2020 -> 2020 (STRING)
2025-12-18 14:27:06,557:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (National): 'MOH - Uganda...' -> STRING (non-numeric detected)
2025-12-18 14:27:06,557:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (National): MOH - Uganda (PROCESSED)
2025-12-18 14:27:06,557:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (Region): 'West Nile...' -> STRING (non-numeric detected)
2025-12-18 14:27:06,557:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (Region): West Nile (PROCESSED)
2025-12-18 14:27:06,557:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (District): None (PROCESSED)
2025-12-18 14:27:06,557:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (Sub_County_Town_Council_Div): None (PROCESSED)
2025-12-18 14:27:06,559:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() returning 64 rows with 10 columns each
2025-12-18 14:27:06,560:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Got 64 rows from cursor
2025-12-18 14:27:06,560:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: First row: ('2020', 'MOH - Uganda', 'West Nile', None, None, None, 2383427, 3351448, 4147148, 2227465)
2025-12-18 14:27:06,566:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: DataFrame created with 64 rows, 10 columns
2025-12-18 14:27:06,566:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:27:06,568:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:27:06,568:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() - Row count: 64

[DHIS2] Transformed rows count: 64
[DHIS2] First transformed row: ('2020', 'MOH - Uganda', 'West Nile', None, None, None, 2383427, 3351448, 4147148, 2227465)
[DHIS2] Fetched 64 rows
[DHIS2] Batch 1: Got 16 org units from DHIS2
[DHIS2]   OU: SUvODYOcaVf, name=Acholi, level=2, parent=akV6429SUqu
[DHIS2]   OU: F1o6qBSx783, name=Ankole, level=2, parent=akV6429SUqu
[DHIS2]   OU: Dt6qdenPX1E, name=Bugisu, level=2, parent=akV6429SUqu
[DHIS2] Total org unit names available: 16 after 1 iterations
[DHIS2] Sample hierarchy for Dl9WvtvDs5V: {'level_1': 'MOH - Uganda', 'level_2': 'North Buganda', 'level_3': None, 'level_4': None, 'level_5': None, 'level_6': None}
[DHIS2]   Dl9WvtvDs5V: filled levels = ['level_1', 'level_2']
[DHIS2]   QBPg7KKCeoA: filled levels = ['level_1', 'level_2']
[DHIS2]   F1o6qBSx783: filled levels = ['level_1', 'level_2']
[DHIS2] Fetched hierarchy for 16 org units
[DHIS2] Sample hierarchy for Dl9WvtvDs5V: {'level_1': 'MOH - Uganda', 'level_2': 'North Buganda', 'level_3': None, 'level_4': None, 'level_5': None, 'level_6': None}
[DHIS2] Calling DHIS2ResponseNormalizer.normalize with:
[DHIS2]   - endpoint: analytics
[DHIS2]   - pivot: True
[DHIS2]   - org_unit_hierarchy: 16 entries
[DHIS2]   - org_unit_level_names: {3: 'District', 5: 'Health Facility', 1: 'National', 2: 'Region', 4: 'Sub County/Town Council/Div'}
[DHIS2] normalize_analytics: pivot=True, using WIDE/PIVOTED format
[DHIS2] PIVOT CONSTRUCTION:
[DHIS2]   data_elements (UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   data_element_list (sorted UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   col_names (SANITIZED): ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Row 0: OU=BD3XaQ7cQAp, hierarchy_info={'level_1': 'MOH - Uganda', 'level_2': 'West Nile', 'level_3': None, 'level_4': None, 'level_5': None, 'level_6': None}
[DHIS2] Row 1: OU=DWPnYhoqza0, hierarchy_info={'level_1': 'MOH - Uganda', 'level_2': 'Lango', 'level_3': None, 'level_4': None, 'level_5': None, 'level_6': None}
[DHIS2] Row 2: OU=Dl9WvtvDs5V, hierarchy_info={'level_1': 'MOH - Uganda', 'level_2': 'North Buganda', 'level_3': None, 'level_4': None, 'level_5': None, 'level_6': None}
[DHIS2] Normalized columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized row count: 64
[DHIS2] First row: ('2020', 'MOH - Uganda', 'West Nile', None, None, None, 2383427, 3351448, 4147148, 2227465)
[DHIS2] _set_description: original=['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], sanitized=['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], types=['String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String']
[DHIS2] Transformed rows count: 64
[DHIS2] First transformed row: ('2020', 'MOH - Uganda', 'West Nile', None, None, None, 2383427, 3351448, 4147148, 2227465)
[DHIS2] Fetched 64 rows
[DHIS2] fetchall() called - returning 64 rows
[DHIS2] fetchall() - First row type: <class 'tuple'>
[DHIS2] fetchall() - First row (original): ('2020', 'MOH - Uganda', 'West Nile', None, None, None, 2383427, 3351448, 4147148, 2227465)
[DHIS2] fetchall() - Column count from description: 10
[DHIS2] Batch 1: Got 16 org units from DHIS2
[DHIS2]   OU: SUvODYOcaVf, name=Acholi, level=2, parent=akV6429SUqu
[DHIS2]   OU: F1o6qBSx783, name=Ankole, level=2, parent=akV6429SUqu
[DHIS2]   OU: Dt6qdenPX1E, name=Bugisu, level=2, parent=akV6429SUqu
[DHIS2] Total org unit names available: 16 after 1 iterations
[DHIS2] Sample hierarchy for Dl9WvtvDs5V: {'level_1': 'MOH - Uganda', 'level_2': 'North Buganda', 'level_3': None, 'level_4': None, 'level_5': None, 'level_6': None}
[DHIS2]   Dl9WvtvDs5V: filled levels = ['level_1', 'level_2']
[DHIS2]   QBPg7KKCeoA: filled levels = ['level_1', 'level_2']
[DHIS2]   F1o6qBSx783: filled levels = ['level_1', 'level_2']
[DHIS2] Fetched hierarchy for 16 org units
[DHIS2] Sample hierarchy for Dl9WvtvDs5V: {'level_1': 'MOH - Uganda', 'level_2': 'North Buganda', 'level_3': None, 'level_4': None, 'level_5': None, 'level_6': None}
[DHIS2] Calling DHIS2ResponseNormalizer.normalize with:
[DHIS2]   - endpoint: analytics
[DHIS2]   - pivot: True
[DHIS2]   - org_unit_hierarchy: 16 entries
[DHIS2]   - org_unit_level_names: {3: 'District', 5: 'Health Facility', 1: 'National', 2: 'Region', 4: 'Sub County/Town Council/Div'}
[DHIS2] normalize_analytics: pivot=True, using WIDE/PIVOTED format
[DHIS2] fetchall() - First row (fixed types): ('2020', 'MOH - Uganda', 'West Nile', None, None, None, 2383427, 3351448, 4147148, 2227465)
[DHIS2] fetchall() - Type enforcement: dimensions=STRING, measures=FLOAT
[DHIS2] PIVOT CONSTRUCTION:
[DHIS2]   data_elements (UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   data_element_list (sorted UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   col_names (SANITIZED): ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Row 0: OU=BD3XaQ7cQAp, hierarchy_info={'level_1': 'MOH - Uganda', 'level_2': 'West Nile', 'level_3': None, 'level_4': None, 'level_5': None, 'level_6': None}
[DHIS2] Row 1: OU=DWPnYhoqza0, hierarchy_info={'level_1': 'MOH - Uganda', 'level_2': 'Lango', 'level_3': None, 'level_4': None, 'level_5': None, 'level_6': None}
[DHIS2] Row 2: OU=Dl9WvtvDs5V, hierarchy_info={'level_1': 'MOH - Uganda', 'level_2': 'North Buganda', 'level_3': None, 'level_4': None, 'level_5': None, 'level_6': None}
[DHIS2] Normalized columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized row count: 64
[DHIS2] First row: ('2020', 'MOH - Uganda', 'West Nile', None, None, None, 2383427, 3351448, 4147148, 2227465)
[DHIS2] _set_description: original=['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], sanitized=['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], types=['String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String']
[DHIS2] Transformed rows count: 64
[DHIS2] First transformed row: ('2020', 'MOH - Uganda', 'West Nile', None, None, None, 2383427, 3351448, 4147148, 2227465)
[DHIS2] Fetched 64 rows
[DHIS2] fetchall() called - returning 64 rows
[DHIS2] fetchall() - First row type: <class 'tuple'>
[DHIS2] fetchall() - First row (original): ('2020', 'MOH - Uganda', 'West Nile', None, None, None, 2383427, 3351448, 4147148, 2227465)
[DHIS2] fetchall() - Column count from description: 10
[DHIS2] fetchall() - First row (fixed types): ('2020', 'MOH - Uganda', 'West Nile', None, None, None, 2383427, 3351448, 4147148, 2227465)
[DHIS2] fetchall() - Type enforcement: dimensions=STRING, measures=FLOAT
[DHIS2] fetchall() called - returning 64 rows
[DHIS2] fetchall() - First row type: <class 'tuple'>
[DHIS2] fetchall() - First row (original): ('2020', 'MOH - Uganda', 'West Nile', None, None, None, 2383427, 3351448, 4147148, 2227465)2025-12-18 14:27:06,568:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Types from cursor: ['String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String']
2025-12-18 14:27:06,575:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes BEFORE fix: {'Period': dtype('O'), 'National': dtype('O'), 'Region': dtype('O'), 'District': dtype('O'), 'Sub_County_Town_Council_Div': dtype('O'), 'Health_Facility': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-18 14:27:06,575:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:27:06,584:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names length: 10
2025-12-18 14:27:06,592:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values count: 10
2025-12-18 14:27:06,592:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values: ('2020', 'MOH - Uganda', 'West Nile', None, None, None, 2383427, 3351448, 4147148, 2227465)
2025-12-18 14:27:06,594:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 0 (Period): 2020 -> 2020 (STRING)
2025-12-18 14:27:06,601:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (National): 'MOH - Uganda...' -> STRING (non-numeric detected)
2025-12-18 14:27:06,610:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (National): MOH - Uganda (PROCESSED)
2025-12-18 14:27:06,610:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (Region): 'West Nile...' -> STRING (non-numeric detected)
2025-12-18 14:27:06,610:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (Region): West Nile (PROCESSED)
2025-12-18 14:27:06,611:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (District): None (PROCESSED)
2025-12-18 14:27:06,609:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Period' to object dtype (dimension)
2025-12-18 14:27:06,603:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: DataFrame created with 64 rows, 10 columns
2025-12-18 14:27:06,612:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (Sub_County_Town_Council_Div): None (PROCESSED)
2025-12-18 14:27:06,616:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'National' as dimension (contains non-numeric string: 'MOH - Uganda...')
2025-12-18 14:27:06,616:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:27:06,619:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() returning 64 rows with 10 columns each
2025-12-18 14:27:06,622:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Got 64 rows from cursor
2025-12-18 14:27:06,622:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: First row: ('2020', 'MOH - Uganda', 'West Nile', None, None, None, 2383427, 3351448, 4147148, 2227465)
2025-12-18 14:27:06,622:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:27:06,622:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Types from cursor: ['String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String']
2025-12-18 14:27:06,621:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes BEFORE fix: {'Period': dtype('O'), 'National': dtype('O'), 'Region': dtype('O'), 'District': dtype('O'), 'Sub_County_Town_Council_Div': dtype('O'), 'Health_Facility': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-18 14:27:06,627:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Period' to object dtype (dimension)
2025-12-18 14:27:06,620:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'National' to object dtype (dimension)
2025-12-18 14:27:06,628:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'Region' as dimension (contains non-numeric string: 'West Nile...')
2025-12-18 14:27:06,627:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'National' as dimension (contains non-numeric string: 'MOH - Uganda...')
2025-12-18 14:27:06,628:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Region' to object dtype (dimension)
2025-12-18 14:27:06,629:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes AFTER fix: {'Period': dtype('O'), 'National': dtype('O'), 'Region': dtype('O'), 'District': dtype('O'), 'Sub_County_Town_Council_Div': dtype('O'), 'Health_Facility': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-18 14:27:06,628:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: DataFrame created with 64 rows, 10 columns
2025-12-18 14:27:06,629:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:27:06,629:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes BEFORE fix: {'Period': dtype('O'), 'National': dtype('O'), 'Region': dtype('O'), 'District': dtype('O'), 'Sub_County_Town_Council_Div': dtype('O'), 'Health_Facility': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-18 14:27:06,629:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Period' to object dtype (dimension)
2025-12-18 14:27:06,630:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'National' as dimension (contains non-numeric string: 'MOH - Uganda...')
2025-12-18 14:27:06,629:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: First row: {'Period': '2020', 'National': 'MOH - Uganda', 'Region': 'West Nile', 'District': None, 'Sub_County_Town_Council_Div': None, 'Health_Facility': None, '105_EP01b_Malaria_Total': 2383427, '105_EP01a_Suspected_fever': 3351448, '105_EP01d_Malaria_cases_treated': 4147148, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 2227465}
2025-12-18 14:27:06,630:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'National' to object dtype (dimension)
2025-12-18 14:27:06,629:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'National' to object dtype (dimension)
2025-12-18 14:27:06,634:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'Region' as dimension (contains non-numeric string: 'West Nile...')
2025-12-18 14:27:06,636:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Region' to object dtype (dimension)
2025-12-18 14:27:06,635:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'Region' as dimension (contains non-numeric string: 'West Nile...')
2025-12-18 14:27:06,638:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Region' to object dtype (dimension)
2025-12-18 14:27:06,637:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes AFTER fix: {'Period': dtype('O'), 'National': dtype('O'), 'Region': dtype('O'), 'District': dtype('O'), 'Sub_County_Town_Council_Div': dtype('O'), 'Health_Facility': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-18 14:27:06,638:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes AFTER fix: {'Period': dtype('O'), 'National': dtype('O'), 'Region': dtype('O'), 'District': dtype('O'), 'Sub_County_Town_Council_Div': dtype('O'), 'Health_Facility': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-18 14:27:06,639:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: First row: {'Period': '2020', 'National': 'MOH - Uganda', 'Region': 'West Nile', 'District': None, 'Sub_County_Town_Council_Div': None, 'Health_Facility': None, '105_EP01b_Malaria_Total': 2383427, '105_EP01a_Suspected_fever': 3351448, '105_EP01d_Malaria_cases_treated': 4147148, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 2227465}
2025-12-18 14:27:06,636:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] BEFORE assign_column_label:
2025-12-18 14:27:06,640:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (64, 10)
2025-12-18 14:27:06,640:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:27:06,640:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['Region', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)']
2025-12-18 14:27:06,640:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: False
2025-12-18 14:27:06,641:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Period': '2020', 'National': 'MOH - Uganda', 'Region': 'West Nile', 'District': None, 'Sub_County_Town_Council_Div': None, 'Health_Facility': None, '105_EP01b_Malaria_Total': 2383427, '105_EP01a_Suspected_fever': 3351448, '105_EP01d_Malaria_cases_treated': 4147148, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 2227465}
2025-12-18 14:27:06,641:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Column truncation needed: df has 10 columns, expected 3
2025-12-18 14:27:06,641:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   DataFrame actual columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:27:06,641:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Expected columns: ['Region', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)']
2025-12-18 14:27:06,641:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] âœ“ Selecting columns BY NAME (matched all expected columns)
2025-12-18 14:27:06,641:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Column mapping: {'Region': 'Region', 'SUM(105_EP01b_Malaria_Total)': '105_EP01b_Malaria_Total', 'SUM(105_EP01a_Suspected_fever)': '105_EP01a_Suspected_fever'}
2025-12-18 14:27:06,639:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: First row: {'Period': '2020', 'National': 'MOH - Uganda', 'Region': 'West Nile', 'District': None, 'Sub_County_Town_Council_Div': None, 'Health_Facility': None, '105_EP01b_Malaria_Total': 2383427, '105_EP01a_Suspected_fever': 3351448, '105_EP01d_Malaria_cases_treated': 4147148, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 2227465}
2025-12-18 14:27:06,644:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] Column Selection âœ“ SUCCESS - method=BY_NAME, datasource=analytics_LAST_YEAR_20251210
2025-12-18 14:27:06,645:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] BEFORE assign_column_label:
2025-12-18 14:27:06,646:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (64, 10)
2025-12-18 14:27:06,646:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:27:06,646:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['Period']
2025-12-18 14:27:06,646:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: False
2025-12-18 14:27:06,645:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Region', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)']
2025-12-18 14:27:06,647:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   tried_by_name=True, success=True, fallback=False
2025-12-18 14:27:06,647:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Assigning column labels: ['Region', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)']
2025-12-18 14:27:06,646:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Period': '2020', 'National': 'MOH - Uganda', 'Region': 'West Nile', 'District': None, 'Sub_County_Town_Council_Div': None, 'Health_Facility': None, '105_EP01b_Malaria_Total': 2383427, '105_EP01a_Suspected_fever': 3351448, '105_EP01d_Malaria_cases_treated': 4147148, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 2227465}
2025-12-18 14:27:06,647:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Column truncation needed: df has 10 columns, expected 1
2025-12-18 14:27:06,647:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   DataFrame actual columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:27:06,647:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Expected columns: ['Period']
2025-12-18 14:27:06,647:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] âœ“ Selecting columns BY NAME (matched all expected columns)
2025-12-18 14:27:06,647:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Column mapping: {'Period': 'Period'}
2025-12-18 14:27:06,647:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] AFTER assign_column_label:
2025-12-18 14:27:06,648:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (64, 3)
2025-12-18 14:27:06,648:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Region', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)']
2025-12-18 14:27:06,648:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['Region', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)']
2025-12-18 14:27:06,648:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: True
2025-12-18 14:27:06,648:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Region': 'West Nile', 'SUM(105_EP01b_Malaria_Total)': 2383427, 'SUM(105_EP01a_Suspected_fever)': 3351448}
2025-12-18 14:27:06,648:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] Column Selection âœ“ SUCCESS - method=BY_NAME, datasource=analytics_LAST_YEAR_20251210
2025-12-18 14:27:06,650:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] DataFrame columns: ['Region', 'SUM(105_EP01b_Malaria_Total)', 'SUM(105_EP01a_Suspected_fever)']
2025-12-18 14:27:06,650:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Aggregates: {'SUM(105_EP01b_Malaria_Total)': {'operator': 'mean'}, 'SUM(105_EP01a_Suspected_fever)': {'operator': 'mean'}}
2025-12-18 14:27:06,650:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105_EP01b_Malaria_Total)', column='SUM(105_EP01b_Malaria_Total)'
2025-12-18 14:27:06,650:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period']
2025-12-18 14:27:06,650:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   tried_by_name=True, success=True, fallback=False
2025-12-18 14:27:06,650:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Assigning column labels: ['Period']
2025-12-18 14:27:06,650:ERROR:superset.utils.pandas_postprocessing.utils:[POSTPROCESSING-DEBUG] Processing aggregate: name='SUM(105_EP01a_Suspected_fever)', column='SUM(105_EP01a_Suspected_fever)'
2025-12-18 14:27:06,650:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] AFTER assign_column_label:
2025-12-18 14:27:06,656:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (64, 1)
2025-12-18 14:27:06,656:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period']
2025-12-18 14:27:06,656:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['Period']
2025-12-18 14:27:06,656:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: True
2025-12-18 14:27:06,656:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Period': '2020'}
2025-12-18 14:27:06,647:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] BEFORE assign_column_label:
2025-12-18 14:27:06,659:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (64, 10)
2025-12-18 14:27:06,659:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:27:06,659:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['District']
2025-12-18 14:27:06,659:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: False
2025-12-18 14:27:06,659:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Period': '2020', 'National': 'MOH - Uganda', 'Region': 'West Nile', 'District': None, 'Sub_County_Town_Council_Div': None, 'Health_Facility': None, '105_EP01b_Malaria_Total': 2383427, '105_EP01a_Suspected_fever': 3351448, '105_EP01d_Malaria_cases_treated': 4147148, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 2227465}
2025-12-18 14:27:06,659:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Column truncation needed: df has 10 columns, expected 1
2025-12-18 14:27:06,659:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   DataFrame actual columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:27:06,659:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Expected columns: ['District']
2025-12-18 14:27:06,659:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] âœ“ Selecting columns BY NAME (matched all expected columns)
2025-12-18 14:27:06,659:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Column mapping: {'District': 'District'}
2025-12-18 14:27:06,659:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] Column Selection âœ“ SUCCESS - method=BY_NAME, datasource=analytics_LAST_YEAR_20251210
2025-12-18 14:27:06,659:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['District']
2025-12-18 14:27:06,659:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   tried_by_name=True, success=True, fallback=False
2025-12-18 14:27:06,659:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Assigning column labels: ['District']
2025-12-18 14:27:06,659:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] AFTER assign_column_label:
2025-12-18 14:27:06,659:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (64, 1)
2025-12-18 14:27:06,659:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['District']
2025-12-18 14:27:06,659:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['District']
2025-12-18 14:27:06,659:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: True
2025-12-18 14:27:06,659:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'District': None}
2025-12-18 14:27:06,696:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:27:06] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-18 14:27:06,705:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:27:06] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-18 14:27:06,713:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:27:06] "POST /api/v1/chart/data?form_data={"slice_id":1}&dashboard_id=1 HTTP/1.1" 200 -
2025-12-18 14:27:06,823:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Fetched 16 org units, found 1 parent IDs
2025-12-18 14:27:06,823:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total org unit names available: 16
2025-12-18 14:27:06,824:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Sample hierarchy for Dl9WvtvDs5V: {'level_1': 'MOH - Uganda', 'level_2': 'North Buganda', 'level_3': None, 'level_4': None, 'level_5': None, 'level_6': None}
2025-12-18 14:27:06,824:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] _fetch_org_unit_hierarchy completed: 16 org units with hierarchy
2025-12-18 14:27:06,824:INFO:superset.db_engine_specs.dhis2_dialect:normalize_analytics called with pivot=True, returning WIDE format
2025-12-18 14:27:06,824:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column construction - data_elements: ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
2025-12-18 14:27:06,824:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column names constructed (SANITIZED): ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:27:06,824:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] FIRST ROW CONSTRUCTION:
2025-12-18 14:27:06,824:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   Period (index 0): 2020
2025-12-18 14:27:06,824:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01b. Malaria Total (index 6): 2383427
2025-12-18 14:27:06,824:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01a. Suspected fever (index 7): 3351448
2025-12-18 14:27:06,824:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01d. Malaria cases treated (index 8): 4147148
2025-12-18 14:27:06,825:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01c. Malaria Confirmed (B/s and RDT Positive) (index 9): 2227465
2025-12-18 14:27:06,825:INFO:superset.db_engine_specs.dhis2_dialect:First pivoted row - Period: '2020'
2025-12-18 14:27:06,825:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total pivoted rows: 64, columns: 10
2025-12-18 14:27:06,826:INFO:superset.db_engine_specs.dhis2_dialect:Normalized 64 rows with 10 columns for endpoint analytics
2025-12-18 14:27:06,826:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API returned 64 rows
2025-12-18 14:27:06,834:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() - Row count: 64
2025-12-18 14:27:06,834:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:27:06,834:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names length: 10
2025-12-18 14:27:06,834:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values count: 10
2025-12-18 14:27:06,835:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values: ('2020', 'MOH - Uganda', 'West Nile', None, None, None, 2383427, 3351448, 4147148, 2227465)
2025-12-18 14:27:06,835:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 0 (Period): 2020 -> 2020 (STRING)
2025-12-18 14:27:06,835:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (National): 'MOH - Uganda...' -> STRING (non-numeric detected)
2025-12-18 14:27:06,835:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (National): MOH - Uganda (PROCESSED)
2025-12-18 14:27:06,835:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (Region): 'West Nile...' -> STRING (non-numeric detected)
2025-12-18 14:27:06,835:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (Region): West Nile (PROCESSED)
2025-12-18 14:27:06,835:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (District): None (PROCESSED)
2025-12-18 14:27:06,835:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (Sub_County_Town_Council_Div): None (PROCESSED)
2025-12-18 14:27:06,835:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() returning 64 rows with 10 columns each
2025-12-18 14:27:06,835:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Got 64 rows from cursor
2025-12-18 14:27:06,835:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: First row: ('2020', 'MOH - Uganda', 'West Nile', None, None, None, 2383427, 3351448, 4147148, 2227465)
2025-12-18 14:27:06,835:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:27:06,835:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Types from cursor: ['String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String']
2025-12-18 14:27:06,837:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: DataFrame created with 64 rows, 10 columns
2025-12-18 14:27:06,837:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:27:06,837:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes BEFORE fix: {'Period': dtype('O'), 'National': dtype('O'), 'Region': dtype('O'), 'District': dtype('O'), 'Sub_County_Town_Council_Div': dtype('O'), 'Health_Facility': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-18 14:27:06,837:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Period' to object dtype (dimension)
2025-12-18 14:27:06,837:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'National' as dimension (contains non-numeric string: 'MOH - Uganda...')
2025-12-18 14:27:06,837:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'National' to object dtype (dimension)
2025-12-18 14:27:06,838:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'Region' as dimension (contains non-numeric string: 'West Nile...')
2025-12-18 14:27:06,838:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Region' to object dtype (dimension)
2025-12-18 14:27:06,838:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes AFTER fix: {'Period': dtype('O'), 'National': dtype('O'), 'Region': dtype('O'), 'District': dtype('O'), 'Sub_County_Town_Council_Div': dtype('O'), 'Health_Facility': dtype('O'), '105_EP01b_Malaria_Total': dtype('int64'), '105_EP01a_Suspected_fever': dtype('int64'), '105_EP01d_Malaria_cases_treated': dtype('int64'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('int64')}
2025-12-18 14:27:06,838:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: First row: {'Period': '2020', 'National': 'MOH - Uganda', 'Region': 'West Nile', 'District': None, 'Sub_County_Town_Council_Div': None, 'Health_Facility': None, '105_EP01b_Malaria_Total': 2383427, '105_EP01a_Suspected_fever': 3351448, '105_EP01d_Malaria_cases_treated': 4147148, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 2227465}
2025-12-18 14:27:06,842:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] BEFORE assign_column_label:
2025-12-18 14:27:06,842:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (64, 10)
2025-12-18 14:27:06,842:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:27:06,842:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['Region']
2025-12-18 14:27:06,842:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: False
2025-12-18 14:27:06,842:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Period': '2020', 'National': 'MOH - Uganda', 'Region': 'West Nile', 'District': None, 'Sub_County_Town_Council_Div': None, 'Health_Facility': None, '105_EP01b_Malaria_Total': 2383427, '105_EP01a_Suspected_fever': 3351448, '105_EP01d_Malaria_cases_treated': 4147148, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 2227465}
2025-12-18 14:27:06,842:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Column truncation needed: df has 10 columns, expected 1
2025-12-18 14:27:06,842:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   DataFrame actual columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:27:06,842:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Expected columns: ['Region']
2025-12-18 14:27:06,842:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] âœ“ Selecting columns BY NAME (matched all expected columns)
2025-12-18 14:27:06,842:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Column mapping: {'Region': 'Region'}
2025-12-18 14:27:06,842:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] Column Selection âœ“ SUCCESS - method=BY_NAME, datasource=analytics_LAST_YEAR_20251210
2025-12-18 14:27:06,842:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Region']
2025-12-18 14:27:06,842:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   tried_by_name=True, success=True, fallback=False
2025-12-18 14:27:06,842:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Assigning column labels: ['Region']
2025-12-18 14:27:06,842:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] AFTER assign_column_label:
2025-12-18 14:27:06,843:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (64, 1)
2025-12-18 14:27:06,843:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Region']
2025-12-18 14:27:06,843:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['Region']
2025-12-18 14:27:06,843:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: True
2025-12-18 14:27:06,843:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Region': 'West Nile'}
2025-12-18 14:27:06,857:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:27:06] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-18 14:27:07,738:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:27:07] "POST /superset/log/?explode=events&dashboard_id=1 HTTP/1.1" 200 -
2025-12-18 14:27:57,521:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:27:57] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 14:27:59,564:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:27:59] "GET /api/v1/chart/_info?q=(keys:!(permissions)) HTTP/1.1" 200 -
2025-12-18 14:28:00,155:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:28:00] "GET /api/v1/chart/?q=(order_column:changed_on_delta_humanized,order_direction:desc,page:0,page_size:25) HTTP/1.1" 200 -
2025-12-18 14:28:00,796:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:28:00] "GET /api/v1/database/?q=(filters:!((col:allow_file_upload,opr:upload_is_enabled,value:!t))) HTTP/1.1" 200 -
2025-12-18 14:28:00,815:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:28:00] "GET /api/v1/database/?q=(filters:!((col:database_name,opr:neq,value:examples))) HTTP/1.1" 200 -
2025-12-18 14:28:00,858:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:28:00] "GET /api/v1/chart/?q=(order_column:changed_on_delta_humanized,order_direction:desc,page:0,page_size:25) HTTP/1.1" 200 -
2025-12-18 14:28:00,898:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:28:00] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 14:28:00,936:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:28:00] "GET /api/v1/chart/?q=(order_column:changed_on_delta_humanized,order_direction:desc,page:0,page_size:25) HTTP/1.1" 200 -
2025-12-18 14:28:01,219:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:28:01] "GET /api/v1/chart/favorite_status/?q=!(4,1,2,3) HTTP/1.1" 200 -
2025-12-18 14:28:01,506:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:28:01] "GET /api/v1/chart/favorite_status/?q=!(4,1,2,3) HTTP/1.1" 200 -
2025-12-18 14:28:01,615:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:28:01] "GET /api/v1/chart/favorite_status/?q=!(4,1,2,3) HTTP/1.1" 200 -
2025-12-18 14:28:09,819:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:28:09] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 14:28:17,297:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:28:17] "GET /api/v1/dataset/?q=(columns:!(id,table_name,datasource_type,database.database_name,schema),filters:!((col:table_name,opr:ct,value:'')),order_column:table_name,order_direction:asc,page:0,page_size:100) HTTP/1.1" 200 -
2025-12-18 14:28:23,621:INFO:superset.db_engine_specs.dhis2:[DHIS2] get_parameters_from_uri called
2025-12-18 14:28:23,625:ERROR:superset.db_engine_specs.dhis2:[DHIS2] Failed to extract parameters from URI: 'URL' object has no attribute 'decode'
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/superset/db_engine_specs/dhis2.py", line 361, in get_parameters_from_uri
    parsed = urlparse(uri)
             ^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/urllib/parse.py", line 394, in urlparse
    url, scheme, _coerce_result = _coerce_args(url, scheme)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/urllib/parse.py", line 133, in _coerce_args
    return _decode_args(args) + (_encode_result,)
           ^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/urllib/parse.py", line 117, in _decode_args
    return tuple(x.decode(encoding, errors) if x else '' for x in args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/urllib/parse.py", line 117, in <genexpr>
    return tuple(x.decode(encoding, errors) if x else '' for x in args)
                 ^^^^^^^^
AttributeError: 'URL' object has no attribute 'decode'
2025-12-18 14:28:23,747:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:28:23] "GET /api/v1/explore/?viz_type=dhis2_map&datasource_id=4&datasource_type=table HTTP/1.1" 200 -
2025-12-18 14:28:25,434:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:28:25] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 14:28:25,461:INFO:superset.databases.api:[DHIS2 OrgUnitLevels] Request URL: https://tests.dhis2.hispuganda.org/hmis/api/organisationUnitLevels
2025-12-18 14:28:25,461:INFO:superset.databases.api:[DHIS2 OrgUnitLevels] Response status: 200
2025-12-18 14:28:25,462:INFO:superset.databases.api:[DHIS2 OrgUnitLevels] Found 5 levels
2025-12-18 14:28:25,469:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:28:25] "GET /api/v1/database/2/dhis2_metadata/?type=organisationUnitLevels HTTP/1.1" 200 -
2025-12-18 14:28:25,605:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:28:25] "[35m[1mPOST /api/v1/explore/form_data?tab_id=2 HTTP/1.1[0m" 201 -
2025-12-18 14:28:35,766:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:28:35] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 14:28:40,995:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:28:40] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 14:28:46,246:WARNING:superset.common.query_object:The field `groupby` is deprecated, please use `columns` instead.
2025-12-18 14:28:46,247:WARNING:superset.common.query_object:The field `columns` is already populated, replacing value with contents from `groupby`.
2025-12-18 14:28:46,285:ERROR:superset.models.helpers:[METRICS-TRACE] Processing 1 metrics
2025-12-18 14:28:46,286:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 0: DHIS2 raw column - 105_EP01b_Malaria_Total
2025-12-18 14:28:46,287:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: 105_EP01b_Malaria_Total
2025-12-18 14:28:46,287:ERROR:superset.models.helpers:[METRICS-TRACE] Total metrics added: 1
2025-12-18 14:28:46,288:ERROR:superset.models.helpers:[METRICS-TRACE] Before dedup: 3 select_exprs + 1 metrics_exprs
2025-12-18 14:28:46,288:ERROR:superset.models.helpers:[METRICS-TRACE] After dedup: 3 total select_exprs
2025-12-18 14:28:46,288:INFO:superset.models.helpers:[COLUMN_TRACE] SQL Query Building:
2025-12-18 14:28:46,288:INFO:superset.models.helpers:[COLUMN_TRACE]   columns: ['District', 'Period', '105_EP01b_Malaria_Total']
2025-12-18 14:28:46,288:INFO:superset.models.helpers:[COLUMN_TRACE]   metrics: ['105_EP01b_Malaria_Total']
2025-12-18 14:28:46,289:INFO:superset.models.helpers:[COLUMN_TRACE]   groupby: []
2025-12-18 14:28:46,289:INFO:superset.models.helpers:[COLUMN_TRACE]   labels_expected: ['District', 'Period', '105_EP01b_Malaria_Total']
2025-12-18 14:28:46,289:INFO:superset.models.helpers:[COLUMN_TRACE]   select_exprs count: 3
2025-12-18 14:28:46,289:INFO:superset.models.helpers:[COLUMN_TRACE]     [0] key=District, name=District, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-18 14:28:46,289:INFO:superset.models.helpers:[COLUMN_TRACE]     [1] key=Period, name=Period, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-18 14:28:46,289:INFO:superset.models.helpers:[COLUMN_TRACE]     [2] key=105_EP01b_Malaria_Total, name=105_EP01b_Malaria_Total, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-18 14:28:46,289:INFO:superset.connectors.sqla.models:[DHIS2] get_from_clause for virtual dataset 4: analytics 20251217-3246
2025-12-18 14:28:46,289:INFO:superset.connectors.sqla.models:[DHIS2] Full SQL stored: SELECT * FROM analytics
/* DHIS2: table=analytics&dx=JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&pe=LAST_5_YEARS&ou=F1o6qBSx783;SUvODYOcaVf&ouMode=DESCENDANTS */
2025-12-18 14:28:46,289:INFO:superset.connectors.sqla.models:[DHIS2] Loaded params from extra field: table=analytics&dx=JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&pe=LAST_5_YEARS&ou=F1o6qBSx783;SUvO
2025-12-18 14:28:46,290:INFO:superset.connectors.sqla.models:[DHIS2] Cached params with key: dhis2_params_4_analytics
2025-12-18 14:28:46,290:INFO:superset.connectors.sqla.models:[DHIS2] Stored params in Flask g for DHIS2 table: analytics
2025-12-18 14:28:46,309:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Query execution in connectors/sqla/models.py:
2025-12-18 14:28:46,309:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   SQL (first 500 chars): SELECT "District", "Period", "105_EP01b_Malaria_Total" 
FROM (SELECT * FROM analytics
/* DHIS2: table=analytics&dx=JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&pe=LAST_5_YEARS&ou=F1o6qBSx783;SUvODYOcaVf&ouMode=DESCENDANTS */
) AS virtual_table GROUP BY "District", "Period", "105_EP01b_Malaria_Total"
 LIMIT 10000
2025-12-18 14:28:46,309:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   labels_expected: ['District', 'Period', '105_EP01b_Malaria_Total']
2025-12-18 14:28:46,311:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 connection initialized: https://tests.dhis2.hispuganda.org/hmis/api
2025-12-18 14:28:46,314:INFO:superset.db_engine_specs.dhis2_dialect:Executing DHIS2 query: SELECT
  "District",
  "Period",
  "105_EP01b_Malaria_Total"
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "District",
  "Period",
  "105_EP01b_Malaria_Total"
LIMIT 10000
2025-12-18 14:28:46,314:INFO:superset.db_engine_specs.dhis2_dialect:Parsed endpoint: analytics
2025-12-18 14:28:46,314:INFO:superset.db_engine_specs.dhis2_dialect:Using stored parameters from Flask g for table: analytics
2025-12-18 14:28:46,314:INFO:superset.db_engine_specs.dhis2_dialect:Query params: {'table': 'analytics', 'dx': 'JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX', 'pe': 'LAST_5_YEARS', 'ou': 'F1o6qBSx783;SUvODYOcaVf', 'ouMode': 'DESCENDANTS'}
2025-12-18 14:28:46,315:INFO:superset.db_engine_specs.dhis2_dialect:Period dimension detected - omitting startDate/endDate (DHIS2 API rule)
2025-12-18 14:28:46,315:INFO:superset.db_engine_specs.dhis2_dialect:Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dx': 'JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX', 'pe': 'LAST_5_YEARS', 'ou': 'F1o6qBSx783;SUvODYOcaVf', 'ouMode': 'DESCENDANTS'}
2025-12-18 14:28:47,004:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:28:47] "PUT /api/v1/explore/form_data/ULWSeaI5Yyo?tab_id=2 HTTP/1.1" 200 -
2025-12-18 14:28:47,158:INFO:superset.db_engine_specs.dhis2_dialect:Fetched org unit levels: {3: 'District', 5: 'Health Facility', 1: 'National', 2: 'Region', 4: 'Sub County/Town Council/Div'}
2025-12-18 14:28:47,963:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Using all_levels scope: ['LEVEL-3', 'LEVEL-4', 'LEVEL-5']
2025-12-18 14:28:47,963:INFO:superset.db_engine_specs.dhis2_dialect:Converted dx/pe/ou to dimension parameter: dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX;pe:LAST_5_YEARS;ou:F1o6qBSx783;SUvODYOcaVf;LEVEL-3;LEVEL-4;LEVEL-5
2025-12-18 14:28:47,963:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API request (cache miss): https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&dimension=pe:LAST_5_YEARS&dimension=ou:F1o6qBSx783;SUvODYOcaVf;LEVEL-3;LEVEL-4;LEVEL-5
2025-12-18 14:28:50,742:INFO:superset.db_engine_specs.dhis2_cache:[DHIS2 Cache] SET: analytics (ttl=3600s, key=dhis2:4a1c3321:analytics:5362e2052855...)
2025-12-18 14:28:50,745:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2 Cache] Stored response for analytics
2025-12-18 14:28:50,756:INFO:superset.db_engine_specs.dhis2_dialect:Using wide/pivoted format for analytics
2025-12-18 14:28:51,659:INFO:superset.db_engine_specs.dhis2_dialect:Fetched org unit levels: {3: 'District', 5: 'Health Facility', 1: 'National', 2: 'Region', 4: 'Sub County/Town Council/Div'}
2025-12-18 14:28:51,661:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] _fetch_org_unit_hierarchy: Fetching 1142 unique org units in batches...

[DHIS2] fetchall() - Column count from description: 10
[DHIS2] fetchall() - First row (fixed types): ('2020', 'MOH - Uganda', 'West Nile', None, None, None, 2383427, 3351448, 4147148, 2227465)
[DHIS2] fetchall() - Type enforcement: dimensions=STRING, measures=FLOAT
[DHIS2] Batch 1: Got 16 org units from DHIS2
[DHIS2]   OU: SUvODYOcaVf, name=Acholi, level=2, parent=akV6429SUqu
[DHIS2]   OU: F1o6qBSx783, name=Ankole, level=2, parent=akV6429SUqu
[DHIS2]   OU: Dt6qdenPX1E, name=Bugisu, level=2, parent=akV6429SUqu
[DHIS2] Total org unit names available: 16 after 1 iterations
[DHIS2] Sample hierarchy for Dl9WvtvDs5V: {'level_1': 'MOH - Uganda', 'level_2': 'North Buganda', 'level_3': None, 'level_4': None, 'level_5': None, 'level_6': None}
[DHIS2]   Dl9WvtvDs5V: filled levels = ['level_1', 'level_2']
[DHIS2]   QBPg7KKCeoA: filled levels = ['level_1', 'level_2']
[DHIS2]   F1o6qBSx783: filled levels = ['level_1', 'level_2']
[DHIS2] Fetched hierarchy for 16 org units
[DHIS2] Sample hierarchy for Dl9WvtvDs5V: {'level_1': 'MOH - Uganda', 'level_2': 'North Buganda', 'level_3': None, 'level_4': None, 'level_5': None, 'level_6': None}
[DHIS2] Calling DHIS2ResponseNormalizer.normalize with:
[DHIS2]   - endpoint: analytics
[DHIS2]   - pivot: True
[DHIS2]   - org_unit_hierarchy: 16 entries
[DHIS2]   - org_unit_level_names: {3: 'District', 5: 'Health Facility', 1: 'National', 2: 'Region', 4: 'Sub County/Town Council/Div'}
[DHIS2] normalize_analytics: pivot=True, using WIDE/PIVOTED format
[DHIS2] PIVOT CONSTRUCTION:
[DHIS2]   data_elements (UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   data_element_list (sorted UIDs): ['D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'wUDxFVBapIc']
[DHIS2]   col_names (SANITIZED): ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Row 0: OU=BD3XaQ7cQAp, hierarchy_info={'level_1': 'MOH - Uganda', 'level_2': 'West Nile', 'level_3': None, 'level_4': None, 'level_5': None, 'level_6': None}
[DHIS2] Row 1: OU=DWPnYhoqza0, hierarchy_info={'level_1': 'MOH - Uganda', 'level_2': 'Lango', 'level_3': None, 'level_4': None, 'level_5': None, 'level_6': None}
[DHIS2] Row 2: OU=Dl9WvtvDs5V, hierarchy_info={'level_1': 'MOH - Uganda', 'level_2': 'North Buganda', 'level_3': None, 'level_4': None, 'level_5': None, 'level_6': None}
[DHIS2] Normalized columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized row count: 64
[DHIS2] First row: ('2020', 'MOH - Uganda', 'West Nile', None, None, None, 2383427, 3351448, 4147148, 2227465)
[DHIS2] _set_description: original=['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], sanitized=['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], types=['String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String']
[DHIS2] Transformed rows count: 64
[DHIS2] First transformed row: ('2020', 'MOH - Uganda', 'West Nile', None, None, None, 2383427, 3351448, 4147148, 2227465)
[DHIS2] Fetched 64 rows
[DHIS2] fetchall() called - returning 64 rows
[DHIS2] fetchall() - First row type: <class 'tuple'>
[DHIS2] fetchall() - First row (original): ('2020', 'MOH - Uganda', 'West Nile', None, None, None, 2383427, 3351448, 4147148, 2227465)
[DHIS2] fetchall() - Column count from description: 10
[DHIS2] fetchall() - First row (fixed types): ('2020', 'MOH - Uganda', 'West Nile', None, None, None, 2383427, 3351448, 4147148, 2227465)
[DHIS2] fetchall() - Type enforcement: dimensions=STRING, measures=FLOAT
[DHIS2] Executing query: SELECT
  "District",
  "Period",
  "105_EP01b_Malaria_Total"
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "District",
  "Period",
  "105_EP01b_Malaria_Total"
LIMIT 10000
[DHIS2] Parsed endpoint: analytics
[DHIS2] Found params in Flask g for analytics: table=analytics&dx=JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7
[DHIS2] Query params: {'table': 'analytics', 'dx': 'JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX', 'pe': 'LAST_5_YEARS', 'ou': 'F1o6qBSx783;SUvODYOcaVf', 'ouMode': 'DESCENDANTS'}
[DHIS2] Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dx': 'JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX', 'pe': 'LAST_5_YEARS', 'ou': 'F1o6qBSx783;SUvODYOcaVf', 'ouMode': 'DESCENDANTS'}
[DHIS2] Using all_levels scope: ['LEVEL-3', 'LEVEL-4', 'LEVEL-5']
[DHIS2] ðŸ”„ CACHE MISS - API request URL: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&dimension=pe:LAST_5_YEARS&dimension=ou:F1o6qBSx783;SUvODYOcaVf;LEVEL-3;LEVEL-4;LEVEL-5
[DHIS2] Raw API response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Raw DHIS2 rows count: 22727
[DHIS2] First raw row: ['JhvC7ZR9hUe', '2022', 'C0RSe3EWBqU', '246166']
[DHIS2] âœ… Cached response for analytics (API took 4389.4ms)
[DHIS2] Parsing response for endpoint: analytics
[DHIS2] Response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Response sample: {'headers': [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}], 'metaDat
[DHIS2] Using WIDE/PIVOTED format (Period, Level_1_Name, Level_2_Name, ..., DX1, DX2, ...) for analytics
[DHIS2] Analytics headers: [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}]
[DHIS2] Found 'ou' column at index 2
[DHIS2] Processing 22727 rows to extract org unit IDs
[DHIS2] Extracted 1142 unique org unit IDs from rows
[DHIS2] Found 1142 unique org units in analytics response
[DHIS2] Fetching hierarchy for 1142 org units...
[DHIS2] _fetch_org_unit_hierarchy: Fetching 1142 unique org units
[DHIS2] Batch 1: Got 50 org units from DHIS2
[DHIS2]   OU: wNunka5Y2uu, name=Acholi-Bur Subcounty, level=4, parent=aBrjuZk0W31
[DHIS2]   OU: FihNC5KfGJV, name=Adilang Subcounty, level=4, parent=ztIyIYAzFKp
[DHIS2]   OU: HSBjlZdFpWn, name=Ajan Subcounty, level=4, parent=aBrjuZk0W31
[DHIS2] Batch 2: Got 50 org units from DHIS2
[DHIS2] Batch 3: Got 50 org units from DHIS2
[DHIS2] Batch 4: Got 50 org units from DHIS2
[DHIS2] Batch 5: Got 50 org units from DHIS2
[DHIS2] Batch 6: Got 50 org units from DHIS2
[DHIS2] Batch 7: Got 50 org units from DHIS2
[DHIS2] Batch 8: Got 50 org units from DHIS2
[DHIS2] Batch 9: Got 50 org units from DHIS2
[DHIS2] Batch 10: Got 50 org units from DHIS2
[DHIS2] Batch 11: Got 50 org units from DHIS2
[DHIS2] Batch 12: Got 50 org units from DHIS22025-12-18 14:29:20,766:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Fetched 1142 org units, found 301 parent IDs
2025-12-18 14:29:20,768:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Iteration 1: Fetching 2 missing parent org units...
2025-12-18 14:29:23,457:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Iteration 2: Fetching 1 missing parent org units...
2025-12-18 14:29:24,273:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total org unit names available: 1145
2025-12-18 14:29:24,286:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Sample hierarchy for a9NzDoLn9kz: {'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Kitgum District', 'level_4': 'Pager Division', 'level_5': None, 'level_6': None}
2025-12-18 14:29:24,286:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] _fetch_org_unit_hierarchy completed: 1142 org units with hierarchy
2025-12-18 14:29:24,286:INFO:superset.db_engine_specs.dhis2_dialect:normalize_analytics called with pivot=True, returning WIDE format
2025-12-18 14:29:24,355:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column construction - data_elements: ['AuAOIfCuBUp', 'BWZFz9RJRPI', 'D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'gHjJrtw9vQX', 'pRZrTLDN7Ge', 'wUDxFVBapIc']
2025-12-18 14:29:24,355:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column names constructed (SANITIZED): ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:29:24,360:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] FIRST ROW CONSTRUCTION:
2025-12-18 14:29:24,360:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   Period (index 0): 2020
2025-12-18 14:29:24,360:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   108-EP01a.2. Malaria Total (Deaths) (index 6): None
2025-12-18 14:29:24,360:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   108-EP01a.1. Malaria Total (Cases) (index 7): 3
2025-12-18 14:29:24,360:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01b. Malaria Total (index 8): 1580
2025-12-18 14:29:24,360:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01a. Suspected fever (index 9): 6695
2025-12-18 14:29:24,360:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01d. Malaria cases treated (index 10): 1560
2025-12-18 14:29:24,360:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   108-EP01b.2. Malaria Confirmed (Microscopic &RDT) (Deaths) (index 11): None
2025-12-18 14:29:24,360:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   108-EP01b.1. Malaria Confirmed (Microscopic &RDT) (Cases) (index 12): 3
2025-12-18 14:29:24,360:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01c. Malaria Confirmed (B/s and RDT Positive) (index 13): 1579
2025-12-18 14:29:24,418:INFO:superset.db_engine_specs.dhis2_dialect:First pivoted row - Period: '2020'
2025-12-18 14:29:24,418:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total pivoted rows: 4437, columns: 14
2025-12-18 14:29:24,419:INFO:superset.db_engine_specs.dhis2_dialect:Normalized 4437 rows with 14 columns for endpoint analytics
2025-12-18 14:29:24,419:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API returned 4437 rows
2025-12-18 14:29:24,453:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() - Row count: 4437
2025-12-18 14:29:24,454:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:29:24,454:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names length: 14
2025-12-18 14:29:24,454:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values count: 14
2025-12-18 14:29:24,454:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values: ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
2025-12-18 14:29:24,454:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 0 (Period): 2020 -> 2020 (STRING)
2025-12-18 14:29:24,454:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (National): 'MOH - Uganda...' -> STRING (non-numeric detected)
2025-12-18 14:29:24,454:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (National): MOH - Uganda (PROCESSED)
2025-12-18 14:29:24,454:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (Region): 'Ankole...' -> STRING (non-numeric detected)
2025-12-18 14:29:24,454:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (Region): Ankole (PROCESSED)
2025-12-18 14:29:24,454:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (District): 'Rwampara District...' -> STRING (non-numeric detected)
2025-12-18 14:29:24,455:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (District): Rwampara District (PROCESSED)
2025-12-18 14:29:24,455:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (Sub_County_Town_Council_Div): 'Mwizi Subcounty...' -> STRING (non-numeric detected)
2025-12-18 14:29:24,455:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (Sub_County_Town_Council_Div): Mwizi Subcounty (PROCESSED)
2025-12-18 14:29:24,473:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() returning 4437 rows with 14 columns each
2025-12-18 14:29:24,474:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Got 4437 rows from cursor
2025-12-18 14:29:24,474:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: First row: ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
2025-12-18 14:29:24,474:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:29:24,474:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Types from cursor: ['String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String']
2025-12-18 14:29:24,491:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: DataFrame created with 4437 rows, 14 columns
2025-12-18 14:29:24,491:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:29:24,493:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes BEFORE fix: {'Period': dtype('O'), 'National': dtype('O'), 'Region': dtype('O'), 'District': dtype('O'), 'Sub_County_Town_Council_Div': dtype('O'), 'Health_Facility': dtype('O'), '108_EP01a_2_Malaria_Total_Deaths': dtype('O'), '108_EP01a_1_Malaria_Total_Cases': dtype('O'), '105_EP01b_Malaria_Total': dtype('O'), '105_EP01a_Suspected_fever': dtype('O'), '105_EP01d_Malaria_cases_treated': dtype('O'), '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths': dtype('O'), '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases': dtype('O'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('O')}
2025-12-18 14:29:24,496:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Period' to object dtype (dimension)
2025-12-18 14:29:24,497:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'National' as dimension (contains non-numeric string: 'MOH - Uganda...')
2025-12-18 14:29:24,498:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'National' to object dtype (dimension)
2025-12-18 14:29:24,498:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'Region' as dimension (contains non-numeric string: 'Ankole...')
2025-12-18 14:29:24,498:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Region' to object dtype (dimension)
2025-12-18 14:29:24,499:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'District' as dimension (contains non-numeric string: 'Rwampara District...')
2025-12-18 14:29:24,499:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'District' to object dtype (dimension)
2025-12-18 14:29:24,499:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'Sub_County_Town_Council_Div' as dimension (contains non-numeric string: 'Mwizi Subcounty...')
2025-12-18 14:29:24,499:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Sub_County_Town_Council_Div' to object dtype (dimension)
2025-12-18 14:29:24,500:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'Health_Facility' as dimension (contains non-numeric string: 'Keyo Health Centre II...')
2025-12-18 14:29:24,500:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Health_Facility' to object dtype (dimension)
2025-12-18 14:29:24,502:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes AFTER fix: {'Period': dtype('O'), 'National': dtype('O'), 'Region': dtype('O'), 'District': dtype('O'), 'Sub_County_Town_Council_Div': dtype('O'), 'Health_Facility': dtype('O'), '108_EP01a_2_Malaria_Total_Deaths': dtype('O'), '108_EP01a_1_Malaria_Total_Cases': dtype('O'), '105_EP01b_Malaria_Total': dtype('O'), '105_EP01a_Suspected_fever': dtype('O'), '105_EP01d_Malaria_cases_treated': dtype('O'), '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths': dtype('O'), '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases': dtype('O'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('O')}
2025-12-18 14:29:24,502:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: First row: {'Period': '2020', 'National': 'MOH - Uganda', 'Region': 'Ankole', 'District': 'Rwampara District', 'Sub_County_Town_Council_Div': 'Mwizi Subcounty', 'Health_Facility': None, '108_EP01a_2_Malaria_Total_Deaths': None, '108_EP01a_1_Malaria_Total_Cases': 3, '105_EP01b_Malaria_Total': 1580, '105_EP01a_Suspected_fever': 6695, '105_EP01d_Malaria_cases_treated': 1560, '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths': None, '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases': 3, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 1579}
2025-12-18 14:29:24,506:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] BEFORE assign_column_label:
2025-12-18 14:29:24,507:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4437, 14)
2025-12-18 14:29:24,507:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:29:24,507:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['District', 'Period', '105_EP01b_Malaria_Total']
2025-12-18 14:29:24,507:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: False
2025-12-18 14:29:24,507:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Period': '2020', 'National': 'MOH - Uganda', 'Region': 'Ankole', 'District': 'Rwampara District', 'Sub_County_Town_Council_Div': 'Mwizi Subcounty', 'Health_Facility': None, '108_EP01a_2_Malaria_Total_Deaths': None, '108_EP01a_1_Malaria_Total_Cases': 3, '105_EP01b_Malaria_Total': 1580, '105_EP01a_Suspected_fever': 6695, '105_EP01d_Malaria_cases_treated': 1560, '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths': None, '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases': 3, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 1579}
2025-12-18 14:29:24,507:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Column truncation needed: df has 14 columns, expected 3
2025-12-18 14:29:24,507:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   DataFrame actual columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:29:24,507:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Expected columns: ['District', 'Period', '105_EP01b_Malaria_Total']
2025-12-18 14:29:24,507:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] âœ“ Selecting columns BY NAME (matched all expected columns)
2025-12-18 14:29:24,507:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Column mapping: {'District': 'District', 'Period': 'Period', '105_EP01b_Malaria_Total': '105_EP01b_Malaria_Total'}
2025-12-18 14:29:24,508:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] Column Selection âœ“ SUCCESS - method=BY_NAME, datasource=analytics 20251217-3246
2025-12-18 14:29:24,509:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['District', 'Period', '105_EP01b_Malaria_Total']
2025-12-18 14:29:24,509:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   tried_by_name=True, success=True, fallback=False
2025-12-18 14:29:24,509:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Assigning column labels: ['District', 'Period', '105_EP01b_Malaria_Total']
2025-12-18 14:29:24,509:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] AFTER assign_column_label:
2025-12-18 14:29:24,509:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4437, 3)
2025-12-18 14:29:24,509:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['District', 'Period', '105_EP01b_Malaria_Total']
2025-12-18 14:29:24,509:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['District', 'Period', '105_EP01b_Malaria_Total']
2025-12-18 14:29:24,509:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: True
2025-12-18 14:29:24,509:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'District': 'Rwampara District', 'Period': '2020', '105_EP01b_Malaria_Total': 1580}
2025-12-18 14:29:24,588:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:29:24] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-18 14:29:24,914:WARNING:superset.common.query_object:The field `groupby` is deprecated, please use `columns` instead.
2025-12-18 14:29:24,914:WARNING:superset.common.query_object:The field `columns` is already populated, replacing value with contents from `groupby`.
2025-12-18 14:29:24,948:ERROR:superset.models.helpers:[METRICS-TRACE] Processing 1 metrics
2025-12-18 14:29:24,948:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 0: DHIS2 raw column - 105_EP01b_Malaria_Total
2025-12-18 14:29:24,966:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: 105_EP01b_Malaria_Total
2025-12-18 14:29:24,967:ERROR:superset.models.helpers:[METRICS-TRACE] Total metrics added: 1
2025-12-18 14:29:24,973:ERROR:superset.models.helpers:[METRICS-TRACE] Before dedup: 3 select_exprs + 1 metrics_exprs
2025-12-18 14:29:24,974:ERROR:superset.models.helpers:[METRICS-TRACE] After dedup: 3 total select_exprs
2025-12-18 14:29:24,974:INFO:superset.models.helpers:[COLUMN_TRACE] SQL Query Building:
2025-12-18 14:29:24,974:INFO:superset.models.helpers:[COLUMN_TRACE]   columns: ['District', 'Period', '105_EP01b_Malaria_Total']
2025-12-18 14:29:24,976:INFO:superset.models.helpers:[COLUMN_TRACE]   metrics: ['105_EP01b_Malaria_Total']
2025-12-18 14:29:24,976:INFO:superset.models.helpers:[COLUMN_TRACE]   groupby: []
2025-12-18 14:29:24,977:INFO:superset.models.helpers:[COLUMN_TRACE]   labels_expected: ['District', 'Period', '105_EP01b_Malaria_Total']
2025-12-18 14:29:24,977:INFO:superset.models.helpers:[COLUMN_TRACE]   select_exprs count: 3
2025-12-18 14:29:24,977:INFO:superset.models.helpers:[COLUMN_TRACE]     [0] key=District, name=District, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-18 14:29:24,977:INFO:superset.models.helpers:[COLUMN_TRACE]     [1] key=Period, name=Period, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-18 14:29:24,977:INFO:superset.models.helpers:[COLUMN_TRACE]     [2] key=105_EP01b_Malaria_Total, name=105_EP01b_Malaria_Total, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-18 14:29:24,978:INFO:superset.connectors.sqla.models:[DHIS2] get_from_clause for virtual dataset 4: analytics 20251217-3246
2025-12-18 14:29:24,978:INFO:superset.connectors.sqla.models:[DHIS2] Full SQL stored: SELECT * FROM analytics
/* DHIS2: table=analytics&dx=JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&pe=LAST_5_YEARS&ou=F1o6qBSx783;SUvODYOcaVf&ouMode=DESCENDANTS */
2025-12-18 14:29:24,978:INFO:superset.connectors.sqla.models:[DHIS2] Loaded params from extra field: table=analytics&dx=JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&pe=LAST_5_YEARS&ou=F1o6qBSx783;SUvO
2025-12-18 14:29:24,980:INFO:superset.connectors.sqla.models:[DHIS2] Cached params with key: dhis2_params_4_analytics
2025-12-18 14:29:24,980:INFO:superset.connectors.sqla.models:[DHIS2] Stored params in Flask g for DHIS2 table: analytics
2025-12-18 14:29:25,036:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Query execution in connectors/sqla/models.py:
2025-12-18 14:29:25,036:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   SQL (first 500 chars): SELECT "District", "Period", "105_EP01b_Malaria_Total" 
FROM (SELECT * FROM analytics
/* DHIS2: table=analytics&dx=JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&pe=LAST_5_YEARS&ou=F1o6qBSx783;SUvODYOcaVf&ouMode=DESCENDANTS */
) AS virtual_table GROUP BY "District", "Period", "105_EP01b_Malaria_Total"
 LIMIT 10000
2025-12-18 14:29:25,037:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   labels_expected: ['District', 'Period', '105_EP01b_Malaria_Total']
2025-12-18 14:29:25,040:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 connection initialized: https://tests.dhis2.hispuganda.org/hmis/api
2025-12-18 14:29:25,042:INFO:superset.db_engine_specs.dhis2_dialect:Executing DHIS2 query: SELECT
  "District",
  "Period",
  "105_EP01b_Malaria_Total"
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "District",
  "Period",
  "105_EP01b_Malaria_Total"
LIMIT 10000
2025-12-18 14:29:25,042:INFO:superset.db_engine_specs.dhis2_dialect:Parsed endpoint: analytics
2025-12-18 14:29:25,042:INFO:superset.db_engine_specs.dhis2_dialect:Using stored parameters from Flask g for table: analytics
2025-12-18 14:29:25,042:INFO:superset.db_engine_specs.dhis2_dialect:Query params: {'table': 'analytics', 'dx': 'JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX', 'pe': 'LAST_5_YEARS', 'ou': 'F1o6qBSx783;SUvODYOcaVf', 'ouMode': 'DESCENDANTS'}
2025-12-18 14:29:25,042:INFO:superset.db_engine_specs.dhis2_dialect:Period dimension detected - omitting startDate/endDate (DHIS2 API rule)
2025-12-18 14:29:25,042:INFO:superset.db_engine_specs.dhis2_dialect:Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dx': 'JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX', 'pe': 'LAST_5_YEARS', 'ou': 'F1o6qBSx783;SUvODYOcaVf', 'ouMode': 'DESCENDANTS'}
2025-12-18 14:29:25,051:INFO:superset.databases.api:[DHIS2 GeoFeatures] Fetching geoFeatures with params: {'ou': 'ou:LEVEL-2'}
2025-12-18 14:29:25,690:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:29:25] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 14:29:26,045:INFO:superset.db_engine_specs.dhis2_dialect:Fetched org unit levels: {3: 'District', 5: 'Health Facility', 1: 'National', 2: 'Region', 4: 'Sub County/Town Council/Div'}
2025-12-18 14:29:26,871:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Using all_levels scope: ['LEVEL-3', 'LEVEL-4', 'LEVEL-5']
2025-12-18 14:29:26,872:INFO:superset.db_engine_specs.dhis2_dialect:Converted dx/pe/ou to dimension parameter: dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX;pe:LAST_5_YEARS;ou:F1o6qBSx783;SUvODYOcaVf;LEVEL-3;LEVEL-4;LEVEL-5
2025-12-18 14:29:26,874:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API request (cache miss): https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&dimension=pe:LAST_5_YEARS&dimension=ou:F1o6qBSx783;SUvODYOcaVf;LEVEL-3;LEVEL-4;LEVEL-5
2025-12-18 14:29:30,376:INFO:superset.databases.api:[DHIS2 GeoFeatures] Response status: 200
2025-12-18 14:29:30,402:INFO:superset.databases.api:[DHIS2 GeoFeatures] Found 15 features
2025-12-18 14:29:30,435:INFO:superset.db_engine_specs.dhis2_cache:[DHIS2 Cache] SET: analytics (ttl=3600s, key=dhis2:4a1c3321:analytics:5362e2052855...)
2025-12-18 14:29:30,435:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2 Cache] Stored response for analytics
2025-12-18 14:29:30,448:INFO:superset.db_engine_specs.dhis2_dialect:Using wide/pivoted format for analytics
2025-12-18 14:29:30,468:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:29:30] "GET /api/v1/database/2/dhis2_metadata/?type=geoFeatures&ou=LEVEL-2 HTTP/1.1" 200 -
2025-12-18 14:29:31,334:INFO:superset.db_engine_specs.dhis2_dialect:Fetched org unit levels: {3: 'District', 5: 'Health Facility', 1: 'National', 2: 'Region', 4: 'Sub County/Town Council/Div'}

[DHIS2] Batch 13: Got 50 org units from DHIS2
[DHIS2] Batch 14: Got 50 org units from DHIS2
[DHIS2] Batch 15: Got 50 org units from DHIS2
[DHIS2] Batch 16: Got 50 org units from DHIS2
[DHIS2] Batch 17: Got 50 org units from DHIS2
[DHIS2] Batch 18: Got 50 org units from DHIS2
[DHIS2] Batch 19: Got 50 org units from DHIS2
[DHIS2] Batch 20: Got 50 org units from DHIS2
[DHIS2] Batch 21: Got 50 org units from DHIS2
[DHIS2] Batch 22: Got 50 org units from DHIS2
[DHIS2] Batch 23: Got 42 org units from DHIS2
[DHIS2] Total org unit names available: 1145 after 2 iterations
[DHIS2] Sample hierarchy for a9NzDoLn9kz: {'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Kitgum District', 'level_4': 'Pager Division', 'level_5': None, 'level_6': None}
[DHIS2]   a9NzDoLn9kz: filled levels = ['level_1', 'level_2', 'level_3', 'level_4']
[DHIS2]   aFgrVHVDqoZ: filled levels = ['level_1', 'level_2', 'level_3', 'level_4', 'level_5']
[DHIS2]   fxHApp8UtpE: filled levels = ['level_1', 'level_2', 'level_3', 'level_4', 'level_5']
[DHIS2] Fetched hierarchy for 1142 org units
[DHIS2] Sample hierarchy for a9NzDoLn9kz: {'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Kitgum District', 'level_4': 'Pager Division', 'level_5': None, 'level_6': None}
[DHIS2] Calling DHIS2ResponseNormalizer.normalize with:
[DHIS2]   - endpoint: analytics
[DHIS2]   - pivot: True
[DHIS2]   - org_unit_hierarchy: 1142 entries
[DHIS2]   - org_unit_level_names: {3: 'District', 5: 'Health Facility', 1: 'National', 2: 'Region', 4: 'Sub County/Town Council/Div'}
[DHIS2] normalize_analytics: pivot=True, using WIDE/PIVOTED format
[DHIS2] PIVOT CONSTRUCTION:
[DHIS2]   data_elements (UIDs): ['AuAOIfCuBUp', 'BWZFz9RJRPI', 'D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'gHjJrtw9vQX', 'pRZrTLDN7Ge', 'wUDxFVBapIc']
[DHIS2]   data_element_list (sorted UIDs): ['AuAOIfCuBUp', 'BWZFz9RJRPI', 'D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'gHjJrtw9vQX', 'pRZrTLDN7Ge', 'wUDxFVBapIc']
[DHIS2]   col_names (SANITIZED): ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Row 0: OU=AA8TRyfTwtn, hierarchy_info={'level_1': 'MOH - Uganda', 'level_2': 'Ankole', 'level_3': 'Rwampara District', 'level_4': 'Mwizi Subcounty', 'level_5': None, 'level_6': None}
[DHIS2] Row 1: OU=AJxamlmKn2x, hierarchy_info={'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Amuru District', 'level_4': 'Lamogi Subcounty', 'level_5': 'Keyo Health Centre II', 'level_6': None}
[DHIS2] Row 2: OU=ALL4sSTGBRn, hierarchy_info={'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Gulu District', 'level_4': 'Owalo Subcounty', 'level_5': None, 'level_6': None}
[DHIS2] Normalized columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized row count: 4437
[DHIS2] First row: ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
[DHIS2] _set_description: original=['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], sanitized=['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], types=['String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String']
[DHIS2] Transformed rows count: 4437
[DHIS2] First transformed row: ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
[DHIS2] Fetched 4437 rows
[DHIS2] fetchall() called - returning 4437 rows
[DHIS2] fetchall() - First row type: <class 'tuple'>
[DHIS2] fetchall() - First row (original): ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
[DHIS2] fetchall() - Column count from description: 14
[DHIS2] fetchall() - First row (fixed types): ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
[DHIS2] fetchall() - Type enforcement: dimensions=STRING, measures=FLOAT
[DHIS2] Executing query: SELECT
  "District",
  "Period",
  "105_EP01b_Malaria_Total"
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "District",
  "Period",
  "105_EP01b_Malaria_Total"
LIMIT 10000
[DHIS2] Parsed endpoint: analytics
[DHIS2] Found params in Flask g for analytics: table=analytics&dx=JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7
[DHIS2] Query params: {'table': 'analytics', 'dx': 'JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX', 'pe': 'LAST_5_YEARS', 'ou': 'F1o6qBSx783;SUvODYOcaVf', 'ouMode': 'DESCENDANTS'}
[DHIS2] Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dx': 'JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX', 'pe': 'LAST_5_YEARS', 'ou': 'F1o6qBSx783;SUvODYOcaVf', 'ouMode': 'DESCENDANTS'}
[DHIS2] Using all_levels scope: ['LEVEL-3', 'LEVEL-4', 'LEVEL-5']
[DHIS2] ðŸ”„ CACHE MISS - API request URL: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&dimension=pe:LAST_5_YEARS&dimension=ou:F1o6qBSx783;SUvODYOcaVf;LEVEL-3;LEVEL-4;LEVEL-5
[DHIS2] Raw API response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Raw DHIS2 rows count: 22727
[DHIS2] First raw row: ['JhvC7ZR9hUe', '2022', 'C0RSe3EWBqU', '246166']
[DHIS2] âœ… Cached response for analytics (API took 5308.2ms)
[DHIS2] Parsing response for endpoint: analytics
[DHIS2] Response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Response sample: {'headers': [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}], 'metaDat
[DHIS2] Using WIDE/PIVOTED format (Period, Level_1_Name, Level_2_Name, ..., DX1, DX2, ...) for analytics
[DHIS2] Analytics headers: [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}]2025-12-18 14:29:31,426:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] _fetch_org_unit_hierarchy: Fetching 1142 unique org units in batches...
2025-12-18 14:29:55,327:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:29:55] "PUT /api/v1/explore/form_data/ULWSeaI5Yyo?tab_id=2 HTTP/1.1" 200 -
2025-12-18 14:29:55,333:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Fetched 1142 org units, found 301 parent IDs
2025-12-18 14:29:55,334:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Iteration 1: Fetching 2 missing parent org units...
2025-12-18 14:29:57,230:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Iteration 2: Fetching 1 missing parent org units...
2025-12-18 14:29:57,371:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:29:57] "PUT /api/v1/explore/form_data/ULWSeaI5Yyo?tab_id=2 HTTP/1.1" 200 -
2025-12-18 14:29:58,108:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total org unit names available: 1145
2025-12-18 14:29:58,121:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Sample hierarchy for a9NzDoLn9kz: {'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Kitgum District', 'level_4': 'Pager Division', 'level_5': None, 'level_6': None}
2025-12-18 14:29:58,121:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] _fetch_org_unit_hierarchy completed: 1142 org units with hierarchy
2025-12-18 14:29:58,122:INFO:superset.db_engine_specs.dhis2_dialect:normalize_analytics called with pivot=True, returning WIDE format
2025-12-18 14:29:58,208:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column construction - data_elements: ['AuAOIfCuBUp', 'BWZFz9RJRPI', 'D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'gHjJrtw9vQX', 'pRZrTLDN7Ge', 'wUDxFVBapIc']
2025-12-18 14:29:58,208:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column names constructed (SANITIZED): ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:29:58,214:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] FIRST ROW CONSTRUCTION:
2025-12-18 14:29:58,215:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   Period (index 0): 2020
2025-12-18 14:29:58,216:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   108-EP01a.2. Malaria Total (Deaths) (index 6): None
2025-12-18 14:29:58,216:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   108-EP01a.1. Malaria Total (Cases) (index 7): 3
2025-12-18 14:29:58,216:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01b. Malaria Total (index 8): 1580
2025-12-18 14:29:58,216:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01a. Suspected fever (index 9): 6695
2025-12-18 14:29:58,218:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01d. Malaria cases treated (index 10): 1560
2025-12-18 14:29:58,218:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   108-EP01b.2. Malaria Confirmed (Microscopic &RDT) (Deaths) (index 11): None
2025-12-18 14:29:58,218:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   108-EP01b.1. Malaria Confirmed (Microscopic &RDT) (Cases) (index 12): 3
2025-12-18 14:29:58,218:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01c. Malaria Confirmed (B/s and RDT Positive) (index 13): 1579
2025-12-18 14:29:58,255:INFO:superset.db_engine_specs.dhis2_dialect:First pivoted row - Period: '2020'
2025-12-18 14:29:58,256:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total pivoted rows: 4437, columns: 14
2025-12-18 14:29:58,260:INFO:superset.db_engine_specs.dhis2_dialect:Normalized 4437 rows with 14 columns for endpoint analytics
2025-12-18 14:29:58,261:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API returned 4437 rows
2025-12-18 14:29:58,301:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() - Row count: 4437
2025-12-18 14:29:58,301:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:29:58,302:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names length: 14
2025-12-18 14:29:58,302:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values count: 14
2025-12-18 14:29:58,302:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values: ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
2025-12-18 14:29:58,302:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 0 (Period): 2020 -> 2020 (STRING)
2025-12-18 14:29:58,302:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (National): 'MOH - Uganda...' -> STRING (non-numeric detected)
2025-12-18 14:29:58,302:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (National): MOH - Uganda (PROCESSED)
2025-12-18 14:29:58,302:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (Region): 'Ankole...' -> STRING (non-numeric detected)
2025-12-18 14:29:58,302:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (Region): Ankole (PROCESSED)
2025-12-18 14:29:58,302:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (District): 'Rwampara District...' -> STRING (non-numeric detected)
2025-12-18 14:29:58,302:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (District): Rwampara District (PROCESSED)
2025-12-18 14:29:58,302:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (Sub_County_Town_Council_Div): 'Mwizi Subcounty...' -> STRING (non-numeric detected)
2025-12-18 14:29:58,302:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (Sub_County_Town_Council_Div): Mwizi Subcounty (PROCESSED)
2025-12-18 14:29:58,335:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() returning 4437 rows with 14 columns each
2025-12-18 14:29:58,335:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Got 4437 rows from cursor
2025-12-18 14:29:58,335:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: First row: ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
2025-12-18 14:29:58,335:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:29:58,336:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Types from cursor: ['String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String']
2025-12-18 14:29:58,360:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: DataFrame created with 4437 rows, 14 columns
2025-12-18 14:29:58,360:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:29:58,362:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes BEFORE fix: {'Period': dtype('O'), 'National': dtype('O'), 'Region': dtype('O'), 'District': dtype('O'), 'Sub_County_Town_Council_Div': dtype('O'), 'Health_Facility': dtype('O'), '108_EP01a_2_Malaria_Total_Deaths': dtype('O'), '108_EP01a_1_Malaria_Total_Cases': dtype('O'), '105_EP01b_Malaria_Total': dtype('O'), '105_EP01a_Suspected_fever': dtype('O'), '105_EP01d_Malaria_cases_treated': dtype('O'), '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths': dtype('O'), '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases': dtype('O'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('O')}
2025-12-18 14:29:58,375:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Period' to object dtype (dimension)
2025-12-18 14:29:58,377:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'National' as dimension (contains non-numeric string: 'MOH - Uganda...')
2025-12-18 14:29:58,378:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'National' to object dtype (dimension)
2025-12-18 14:29:58,380:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'Region' as dimension (contains non-numeric string: 'Ankole...')
2025-12-18 14:29:58,380:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Region' to object dtype (dimension)
2025-12-18 14:29:58,381:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'District' as dimension (contains non-numeric string: 'Rwampara District...')
2025-12-18 14:29:58,381:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'District' to object dtype (dimension)
2025-12-18 14:29:58,382:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'Sub_County_Town_Council_Div' as dimension (contains non-numeric string: 'Mwizi Subcounty...')
2025-12-18 14:29:58,383:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Sub_County_Town_Council_Div' to object dtype (dimension)
2025-12-18 14:29:58,383:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'Health_Facility' as dimension (contains non-numeric string: 'Keyo Health Centre II...')
2025-12-18 14:29:58,383:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Health_Facility' to object dtype (dimension)
2025-12-18 14:29:58,387:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes AFTER fix: {'Period': dtype('O'), 'National': dtype('O'), 'Region': dtype('O'), 'District': dtype('O'), 'Sub_County_Town_Council_Div': dtype('O'), 'Health_Facility': dtype('O'), '108_EP01a_2_Malaria_Total_Deaths': dtype('O'), '108_EP01a_1_Malaria_Total_Cases': dtype('O'), '105_EP01b_Malaria_Total': dtype('O'), '105_EP01a_Suspected_fever': dtype('O'), '105_EP01d_Malaria_cases_treated': dtype('O'), '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths': dtype('O'), '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases': dtype('O'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('O')}
2025-12-18 14:29:58,387:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: First row: {'Period': '2020', 'National': 'MOH - Uganda', 'Region': 'Ankole', 'District': 'Rwampara District', 'Sub_County_Town_Council_Div': 'Mwizi Subcounty', 'Health_Facility': None, '108_EP01a_2_Malaria_Total_Deaths': None, '108_EP01a_1_Malaria_Total_Cases': 3, '105_EP01b_Malaria_Total': 1580, '105_EP01a_Suspected_fever': 6695, '105_EP01d_Malaria_cases_treated': 1560, '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths': None, '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases': 3, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 1579}
2025-12-18 14:29:58,398:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] BEFORE assign_column_label:
2025-12-18 14:29:58,399:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4437, 14)
2025-12-18 14:29:58,399:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:29:58,399:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['District', 'Period', '105_EP01b_Malaria_Total']
2025-12-18 14:29:58,399:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: False
2025-12-18 14:29:58,399:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Period': '2020', 'National': 'MOH - Uganda', 'Region': 'Ankole', 'District': 'Rwampara District', 'Sub_County_Town_Council_Div': 'Mwizi Subcounty', 'Health_Facility': None, '108_EP01a_2_Malaria_Total_Deaths': None, '108_EP01a_1_Malaria_Total_Cases': 3, '105_EP01b_Malaria_Total': 1580, '105_EP01a_Suspected_fever': 6695, '105_EP01d_Malaria_cases_treated': 1560, '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths': None, '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases': 3, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 1579}
2025-12-18 14:29:58,400:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Column truncation needed: df has 14 columns, expected 3
2025-12-18 14:29:58,400:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   DataFrame actual columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:29:58,400:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Expected columns: ['District', 'Period', '105_EP01b_Malaria_Total']
2025-12-18 14:29:58,400:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] âœ“ Selecting columns BY NAME (matched all expected columns)
2025-12-18 14:29:58,401:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Column mapping: {'District': 'District', 'Period': 'Period', '105_EP01b_Malaria_Total': '105_EP01b_Malaria_Total'}
2025-12-18 14:29:58,403:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] Column Selection âœ“ SUCCESS - method=BY_NAME, datasource=analytics 20251217-3246
2025-12-18 14:29:58,403:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['District', 'Period', '105_EP01b_Malaria_Total']
2025-12-18 14:29:58,403:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   tried_by_name=True, success=True, fallback=False
2025-12-18 14:29:58,403:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Assigning column labels: ['District', 'Period', '105_EP01b_Malaria_Total']
2025-12-18 14:29:58,403:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] AFTER assign_column_label:
2025-12-18 14:29:58,403:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4437, 3)
2025-12-18 14:29:58,403:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['District', 'Period', '105_EP01b_Malaria_Total']
2025-12-18 14:29:58,403:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['District', 'Period', '105_EP01b_Malaria_Total']
2025-12-18 14:29:58,403:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: True
2025-12-18 14:29:58,405:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'District': 'Rwampara District', 'Period': '2020', '105_EP01b_Malaria_Total': 1580}
2025-12-18 14:29:58,519:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:29:58] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-18 14:30:04,184:WARNING:superset.common.query_object:The field `groupby` is deprecated, please use `columns` instead.
2025-12-18 14:30:04,184:WARNING:superset.common.query_object:The field `columns` is already populated, replacing value with contents from `groupby`.
2025-12-18 14:30:04,306:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:30:04] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-18 14:30:04,753:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:30:04] "PUT /api/v1/explore/form_data/ULWSeaI5Yyo?tab_id=2 HTTP/1.1" 200 -
2025-12-18 14:30:05,374:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:30:05] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 14:30:08,344:WARNING:superset.common.query_object:The field `groupby` is deprecated, please use `columns` instead.
2025-12-18 14:30:08,345:WARNING:superset.common.query_object:The field `columns` is already populated, replacing value with contents from `groupby`.
2025-12-18 14:30:08,389:ERROR:superset.models.helpers:[METRICS-TRACE] Processing 1 metrics
2025-12-18 14:30:08,389:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 0: DHIS2 raw column - 105_EP01b_Malaria_Total
2025-12-18 14:30:08,391:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: 105_EP01b_Malaria_Total
2025-12-18 14:30:08,391:ERROR:superset.models.helpers:[METRICS-TRACE] Total metrics added: 1
2025-12-18 14:30:08,394:ERROR:superset.models.helpers:[METRICS-TRACE] Before dedup: 3 select_exprs + 1 metrics_exprs
2025-12-18 14:30:08,395:ERROR:superset.models.helpers:[METRICS-TRACE] After dedup: 3 total select_exprs
2025-12-18 14:30:08,395:INFO:superset.models.helpers:[COLUMN_TRACE] SQL Query Building:
2025-12-18 14:30:08,395:INFO:superset.models.helpers:[COLUMN_TRACE]   columns: ['District', 'Period', '105_EP01b_Malaria_Total']
2025-12-18 14:30:08,395:INFO:superset.models.helpers:[COLUMN_TRACE]   metrics: ['105_EP01b_Malaria_Total']
2025-12-18 14:30:08,395:INFO:superset.models.helpers:[COLUMN_TRACE]   groupby: []
2025-12-18 14:30:08,395:INFO:superset.models.helpers:[COLUMN_TRACE]   labels_expected: ['District', 'Period', '105_EP01b_Malaria_Total']
2025-12-18 14:30:08,395:INFO:superset.models.helpers:[COLUMN_TRACE]   select_exprs count: 3
2025-12-18 14:30:08,395:INFO:superset.models.helpers:[COLUMN_TRACE]     [0] key=District, name=District, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-18 14:30:08,395:INFO:superset.models.helpers:[COLUMN_TRACE]     [1] key=Period, name=Period, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-18 14:30:08,395:INFO:superset.models.helpers:[COLUMN_TRACE]     [2] key=105_EP01b_Malaria_Total, name=105_EP01b_Malaria_Total, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-18 14:30:08,395:INFO:superset.connectors.sqla.models:[DHIS2] get_from_clause for virtual dataset 4: analytics 20251217-3246
2025-12-18 14:30:08,395:INFO:superset.connectors.sqla.models:[DHIS2] Full SQL stored: SELECT * FROM analytics
/* DHIS2: table=analytics&dx=JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&pe=LAST_5_YEARS&ou=F1o6qBSx783;SUvODYOcaVf&ouMode=DESCENDANTS */
2025-12-18 14:30:08,395:INFO:superset.connectors.sqla.models:[DHIS2] Loaded params from extra field: table=analytics&dx=JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&pe=LAST_5_YEARS&ou=F1o6qBSx783;SUvO
2025-12-18 14:30:08,398:INFO:superset.connectors.sqla.models:[DHIS2] Cached params with key: dhis2_params_4_analytics
2025-12-18 14:30:08,399:INFO:superset.connectors.sqla.models:[DHIS2] Stored params in Flask g for DHIS2 table: analytics
2025-12-18 14:30:08,412:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Query execution in connectors/sqla/models.py:
2025-12-18 14:30:08,412:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   SQL (first 500 chars): SELECT "District", "Period", "105_EP01b_Malaria_Total" 
FROM (SELECT * FROM analytics
/* DHIS2: table=analytics&dx=JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&pe=LAST_5_YEARS&ou=F1o6qBSx783;SUvODYOcaVf&ouMode=DESCENDANTS */
) AS virtual_table GROUP BY "District", "Period", "105_EP01b_Malaria_Total"
 LIMIT 10000
2025-12-18 14:30:08,412:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   labels_expected: ['District', 'Period', '105_EP01b_Malaria_Total']
2025-12-18 14:30:08,416:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 connection initialized: https://tests.dhis2.hispuganda.org/hmis/api
2025-12-18 14:30:08,418:INFO:superset.db_engine_specs.dhis2_dialect:Executing DHIS2 query: SELECT
  "District",
  "Period",
  "105_EP01b_Malaria_Total"
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "District",
  "Period",
  "105_EP01b_Malaria_Total"
LIMIT 10000
2025-12-18 14:30:08,419:INFO:superset.db_engine_specs.dhis2_dialect:Parsed endpoint: analytics
2025-12-18 14:30:08,420:INFO:superset.db_engine_specs.dhis2_dialect:Using stored parameters from Flask g for table: analytics
2025-12-18 14:30:08,420:INFO:superset.db_engine_specs.dhis2_dialect:Query params: {'table': 'analytics', 'dx': 'JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX', 'pe': 'LAST_5_YEARS', 'ou': 'F1o6qBSx783;SUvODYOcaVf', 'ouMode': 'DESCENDANTS'}
2025-12-18 14:30:08,420:INFO:superset.db_engine_specs.dhis2_dialect:Period dimension detected - omitting startDate/endDate (DHIS2 API rule)
2025-12-18 14:30:08,420:INFO:superset.db_engine_specs.dhis2_dialect:Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dx': 'JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX', 'pe': 'LAST_5_YEARS', 'ou': 'F1o6qBSx783;SUvODYOcaVf', 'ouMode': 'DESCENDANTS'}
2025-12-18 14:30:09,325:INFO:superset.db_engine_specs.dhis2_dialect:Fetched org unit levels: {3: 'District', 5: 'Health Facility', 1: 'National', 2: 'Region', 4: 'Sub County/Town Council/Div'}
2025-12-18 14:30:10,174:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Using all_levels scope: ['LEVEL-3', 'LEVEL-4', 'LEVEL-5']
2025-12-18 14:30:10,175:INFO:superset.db_engine_specs.dhis2_dialect:Converted dx/pe/ou to dimension parameter: dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX;pe:LAST_5_YEARS;ou:F1o6qBSx783;SUvODYOcaVf;LEVEL-3;LEVEL-4;LEVEL-5
2025-12-18 14:30:10,175:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API request (cache miss): https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&dimension=pe:LAST_5_YEARS&dimension=ou:F1o6qBSx783;SUvODYOcaVf;LEVEL-3;LEVEL-4;LEVEL-5
2025-12-18 14:30:31,972:INFO:superset.db_engine_specs.dhis2_cache:[DHIS2 Cache] SET: analytics (ttl=3600s, key=dhis2:4a1c3321:analytics:5362e2052855...)
2025-12-18 14:30:31,974:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2 Cache] Stored response for analytics

[DHIS2] Found 'ou' column at index 2
[DHIS2] Processing 22727 rows to extract org unit IDs
[DHIS2] Extracted 1142 unique org unit IDs from rows
[DHIS2] Found 1142 unique org units in analytics response
[DHIS2] Fetching hierarchy for 1142 org units...
[DHIS2] _fetch_org_unit_hierarchy: Fetching 1142 unique org units
[DHIS2] Batch 1: Got 50 org units from DHIS2
[DHIS2]   OU: wNunka5Y2uu, name=Acholi-Bur Subcounty, level=4, parent=aBrjuZk0W31
[DHIS2]   OU: FihNC5KfGJV, name=Adilang Subcounty, level=4, parent=ztIyIYAzFKp
[DHIS2]   OU: HSBjlZdFpWn, name=Ajan Subcounty, level=4, parent=aBrjuZk0W31
[DHIS2] Batch 2: Got 50 org units from DHIS2
[DHIS2] Batch 3: Got 50 org units from DHIS2
[DHIS2] Batch 4: Got 50 org units from DHIS2
[DHIS2] Batch 5: Got 50 org units from DHIS2
[DHIS2] Batch 6: Got 50 org units from DHIS2
[DHIS2] Batch 7: Got 50 org units from DHIS2
[DHIS2] Batch 8: Got 50 org units from DHIS2
[DHIS2] Batch 9: Got 50 org units from DHIS2
[DHIS2] Batch 10: Got 50 org units from DHIS2
[DHIS2] Batch 11: Got 50 org units from DHIS2
[DHIS2] Batch 12: Got 50 org units from DHIS2
[DHIS2] Batch 13: Got 50 org units from DHIS2
[DHIS2] Batch 14: Got 50 org units from DHIS2
[DHIS2] Batch 15: Got 50 org units from DHIS2
[DHIS2] Batch 16: Got 50 org units from DHIS2
[DHIS2] Batch 17: Got 50 org units from DHIS2
[DHIS2] Batch 18: Got 50 org units from DHIS2
[DHIS2] Batch 19: Got 50 org units from DHIS2
[DHIS2] Batch 20: Got 50 org units from DHIS2
[DHIS2] Batch 21: Got 50 org units from DHIS2
[DHIS2] Batch 22: Got 50 org units from DHIS2
[DHIS2] Batch 23: Got 42 org units from DHIS2
[DHIS2] Total org unit names available: 1145 after 2 iterations
[DHIS2] Sample hierarchy for a9NzDoLn9kz: {'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Kitgum District', 'level_4': 'Pager Division', 'level_5': None, 'level_6': None}
[DHIS2]   a9NzDoLn9kz: filled levels = ['level_1', 'level_2', 'level_3', 'level_4']
[DHIS2]   aFgrVHVDqoZ: filled levels = ['level_1', 'level_2', 'level_3', 'level_4', 'level_5']
[DHIS2]   fxHApp8UtpE: filled levels = ['level_1', 'level_2', 'level_3', 'level_4', 'level_5']
[DHIS2] Fetched hierarchy for 1142 org units
[DHIS2] Sample hierarchy for a9NzDoLn9kz: {'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Kitgum District', 'level_4': 'Pager Division', 'level_5': None, 'level_6': None}
[DHIS2] Calling DHIS2ResponseNormalizer.normalize with:
[DHIS2]   - endpoint: analytics
[DHIS2]   - pivot: True
[DHIS2]   - org_unit_hierarchy: 1142 entries
[DHIS2]   - org_unit_level_names: {3: 'District', 5: 'Health Facility', 1: 'National', 2: 'Region', 4: 'Sub County/Town Council/Div'}
[DHIS2] normalize_analytics: pivot=True, using WIDE/PIVOTED format
[DHIS2] PIVOT CONSTRUCTION:
[DHIS2]   data_elements (UIDs): ['AuAOIfCuBUp', 'BWZFz9RJRPI', 'D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'gHjJrtw9vQX', 'pRZrTLDN7Ge', 'wUDxFVBapIc']
[DHIS2]   data_element_list (sorted UIDs): ['AuAOIfCuBUp', 'BWZFz9RJRPI', 'D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'gHjJrtw9vQX', 'pRZrTLDN7Ge', 'wUDxFVBapIc']
[DHIS2]   col_names (SANITIZED): ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Row 0: OU=AA8TRyfTwtn, hierarchy_info={'level_1': 'MOH - Uganda', 'level_2': 'Ankole', 'level_3': 'Rwampara District', 'level_4': 'Mwizi Subcounty', 'level_5': None, 'level_6': None}
[DHIS2] Row 1: OU=AJxamlmKn2x, hierarchy_info={'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Amuru District', 'level_4': 'Lamogi Subcounty', 'level_5': 'Keyo Health Centre II', 'level_6': None}
[DHIS2] Row 2: OU=ALL4sSTGBRn, hierarchy_info={'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Gulu District', 'level_4': 'Owalo Subcounty', 'level_5': None, 'level_6': None}
[DHIS2] Normalized columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized row count: 4437
[DHIS2] First row: ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
[DHIS2] _set_description: original=['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], sanitized=['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], types=['String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String']
[DHIS2] Transformed rows count: 4437
[DHIS2] First transformed row: ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
[DHIS2] Fetched 4437 rows
[DHIS2] fetchall() called - returning 4437 rows
[DHIS2] fetchall() - First row type: <class 'tuple'>
[DHIS2] fetchall() - First row (original): ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
[DHIS2] fetchall() - Column count from description: 14
[DHIS2] fetchall() - First row (fixed types): ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
[DHIS2] fetchall() - Type enforcement: dimensions=STRING, measures=FLOAT
[DHIS2] Executing query: SELECT
  "District",
  "Period",
  "105_EP01b_Malaria_Total"
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "District",
  "Period",
  "105_EP01b_Malaria_Total"
LIMIT 10000
[DHIS2] Parsed endpoint: analytics
[DHIS2] Found params in Flask g for analytics: table=analytics&dx=JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7
[DHIS2] Query params: {'table': 'analytics', 'dx': 'JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX', 'pe': 'LAST_5_YEARS', 'ou': 'F1o6qBSx783;SUvODYOcaVf', 'ouMode': 'DESCENDANTS'}
[DHIS2] Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dx': 'JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX', 'pe': 'LAST_5_YEARS', 'ou': 'F1o6qBSx783;SUvODYOcaVf', 'ouMode': 'DESCENDANTS'}
[DHIS2] Using all_levels scope: ['LEVEL-3', 'LEVEL-4', 'LEVEL-5']
[DHIS2] ðŸ”„ CACHE MISS - API request URL: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&dimension=pe:LAST_5_YEARS&dimension=ou:F1o6qBSx783;SUvODYOcaVf;LEVEL-3;LEVEL-4;LEVEL-5
[DHIS2] Raw API response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Raw DHIS2 rows count: 22727
[DHIS2] First raw row: ['JhvC7ZR9hUe', '2022', 'C0RSe3EWBqU', '246166']
[DHIS2] âœ… Cached response for analytics (API took 23523.4ms)
[DHIS2] Parsing response for endpoint: analytics
[DHIS2] Response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']2025-12-18 14:30:31,999:INFO:superset.db_engine_specs.dhis2_dialect:Using wide/pivoted format for analytics
2025-12-18 14:30:35,470:INFO:superset.db_engine_specs.dhis2_dialect:Fetched org unit levels: {3: 'District', 5: 'Health Facility', 1: 'National', 2: 'Region', 4: 'Sub County/Town Council/Div'}
2025-12-18 14:30:35,479:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] _fetch_org_unit_hierarchy: Fetching 1142 unique org units in batches...
2025-12-18 14:31:03,979:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Fetched 1142 org units, found 301 parent IDs
2025-12-18 14:31:03,980:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Iteration 1: Fetching 2 missing parent org units...
2025-12-18 14:31:05,019:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Iteration 2: Fetching 1 missing parent org units...
2025-12-18 14:31:06,066:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total org unit names available: 1145
2025-12-18 14:31:06,078:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Sample hierarchy for a9NzDoLn9kz: {'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Kitgum District', 'level_4': 'Pager Division', 'level_5': None, 'level_6': None}
2025-12-18 14:31:06,078:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] _fetch_org_unit_hierarchy completed: 1142 org units with hierarchy
2025-12-18 14:31:06,080:INFO:superset.db_engine_specs.dhis2_dialect:normalize_analytics called with pivot=True, returning WIDE format
2025-12-18 14:31:06,246:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column construction - data_elements: ['AuAOIfCuBUp', 'BWZFz9RJRPI', 'D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'gHjJrtw9vQX', 'pRZrTLDN7Ge', 'wUDxFVBapIc']
2025-12-18 14:31:06,246:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column names constructed (SANITIZED): ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:31:06,249:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] FIRST ROW CONSTRUCTION:
2025-12-18 14:31:06,249:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   Period (index 0): 2020
2025-12-18 14:31:06,250:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   108-EP01a.2. Malaria Total (Deaths) (index 6): None
2025-12-18 14:31:06,251:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   108-EP01a.1. Malaria Total (Cases) (index 7): 3
2025-12-18 14:31:06,251:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01b. Malaria Total (index 8): 1580
2025-12-18 14:31:06,251:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01a. Suspected fever (index 9): 6695
2025-12-18 14:31:06,251:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01d. Malaria cases treated (index 10): 1560
2025-12-18 14:31:06,251:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   108-EP01b.2. Malaria Confirmed (Microscopic &RDT) (Deaths) (index 11): None
2025-12-18 14:31:06,251:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   108-EP01b.1. Malaria Confirmed (Microscopic &RDT) (Cases) (index 12): 3
2025-12-18 14:31:06,251:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01c. Malaria Confirmed (B/s and RDT Positive) (index 13): 1579
2025-12-18 14:31:06,284:INFO:superset.db_engine_specs.dhis2_dialect:First pivoted row - Period: '2020'
2025-12-18 14:31:06,285:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total pivoted rows: 4437, columns: 14
2025-12-18 14:31:06,291:INFO:superset.db_engine_specs.dhis2_dialect:Normalized 4437 rows with 14 columns for endpoint analytics
2025-12-18 14:31:06,292:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API returned 4437 rows
2025-12-18 14:31:06,373:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() - Row count: 4437
2025-12-18 14:31:06,373:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:31:06,373:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names length: 14
2025-12-18 14:31:06,373:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values count: 14
2025-12-18 14:31:06,373:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values: ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
2025-12-18 14:31:06,373:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 0 (Period): 2020 -> 2020 (STRING)
2025-12-18 14:31:06,373:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (National): 'MOH - Uganda...' -> STRING (non-numeric detected)
2025-12-18 14:31:06,373:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (National): MOH - Uganda (PROCESSED)
2025-12-18 14:31:06,373:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (Region): 'Ankole...' -> STRING (non-numeric detected)
2025-12-18 14:31:06,373:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (Region): Ankole (PROCESSED)
2025-12-18 14:31:06,373:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (District): 'Rwampara District...' -> STRING (non-numeric detected)
2025-12-18 14:31:06,373:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (District): Rwampara District (PROCESSED)
2025-12-18 14:31:06,373:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (Sub_County_Town_Council_Div): 'Mwizi Subcounty...' -> STRING (non-numeric detected)
2025-12-18 14:31:06,373:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (Sub_County_Town_Council_Div): Mwizi Subcounty (PROCESSED)
2025-12-18 14:31:06,393:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() returning 4437 rows with 14 columns each
2025-12-18 14:31:06,393:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Got 4437 rows from cursor
2025-12-18 14:31:06,393:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: First row: ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
2025-12-18 14:31:06,393:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:31:06,393:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Types from cursor: ['String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String']
2025-12-18 14:31:06,419:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: DataFrame created with 4437 rows, 14 columns
2025-12-18 14:31:06,419:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:31:06,421:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes BEFORE fix: {'Period': dtype('O'), 'National': dtype('O'), 'Region': dtype('O'), 'District': dtype('O'), 'Sub_County_Town_Council_Div': dtype('O'), 'Health_Facility': dtype('O'), '108_EP01a_2_Malaria_Total_Deaths': dtype('O'), '108_EP01a_1_Malaria_Total_Cases': dtype('O'), '105_EP01b_Malaria_Total': dtype('O'), '105_EP01a_Suspected_fever': dtype('O'), '105_EP01d_Malaria_cases_treated': dtype('O'), '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths': dtype('O'), '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases': dtype('O'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('O')}
2025-12-18 14:31:06,422:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Period' to object dtype (dimension)
2025-12-18 14:31:06,423:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'National' as dimension (contains non-numeric string: 'MOH - Uganda...')
2025-12-18 14:31:06,423:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'National' to object dtype (dimension)
2025-12-18 14:31:06,424:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'Region' as dimension (contains non-numeric string: 'Ankole...')
2025-12-18 14:31:06,424:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Region' to object dtype (dimension)
2025-12-18 14:31:06,424:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'District' as dimension (contains non-numeric string: 'Rwampara District...')
2025-12-18 14:31:06,424:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'District' to object dtype (dimension)
2025-12-18 14:31:06,425:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'Sub_County_Town_Council_Div' as dimension (contains non-numeric string: 'Mwizi Subcounty...')
2025-12-18 14:31:06,425:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Sub_County_Town_Council_Div' to object dtype (dimension)
2025-12-18 14:31:06,426:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'Health_Facility' as dimension (contains non-numeric string: 'Keyo Health Centre II...')
2025-12-18 14:31:06,426:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Health_Facility' to object dtype (dimension)
2025-12-18 14:31:06,429:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes AFTER fix: {'Period': dtype('O'), 'National': dtype('O'), 'Region': dtype('O'), 'District': dtype('O'), 'Sub_County_Town_Council_Div': dtype('O'), 'Health_Facility': dtype('O'), '108_EP01a_2_Malaria_Total_Deaths': dtype('O'), '108_EP01a_1_Malaria_Total_Cases': dtype('O'), '105_EP01b_Malaria_Total': dtype('O'), '105_EP01a_Suspected_fever': dtype('O'), '105_EP01d_Malaria_cases_treated': dtype('O'), '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths': dtype('O'), '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases': dtype('O'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('O')}
2025-12-18 14:31:06,429:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: First row: {'Period': '2020', 'National': 'MOH - Uganda', 'Region': 'Ankole', 'District': 'Rwampara District', 'Sub_County_Town_Council_Div': 'Mwizi Subcounty', 'Health_Facility': None, '108_EP01a_2_Malaria_Total_Deaths': None, '108_EP01a_1_Malaria_Total_Cases': 3, '105_EP01b_Malaria_Total': 1580, '105_EP01a_Suspected_fever': 6695, '105_EP01d_Malaria_cases_treated': 1560, '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths': None, '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases': 3, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 1579}
2025-12-18 14:31:06,446:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] BEFORE assign_column_label:
2025-12-18 14:31:06,446:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4437, 14)
2025-12-18 14:31:06,446:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:31:06,446:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['District', 'Period', '105_EP01b_Malaria_Total']
2025-12-18 14:31:06,446:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: False
2025-12-18 14:31:06,447:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Period': '2020', 'National': 'MOH - Uganda', 'Region': 'Ankole', 'District': 'Rwampara District', 'Sub_County_Town_Council_Div': 'Mwizi Subcounty', 'Health_Facility': None, '108_EP01a_2_Malaria_Total_Deaths': None, '108_EP01a_1_Malaria_Total_Cases': 3, '105_EP01b_Malaria_Total': 1580, '105_EP01a_Suspected_fever': 6695, '105_EP01d_Malaria_cases_treated': 1560, '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths': None, '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases': 3, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 1579}
2025-12-18 14:31:06,447:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Column truncation needed: df has 14 columns, expected 3
2025-12-18 14:31:06,447:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   DataFrame actual columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:31:06,447:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Expected columns: ['District', 'Period', '105_EP01b_Malaria_Total']
2025-12-18 14:31:06,447:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] âœ“ Selecting columns BY NAME (matched all expected columns)
2025-12-18 14:31:06,447:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Column mapping: {'District': 'District', 'Period': 'Period', '105_EP01b_Malaria_Total': '105_EP01b_Malaria_Total'}
2025-12-18 14:31:06,449:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] Column Selection âœ“ SUCCESS - method=BY_NAME, datasource=analytics 20251217-3246
2025-12-18 14:31:06,449:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['District', 'Period', '105_EP01b_Malaria_Total']
2025-12-18 14:31:06,450:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   tried_by_name=True, success=True, fallback=False
2025-12-18 14:31:06,450:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Assigning column labels: ['District', 'Period', '105_EP01b_Malaria_Total']
2025-12-18 14:31:06,450:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] AFTER assign_column_label:
2025-12-18 14:31:06,450:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4437, 3)
2025-12-18 14:31:06,450:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['District', 'Period', '105_EP01b_Malaria_Total']
2025-12-18 14:31:06,450:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['District', 'Period', '105_EP01b_Malaria_Total']
2025-12-18 14:31:06,450:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: True
2025-12-18 14:31:06,450:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'District': 'Rwampara District', 'Period': '2020', '105_EP01b_Malaria_Total': 1580}
2025-12-18 14:31:06,511:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:31:06] "POST /api/v1/chart/data?force=true HTTP/1.1" 200 -
2025-12-18 14:31:07,817:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:31:07] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 14:31:17,360:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:31:17] "PUT /api/v1/explore/form_data/ULWSeaI5Yyo?tab_id=2 HTTP/1.1" 200 -
2025-12-18 14:31:18,785:WARNING:superset.common.query_object:The field `groupby` is deprecated, please use `columns` instead.
2025-12-18 14:31:18,786:WARNING:superset.common.query_object:The field `columns` is already populated, replacing value with contents from `groupby`.
2025-12-18 14:31:18,917:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:31:18] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-18 14:31:19,375:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:31:19] "PUT /api/v1/explore/form_data/ULWSeaI5Yyo?tab_id=2 HTTP/1.1" 200 -
2025-12-18 14:31:20,087:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:31:20] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 14:33:43,408:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:33:43] "PUT /api/v1/explore/form_data/ULWSeaI5Yyo?tab_id=2 HTTP/1.1" 200 -
2025-12-18 14:33:45,650:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:33:45] "PUT /api/v1/explore/form_data/ULWSeaI5Yyo?tab_id=2 HTTP/1.1" 200 -
2025-12-18 14:33:51,097:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:33:51] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 14:33:52,395:WARNING:superset.common.query_object:The field `groupby` is deprecated, please use `columns` instead.
2025-12-18 14:33:52,396:WARNING:superset.common.query_object:The field `groupby` is deprecated, please use `columns` instead.
2025-12-18 14:33:52,396:WARNING:superset.common.query_object:The field `columns` is already populated, replacing value with contents from `groupby`.
2025-12-18 14:33:52,396:WARNING:superset.common.query_object:The field `columns` is already populated, replacing value with contents from `groupby`.
2025-12-18 14:33:52,427:ERROR:superset.models.helpers:[METRICS-TRACE] Processing 1 metrics
2025-12-18 14:33:52,427:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 0: DHIS2 raw column - 105_EP01b_Malaria_Total
2025-12-18 14:33:52,429:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: 105_EP01b_Malaria_Total
2025-12-18 14:33:52,429:ERROR:superset.models.helpers:[METRICS-TRACE] Total metrics added: 1
2025-12-18 14:33:52,432:ERROR:superset.models.helpers:[METRICS-TRACE] Before dedup: 3 select_exprs + 1 metrics_exprs
2025-12-18 14:33:52,434:ERROR:superset.models.helpers:[METRICS-TRACE] After dedup: 3 total select_exprs
2025-12-18 14:33:52,437:INFO:superset.models.helpers:[COLUMN_TRACE] SQL Query Building:
2025-12-18 14:33:52,437:INFO:superset.models.helpers:[COLUMN_TRACE]   columns: ['Region', 'Period', '105_EP01b_Malaria_Total']
2025-12-18 14:33:52,441:INFO:superset.models.helpers:[COLUMN_TRACE]   metrics: ['105_EP01b_Malaria_Total']
2025-12-18 14:33:52,442:INFO:superset.models.helpers:[COLUMN_TRACE]   groupby: []
2025-12-18 14:33:52,442:INFO:superset.models.helpers:[COLUMN_TRACE]   labels_expected: ['Region', 'Period', '105_EP01b_Malaria_Total']
2025-12-18 14:33:52,442:INFO:superset.models.helpers:[COLUMN_TRACE]   select_exprs count: 3
2025-12-18 14:33:52,442:INFO:superset.models.helpers:[COLUMN_TRACE]     [0] key=Region, name=Region, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-18 14:33:52,442:INFO:superset.models.helpers:[COLUMN_TRACE]     [1] key=Period, name=Period, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-18 14:33:52,442:INFO:superset.models.helpers:[COLUMN_TRACE]     [2] key=105_EP01b_Malaria_Total, name=105_EP01b_Malaria_Total, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-18 14:33:52,442:INFO:superset.connectors.sqla.models:[DHIS2] get_from_clause for virtual dataset 4: analytics 20251217-3246
2025-12-18 14:33:52,442:INFO:superset.connectors.sqla.models:[DHIS2] Full SQL stored: SELECT * FROM analytics
/* DHIS2: table=analytics&dx=JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&pe=LAST_5_YEARS&ou=F1o6qBSx783;SUvODYOcaVf&ouMode=DESCENDANTS */
2025-12-18 14:33:52,442:INFO:superset.connectors.sqla.models:[DHIS2] Loaded params from extra field: table=analytics&dx=JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&pe=LAST_5_YEARS&ou=F1o6qBSx783;SUvO
2025-12-18 14:33:52,441:ERROR:superset.models.helpers:[METRICS-TRACE] Processing 1 metrics
2025-12-18 14:33:52,443:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 0: DHIS2 raw column - 105_EP01b_Malaria_Total
2025-12-18 14:33:52,443:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: 105_EP01b_Malaria_Total
2025-12-18 14:33:52,443:ERROR:superset.models.helpers:[METRICS-TRACE] Total metrics added: 1
2025-12-18 14:33:52,444:ERROR:superset.models.helpers:[METRICS-TRACE] Before dedup: 3 select_exprs + 1 metrics_exprs
2025-12-18 14:33:52,444:ERROR:superset.models.helpers:[METRICS-TRACE] After dedup: 3 total select_exprs
2025-12-18 14:33:52,444:INFO:superset.models.helpers:[COLUMN_TRACE] SQL Query Building:
2025-12-18 14:33:52,444:INFO:superset.models.helpers:[COLUMN_TRACE]   columns: ['Region', 'Period', '105_EP01b_Malaria_Total']
2025-12-18 14:33:52,444:INFO:superset.models.helpers:[COLUMN_TRACE]   metrics: ['105_EP01b_Malaria_Total']
2025-12-18 14:33:52,444:INFO:superset.models.helpers:[COLUMN_TRACE]   groupby: []
2025-12-18 14:33:52,444:INFO:superset.models.helpers:[COLUMN_TRACE]   labels_expected: ['Region', 'Period', '105_EP01b_Malaria_Total']
2025-12-18 14:33:52,444:INFO:superset.models.helpers:[COLUMN_TRACE]   select_exprs count: 3
2025-12-18 14:33:52,445:INFO:superset.models.helpers:[COLUMN_TRACE]     [0] key=Region, name=Region, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-18 14:33:52,445:INFO:superset.models.helpers:[COLUMN_TRACE]     [1] key=Period, name=Period, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-18 14:33:52,445:INFO:superset.models.helpers:[COLUMN_TRACE]     [2] key=105_EP01b_Malaria_Total, name=105_EP01b_Malaria_Total, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-18 14:33:52,445:INFO:superset.connectors.sqla.models:[DHIS2] get_from_clause for virtual dataset 4: analytics 20251217-3246
2025-12-18 14:33:52,445:INFO:superset.connectors.sqla.models:[DHIS2] Full SQL stored: SELECT * FROM analytics
/* DHIS2: table=analytics&dx=JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&pe=LAST_5_YEARS&ou=F1o6qBSx783;SUvODYOcaVf&ouMode=DESCENDANTS */
2025-12-18 14:33:52,445:INFO:superset.connectors.sqla.models:[DHIS2] Loaded params from extra field: table=analytics&dx=JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&pe=LAST_5_YEARS&ou=F1o6qBSx783;SUvO
2025-12-18 14:33:52,446:INFO:superset.connectors.sqla.models:[DHIS2] Cached params with key: dhis2_params_4_analytics
2025-12-18 14:33:52,446:INFO:superset.connectors.sqla.models:[DHIS2] Stored params in Flask g for DHIS2 table: analytics
2025-12-18 14:33:52,445:INFO:superset.connectors.sqla.models:[DHIS2] Cached params with key: dhis2_params_4_analytics
2025-12-18 14:33:52,458:INFO:superset.connectors.sqla.models:[DHIS2] Stored params in Flask g for DHIS2 table: analytics
2025-12-18 14:33:52,463:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Query execution in connectors/sqla/models.py:
2025-12-18 14:33:52,463:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   SQL (first 500 chars): SELECT "Region", "Period", "105_EP01b_Malaria_Total" 
FROM (SELECT * FROM analytics
/* DHIS2: table=analytics&dx=JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&pe=LAST_5_YEARS&ou=F1o6qBSx783;SUvODYOcaVf&ouMode=DESCENDANTS */
) AS virtual_table GROUP BY "Region", "Period", "105_EP01b_Malaria_Total"
 LIMIT 10000
2025-12-18 14:33:52,463:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   labels_expected: ['Region', 'Period', '105_EP01b_Malaria_Total']
2025-12-18 14:33:52,468:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 connection initialized: https://tests.dhis2.hispuganda.org/hmis/api
2025-12-18 14:33:52,471:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Query execution in connectors/sqla/models.py:
2025-12-18 14:33:52,473:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   SQL (first 500 chars): SELECT "Region", "Period", "105_EP01b_Malaria_Total" 
FROM (SELECT * FROM analytics
/* DHIS2: table=analytics&dx=JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&pe=LAST_5_YEARS&ou=F1o6qBSx783;SUvODYOcaVf&ouMode=DESCENDANTS */
) AS virtual_table GROUP BY "Region", "Period", "105_EP01b_Malaria_Total"
 LIMIT 10000
2025-12-18 14:33:52,473:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   labels_expected: ['Region', 'Period', '105_EP01b_Malaria_Total']
2025-12-18 14:33:52,472:INFO:superset.db_engine_specs.dhis2_dialect:Executing DHIS2 query: SELECT
  "Region",
  "Period",
  "105_EP01b_Malaria_Total"
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "Region",
  "Period",
  "105_EP01b_Malaria_Total"
LIMIT 10000
2025-12-18 14:33:52,477:INFO:superset.db_engine_specs.dhis2_dialect:Parsed endpoint: analytics
2025-12-18 14:33:52,477:INFO:superset.db_engine_specs.dhis2_dialect:Using stored parameters from Flask g for table: analytics

[DHIS2] Response sample: {'headers': [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}], 'metaDat
[DHIS2] Using WIDE/PIVOTED format (Period, Level_1_Name, Level_2_Name, ..., DX1, DX2, ...) for analytics
[DHIS2] Analytics headers: [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}]
[DHIS2] Found 'ou' column at index 2
[DHIS2] Processing 22727 rows to extract org unit IDs
[DHIS2] Extracted 1142 unique org unit IDs from rows
[DHIS2] Found 1142 unique org units in analytics response
[DHIS2] Fetching hierarchy for 1142 org units...
[DHIS2] _fetch_org_unit_hierarchy: Fetching 1142 unique org units
[DHIS2] Batch 1: Got 50 org units from DHIS2
[DHIS2]   OU: wNunka5Y2uu, name=Acholi-Bur Subcounty, level=4, parent=aBrjuZk0W31
[DHIS2]   OU: FihNC5KfGJV, name=Adilang Subcounty, level=4, parent=ztIyIYAzFKp
[DHIS2]   OU: HSBjlZdFpWn, name=Ajan Subcounty, level=4, parent=aBrjuZk0W31
[DHIS2] Batch 2: Got 50 org units from DHIS2
[DHIS2] Batch 3: Got 50 org units from DHIS2
[DHIS2] Batch 4: Got 50 org units from DHIS2
[DHIS2] Batch 5: Got 50 org units from DHIS2
[DHIS2] Batch 6: Got 50 org units from DHIS2
[DHIS2] Batch 7: Got 50 org units from DHIS2
[DHIS2] Batch 8: Got 50 org units from DHIS2
[DHIS2] Batch 9: Got 50 org units from DHIS2
[DHIS2] Batch 10: Got 50 org units from DHIS2
[DHIS2] Batch 11: Got 50 org units from DHIS2
[DHIS2] Batch 12: Got 50 org units from DHIS2
[DHIS2] Batch 13: Got 50 org units from DHIS2
[DHIS2] Batch 14: Got 50 org units from DHIS2
[DHIS2] Batch 15: Got 50 org units from DHIS2
[DHIS2] Batch 16: Got 50 org units from DHIS2
[DHIS2] Batch 17: Got 50 org units from DHIS2
[DHIS2] Batch 18: Got 50 org units from DHIS2
[DHIS2] Batch 19: Got 50 org units from DHIS2
[DHIS2] Batch 20: Got 50 org units from DHIS2
[DHIS2] Batch 21: Got 50 org units from DHIS2
[DHIS2] Batch 22: Got 50 org units from DHIS2
[DHIS2] Batch 23: Got 42 org units from DHIS2
[DHIS2] Total org unit names available: 1145 after 2 iterations
[DHIS2] Sample hierarchy for a9NzDoLn9kz: {'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Kitgum District', 'level_4': 'Pager Division', 'level_5': None, 'level_6': None}
[DHIS2]   a9NzDoLn9kz: filled levels = ['level_1', 'level_2', 'level_3', 'level_4']
[DHIS2]   aFgrVHVDqoZ: filled levels = ['level_1', 'level_2', 'level_3', 'level_4', 'level_5']
[DHIS2]   fxHApp8UtpE: filled levels = ['level_1', 'level_2', 'level_3', 'level_4', 'level_5']
[DHIS2] Fetched hierarchy for 1142 org units
[DHIS2] Sample hierarchy for a9NzDoLn9kz: {'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Kitgum District', 'level_4': 'Pager Division', 'level_5': None, 'level_6': None}
[DHIS2] Calling DHIS2ResponseNormalizer.normalize with:
[DHIS2]   - endpoint: analytics
[DHIS2]   - pivot: True
[DHIS2]   - org_unit_hierarchy: 1142 entries
[DHIS2]   - org_unit_level_names: {3: 'District', 5: 'Health Facility', 1: 'National', 2: 'Region', 4: 'Sub County/Town Council/Div'}
[DHIS2] normalize_analytics: pivot=True, using WIDE/PIVOTED format
[DHIS2] PIVOT CONSTRUCTION:
[DHIS2]   data_elements (UIDs): ['AuAOIfCuBUp', 'BWZFz9RJRPI', 'D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'gHjJrtw9vQX', 'pRZrTLDN7Ge', 'wUDxFVBapIc']
[DHIS2]   data_element_list (sorted UIDs): ['AuAOIfCuBUp', 'BWZFz9RJRPI', 'D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'gHjJrtw9vQX', 'pRZrTLDN7Ge', 'wUDxFVBapIc']
[DHIS2]   col_names (SANITIZED): ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Row 0: OU=AA8TRyfTwtn, hierarchy_info={'level_1': 'MOH - Uganda', 'level_2': 'Ankole', 'level_3': 'Rwampara District', 'level_4': 'Mwizi Subcounty', 'level_5': None, 'level_6': None}
[DHIS2] Row 1: OU=AJxamlmKn2x, hierarchy_info={'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Amuru District', 'level_4': 'Lamogi Subcounty', 'level_5': 'Keyo Health Centre II', 'level_6': None}
[DHIS2] Row 2: OU=ALL4sSTGBRn, hierarchy_info={'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Gulu District', 'level_4': 'Owalo Subcounty', 'level_5': None, 'level_6': None}
[DHIS2] Normalized columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized row count: 4437
[DHIS2] First row: ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
[DHIS2] _set_description: original=['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], sanitized=['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], types=['String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String']
[DHIS2] Transformed rows count: 4437
[DHIS2] First transformed row: ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
[DHIS2] Fetched 4437 rows
[DHIS2] fetchall() called - returning 4437 rows
[DHIS2] fetchall() - First row type: <class 'tuple'>
[DHIS2] fetchall() - First row (original): ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
[DHIS2] fetchall() - Column count from description: 14
[DHIS2] fetchall() - First row (fixed types): ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
[DHIS2] fetchall() - Type enforcement: dimensions=STRING, measures=FLOAT
[DHIS2] Executing query: SELECT
  "Region",
  "Period",
  "105_EP01b_Malaria_Total"
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "Region",
  "Period",
  "105_EP01b_Malaria_Total"
LIMIT 10000
[DHIS2] Parsed endpoint: analytics
[DHIS2] Found params in Flask g for analytics: table=analytics&dx=JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7
[DHIS2] Query params: {'table': 'analytics', 'dx': 'JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX', 'pe': 'LAST_5_YEARS', 'ou': 'F1o6qBSx783;SUvODYOcaVf', 'ouMode': 'DESCENDANTS'}2025-12-18 14:33:52,477:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 connection initialized: https://tests.dhis2.hispuganda.org/hmis/api
2025-12-18 14:33:52,478:INFO:superset.db_engine_specs.dhis2_dialect:Query params: {'table': 'analytics', 'dx': 'JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX', 'pe': 'LAST_5_YEARS', 'ou': 'F1o6qBSx783;SUvODYOcaVf', 'ouMode': 'DESCENDANTS'}
2025-12-18 14:33:52,518:INFO:superset.db_engine_specs.dhis2_dialect:Period dimension detected - omitting startDate/endDate (DHIS2 API rule)
2025-12-18 14:33:52,527:INFO:superset.db_engine_specs.dhis2_dialect:Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dx': 'JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX', 'pe': 'LAST_5_YEARS', 'ou': 'F1o6qBSx783;SUvODYOcaVf', 'ouMode': 'DESCENDANTS'}
2025-12-18 14:33:52,527:INFO:superset.db_engine_specs.dhis2_dialect:Executing DHIS2 query: SELECT
  "Region",
  "Period",
  "105_EP01b_Malaria_Total"
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "Region",
  "Period",
  "105_EP01b_Malaria_Total"
LIMIT 10000
2025-12-18 14:33:52,542:INFO:superset.db_engine_specs.dhis2_dialect:Parsed endpoint: analytics
2025-12-18 14:33:52,558:INFO:superset.db_engine_specs.dhis2_dialect:Using stored parameters from Flask g for table: analytics
2025-12-18 14:33:52,569:INFO:superset.db_engine_specs.dhis2_dialect:Query params: {'table': 'analytics', 'dx': 'JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX', 'pe': 'LAST_5_YEARS', 'ou': 'F1o6qBSx783;SUvODYOcaVf', 'ouMode': 'DESCENDANTS'}
2025-12-18 14:33:52,575:INFO:superset.db_engine_specs.dhis2_dialect:Period dimension detected - omitting startDate/endDate (DHIS2 API rule)
2025-12-18 14:33:52,575:INFO:superset.db_engine_specs.dhis2_dialect:Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dx': 'JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX', 'pe': 'LAST_5_YEARS', 'ou': 'F1o6qBSx783;SUvODYOcaVf', 'ouMode': 'DESCENDANTS'}
2025-12-18 14:33:53,170:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:33:53] "PUT /api/v1/explore/form_data/ULWSeaI5Yyo?tab_id=2 HTTP/1.1" 200 -
2025-12-18 14:33:53,596:INFO:superset.db_engine_specs.dhis2_dialect:Fetched org unit levels: {3: 'District', 5: 'Health Facility', 1: 'National', 2: 'Region', 4: 'Sub County/Town Council/Div'}
2025-12-18 14:33:54,494:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Using all_levels scope: ['LEVEL-3', 'LEVEL-4', 'LEVEL-5']
2025-12-18 14:33:54,513:INFO:superset.db_engine_specs.dhis2_dialect:Converted dx/pe/ou to dimension parameter: dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX;pe:LAST_5_YEARS;ou:F1o6qBSx783;SUvODYOcaVf;LEVEL-3;LEVEL-4;LEVEL-5
2025-12-18 14:33:54,514:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API request (cache miss): https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&dimension=pe:LAST_5_YEARS&dimension=ou:F1o6qBSx783;SUvODYOcaVf;LEVEL-3;LEVEL-4;LEVEL-5
2025-12-18 14:33:55,045:INFO:superset.db_engine_specs.dhis2_dialect:Fetched org unit levels: {3: 'District', 5: 'Health Facility', 1: 'National', 2: 'Region', 4: 'Sub County/Town Council/Div'}
2025-12-18 14:33:55,957:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Using all_levels scope: ['LEVEL-3', 'LEVEL-4', 'LEVEL-5']
2025-12-18 14:33:55,957:INFO:superset.db_engine_specs.dhis2_dialect:Converted dx/pe/ou to dimension parameter: dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX;pe:LAST_5_YEARS;ou:F1o6qBSx783;SUvODYOcaVf;LEVEL-3;LEVEL-4;LEVEL-5
2025-12-18 14:33:55,957:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API request (cache miss): https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&dimension=pe:LAST_5_YEARS&dimension=ou:F1o6qBSx783;SUvODYOcaVf;LEVEL-3;LEVEL-4;LEVEL-5
2025-12-18 14:34:16,830:INFO:superset.db_engine_specs.dhis2_cache:[DHIS2 Cache] SET: analytics (ttl=3600s, key=dhis2:4a1c3321:analytics:5362e2052855...)
2025-12-18 14:34:16,831:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2 Cache] Stored response for analytics
2025-12-18 14:34:16,846:INFO:superset.db_engine_specs.dhis2_dialect:Using wide/pivoted format for analytics
2025-12-18 14:34:17,690:INFO:superset.db_engine_specs.dhis2_dialect:Fetched org unit levels: {3: 'District', 5: 'Health Facility', 1: 'National', 2: 'Region', 4: 'Sub County/Town Council/Div'}
2025-12-18 14:34:17,693:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] _fetch_org_unit_hierarchy: Fetching 1142 unique org units in batches...
2025-12-18 14:34:27,491:INFO:superset.db_engine_specs.dhis2_cache:[DHIS2 Cache] SET: analytics (ttl=3600s, key=dhis2:4a1c3321:analytics:5362e2052855...)
2025-12-18 14:34:27,492:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2 Cache] Stored response for analytics
2025-12-18 14:34:27,504:INFO:superset.db_engine_specs.dhis2_dialect:Using wide/pivoted format for analytics
2025-12-18 14:34:28,381:INFO:superset.db_engine_specs.dhis2_dialect:Fetched org unit levels: {3: 'District', 5: 'Health Facility', 1: 'National', 2: 'Region', 4: 'Sub County/Town Council/Div'}
2025-12-18 14:34:28,384:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] _fetch_org_unit_hierarchy: Fetching 1142 unique org units in batches...
2025-12-18 14:34:39,337:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Fetched 1142 org units, found 301 parent IDs
2025-12-18 14:34:39,337:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Iteration 1: Fetching 2 missing parent org units...
2025-12-18 14:34:41,174:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Iteration 2: Fetching 1 missing parent org units...
2025-12-18 14:34:41,985:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total org unit names available: 1145

[DHIS2] Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dx': 'JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX', 'pe': 'LAST_5_YEARS', 'ou': 'F1o6qBSx783;SUvODYOcaVf', 'ouMode': 'DESCENDANTS'}
[DHIS2] Executing query: SELECT
  "Region",
  "Period",
  "105_EP01b_Malaria_Total"
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "Region",
  "Period",
  "105_EP01b_Malaria_Total"
LIMIT 10000
[DHIS2] Parsed endpoint: analytics
[DHIS2] Found params in Flask g for analytics: table=analytics&dx=JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7
[DHIS2] Query params: {'table': 'analytics', 'dx': 'JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX', 'pe': 'LAST_5_YEARS', 'ou': 'F1o6qBSx783;SUvODYOcaVf', 'ouMode': 'DESCENDANTS'}
[DHIS2] Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dx': 'JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX', 'pe': 'LAST_5_YEARS', 'ou': 'F1o6qBSx783;SUvODYOcaVf', 'ouMode': 'DESCENDANTS'}
[DHIS2] Using all_levels scope: ['LEVEL-3', 'LEVEL-4', 'LEVEL-5']
[DHIS2] ðŸ”„ CACHE MISS - API request URL: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&dimension=pe:LAST_5_YEARS&dimension=ou:F1o6qBSx783;SUvODYOcaVf;LEVEL-3;LEVEL-4;LEVEL-5
[DHIS2] Using all_levels scope: ['LEVEL-3', 'LEVEL-4', 'LEVEL-5']
[DHIS2] ðŸ”„ CACHE MISS - API request URL: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&dimension=pe:LAST_5_YEARS&dimension=ou:F1o6qBSx783;SUvODYOcaVf;LEVEL-3;LEVEL-4;LEVEL-5
[DHIS2] Raw API response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Raw DHIS2 rows count: 22727
[DHIS2] First raw row: ['JhvC7ZR9hUe', '2022', 'C0RSe3EWBqU', '246166']
[DHIS2] âœ… Cached response for analytics (API took 24275.0ms)
[DHIS2] Parsing response for endpoint: analytics
[DHIS2] Response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Response sample: {'headers': [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}], 'metaDat
[DHIS2] Using WIDE/PIVOTED format (Period, Level_1_Name, Level_2_Name, ..., DX1, DX2, ...) for analytics
[DHIS2] Analytics headers: [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}]
[DHIS2] Found 'ou' column at index 2
[DHIS2] Processing 22727 rows to extract org unit IDs
[DHIS2] Extracted 1142 unique org unit IDs from rows
[DHIS2] Found 1142 unique org units in analytics response
[DHIS2] Fetching hierarchy for 1142 org units...
[DHIS2] _fetch_org_unit_hierarchy: Fetching 1142 unique org units
[DHIS2] Batch 1: Got 50 org units from DHIS2
[DHIS2]   OU: wNunka5Y2uu, name=Acholi-Bur Subcounty, level=4, parent=aBrjuZk0W31
[DHIS2]   OU: FihNC5KfGJV, name=Adilang Subcounty, level=4, parent=ztIyIYAzFKp
[DHIS2]   OU: HSBjlZdFpWn, name=Ajan Subcounty, level=4, parent=aBrjuZk0W31
[DHIS2] Batch 2: Got 50 org units from DHIS2
[DHIS2] Batch 3: Got 50 org units from DHIS2
[DHIS2] Batch 4: Got 50 org units from DHIS2
[DHIS2] Batch 5: Got 50 org units from DHIS2
[DHIS2] Batch 6: Got 50 org units from DHIS2
[DHIS2] Batch 7: Got 50 org units from DHIS2
[DHIS2] Batch 8: Got 50 org units from DHIS2
[DHIS2] Batch 9: Got 50 org units from DHIS2
[DHIS2] Batch 10: Got 50 org units from DHIS2
[DHIS2] Raw API response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Raw DHIS2 rows count: 22727
[DHIS2] First raw row: ['JhvC7ZR9hUe', '2022', 'C0RSe3EWBqU', '246166']
[DHIS2] âœ… Cached response for analytics (API took 34899.9ms)
[DHIS2] Parsing response for endpoint: analytics
[DHIS2] Response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Response sample: {'headers': [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}], 'metaDat
[DHIS2] Using WIDE/PIVOTED format (Period, Level_1_Name, Level_2_Name, ..., DX1, DX2, ...) for analytics
[DHIS2] Batch 11: Got 50 org units from DHIS2
[DHIS2] Analytics headers: [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}]
[DHIS2] Found 'ou' column at index 2
[DHIS2] Processing 22727 rows to extract org unit IDs
[DHIS2] Extracted 1142 unique org unit IDs from rows
[DHIS2] Found 1142 unique org units in analytics response
[DHIS2] Fetching hierarchy for 1142 org units...
[DHIS2] _fetch_org_unit_hierarchy: Fetching 1142 unique org units
[DHIS2] Batch 12: Got 50 org units from DHIS2
[DHIS2] Batch 1: Got 50 org units from DHIS2
[DHIS2]   OU: wNunka5Y2uu, name=Acholi-Bur Subcounty, level=4, parent=aBrjuZk0W31
[DHIS2]   OU: FihNC5KfGJV, name=Adilang Subcounty, level=4, parent=ztIyIYAzFKp
[DHIS2]   OU: HSBjlZdFpWn, name=Ajan Subcounty, level=4, parent=aBrjuZk0W31
[DHIS2] Batch 13: Got 50 org units from DHIS2
[DHIS2] Batch 14: Got 50 org units from DHIS2
[DHIS2] Batch 2: Got 50 org units from DHIS2
[DHIS2] Batch 15: Got 50 org units from DHIS2
[DHIS2] Batch 3: Got 50 org units from DHIS2
[DHIS2] Batch 4: Got 50 org units from DHIS2
[DHIS2] Batch 16: Got 50 org units from DHIS2
[DHIS2] Batch 17: Got 50 org units from DHIS2
[DHIS2] Batch 5: Got 50 org units from DHIS2
[DHIS2] Batch 6: Got 50 org units from DHIS2
[DHIS2] Batch 18: Got 50 org units from DHIS2
[DHIS2] Batch 7: Got 50 org units from DHIS2
[DHIS2] Batch 19: Got 50 org units from DHIS2
[DHIS2] Batch 8: Got 50 org units from DHIS2
[DHIS2] Batch 20: Got 50 org units from DHIS2
[DHIS2] Batch 9: Got 50 org units from DHIS2
[DHIS2] Batch 21: Got 50 org units from DHIS2
[DHIS2] Batch 10: Got 50 org units from DHIS2
[DHIS2] Batch 22: Got 50 org units from DHIS2
[DHIS2] Batch 11: Got 50 org units from DHIS2
[DHIS2] Batch 23: Got 42 org units from DHIS2
[DHIS2] Batch 12: Got 50 org units from DHIS2
[DHIS2] Batch 13: Got 50 org units from DHIS2
[DHIS2] Batch 14: Got 50 org units from DHIS2
[DHIS2] Total org unit names available: 1145 after 2 iterations
[DHIS2] Sample hierarchy for a9NzDoLn9kz: {'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Kitgum District', 'level_4': 'Pager Division', 'level_5': None, 'level_6': None}
[DHIS2]   a9NzDoLn9kz: filled levels = ['level_1', 'level_2', 'level_3', 'level_4']2025-12-18 14:34:41,996:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Sample hierarchy for a9NzDoLn9kz: {'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Kitgum District', 'level_4': 'Pager Division', 'level_5': None, 'level_6': None}
2025-12-18 14:34:41,996:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] _fetch_org_unit_hierarchy completed: 1142 org units with hierarchy
2025-12-18 14:34:41,997:INFO:superset.db_engine_specs.dhis2_dialect:normalize_analytics called with pivot=True, returning WIDE format
2025-12-18 14:34:42,017:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column construction - data_elements: ['AuAOIfCuBUp', 'BWZFz9RJRPI', 'D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'gHjJrtw9vQX', 'pRZrTLDN7Ge', 'wUDxFVBapIc']
2025-12-18 14:34:42,017:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column names constructed (SANITIZED): ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:34:42,018:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] FIRST ROW CONSTRUCTION:
2025-12-18 14:34:42,018:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   Period (index 0): 2020
2025-12-18 14:34:42,018:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   108-EP01a.2. Malaria Total (Deaths) (index 6): None
2025-12-18 14:34:42,018:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   108-EP01a.1. Malaria Total (Cases) (index 7): 3
2025-12-18 14:34:42,018:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01b. Malaria Total (index 8): 1580
2025-12-18 14:34:42,018:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01a. Suspected fever (index 9): 6695
2025-12-18 14:34:42,018:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01d. Malaria cases treated (index 10): 1560
2025-12-18 14:34:42,018:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   108-EP01b.2. Malaria Confirmed (Microscopic &RDT) (Deaths) (index 11): None
2025-12-18 14:34:42,018:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   108-EP01b.1. Malaria Confirmed (Microscopic &RDT) (Cases) (index 12): 3
2025-12-18 14:34:42,018:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01c. Malaria Confirmed (B/s and RDT Positive) (index 13): 1579
2025-12-18 14:34:42,029:INFO:superset.db_engine_specs.dhis2_dialect:First pivoted row - Period: '2020'
2025-12-18 14:34:42,029:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total pivoted rows: 4437, columns: 14
2025-12-18 14:34:42,030:INFO:superset.db_engine_specs.dhis2_dialect:Normalized 4437 rows with 14 columns for endpoint analytics
2025-12-18 14:34:42,030:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API returned 4437 rows
2025-12-18 14:34:42,045:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() - Row count: 4437
2025-12-18 14:34:42,045:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:34:42,045:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names length: 14
2025-12-18 14:34:42,046:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values count: 14
2025-12-18 14:34:42,046:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values: ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
2025-12-18 14:34:42,046:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 0 (Period): 2020 -> 2020 (STRING)
2025-12-18 14:34:42,046:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (National): 'MOH - Uganda...' -> STRING (non-numeric detected)
2025-12-18 14:34:42,046:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (National): MOH - Uganda (PROCESSED)
2025-12-18 14:34:42,046:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (Region): 'Ankole...' -> STRING (non-numeric detected)
2025-12-18 14:34:42,046:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (Region): Ankole (PROCESSED)
2025-12-18 14:34:42,046:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (District): 'Rwampara District...' -> STRING (non-numeric detected)
2025-12-18 14:34:42,046:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (District): Rwampara District (PROCESSED)
2025-12-18 14:34:42,046:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (Sub_County_Town_Council_Div): 'Mwizi Subcounty...' -> STRING (non-numeric detected)
2025-12-18 14:34:42,046:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (Sub_County_Town_Council_Div): Mwizi Subcounty (PROCESSED)
2025-12-18 14:34:42,062:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() returning 4437 rows with 14 columns each
2025-12-18 14:34:42,062:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Got 4437 rows from cursor
2025-12-18 14:34:42,062:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: First row: ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
2025-12-18 14:34:42,062:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:34:42,062:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Types from cursor: ['String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String']
2025-12-18 14:34:42,072:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: DataFrame created with 4437 rows, 14 columns
2025-12-18 14:34:42,072:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:34:42,072:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes BEFORE fix: {'Period': dtype('O'), 'National': dtype('O'), 'Region': dtype('O'), 'District': dtype('O'), 'Sub_County_Town_Council_Div': dtype('O'), 'Health_Facility': dtype('O'), '108_EP01a_2_Malaria_Total_Deaths': dtype('O'), '108_EP01a_1_Malaria_Total_Cases': dtype('O'), '105_EP01b_Malaria_Total': dtype('O'), '105_EP01a_Suspected_fever': dtype('O'), '105_EP01d_Malaria_cases_treated': dtype('O'), '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths': dtype('O'), '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases': dtype('O'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('O')}
2025-12-18 14:34:42,074:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Period' to object dtype (dimension)
2025-12-18 14:34:42,074:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'National' as dimension (contains non-numeric string: 'MOH - Uganda...')
2025-12-18 14:34:42,075:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'National' to object dtype (dimension)
2025-12-18 14:34:42,075:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'Region' as dimension (contains non-numeric string: 'Ankole...')
2025-12-18 14:34:42,076:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Region' to object dtype (dimension)
2025-12-18 14:34:42,076:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'District' as dimension (contains non-numeric string: 'Rwampara District...')
2025-12-18 14:34:42,076:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'District' to object dtype (dimension)
2025-12-18 14:34:42,077:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'Sub_County_Town_Council_Div' as dimension (contains non-numeric string: 'Mwizi Subcounty...')
2025-12-18 14:34:42,077:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Sub_County_Town_Council_Div' to object dtype (dimension)
2025-12-18 14:34:42,077:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'Health_Facility' as dimension (contains non-numeric string: 'Keyo Health Centre II...')
2025-12-18 14:34:42,077:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Health_Facility' to object dtype (dimension)
2025-12-18 14:34:42,079:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes AFTER fix: {'Period': dtype('O'), 'National': dtype('O'), 'Region': dtype('O'), 'District': dtype('O'), 'Sub_County_Town_Council_Div': dtype('O'), 'Health_Facility': dtype('O'), '108_EP01a_2_Malaria_Total_Deaths': dtype('O'), '108_EP01a_1_Malaria_Total_Cases': dtype('O'), '105_EP01b_Malaria_Total': dtype('O'), '105_EP01a_Suspected_fever': dtype('O'), '105_EP01d_Malaria_cases_treated': dtype('O'), '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths': dtype('O'), '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases': dtype('O'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('O')}
2025-12-18 14:34:42,079:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: First row: {'Period': '2020', 'National': 'MOH - Uganda', 'Region': 'Ankole', 'District': 'Rwampara District', 'Sub_County_Town_Council_Div': 'Mwizi Subcounty', 'Health_Facility': None, '108_EP01a_2_Malaria_Total_Deaths': None, '108_EP01a_1_Malaria_Total_Cases': 3, '105_EP01b_Malaria_Total': 1580, '105_EP01a_Suspected_fever': 6695, '105_EP01d_Malaria_cases_treated': 1560, '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths': None, '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases': 3, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 1579}
2025-12-18 14:34:42,082:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] BEFORE assign_column_label:
2025-12-18 14:34:42,082:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4437, 14)
2025-12-18 14:34:42,082:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:34:42,082:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['Region', 'Period', '105_EP01b_Malaria_Total']
2025-12-18 14:34:42,082:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: False
2025-12-18 14:34:42,083:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Period': '2020', 'National': 'MOH - Uganda', 'Region': 'Ankole', 'District': 'Rwampara District', 'Sub_County_Town_Council_Div': 'Mwizi Subcounty', 'Health_Facility': None, '108_EP01a_2_Malaria_Total_Deaths': None, '108_EP01a_1_Malaria_Total_Cases': 3, '105_EP01b_Malaria_Total': 1580, '105_EP01a_Suspected_fever': 6695, '105_EP01d_Malaria_cases_treated': 1560, '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths': None, '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases': 3, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 1579}
2025-12-18 14:34:42,083:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Column truncation needed: df has 14 columns, expected 3
2025-12-18 14:34:42,083:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   DataFrame actual columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:34:42,083:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Expected columns: ['Region', 'Period', '105_EP01b_Malaria_Total']
2025-12-18 14:34:42,083:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] âœ“ Selecting columns BY NAME (matched all expected columns)
2025-12-18 14:34:42,083:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Column mapping: {'Region': 'Region', 'Period': 'Period', '105_EP01b_Malaria_Total': '105_EP01b_Malaria_Total'}
2025-12-18 14:34:42,084:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] Column Selection âœ“ SUCCESS - method=BY_NAME, datasource=analytics 20251217-3246
2025-12-18 14:34:42,084:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Region', 'Period', '105_EP01b_Malaria_Total']
2025-12-18 14:34:42,084:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   tried_by_name=True, success=True, fallback=False
2025-12-18 14:34:42,084:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Assigning column labels: ['Region', 'Period', '105_EP01b_Malaria_Total']
2025-12-18 14:34:42,085:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] AFTER assign_column_label:
2025-12-18 14:34:42,085:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4437, 3)
2025-12-18 14:34:42,085:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Region', 'Period', '105_EP01b_Malaria_Total']
2025-12-18 14:34:42,085:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['Region', 'Period', '105_EP01b_Malaria_Total']
2025-12-18 14:34:42,085:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: True
2025-12-18 14:34:42,085:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Region': 'Ankole', 'Period': '2020', '105_EP01b_Malaria_Total': 1580}
2025-12-18 14:34:42,343:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:34:42] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-18 14:34:43,405:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:34:43] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 14:34:50,599:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Fetched 1142 org units, found 301 parent IDs
2025-12-18 14:34:50,599:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Iteration 1: Fetching 2 missing parent org units...
2025-12-18 14:34:51,443:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Iteration 2: Fetching 1 missing parent org units...
2025-12-18 14:34:52,422:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total org unit names available: 1145
2025-12-18 14:34:52,435:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Sample hierarchy for a9NzDoLn9kz: {'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Kitgum District', 'level_4': 'Pager Division', 'level_5': None, 'level_6': None}
2025-12-18 14:34:52,435:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] _fetch_org_unit_hierarchy completed: 1142 org units with hierarchy
2025-12-18 14:34:52,437:INFO:superset.db_engine_specs.dhis2_dialect:normalize_analytics called with pivot=True, returning WIDE format
2025-12-18 14:34:52,468:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column construction - data_elements: ['AuAOIfCuBUp', 'BWZFz9RJRPI', 'D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'gHjJrtw9vQX', 'pRZrTLDN7Ge', 'wUDxFVBapIc']
2025-12-18 14:34:52,468:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column names constructed (SANITIZED): ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:34:52,470:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] FIRST ROW CONSTRUCTION:
2025-12-18 14:34:52,470:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   Period (index 0): 2020
2025-12-18 14:34:52,470:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   108-EP01a.2. Malaria Total (Deaths) (index 6): None
2025-12-18 14:34:52,470:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   108-EP01a.1. Malaria Total (Cases) (index 7): 3
2025-12-18 14:34:52,470:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01b. Malaria Total (index 8): 1580
2025-12-18 14:34:52,470:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01a. Suspected fever (index 9): 6695
2025-12-18 14:34:52,470:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01d. Malaria cases treated (index 10): 1560
2025-12-18 14:34:52,470:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   108-EP01b.2. Malaria Confirmed (Microscopic &RDT) (Deaths) (index 11): None
2025-12-18 14:34:52,470:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   108-EP01b.1. Malaria Confirmed (Microscopic &RDT) (Cases) (index 12): 3
2025-12-18 14:34:52,470:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01c. Malaria Confirmed (B/s and RDT Positive) (index 13): 1579
2025-12-18 14:34:52,486:INFO:superset.db_engine_specs.dhis2_dialect:First pivoted row - Period: '2020'
2025-12-18 14:34:52,486:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total pivoted rows: 4437, columns: 14

[DHIS2]   aFgrVHVDqoZ: filled levels = ['level_1', 'level_2', 'level_3', 'level_4', 'level_5']
[DHIS2]   fxHApp8UtpE: filled levels = ['level_1', 'level_2', 'level_3', 'level_4', 'level_5']
[DHIS2] Fetched hierarchy for 1142 org units
[DHIS2] Sample hierarchy for a9NzDoLn9kz: {'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Kitgum District', 'level_4': 'Pager Division', 'level_5': None, 'level_6': None}
[DHIS2] Calling DHIS2ResponseNormalizer.normalize with:
[DHIS2]   - endpoint: analytics
[DHIS2]   - pivot: True
[DHIS2]   - org_unit_hierarchy: 1142 entries
[DHIS2]   - org_unit_level_names: {3: 'District', 5: 'Health Facility', 1: 'National', 2: 'Region', 4: 'Sub County/Town Council/Div'}
[DHIS2] normalize_analytics: pivot=True, using WIDE/PIVOTED format
[DHIS2] PIVOT CONSTRUCTION:
[DHIS2]   data_elements (UIDs): ['AuAOIfCuBUp', 'BWZFz9RJRPI', 'D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'gHjJrtw9vQX', 'pRZrTLDN7Ge', 'wUDxFVBapIc']
[DHIS2]   data_element_list (sorted UIDs): ['AuAOIfCuBUp', 'BWZFz9RJRPI', 'D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'gHjJrtw9vQX', 'pRZrTLDN7Ge', 'wUDxFVBapIc']
[DHIS2]   col_names (SANITIZED): ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Row 0: OU=AA8TRyfTwtn, hierarchy_info={'level_1': 'MOH - Uganda', 'level_2': 'Ankole', 'level_3': 'Rwampara District', 'level_4': 'Mwizi Subcounty', 'level_5': None, 'level_6': None}
[DHIS2] Row 1: OU=AJxamlmKn2x, hierarchy_info={'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Amuru District', 'level_4': 'Lamogi Subcounty', 'level_5': 'Keyo Health Centre II', 'level_6': None}
[DHIS2] Row 2: OU=ALL4sSTGBRn, hierarchy_info={'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Gulu District', 'level_4': 'Owalo Subcounty', 'level_5': None, 'level_6': None}
[DHIS2] Normalized columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized row count: 4437
[DHIS2] First row: ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
[DHIS2] _set_description: original=['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], sanitized=['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], types=['String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String']
[DHIS2] Transformed rows count: 4437
[DHIS2] First transformed row: ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
[DHIS2] Fetched 4437 rows
[DHIS2] fetchall() called - returning 4437 rows
[DHIS2] fetchall() - First row type: <class 'tuple'>
[DHIS2] fetchall() - First row (original): ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
[DHIS2] fetchall() - Column count from description: 14
[DHIS2] fetchall() - First row (fixed types): ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
[DHIS2] fetchall() - Type enforcement: dimensions=STRING, measures=FLOAT
[DHIS2] Batch 15: Got 50 org units from DHIS2
[DHIS2] Batch 16: Got 50 org units from DHIS2
[DHIS2] Batch 17: Got 50 org units from DHIS2
[DHIS2] Batch 18: Got 50 org units from DHIS2
[DHIS2] Batch 19: Got 50 org units from DHIS2
[DHIS2] Batch 20: Got 50 org units from DHIS2
[DHIS2] Batch 21: Got 50 org units from DHIS2
[DHIS2] Batch 22: Got 50 org units from DHIS2
[DHIS2] Batch 23: Got 42 org units from DHIS2
[DHIS2] Total org unit names available: 1145 after 2 iterations
[DHIS2] Sample hierarchy for a9NzDoLn9kz: {'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Kitgum District', 'level_4': 'Pager Division', 'level_5': None, 'level_6': None}
[DHIS2]   a9NzDoLn9kz: filled levels = ['level_1', 'level_2', 'level_3', 'level_4']
[DHIS2]   aFgrVHVDqoZ: filled levels = ['level_1', 'level_2', 'level_3', 'level_4', 'level_5']
[DHIS2]   fxHApp8UtpE: filled levels = ['level_1', 'level_2', 'level_3', 'level_4', 'level_5']
[DHIS2] Fetched hierarchy for 1142 org units
[DHIS2] Sample hierarchy for a9NzDoLn9kz: {'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Kitgum District', 'level_4': 'Pager Division', 'level_5': None, 'level_6': None}
[DHIS2] Calling DHIS2ResponseNormalizer.normalize with:
[DHIS2]   - endpoint: analytics
[DHIS2]   - pivot: True
[DHIS2]   - org_unit_hierarchy: 1142 entries
[DHIS2]   - org_unit_level_names: {3: 'District', 5: 'Health Facility', 1: 'National', 2: 'Region', 4: 'Sub County/Town Council/Div'}
[DHIS2] normalize_analytics: pivot=True, using WIDE/PIVOTED format
[DHIS2] PIVOT CONSTRUCTION:
[DHIS2]   data_elements (UIDs): ['AuAOIfCuBUp', 'BWZFz9RJRPI', 'D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'gHjJrtw9vQX', 'pRZrTLDN7Ge', 'wUDxFVBapIc']
[DHIS2]   data_element_list (sorted UIDs): ['AuAOIfCuBUp', 'BWZFz9RJRPI', 'D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'gHjJrtw9vQX', 'pRZrTLDN7Ge', 'wUDxFVBapIc']
[DHIS2]   col_names (SANITIZED): ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Row 0: OU=AA8TRyfTwtn, hierarchy_info={'level_1': 'MOH - Uganda', 'level_2': 'Ankole', 'level_3': 'Rwampara District', 'level_4': 'Mwizi Subcounty', 'level_5': None, 'level_6': None}
[DHIS2] Row 1: OU=AJxamlmKn2x, hierarchy_info={'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Amuru District', 'level_4': 'Lamogi Subcounty', 'level_5': 'Keyo Health Centre II', 'level_6': None}
[DHIS2] Row 2: OU=ALL4sSTGBRn, hierarchy_info={'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Gulu District', 'level_4': 'Owalo Subcounty', 'level_5': None, 'level_6': None}
[DHIS2] Normalized columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Normalized row count: 4437
[DHIS2] First row: ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
[DHIS2] _set_description: original=['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], sanitized=['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], types=['String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String']2025-12-18 14:34:52,488:INFO:superset.db_engine_specs.dhis2_dialect:Normalized 4437 rows with 14 columns for endpoint analytics
2025-12-18 14:34:52,489:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API returned 4437 rows
2025-12-18 14:34:52,510:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() - Row count: 4437
2025-12-18 14:34:52,510:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:34:52,510:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names length: 14
2025-12-18 14:34:52,510:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values count: 14
2025-12-18 14:34:52,510:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values: ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
2025-12-18 14:34:52,510:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 0 (Period): 2020 -> 2020 (STRING)
2025-12-18 14:34:52,510:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (National): 'MOH - Uganda...' -> STRING (non-numeric detected)
2025-12-18 14:34:52,510:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (National): MOH - Uganda (PROCESSED)
2025-12-18 14:34:52,510:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (Region): 'Ankole...' -> STRING (non-numeric detected)
2025-12-18 14:34:52,510:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (Region): Ankole (PROCESSED)
2025-12-18 14:34:52,510:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (District): 'Rwampara District...' -> STRING (non-numeric detected)
2025-12-18 14:34:52,510:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (District): Rwampara District (PROCESSED)
2025-12-18 14:34:52,510:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (Sub_County_Town_Council_Div): 'Mwizi Subcounty...' -> STRING (non-numeric detected)
2025-12-18 14:34:52,510:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (Sub_County_Town_Council_Div): Mwizi Subcounty (PROCESSED)
2025-12-18 14:34:52,530:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() returning 4437 rows with 14 columns each
2025-12-18 14:34:52,530:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Got 4437 rows from cursor
2025-12-18 14:34:52,530:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: First row: ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
2025-12-18 14:34:52,530:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:34:52,530:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Types from cursor: ['String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String']
2025-12-18 14:34:52,542:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: DataFrame created with 4437 rows, 14 columns
2025-12-18 14:34:52,542:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:34:52,544:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes BEFORE fix: {'Period': dtype('O'), 'National': dtype('O'), 'Region': dtype('O'), 'District': dtype('O'), 'Sub_County_Town_Council_Div': dtype('O'), 'Health_Facility': dtype('O'), '108_EP01a_2_Malaria_Total_Deaths': dtype('O'), '108_EP01a_1_Malaria_Total_Cases': dtype('O'), '105_EP01b_Malaria_Total': dtype('O'), '105_EP01a_Suspected_fever': dtype('O'), '105_EP01d_Malaria_cases_treated': dtype('O'), '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths': dtype('O'), '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases': dtype('O'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('O')}
2025-12-18 14:34:52,546:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Period' to object dtype (dimension)
2025-12-18 14:34:52,548:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'National' as dimension (contains non-numeric string: 'MOH - Uganda...')
2025-12-18 14:34:52,548:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'National' to object dtype (dimension)
2025-12-18 14:34:52,549:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'Region' as dimension (contains non-numeric string: 'Ankole...')
2025-12-18 14:34:52,549:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Region' to object dtype (dimension)
2025-12-18 14:34:52,549:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'District' as dimension (contains non-numeric string: 'Rwampara District...')
2025-12-18 14:34:52,549:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'District' to object dtype (dimension)
2025-12-18 14:34:52,550:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'Sub_County_Town_Council_Div' as dimension (contains non-numeric string: 'Mwizi Subcounty...')
2025-12-18 14:34:52,550:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Sub_County_Town_Council_Div' to object dtype (dimension)
2025-12-18 14:34:52,550:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'Health_Facility' as dimension (contains non-numeric string: 'Keyo Health Centre II...')
2025-12-18 14:34:52,550:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Health_Facility' to object dtype (dimension)
2025-12-18 14:34:52,553:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes AFTER fix: {'Period': dtype('O'), 'National': dtype('O'), 'Region': dtype('O'), 'District': dtype('O'), 'Sub_County_Town_Council_Div': dtype('O'), 'Health_Facility': dtype('O'), '108_EP01a_2_Malaria_Total_Deaths': dtype('O'), '108_EP01a_1_Malaria_Total_Cases': dtype('O'), '105_EP01b_Malaria_Total': dtype('O'), '105_EP01a_Suspected_fever': dtype('O'), '105_EP01d_Malaria_cases_treated': dtype('O'), '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths': dtype('O'), '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases': dtype('O'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('O')}
2025-12-18 14:34:52,553:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: First row: {'Period': '2020', 'National': 'MOH - Uganda', 'Region': 'Ankole', 'District': 'Rwampara District', 'Sub_County_Town_Council_Div': 'Mwizi Subcounty', 'Health_Facility': None, '108_EP01a_2_Malaria_Total_Deaths': None, '108_EP01a_1_Malaria_Total_Cases': 3, '105_EP01b_Malaria_Total': 1580, '105_EP01a_Suspected_fever': 6695, '105_EP01d_Malaria_cases_treated': 1560, '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths': None, '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases': 3, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 1579}
2025-12-18 14:34:52,557:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] BEFORE assign_column_label:
2025-12-18 14:34:52,557:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4437, 14)
2025-12-18 14:34:52,557:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:34:52,557:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['Region', 'Period', '105_EP01b_Malaria_Total']
2025-12-18 14:34:52,557:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: False
2025-12-18 14:34:52,557:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Period': '2020', 'National': 'MOH - Uganda', 'Region': 'Ankole', 'District': 'Rwampara District', 'Sub_County_Town_Council_Div': 'Mwizi Subcounty', 'Health_Facility': None, '108_EP01a_2_Malaria_Total_Deaths': None, '108_EP01a_1_Malaria_Total_Cases': 3, '105_EP01b_Malaria_Total': 1580, '105_EP01a_Suspected_fever': 6695, '105_EP01d_Malaria_cases_treated': 1560, '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths': None, '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases': 3, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 1579}
2025-12-18 14:34:52,557:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Column truncation needed: df has 14 columns, expected 3
2025-12-18 14:34:52,557:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   DataFrame actual columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 14:34:52,557:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Expected columns: ['Region', 'Period', '105_EP01b_Malaria_Total']
2025-12-18 14:34:52,557:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] âœ“ Selecting columns BY NAME (matched all expected columns)
2025-12-18 14:34:52,557:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Column mapping: {'Region': 'Region', 'Period': 'Period', '105_EP01b_Malaria_Total': '105_EP01b_Malaria_Total'}
2025-12-18 14:34:52,560:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] Column Selection âœ“ SUCCESS - method=BY_NAME, datasource=analytics 20251217-3246
2025-12-18 14:34:52,560:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Region', 'Period', '105_EP01b_Malaria_Total']
2025-12-18 14:34:52,560:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   tried_by_name=True, success=True, fallback=False
2025-12-18 14:34:52,560:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Assigning column labels: ['Region', 'Period', '105_EP01b_Malaria_Total']
2025-12-18 14:34:52,560:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] AFTER assign_column_label:
2025-12-18 14:34:52,560:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4437, 3)
2025-12-18 14:34:52,560:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Region', 'Period', '105_EP01b_Malaria_Total']
2025-12-18 14:34:52,560:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['Region', 'Period', '105_EP01b_Malaria_Total']
2025-12-18 14:34:52,560:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: True
2025-12-18 14:34:52,560:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Region': 'Ankole', 'Period': '2020', '105_EP01b_Malaria_Total': 1580}
2025-12-18 14:34:52,595:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:34:52] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-18 14:35:59,988:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:35:59] "PUT /api/v1/explore/form_data/ULWSeaI5Yyo?tab_id=2 HTTP/1.1" 200 -
2025-12-18 14:36:01,341:WARNING:superset.common.query_object:The field `groupby` is deprecated, please use `columns` instead.
2025-12-18 14:36:01,342:WARNING:superset.common.query_object:The field `columns` is already populated, replacing value with contents from `groupby`.
2025-12-18 14:36:01,499:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:36:01] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-18 14:36:01,974:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:36:01] "PUT /api/v1/explore/form_data/ULWSeaI5Yyo?tab_id=2 HTTP/1.1" 200 -
2025-12-18 14:36:02,812:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:36:02] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 14:36:04,267:WARNING:superset.common.query_object:The field `groupby` is deprecated, please use `columns` instead.
2025-12-18 14:36:04,268:WARNING:superset.common.query_object:The field `columns` is already populated, replacing value with contents from `groupby`.
2025-12-18 14:36:04,405:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:36:04] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-18 14:36:05,292:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:36:05] "PUT /api/v1/explore/form_data/ULWSeaI5Yyo?tab_id=2 HTTP/1.1" 200 -
2025-12-18 14:36:05,529:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:36:05] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 14:41:24,177:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:41:24] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 14:41:24,586:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:41:24] "GET /api/v1/database/?q=(filters:!((col:allow_file_upload,opr:upload_is_enabled,value:!t))) HTTP/1.1" 200 -
2025-12-18 14:41:24,587:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:41:24] "GET /api/v1/database/?q=(filters:!((col:database_name,opr:neq,value:examples))) HTTP/1.1" 200 -
2025-12-18 14:43:02,567:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:43:02] "GET /api/v1/database/?q=(filters:!((col:allow_file_upload,opr:upload_is_enabled,value:!t))) HTTP/1.1" 200 -
2025-12-18 14:43:02,573:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:43:02] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 14:43:03,266:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:43:03] "GET /api/v1/database/?q=(filters:!((col:database_name,opr:neq,value:examples))) HTTP/1.1" 200 -
2025-12-18 14:46:32,706:WARNING:superset.common.query_object:The field `groupby` is deprecated, please use `columns` instead.
2025-12-18 14:46:32,721:WARNING:superset.common.query_object:The field `columns` is already populated, replacing value with contents from `groupby`.
2025-12-18 14:46:33,764:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:46:33] "PUT /api/v1/explore/form_data/ULWSeaI5Yyo?tab_id=2 HTTP/1.1" 200 -
2025-12-18 14:46:34,624:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:46:34] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-18 14:46:38,413:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:46:38] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 14:47:38,733:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:47:38] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 14:47:39,213:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:47:39] "GET /api/v1/database/?q=(filters:!((col:allow_file_upload,opr:upload_is_enabled,value:!t))) HTTP/1.1" 200 -
2025-12-18 14:47:39,282:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:47:39] "GET /api/v1/database/?q=(filters:!((col:database_name,opr:neq,value:examples))) HTTP/1.1" 200 -
2025-12-18 14:54:19,536:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:54:19] "GET /api/v1/database/?q=(filters:!((col:allow_file_upload,opr:upload_is_enabled,value:!t))) HTTP/1.1" 200 -
2025-12-18 14:54:19,538:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:54:19] "GET /api/v1/database/?q=(filters:!((col:database_name,opr:neq,value:examples))) HTTP/1.1" 200 -
2025-12-18 14:54:19,801:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:54:19] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 14:57:17,836:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:57:17] "GET /api/v1/database/?q=(filters:!((col:allow_file_upload,opr:upload_is_enabled,value:!t))) HTTP/1.1" 200 -
2025-12-18 14:57:17,837:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:57:17] "GET /api/v1/database/?q=(filters:!((col:database_name,opr:neq,value:examples))) HTTP/1.1" 200 -
2025-12-18 14:57:18,001:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:57:18] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 14:59:49,717:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:59:49] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 14:59:49,732:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:59:49] "GET /api/v1/database/?q=(filters:!((col:database_name,opr:neq,value:examples))) HTTP/1.1" 200 -
2025-12-18 14:59:49,733:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 14:59:49] "GET /api/v1/database/?q=(filters:!((col:allow_file_upload,opr:upload_is_enabled,value:!t))) HTTP/1.1" 200 -
2025-12-18 15:00:40,554:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 15:00:40] "GET /api/v1/database/?q=(filters:!((col:allow_file_upload,opr:upload_is_enabled,value:!t))) HTTP/1.1" 200 -
2025-12-18 15:00:40,556:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 15:00:40] "GET /api/v1/database/?q=(filters:!((col:database_name,opr:neq,value:examples))) HTTP/1.1" 200 -
2025-12-18 15:00:40,749:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 15:00:40] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 15:02:16,750:WARNING:superset.common.query_object:The field `groupby` is deprecated, please use `columns` instead.
2025-12-18 15:02:16,753:WARNING:superset.common.query_object:The field `columns` is already populated, replacing value with contents from `groupby`.
2025-12-18 15:02:16,911:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 15:02:16] "PUT /api/v1/explore/form_data/ULWSeaI5Yyo?tab_id=2 HTTP/1.1" 200 -
2025-12-18 15:02:17,827:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 15:02:17] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-18 15:02:21,272:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 15:02:21] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 15:02:28,721:WARNING:superset.common.query_object:The field `groupby` is deprecated, please use `columns` instead.
2025-12-18 15:02:28,723:WARNING:superset.common.query_object:The field `columns` is already populated, replacing value with contents from `groupby`.
2025-12-18 15:02:28,817:ERROR:superset.models.helpers:[METRICS-TRACE] Processing 1 metrics
2025-12-18 15:02:28,818:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 0: DHIS2 raw column - 105_EP01b_Malaria_Total
2025-12-18 15:02:28,823:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: 105_EP01b_Malaria_Total
2025-12-18 15:02:28,824:ERROR:superset.models.helpers:[METRICS-TRACE] Total metrics added: 1
2025-12-18 15:02:28,830:ERROR:superset.models.helpers:[METRICS-TRACE] Before dedup: 3 select_exprs + 1 metrics_exprs
2025-12-18 15:02:28,830:ERROR:superset.models.helpers:[METRICS-TRACE] After dedup: 3 total select_exprs
2025-12-18 15:02:28,830:INFO:superset.models.helpers:[COLUMN_TRACE] SQL Query Building:
2025-12-18 15:02:28,830:INFO:superset.models.helpers:[COLUMN_TRACE]   columns: ['Region', 'Period', '105_EP01b_Malaria_Total']
2025-12-18 15:02:28,830:INFO:superset.models.helpers:[COLUMN_TRACE]   metrics: ['105_EP01b_Malaria_Total']
2025-12-18 15:02:28,830:INFO:superset.models.helpers:[COLUMN_TRACE]   groupby: []
2025-12-18 15:02:28,830:INFO:superset.models.helpers:[COLUMN_TRACE]   labels_expected: ['Region', 'Period', '105_EP01b_Malaria_Total']
2025-12-18 15:02:28,830:INFO:superset.models.helpers:[COLUMN_TRACE]   select_exprs count: 3
2025-12-18 15:02:28,830:INFO:superset.models.helpers:[COLUMN_TRACE]     [0] key=Region, name=Region, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-18 15:02:28,830:INFO:superset.models.helpers:[COLUMN_TRACE]     [1] key=Period, name=Period, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-18 15:02:28,830:INFO:superset.models.helpers:[COLUMN_TRACE]     [2] key=105_EP01b_Malaria_Total, name=105_EP01b_Malaria_Total, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-18 15:02:28,834:INFO:superset.connectors.sqla.models:[DHIS2] get_from_clause for virtual dataset 4: analytics 20251217-3246
2025-12-18 15:02:28,834:INFO:superset.connectors.sqla.models:[DHIS2] Full SQL stored: SELECT * FROM analytics
/* DHIS2: table=analytics&dx=JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&pe=LAST_5_YEARS&ou=F1o6qBSx783;SUvODYOcaVf&ouMode=DESCENDANTS */
2025-12-18 15:02:28,836:INFO:superset.connectors.sqla.models:[DHIS2] Loaded params from extra field: table=analytics&dx=JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&pe=LAST_5_YEARS&ou=F1o6qBSx783;SUvO
2025-12-18 15:02:28,845:INFO:superset.connectors.sqla.models:[DHIS2] Cached params with key: dhis2_params_4_analytics
2025-12-18 15:02:28,846:INFO:superset.connectors.sqla.models:[DHIS2] Stored params in Flask g for DHIS2 table: analytics
2025-12-18 15:02:28,948:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Query execution in connectors/sqla/models.py:
2025-12-18 15:02:28,948:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   SQL (first 500 chars): SELECT "Region", "Period", "105_EP01b_Malaria_Total" 
FROM (SELECT * FROM analytics
/* DHIS2: table=analytics&dx=JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&pe=LAST_5_YEARS&ou=F1o6qBSx783;SUvODYOcaVf&ouMode=DESCENDANTS */
) AS virtual_table GROUP BY "Region", "Period", "105_EP01b_Malaria_Total"
 LIMIT 10000
2025-12-18 15:02:28,948:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   labels_expected: ['Region', 'Period', '105_EP01b_Malaria_Total']
2025-12-18 15:02:28,973:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 connection initialized: https://tests.dhis2.hispuganda.org/hmis/api
2025-12-18 15:02:29,002:INFO:superset.db_engine_specs.dhis2_dialect:Executing DHIS2 query: SELECT
  "Region",
  "Period",
  "105_EP01b_Malaria_Total"
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "Region",
  "Period",
  "105_EP01b_Malaria_Total"
LIMIT 10000
2025-12-18 15:02:29,002:INFO:superset.db_engine_specs.dhis2_dialect:Parsed endpoint: analytics
2025-12-18 15:02:29,010:INFO:superset.db_engine_specs.dhis2_dialect:Using stored parameters from Flask g for table: analytics
2025-12-18 15:02:29,014:INFO:superset.db_engine_specs.dhis2_dialect:Query params: {'table': 'analytics', 'dx': 'JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX', 'pe': 'LAST_5_YEARS', 'ou': 'F1o6qBSx783;SUvODYOcaVf', 'ouMode': 'DESCENDANTS'}
2025-12-18 15:02:29,018:INFO:superset.db_engine_specs.dhis2_dialect:Period dimension detected - omitting startDate/endDate (DHIS2 API rule)
2025-12-18 15:02:29,018:INFO:superset.db_engine_specs.dhis2_dialect:Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dx': 'JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX', 'pe': 'LAST_5_YEARS', 'ou': 'F1o6qBSx783;SUvODYOcaVf', 'ouMode': 'DESCENDANTS'}
2025-12-18 15:02:30,092:INFO:superset.db_engine_specs.dhis2_dialect:Fetched org unit levels: {3: 'District', 5: 'Health Facility', 1: 'National', 2: 'Region', 4: 'Sub County/Town Council/Div'}
2025-12-18 15:02:30,912:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Using all_levels scope: ['LEVEL-3', 'LEVEL-4', 'LEVEL-5']
2025-12-18 15:02:30,913:INFO:superset.db_engine_specs.dhis2_dialect:Converted dx/pe/ou to dimension parameter: dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX;pe:LAST_5_YEARS;ou:F1o6qBSx783;SUvODYOcaVf;LEVEL-3;LEVEL-4;LEVEL-5
2025-12-18 15:02:30,927:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API request (cache miss): https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&dimension=pe:LAST_5_YEARS&dimension=ou:F1o6qBSx783;SUvODYOcaVf;LEVEL-3;LEVEL-4;LEVEL-5
2025-12-18 15:02:33,571:INFO:superset.db_engine_specs.dhis2_cache:[DHIS2 Cache] SET: analytics (ttl=3600s, key=dhis2:4a1c3321:analytics:5362e2052855...)
2025-12-18 15:02:33,572:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2 Cache] Stored response for analytics
2025-12-18 15:02:33,590:INFO:superset.db_engine_specs.dhis2_dialect:Using wide/pivoted format for analytics
2025-12-18 15:02:34,600:INFO:superset.db_engine_specs.dhis2_dialect:Fetched org unit levels: {3: 'District', 5: 'Health Facility', 1: 'National', 2: 'Region', 4: 'Sub County/Town Council/Div'}
2025-12-18 15:02:34,606:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] _fetch_org_unit_hierarchy: Fetching 1142 unique org units in batches...
2025-12-18 15:02:56,595:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Fetched 1142 org units, found 301 parent IDs
2025-12-18 15:02:56,611:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Iteration 1: Fetching 2 missing parent org units...
2025-12-18 15:02:57,612:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Iteration 2: Fetching 1 missing parent org units...
2025-12-18 15:02:58,496:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total org unit names available: 1145
2025-12-18 15:02:58,526:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Sample hierarchy for a9NzDoLn9kz: {'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Kitgum District', 'level_4': 'Pager Division', 'level_5': None, 'level_6': None}
2025-12-18 15:02:58,526:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] _fetch_org_unit_hierarchy completed: 1142 org units with hierarchy
2025-12-18 15:02:58,529:INFO:superset.db_engine_specs.dhis2_dialect:normalize_analytics called with pivot=True, returning WIDE format
2025-12-18 15:02:58,636:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column construction - data_elements: ['AuAOIfCuBUp', 'BWZFz9RJRPI', 'D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'gHjJrtw9vQX', 'pRZrTLDN7Ge', 'wUDxFVBapIc']
2025-12-18 15:02:58,637:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column names constructed (SANITIZED): ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 15:02:58,643:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] FIRST ROW CONSTRUCTION:
2025-12-18 15:02:58,643:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   Period (index 0): 2020
2025-12-18 15:02:58,644:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   108-EP01a.2. Malaria Total (Deaths) (index 6): None
2025-12-18 15:02:58,644:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   108-EP01a.1. Malaria Total (Cases) (index 7): 3
2025-12-18 15:02:58,644:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01b. Malaria Total (index 8): 1580
2025-12-18 15:02:58,644:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01a. Suspected fever (index 9): 6695
2025-12-18 15:02:58,644:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01d. Malaria cases treated (index 10): 1560
2025-12-18 15:02:58,644:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   108-EP01b.2. Malaria Confirmed (Microscopic &RDT) (Deaths) (index 11): None
2025-12-18 15:02:58,644:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   108-EP01b.1. Malaria Confirmed (Microscopic &RDT) (Cases) (index 12): 3
2025-12-18 15:02:58,644:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01c. Malaria Confirmed (B/s and RDT Positive) (index 13): 1579
2025-12-18 15:02:58,701:INFO:superset.db_engine_specs.dhis2_dialect:First pivoted row - Period: '2020'
2025-12-18 15:02:58,701:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total pivoted rows: 4437, columns: 14

[DHIS2] Transformed rows count: 4437
[DHIS2] First transformed row: ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
[DHIS2] Fetched 4437 rows
[DHIS2] fetchall() called - returning 4437 rows
[DHIS2] fetchall() - First row type: <class 'tuple'>
[DHIS2] fetchall() - First row (original): ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
[DHIS2] fetchall() - Column count from description: 14
[DHIS2] fetchall() - First row (fixed types): ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
[DHIS2] fetchall() - Type enforcement: dimensions=STRING, measures=FLOAT
[DHIS2] Executing query: SELECT
  "Region",
  "Period",
  "105_EP01b_Malaria_Total"
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "Region",
  "Period",
  "105_EP01b_Malaria_Total"
LIMIT 10000
[DHIS2] Parsed endpoint: analytics
[DHIS2] Found params in Flask g for analytics: table=analytics&dx=JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7
[DHIS2] Query params: {'table': 'analytics', 'dx': 'JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX', 'pe': 'LAST_5_YEARS', 'ou': 'F1o6qBSx783;SUvODYOcaVf', 'ouMode': 'DESCENDANTS'}
[DHIS2] Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dx': 'JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX', 'pe': 'LAST_5_YEARS', 'ou': 'F1o6qBSx783;SUvODYOcaVf', 'ouMode': 'DESCENDANTS'}
[DHIS2] Using all_levels scope: ['LEVEL-3', 'LEVEL-4', 'LEVEL-5']
[DHIS2] ðŸ”„ CACHE MISS - API request URL: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&dimension=pe:LAST_5_YEARS&dimension=ou:F1o6qBSx783;SUvODYOcaVf;LEVEL-3;LEVEL-4;LEVEL-5
[DHIS2] Raw API response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Raw DHIS2 rows count: 22727
[DHIS2] First raw row: ['JhvC7ZR9hUe', '2022', 'C0RSe3EWBqU', '246166']
[DHIS2] âœ… Cached response for analytics (API took 4511.4ms)
[DHIS2] Parsing response for endpoint: analytics
[DHIS2] Response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Response sample: {'headers': [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}], 'metaDat
[DHIS2] Using WIDE/PIVOTED format (Period, Level_1_Name, Level_2_Name, ..., DX1, DX2, ...) for analytics
[DHIS2] Analytics headers: [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}]
[DHIS2] Found 'ou' column at index 2
[DHIS2] Processing 22727 rows to extract org unit IDs
[DHIS2] Extracted 1142 unique org unit IDs from rows
[DHIS2] Found 1142 unique org units in analytics response
[DHIS2] Fetching hierarchy for 1142 org units...
[DHIS2] _fetch_org_unit_hierarchy: Fetching 1142 unique org units
[DHIS2] Batch 1: Got 50 org units from DHIS2
[DHIS2]   OU: wNunka5Y2uu, name=Acholi-Bur Subcounty, level=4, parent=aBrjuZk0W31
[DHIS2]   OU: FihNC5KfGJV, name=Adilang Subcounty, level=4, parent=ztIyIYAzFKp
[DHIS2]   OU: HSBjlZdFpWn, name=Ajan Subcounty, level=4, parent=aBrjuZk0W31
[DHIS2] Batch 2: Got 50 org units from DHIS2
[DHIS2] Batch 3: Got 50 org units from DHIS2
[DHIS2] Batch 4: Got 50 org units from DHIS2
[DHIS2] Batch 5: Got 50 org units from DHIS2
[DHIS2] Batch 6: Got 50 org units from DHIS2
[DHIS2] Batch 7: Got 50 org units from DHIS2
[DHIS2] Batch 8: Got 50 org units from DHIS2
[DHIS2] Batch 9: Got 50 org units from DHIS2
[DHIS2] Batch 10: Got 50 org units from DHIS2
[DHIS2] Batch 11: Got 50 org units from DHIS2
[DHIS2] Batch 12: Got 50 org units from DHIS2
[DHIS2] Batch 13: Got 50 org units from DHIS2
[DHIS2] Batch 14: Got 50 org units from DHIS2
[DHIS2] Batch 15: Got 50 org units from DHIS2
[DHIS2] Batch 16: Got 50 org units from DHIS2
[DHIS2] Batch 17: Got 50 org units from DHIS2
[DHIS2] Batch 18: Got 50 org units from DHIS2
[DHIS2] Batch 19: Got 50 org units from DHIS2
[DHIS2] Batch 20: Got 50 org units from DHIS2
[DHIS2] Batch 21: Got 50 org units from DHIS2
[DHIS2] Batch 22: Got 50 org units from DHIS2
[DHIS2] Batch 23: Got 42 org units from DHIS2
[DHIS2] Total org unit names available: 1145 after 2 iterations
[DHIS2] Sample hierarchy for a9NzDoLn9kz: {'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Kitgum District', 'level_4': 'Pager Division', 'level_5': None, 'level_6': None}
[DHIS2]   a9NzDoLn9kz: filled levels = ['level_1', 'level_2', 'level_3', 'level_4']
[DHIS2]   aFgrVHVDqoZ: filled levels = ['level_1', 'level_2', 'level_3', 'level_4', 'level_5']
[DHIS2]   fxHApp8UtpE: filled levels = ['level_1', 'level_2', 'level_3', 'level_4', 'level_5']
[DHIS2] Fetched hierarchy for 1142 org units
[DHIS2] Sample hierarchy for a9NzDoLn9kz: {'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Kitgum District', 'level_4': 'Pager Division', 'level_5': None, 'level_6': None}
[DHIS2] Calling DHIS2ResponseNormalizer.normalize with:
[DHIS2]   - endpoint: analytics
[DHIS2]   - pivot: True
[DHIS2]   - org_unit_hierarchy: 1142 entries
[DHIS2]   - org_unit_level_names: {3: 'District', 5: 'Health Facility', 1: 'National', 2: 'Region', 4: 'Sub County/Town Council/Div'}
[DHIS2] normalize_analytics: pivot=True, using WIDE/PIVOTED format
[DHIS2] PIVOT CONSTRUCTION:
[DHIS2]   data_elements (UIDs): ['AuAOIfCuBUp', 'BWZFz9RJRPI', 'D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'gHjJrtw9vQX', 'pRZrTLDN7Ge', 'wUDxFVBapIc']
[DHIS2]   data_element_list (sorted UIDs): ['AuAOIfCuBUp', 'BWZFz9RJRPI', 'D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'gHjJrtw9vQX', 'pRZrTLDN7Ge', 'wUDxFVBapIc']
[DHIS2]   col_names (SANITIZED): ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
[DHIS2] Row 0: OU=AA8TRyfTwtn, hierarchy_info={'level_1': 'MOH - Uganda', 'level_2': 'Ankole', 'level_3': 'Rwampara District', 'level_4': 'Mwizi Subcounty', 'level_5': None, 'level_6': None}
[DHIS2] Row 1: OU=AJxamlmKn2x, hierarchy_info={'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Amuru District', 'level_4': 'Lamogi Subcounty', 'level_5': 'Keyo Health Centre II', 'level_6': None}
[DHIS2] Row 2: OU=ALL4sSTGBRn, hierarchy_info={'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Gulu District', 'level_4': 'Owalo Subcounty', 'level_5': None, 'level_6': None}
[DHIS2] Normalized columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']2025-12-18 15:02:58,714:INFO:superset.db_engine_specs.dhis2_dialect:Normalized 4437 rows with 14 columns for endpoint analytics
2025-12-18 15:02:58,715:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API returned 4437 rows
2025-12-18 15:02:58,842:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() - Row count: 4437
2025-12-18 15:02:58,842:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 15:02:58,842:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names length: 14
2025-12-18 15:02:58,842:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values count: 14
2025-12-18 15:02:58,842:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values: ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
2025-12-18 15:02:58,843:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 0 (Period): 2020 -> 2020 (STRING)
2025-12-18 15:02:58,843:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (National): 'MOH - Uganda...' -> STRING (non-numeric detected)
2025-12-18 15:02:58,843:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (National): MOH - Uganda (PROCESSED)
2025-12-18 15:02:58,843:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (Region): 'Ankole...' -> STRING (non-numeric detected)
2025-12-18 15:02:58,843:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (Region): Ankole (PROCESSED)
2025-12-18 15:02:58,843:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (District): 'Rwampara District...' -> STRING (non-numeric detected)
2025-12-18 15:02:58,843:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (District): Rwampara District (PROCESSED)
2025-12-18 15:02:58,843:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (Sub_County_Town_Council_Div): 'Mwizi Subcounty...' -> STRING (non-numeric detected)
2025-12-18 15:02:58,843:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (Sub_County_Town_Council_Div): Mwizi Subcounty (PROCESSED)
2025-12-18 15:02:58,965:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() returning 4437 rows with 14 columns each
2025-12-18 15:02:58,980:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Got 4437 rows from cursor
2025-12-18 15:02:58,980:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: First row: ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
2025-12-18 15:02:58,981:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 15:02:58,981:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Types from cursor: ['String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String']
2025-12-18 15:02:59,087:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: DataFrame created with 4437 rows, 14 columns
2025-12-18 15:02:59,087:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 15:02:59,092:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes BEFORE fix: {'Period': dtype('O'), 'National': dtype('O'), 'Region': dtype('O'), 'District': dtype('O'), 'Sub_County_Town_Council_Div': dtype('O'), 'Health_Facility': dtype('O'), '108_EP01a_2_Malaria_Total_Deaths': dtype('O'), '108_EP01a_1_Malaria_Total_Cases': dtype('O'), '105_EP01b_Malaria_Total': dtype('O'), '105_EP01a_Suspected_fever': dtype('O'), '105_EP01d_Malaria_cases_treated': dtype('O'), '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths': dtype('O'), '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases': dtype('O'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('O')}
2025-12-18 15:02:59,121:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Period' to object dtype (dimension)
2025-12-18 15:02:59,130:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'National' as dimension (contains non-numeric string: 'MOH - Uganda...')
2025-12-18 15:02:59,130:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'National' to object dtype (dimension)
2025-12-18 15:02:59,131:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'Region' as dimension (contains non-numeric string: 'Ankole...')
2025-12-18 15:02:59,132:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Region' to object dtype (dimension)
2025-12-18 15:02:59,139:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'District' as dimension (contains non-numeric string: 'Rwampara District...')
2025-12-18 15:02:59,140:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'District' to object dtype (dimension)
2025-12-18 15:02:59,140:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'Sub_County_Town_Council_Div' as dimension (contains non-numeric string: 'Mwizi Subcounty...')
2025-12-18 15:02:59,141:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Sub_County_Town_Council_Div' to object dtype (dimension)
2025-12-18 15:02:59,143:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'Health_Facility' as dimension (contains non-numeric string: 'Keyo Health Centre II...')
2025-12-18 15:02:59,144:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Health_Facility' to object dtype (dimension)
2025-12-18 15:02:59,150:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes AFTER fix: {'Period': dtype('O'), 'National': dtype('O'), 'Region': dtype('O'), 'District': dtype('O'), 'Sub_County_Town_Council_Div': dtype('O'), 'Health_Facility': dtype('O'), '108_EP01a_2_Malaria_Total_Deaths': dtype('O'), '108_EP01a_1_Malaria_Total_Cases': dtype('O'), '105_EP01b_Malaria_Total': dtype('O'), '105_EP01a_Suspected_fever': dtype('O'), '105_EP01d_Malaria_cases_treated': dtype('O'), '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths': dtype('O'), '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases': dtype('O'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('O')}
2025-12-18 15:02:59,152:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: First row: {'Period': '2020', 'National': 'MOH - Uganda', 'Region': 'Ankole', 'District': 'Rwampara District', 'Sub_County_Town_Council_Div': 'Mwizi Subcounty', 'Health_Facility': None, '108_EP01a_2_Malaria_Total_Deaths': None, '108_EP01a_1_Malaria_Total_Cases': 3, '105_EP01b_Malaria_Total': 1580, '105_EP01a_Suspected_fever': 6695, '105_EP01d_Malaria_cases_treated': 1560, '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths': None, '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases': 3, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 1579}
2025-12-18 15:02:59,175:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] BEFORE assign_column_label:
2025-12-18 15:02:59,175:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4437, 14)
2025-12-18 15:02:59,175:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 15:02:59,175:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['Region', 'Period', '105_EP01b_Malaria_Total']
2025-12-18 15:02:59,178:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: False
2025-12-18 15:02:59,179:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Period': '2020', 'National': 'MOH - Uganda', 'Region': 'Ankole', 'District': 'Rwampara District', 'Sub_County_Town_Council_Div': 'Mwizi Subcounty', 'Health_Facility': None, '108_EP01a_2_Malaria_Total_Deaths': None, '108_EP01a_1_Malaria_Total_Cases': 3, '105_EP01b_Malaria_Total': 1580, '105_EP01a_Suspected_fever': 6695, '105_EP01d_Malaria_cases_treated': 1560, '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths': None, '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases': 3, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 1579}
2025-12-18 15:02:59,180:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Column truncation needed: df has 14 columns, expected 3
2025-12-18 15:02:59,180:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   DataFrame actual columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 15:02:59,180:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Expected columns: ['Region', 'Period', '105_EP01b_Malaria_Total']
2025-12-18 15:02:59,181:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] âœ“ Selecting columns BY NAME (matched all expected columns)
2025-12-18 15:02:59,181:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Column mapping: {'Region': 'Region', 'Period': 'Period', '105_EP01b_Malaria_Total': '105_EP01b_Malaria_Total'}
2025-12-18 15:02:59,189:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] Column Selection âœ“ SUCCESS - method=BY_NAME, datasource=analytics 20251217-3246
2025-12-18 15:02:59,189:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Region', 'Period', '105_EP01b_Malaria_Total']
2025-12-18 15:02:59,189:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   tried_by_name=True, success=True, fallback=False
2025-12-18 15:02:59,190:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Assigning column labels: ['Region', 'Period', '105_EP01b_Malaria_Total']
2025-12-18 15:02:59,190:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] AFTER assign_column_label:
2025-12-18 15:02:59,190:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4437, 3)
2025-12-18 15:02:59,190:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Region', 'Period', '105_EP01b_Malaria_Total']
2025-12-18 15:02:59,190:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['Region', 'Period', '105_EP01b_Malaria_Total']
2025-12-18 15:02:59,190:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: True
2025-12-18 15:02:59,190:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Region': 'Ankole', 'Period': '2020', '105_EP01b_Malaria_Total': 1580}
2025-12-18 15:02:59,333:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 15:02:59] "POST /api/v1/chart/data?force=true HTTP/1.1" 200 -
2025-12-18 15:03:01,323:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 15:03:01] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 15:07:13,910:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 15:07:13] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 15:07:21,062:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 15:07:21] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 15:07:21,106:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 15:07:21] "PUT /api/v1/explore/form_data/ULWSeaI5Yyo?tab_id=2 HTTP/1.1" 200 -
2025-12-18 15:07:24,226:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 15:07:24] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 15:07:24,239:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 15:07:24] "PUT /api/v1/explore/form_data/ULWSeaI5Yyo?tab_id=2 HTTP/1.1" 200 -
2025-12-18 15:07:32,007:WARNING:superset.common.query_object:The field `groupby` is deprecated, please use `columns` instead.
2025-12-18 15:07:32,010:WARNING:superset.common.query_object:The field `columns` is already populated, replacing value with contents from `groupby`.
2025-12-18 15:07:32,247:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 15:07:32] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-18 15:07:33,224:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 15:07:33] "PUT /api/v1/explore/form_data/ULWSeaI5Yyo?tab_id=2 HTTP/1.1" 200 -
2025-12-18 15:07:33,319:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 15:07:33] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 15:11:14,320:WARNING:superset.common.query_object:The field `groupby` is deprecated, please use `columns` instead.
2025-12-18 15:11:14,321:WARNING:superset.common.query_object:The field `columns` is already populated, replacing value with contents from `groupby`.
2025-12-18 15:11:14,681:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 15:11:14] "PUT /api/v1/explore/form_data/ULWSeaI5Yyo?tab_id=2 HTTP/1.1" 200 -
2025-12-18 15:11:15,030:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 15:11:15] "POST /api/v1/chart/data HTTP/1.1" 200 -
Python(40843) MallocStackLogging: can't turn off malloc stack logging because it was not enabled.
2025-12-18 15:11:19,981:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 15:11:19] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 15:11:20,401:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 15:11:20] "GET /explore/?form_data_key=ULWSeaI5Yyo&viz_type=dhis2_map&datasource=4__table&datasource_id=4&datasource_type=table HTTP/1.1" 200 -
2025-12-18 15:11:22,267:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 15:11:22] "GET /static/appbuilder/css/flags/flags16.css HTTP/1.1" 200 -
2025-12-18 15:11:33,647:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 15:11:33] "GET /api/v1/database/?q=(filters:!((col:allow_file_upload,opr:upload_is_enabled,value:!t))) HTTP/1.1" 200 -
2025-12-18 15:11:36,664:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 15:11:36] "GET /api/v1/database/?q=(filters:!((col:database_name,opr:neq,value:examples))) HTTP/1.1" 200 -
2025-12-18 15:11:36,796:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 15:11:36] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 15:11:44,642:INFO:superset.db_engine_specs.dhis2:[DHIS2] get_parameters_from_uri called
2025-12-18 15:11:44,643:ERROR:superset.db_engine_specs.dhis2:[DHIS2] Failed to extract parameters from URI: 'URL' object has no attribute 'decode'
Traceback (most recent call last):
  File "/Users/stephocay/projects/hispuganda/superset/superset/db_engine_specs/dhis2.py", line 361, in get_parameters_from_uri
    parsed = urlparse(uri)
             ^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/urllib/parse.py", line 394, in urlparse
    url, scheme, _coerce_result = _coerce_args(url, scheme)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/urllib/parse.py", line 133, in _coerce_args
    return _decode_args(args) + (_encode_result,)
           ^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/urllib/parse.py", line 117, in _decode_args
    return tuple(x.decode(encoding, errors) if x else '' for x in args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/urllib/parse.py", line 117, in <genexpr>
    return tuple(x.decode(encoding, errors) if x else '' for x in args)
                 ^^^^^^^^
AttributeError: 'URL' object has no attribute 'decode'
2025-12-18 15:11:44,818:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 15:11:44] "GET /api/v1/explore/?form_data_key=ULWSeaI5Yyo&viz_type=dhis2_map&datasource_id=4&datasource_type=table HTTP/1.1" 200 -
2025-12-18 15:11:46,788:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 15:11:46] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 15:11:46,837:WARNING:superset.common.query_object:The field `groupby` is deprecated, please use `columns` instead.
2025-12-18 15:11:46,838:WARNING:superset.common.query_object:The field `columns` is already populated, replacing value with contents from `groupby`.
2025-12-18 15:11:47,017:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 15:11:47] "[35m[1mPOST /api/v1/explore/form_data?tab_id=2 HTTP/1.1[0m" 201 -
2025-12-18 15:11:47,397:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 15:11:47] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-18 15:11:50,594:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 15:11:50] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 15:11:50,616:WARNING:superset.common.query_object:The field `groupby` is deprecated, please use `columns` instead.
2025-12-18 15:11:50,617:WARNING:superset.common.query_object:The field `columns` is already populated, replacing value with contents from `groupby`.
2025-12-18 15:11:51,767:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 15:11:51] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-18 15:13:37,888:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 15:13:37] "GET /api/v1/database/?q=(filters:!((col:database_name,opr:neq,value:examples))) HTTP/1.1" 200 -
2025-12-18 15:13:37,889:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 15:13:37] "GET /api/v1/database/?q=(filters:!((col:allow_file_upload,opr:upload_is_enabled,value:!t))) HTTP/1.1" 200 -
2025-12-18 15:13:38,128:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 15:13:38] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 15:14:13,010:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 15:14:13] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 15:14:13,102:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 15:14:13] "GET /api/v1/database/?q=(filters:!((col:allow_file_upload,opr:upload_is_enabled,value:!t))) HTTP/1.1" 200 -
2025-12-18 15:14:13,336:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 15:14:13] "GET /api/v1/database/?q=(filters:!((col:database_name,opr:neq,value:examples))) HTTP/1.1" 200 -
2025-12-18 15:27:11,174:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 15:27:11] "GET /api/v1/database/?q=(filters:!((col:database_name,opr:neq,value:examples))) HTTP/1.1" 200 -
2025-12-18 15:27:11,182:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 15:27:11] "GET /api/v1/database/?q=(filters:!((col:allow_file_upload,opr:upload_is_enabled,value:!t))) HTTP/1.1" 200 -
2025-12-18 15:27:11,213:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 15:27:11] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 15:30:43,676:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 15:30:43] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 15:30:43,718:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 15:30:43] "GET /api/v1/database/?q=(filters:!((col:allow_file_upload,opr:upload_is_enabled,value:!t))) HTTP/1.1" 200 -
2025-12-18 15:30:43,719:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 15:30:43] "GET /api/v1/database/?q=(filters:!((col:database_name,opr:neq,value:examples))) HTTP/1.1" 200 -
2025-12-18 15:30:50,494:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 15:30:50] "GET /api/v1/me/ HTTP/1.1" 200 -
2025-12-18 15:31:02,652:WARNING:superset.common.query_object:The field `groupby` is deprecated, please use `columns` instead.
2025-12-18 15:31:02,653:WARNING:superset.common.query_object:The field `groupby` is deprecated, please use `columns` instead.
2025-12-18 15:31:02,669:WARNING:superset.common.query_object:The field `columns` is already populated, replacing value with contents from `groupby`.
2025-12-18 15:31:02,663:WARNING:superset.common.query_object:The field `columns` is already populated, replacing value with contents from `groupby`.
2025-12-18 15:31:03,175:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 15:31:03] "PUT /api/v1/explore/form_data/ULWSeaI5Yyo?tab_id=2 HTTP/1.1" 200 -
2025-12-18 15:31:03,613:ERROR:superset.models.helpers:[METRICS-TRACE] Processing 1 metrics
2025-12-18 15:31:03,948:ERROR:superset.models.helpers:[METRICS-TRACE] Metric 0: DHIS2 raw column - 105_EP01b_Malaria_Total
2025-12-18 15:31:03,995:ERROR:superset.models.helpers:[METRICS-TRACE]   âœ“ Added: 105_EP01b_Malaria_Total
2025-12-18 15:31:03,995:ERROR:superset.models.helpers:[METRICS-TRACE] Total metrics added: 1
2025-12-18 15:31:04,100:ERROR:superset.models.helpers:[METRICS-TRACE] Before dedup: 3 select_exprs + 1 metrics_exprs
2025-12-18 15:31:04,102:ERROR:superset.models.helpers:[METRICS-TRACE] After dedup: 3 total select_exprs
2025-12-18 15:31:04,102:INFO:superset.models.helpers:[COLUMN_TRACE] SQL Query Building:
2025-12-18 15:31:04,244:INFO:superset.models.helpers:[COLUMN_TRACE]   columns: ['District', 'Period', '105_EP01b_Malaria_Total']
2025-12-18 15:31:04,244:INFO:superset.models.helpers:[COLUMN_TRACE]   metrics: ['105_EP01b_Malaria_Total']
2025-12-18 15:31:04,273:INFO:superset.models.helpers:[COLUMN_TRACE]   groupby: []
2025-12-18 15:31:04,274:INFO:superset.models.helpers:[COLUMN_TRACE]   labels_expected: ['District', 'Period', '105_EP01b_Malaria_Total']
2025-12-18 15:31:04,292:INFO:superset.models.helpers:[COLUMN_TRACE]   select_exprs count: 3
2025-12-18 15:31:04,293:INFO:superset.models.helpers:[COLUMN_TRACE]     [0] key=District, name=District, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-18 15:31:04,301:INFO:superset.models.helpers:[COLUMN_TRACE]     [1] key=Period, name=Period, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-18 15:31:04,321:INFO:superset.models.helpers:[COLUMN_TRACE]     [2] key=105_EP01b_Malaria_Total, name=105_EP01b_Malaria_Total, type=<class 'sqlalchemy.sql.elements.ColumnClause'>
2025-12-18 15:31:04,414:INFO:superset.connectors.sqla.models:[DHIS2] get_from_clause for virtual dataset 4: analytics 20251217-3246
2025-12-18 15:31:04,435:INFO:superset.connectors.sqla.models:[DHIS2] Full SQL stored: SELECT * FROM analytics
/* DHIS2: table=analytics&dx=JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&pe=LAST_5_YEARS&ou=F1o6qBSx783;SUvODYOcaVf&ouMode=DESCENDANTS */
2025-12-18 15:31:04,467:INFO:superset.connectors.sqla.models:[DHIS2] Loaded params from extra field: table=analytics&dx=JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&pe=LAST_5_YEARS&ou=F1o6qBSx783;SUvO
2025-12-18 15:31:04,611:INFO:superset.connectors.sqla.models:[DHIS2] Cached params with key: dhis2_params_4_analytics
2025-12-18 15:31:04,612:INFO:superset.connectors.sqla.models:[DHIS2] Stored params in Flask g for DHIS2 table: analytics
2025-12-18 15:31:05,466:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Query execution in connectors/sqla/models.py:
2025-12-18 15:31:05,468:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   SQL (first 500 chars): SELECT "District", "Period", "105_EP01b_Malaria_Total" 
FROM (SELECT * FROM analytics
/* DHIS2: table=analytics&dx=JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&pe=LAST_5_YEARS&ou=F1o6qBSx783;SUvODYOcaVf&ouMode=DESCENDANTS */
) AS virtual_table GROUP BY "District", "Period", "105_EP01b_Malaria_Total"
 LIMIT 10000
2025-12-18 15:31:05,468:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   labels_expected: ['District', 'Period', '105_EP01b_Malaria_Total']
2025-12-18 15:31:05,535:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 connection initialized: https://tests.dhis2.hispuganda.org/hmis/api
2025-12-18 15:31:05,648:INFO:superset.db_engine_specs.dhis2_dialect:Executing DHIS2 query: SELECT
  "District",
  "Period",
  "105_EP01b_Malaria_Total"
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "District",
  "Period",
  "105_EP01b_Malaria_Total"
LIMIT 10000
2025-12-18 15:31:06,432:INFO:superset.db_engine_specs.dhis2_dialect:Parsed endpoint: analytics
2025-12-18 15:31:06,479:INFO:superset.db_engine_specs.dhis2_dialect:Using stored parameters from Flask g for table: analytics
2025-12-18 15:31:06,484:INFO:superset.db_engine_specs.dhis2_dialect:Query params: {'table': 'analytics', 'dx': 'JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX', 'pe': 'LAST_5_YEARS', 'ou': 'F1o6qBSx783;SUvODYOcaVf', 'ouMode': 'DESCENDANTS'}
2025-12-18 15:31:06,487:INFO:superset.db_engine_specs.dhis2_dialect:Period dimension detected - omitting startDate/endDate (DHIS2 API rule)
2025-12-18 15:31:06,487:INFO:superset.db_engine_specs.dhis2_dialect:Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dx': 'JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX', 'pe': 'LAST_5_YEARS', 'ou': 'F1o6qBSx783;SUvODYOcaVf', 'ouMode': 'DESCENDANTS'}
2025-12-18 15:31:06,530:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 15:31:06] "POST /api/v1/chart/data HTTP/1.1" 200 -
2025-12-18 15:31:07,596:INFO:superset.databases.api:[DHIS2 GeoFeatures] Fetching geoFeatures with params: {'ou': 'ou:LEVEL-2'}
2025-12-18 15:31:08,191:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 15:31:08] "POST /superset/log/?explode=events HTTP/1.1" 200 -
2025-12-18 15:31:08,628:INFO:superset.databases.api:[DHIS2 OrgUnitLevels] Request URL: https://tests.dhis2.hispuganda.org/hmis/api/organisationUnitLevels
2025-12-18 15:31:08,629:INFO:superset.db_engine_specs.dhis2_dialect:Fetched org unit levels: {3: 'District', 5: 'Health Facility', 1: 'National', 2: 'Region', 4: 'Sub County/Town Council/Div'}
2025-12-18 15:31:08,629:INFO:superset.databases.api:[DHIS2 OrgUnitLevels] Response status: 200
2025-12-18 15:31:08,633:INFO:superset.databases.api:[DHIS2 OrgUnitLevels] Found 5 levels
2025-12-18 15:31:08,638:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 15:31:08] "GET /api/v1/database/2/dhis2_metadata/?type=organisationUnitLevels HTTP/1.1" 200 -
2025-12-18 15:31:09,437:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Using all_levels scope: ['LEVEL-3', 'LEVEL-4', 'LEVEL-5']
2025-12-18 15:31:09,563:INFO:superset.db_engine_specs.dhis2_dialect:Converted dx/pe/ou to dimension parameter: dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX;pe:LAST_5_YEARS;ou:F1o6qBSx783;SUvODYOcaVf;LEVEL-3;LEVEL-4;LEVEL-5
2025-12-18 15:31:09,569:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API request (cache miss): https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&dimension=pe:LAST_5_YEARS&dimension=ou:F1o6qBSx783;SUvODYOcaVf;LEVEL-3;LEVEL-4;LEVEL-5
2025-12-18 15:31:11,132:INFO:superset.databases.api:[DHIS2 GeoFeatures] Response status: 200
2025-12-18 15:31:11,148:INFO:superset.databases.api:[DHIS2 GeoFeatures] Found 15 features
2025-12-18 15:31:11,175:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 15:31:11] "GET /api/v1/database/2/dhis2_metadata/?type=geoFeatures&ou=LEVEL-2 HTTP/1.1" 200 -
2025-12-18 15:31:19,804:INFO:superset.db_engine_specs.dhis2_cache:[DHIS2 Cache] SET: analytics (ttl=3600s, key=dhis2:4a1c3321:analytics:5362e2052855...)
2025-12-18 15:31:19,804:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2 Cache] Stored response for analytics
2025-12-18 15:31:19,831:INFO:superset.db_engine_specs.dhis2_dialect:Using wide/pivoted format for analytics
2025-12-18 15:31:20,815:INFO:superset.db_engine_specs.dhis2_dialect:Fetched org unit levels: {3: 'District', 5: 'Health Facility', 1: 'National', 2: 'Region', 4: 'Sub County/Town Council/Div'}
2025-12-18 15:31:20,818:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] _fetch_org_unit_hierarchy: Fetching 1142 unique org units in batches...
2025-12-18 15:31:41,526:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Fetched 1142 org units, found 301 parent IDs
2025-12-18 15:31:41,533:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Iteration 1: Fetching 2 missing parent org units...
2025-12-18 15:31:42,405:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Iteration 2: Fetching 1 missing parent org units...
2025-12-18 15:31:43,245:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total org unit names available: 1145
2025-12-18 15:31:43,267:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Sample hierarchy for a9NzDoLn9kz: {'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Kitgum District', 'level_4': 'Pager Division', 'level_5': None, 'level_6': None}
2025-12-18 15:31:43,267:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] _fetch_org_unit_hierarchy completed: 1142 org units with hierarchy
2025-12-18 15:31:43,267:INFO:superset.db_engine_specs.dhis2_dialect:normalize_analytics called with pivot=True, returning WIDE format

[DHIS2] Normalized row count: 4437
[DHIS2] First row: ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
[DHIS2] _set_description: original=['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], sanitized=['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive'], types=['String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String']
[DHIS2] Transformed rows count: 4437
[DHIS2] First transformed row: ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
[DHIS2] Fetched 4437 rows
[DHIS2] fetchall() called - returning 4437 rows
[DHIS2] fetchall() - First row type: <class 'tuple'>
[DHIS2] fetchall() - First row (original): ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
[DHIS2] fetchall() - Column count from description: 14
[DHIS2] fetchall() - First row (fixed types): ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
[DHIS2] fetchall() - Type enforcement: dimensions=STRING, measures=FLOAT
[DHIS2] Executing query: SELECT
  "District",
  "Period",
  "105_EP01b_Malaria_Total"
FROM (
  SELECT
    *
  FROM analytics
) AS virtual_table
GROUP BY
  "District",
  "Period",
  "105_EP01b_Malaria_Total"
LIMIT 10000
[DHIS2] Parsed endpoint: analytics
[DHIS2] Found params in Flask g for analytics: table=analytics&dx=JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7
[DHIS2] Query params: {'table': 'analytics', 'dx': 'JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX', 'pe': 'LAST_5_YEARS', 'ou': 'F1o6qBSx783;SUvODYOcaVf', 'ouMode': 'DESCENDANTS'}
[DHIS2] Merged params: {'skipMeta': 'false', 'displayProperty': 'NAME', 'table': 'analytics', 'dx': 'JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX', 'pe': 'LAST_5_YEARS', 'ou': 'F1o6qBSx783;SUvODYOcaVf', 'ouMode': 'DESCENDANTS'}
[DHIS2] Using all_levels scope: ['LEVEL-3', 'LEVEL-4', 'LEVEL-5']
[DHIS2] ðŸ”„ CACHE MISS - API request URL: https://tests.dhis2.hispuganda.org/hmis/api/analytics?skipMeta=false&displayProperty=NAME&table=analytics&dimension=dx:JhvC7ZR9hUe;D9A0afrTYPw;wUDxFVBapIc;QHnwKs2OUZv;BWZFz9RJRPI;AuAOIfCuBUp;pRZrTLDN7Ge;gHjJrtw9vQX&dimension=pe:LAST_5_YEARS&dimension=ou:F1o6qBSx783;SUvODYOcaVf;LEVEL-3;LEVEL-4;LEVEL-5
[DHIS2] Raw API response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Raw DHIS2 rows count: 22727
[DHIS2] First raw row: ['JhvC7ZR9hUe', '2022', 'C0RSe3EWBqU', '246166']
[DHIS2] âœ… Cached response for analytics (API took 13265.8ms)
[DHIS2] Parsing response for endpoint: analytics
[DHIS2] Response keys: ['headers', 'metaData', 'rowContext', 'rows', 'height', 'width', 'headerWidth']
[DHIS2] Response sample: {'headers': [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}], 'metaDat
[DHIS2] Using WIDE/PIVOTED format (Period, Level_1_Name, Level_2_Name, ..., DX1, DX2, ...) for analytics
[DHIS2] Analytics headers: [{'name': 'dx', 'column': 'Data', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'pe', 'column': 'Period', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'ou', 'column': 'Organisation unit', 'valueType': 'TEXT', 'type': 'java.lang.String', 'hidden': False, 'meta': True}, {'name': 'value', 'column': 'Value', 'valueType': 'NUMBER', 'type': 'java.lang.Double', 'hidden': False, 'meta': False}]
[DHIS2] Found 'ou' column at index 2
[DHIS2] Processing 22727 rows to extract org unit IDs
[DHIS2] Extracted 1142 unique org unit IDs from rows
[DHIS2] Found 1142 unique org units in analytics response
[DHIS2] Fetching hierarchy for 1142 org units...
[DHIS2] _fetch_org_unit_hierarchy: Fetching 1142 unique org units
[DHIS2] Batch 1: Got 50 org units from DHIS2
[DHIS2]   OU: wNunka5Y2uu, name=Acholi-Bur Subcounty, level=4, parent=aBrjuZk0W31
[DHIS2]   OU: FihNC5KfGJV, name=Adilang Subcounty, level=4, parent=ztIyIYAzFKp
[DHIS2]   OU: HSBjlZdFpWn, name=Ajan Subcounty, level=4, parent=aBrjuZk0W31
[DHIS2] Batch 2: Got 50 org units from DHIS2
[DHIS2] Batch 3: Got 50 org units from DHIS2
[DHIS2] Batch 4: Got 50 org units from DHIS2
[DHIS2] Batch 5: Got 50 org units from DHIS2
[DHIS2] Batch 6: Got 50 org units from DHIS2
[DHIS2] Batch 7: Got 50 org units from DHIS2
[DHIS2] Batch 8: Got 50 org units from DHIS2
[DHIS2] Batch 9: Got 50 org units from DHIS2
[DHIS2] Batch 10: Got 50 org units from DHIS2
[DHIS2] Batch 11: Got 50 org units from DHIS2
[DHIS2] Batch 12: Got 50 org units from DHIS2
[DHIS2] Batch 13: Got 50 org units from DHIS2
[DHIS2] Batch 14: Got 50 org units from DHIS2
[DHIS2] Batch 15: Got 50 org units from DHIS2
[DHIS2] Batch 16: Got 50 org units from DHIS2
[DHIS2] Batch 17: Got 50 org units from DHIS2
[DHIS2] Batch 18: Got 50 org units from DHIS2
[DHIS2] Batch 19: Got 50 org units from DHIS2
[DHIS2] Batch 20: Got 50 org units from DHIS2
[DHIS2] Batch 21: Got 50 org units from DHIS2
[DHIS2] Batch 22: Got 50 org units from DHIS2
[DHIS2] Batch 23: Got 42 org units from DHIS2
[DHIS2] Total org unit names available: 1145 after 2 iterations
[DHIS2] Sample hierarchy for a9NzDoLn9kz: {'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Kitgum District', 'level_4': 'Pager Division', 'level_5': None, 'level_6': None}
[DHIS2]   a9NzDoLn9kz: filled levels = ['level_1', 'level_2', 'level_3', 'level_4']
[DHIS2]   aFgrVHVDqoZ: filled levels = ['level_1', 'level_2', 'level_3', 'level_4', 'level_5']
[DHIS2]   fxHApp8UtpE: filled levels = ['level_1', 'level_2', 'level_3', 'level_4', 'level_5']
[DHIS2] Fetched hierarchy for 1142 org units
[DHIS2] Sample hierarchy for a9NzDoLn9kz: {'level_1': 'MOH - Uganda', 'level_2': 'Acholi', 'level_3': 'Kitgum District', 'level_4': 'Pager Division', 'level_5': None, 'level_6': None}
[DHIS2] Calling DHIS2ResponseNormalizer.normalize with:
[DHIS2]   - endpoint: analytics
[DHIS2]   - pivot: True
[DHIS2]   - org_unit_hierarchy: 1142 entries
[DHIS2]   - org_unit_level_names: {3: 'District', 5: 'Health Facility', 1: 'National', 2: 'Region', 4: 'Sub County/Town Council/Div'}
[DHIS2] normalize_analytics: pivot=True, using WIDE/PIVOTED format
[DHIS2] PIVOT CONSTRUCTION:
[DHIS2]   data_elements (UIDs): ['AuAOIfCuBUp', 'BWZFz9RJRPI', 'D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'gHjJrtw9vQX', 'pRZrTLDN7Ge', 'wUDxFVBapIc']
[DHIS2]   data_element_list (sorted UIDs): ['AuAOIfCuBUp', 'BWZFz9RJRPI', 'D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'gHjJrtw9vQX', 'pRZrTLDN7Ge', 'wUDxFVBapIc']
[DHIS2]   col_names (SANITIZED): ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']2025-12-18 15:31:43,338:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column construction - data_elements: ['AuAOIfCuBUp', 'BWZFz9RJRPI', 'D9A0afrTYPw', 'JhvC7ZR9hUe', 'QHnwKs2OUZv', 'gHjJrtw9vQX', 'pRZrTLDN7Ge', 'wUDxFVBapIc']
2025-12-18 15:31:43,338:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Column names constructed (SANITIZED): ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 15:31:43,339:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] FIRST ROW CONSTRUCTION:
2025-12-18 15:31:43,339:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   Period (index 0): 2020
2025-12-18 15:31:43,339:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   108-EP01a.2. Malaria Total (Deaths) (index 6): None
2025-12-18 15:31:43,339:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   108-EP01a.1. Malaria Total (Cases) (index 7): 3
2025-12-18 15:31:43,339:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01b. Malaria Total (index 8): 1580
2025-12-18 15:31:43,340:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01a. Suspected fever (index 9): 6695
2025-12-18 15:31:43,340:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01d. Malaria cases treated (index 10): 1560
2025-12-18 15:31:43,340:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   108-EP01b.2. Malaria Confirmed (Microscopic &RDT) (Deaths) (index 11): None
2025-12-18 15:31:43,340:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   108-EP01b.1. Malaria Confirmed (Microscopic &RDT) (Cases) (index 12): 3
2025-12-18 15:31:43,340:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2]   105-EP01c. Malaria Confirmed (B/s and RDT Positive) (index 13): 1579
2025-12-18 15:31:43,360:INFO:superset.db_engine_specs.dhis2_dialect:First pivoted row - Period: '2020'
2025-12-18 15:31:43,360:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Total pivoted rows: 4437, columns: 14
2025-12-18 15:31:43,363:INFO:superset.db_engine_specs.dhis2_dialect:Normalized 4437 rows with 14 columns for endpoint analytics
2025-12-18 15:31:43,363:INFO:superset.db_engine_specs.dhis2_dialect:DHIS2 API returned 4437 rows
2025-12-18 15:31:43,395:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() - Row count: 4437
2025-12-18 15:31:43,395:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 15:31:43,395:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() column_names length: 14
2025-12-18 15:31:43,396:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values count: 14
2025-12-18 15:31:43,396:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] First row values: ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
2025-12-18 15:31:43,396:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 0 (Period): 2020 -> 2020 (STRING)
2025-12-18 15:31:43,396:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (National): 'MOH - Uganda...' -> STRING (non-numeric detected)
2025-12-18 15:31:43,396:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 1 (National): MOH - Uganda (PROCESSED)
2025-12-18 15:31:43,396:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (Region): 'Ankole...' -> STRING (non-numeric detected)
2025-12-18 15:31:43,396:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 2 (Region): Ankole (PROCESSED)
2025-12-18 15:31:43,396:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (District): 'Rwampara District...' -> STRING (non-numeric detected)
2025-12-18 15:31:43,396:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 3 (District): Rwampara District (PROCESSED)
2025-12-18 15:31:43,396:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (Sub_County_Town_Council_Div): 'Mwizi Subcounty...' -> STRING (non-numeric detected)
2025-12-18 15:31:43,396:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] Row 0 col 4 (Sub_County_Town_Council_Div): Mwizi Subcounty (PROCESSED)
2025-12-18 15:31:43,411:INFO:superset.db_engine_specs.dhis2_dialect:[DHIS2] fetchall() returning 4437 rows with 14 columns each
2025-12-18 15:31:43,412:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Got 4437 rows from cursor
2025-12-18 15:31:43,412:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: First row: ('2020', 'MOH - Uganda', 'Ankole', 'Rwampara District', 'Mwizi Subcounty', None, None, 3, 1580, 6695, 1560, None, 3, 1579)
2025-12-18 15:31:43,412:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 15:31:43,412:INFO:superset.db_engine_specs.dhis2:[DHIS2] fetch_data: Types from cursor: ['String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String', 'String']
2025-12-18 15:31:43,532:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: DataFrame created with 4437 rows, 14 columns
2025-12-18 15:31:43,532:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 15:31:43,535:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes BEFORE fix: {'Period': dtype('O'), 'National': dtype('O'), 'Region': dtype('O'), 'District': dtype('O'), 'Sub_County_Town_Council_Div': dtype('O'), 'Health_Facility': dtype('O'), '108_EP01a_2_Malaria_Total_Deaths': dtype('O'), '108_EP01a_1_Malaria_Total_Cases': dtype('O'), '105_EP01b_Malaria_Total': dtype('O'), '105_EP01a_Suspected_fever': dtype('O'), '105_EP01d_Malaria_cases_treated': dtype('O'), '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths': dtype('O'), '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases': dtype('O'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('O')}
2025-12-18 15:31:43,540:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Period' to object dtype (dimension)
2025-12-18 15:31:43,542:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'National' as dimension (contains non-numeric string: 'MOH - Uganda...')
2025-12-18 15:31:43,542:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'National' to object dtype (dimension)
2025-12-18 15:31:43,542:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'Region' as dimension (contains non-numeric string: 'Ankole...')
2025-12-18 15:31:43,543:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Region' to object dtype (dimension)
2025-12-18 15:31:43,543:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'District' as dimension (contains non-numeric string: 'Rwampara District...')
2025-12-18 15:31:43,544:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'District' to object dtype (dimension)
2025-12-18 15:31:43,544:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'Sub_County_Town_Council_Div' as dimension (contains non-numeric string: 'Mwizi Subcounty...')
2025-12-18 15:31:43,545:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Sub_County_Town_Council_Div' to object dtype (dimension)
2025-12-18 15:31:43,546:INFO:superset.db_engine_specs.dhis2:[DHIS2] Detected 'Health_Facility' as dimension (contains non-numeric string: 'Keyo Health Centre II...')
2025-12-18 15:31:43,546:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Forced column 'Health_Facility' to object dtype (dimension)
2025-12-18 15:31:43,548:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: Dtypes AFTER fix: {'Period': dtype('O'), 'National': dtype('O'), 'Region': dtype('O'), 'District': dtype('O'), 'Sub_County_Town_Council_Div': dtype('O'), 'Health_Facility': dtype('O'), '108_EP01a_2_Malaria_Total_Deaths': dtype('O'), '108_EP01a_1_Malaria_Total_Cases': dtype('O'), '105_EP01b_Malaria_Total': dtype('O'), '105_EP01a_Suspected_fever': dtype('O'), '105_EP01d_Malaria_cases_treated': dtype('O'), '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths': dtype('O'), '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases': dtype('O'), '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': dtype('O')}
2025-12-18 15:31:43,548:INFO:superset.db_engine_specs.dhis2:[DHIS2] convert_table_to_df: First row: {'Period': '2020', 'National': 'MOH - Uganda', 'Region': 'Ankole', 'District': 'Rwampara District', 'Sub_County_Town_Council_Div': 'Mwizi Subcounty', 'Health_Facility': None, '108_EP01a_2_Malaria_Total_Deaths': None, '108_EP01a_1_Malaria_Total_Cases': 3, '105_EP01b_Malaria_Total': 1580, '105_EP01a_Suspected_fever': 6695, '105_EP01d_Malaria_cases_treated': 1560, '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths': None, '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases': 3, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 1579}
2025-12-18 15:31:43,557:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] BEFORE assign_column_label:
2025-12-18 15:31:43,557:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4437, 14)
2025-12-18 15:31:43,557:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 15:31:43,557:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['District', 'Period', '105_EP01b_Malaria_Total']
2025-12-18 15:31:43,557:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: False
2025-12-18 15:31:43,558:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'Period': '2020', 'National': 'MOH - Uganda', 'Region': 'Ankole', 'District': 'Rwampara District', 'Sub_County_Town_Council_Div': 'Mwizi Subcounty', 'Health_Facility': None, '108_EP01a_2_Malaria_Total_Deaths': None, '108_EP01a_1_Malaria_Total_Cases': 3, '105_EP01b_Malaria_Total': 1580, '105_EP01a_Suspected_fever': 6695, '105_EP01d_Malaria_cases_treated': 1560, '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths': None, '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases': 3, '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive': 1579}
2025-12-18 15:31:43,558:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Column truncation needed: df has 14 columns, expected 3
2025-12-18 15:31:43,558:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   DataFrame actual columns: ['Period', 'National', 'Region', 'District', 'Sub_County_Town_Council_Div', 'Health_Facility', '108_EP01a_2_Malaria_Total_Deaths', '108_EP01a_1_Malaria_Total_Cases', '105_EP01b_Malaria_Total', '105_EP01a_Suspected_fever', '105_EP01d_Malaria_cases_treated', '108_EP01b_2_Malaria_Confirmed_Microscopic_RDT_Deaths', '108_EP01b_1_Malaria_Confirmed_Microscopic_RDT_Cases', '105_EP01c_Malaria_Confirmed_B_s_and_RDT_Positive']
2025-12-18 15:31:43,558:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Expected columns: ['District', 'Period', '105_EP01b_Malaria_Total']
2025-12-18 15:31:43,558:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] âœ“ Selecting columns BY NAME (matched all expected columns)
2025-12-18 15:31:43,558:INFO:superset.connectors.sqla.models:[COLUMN_TRACE]   Column mapping: {'District': 'District', 'Period': 'Period', '105_EP01b_Malaria_Total': '105_EP01b_Malaria_Total'}
2025-12-18 15:31:43,562:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] Column Selection âœ“ SUCCESS - method=BY_NAME, datasource=analytics 20251217-3246
2025-12-18 15:31:43,562:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['District', 'Period', '105_EP01b_Malaria_Total']
2025-12-18 15:31:43,562:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   tried_by_name=True, success=True, fallback=False
2025-12-18 15:31:43,562:INFO:superset.connectors.sqla.models:[COLUMN_TRACE] Assigning column labels: ['District', 'Period', '105_EP01b_Malaria_Total']
2025-12-18 15:31:43,562:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE] AFTER assign_column_label:
2025-12-18 15:31:43,562:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   shape: (4437, 3)
2025-12-18 15:31:43,562:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   columns: ['District', 'Period', '105_EP01b_Malaria_Total']
2025-12-18 15:31:43,562:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   expected: ['District', 'Period', '105_EP01b_Malaria_Total']
2025-12-18 15:31:43,562:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   match: True
2025-12-18 15:31:43,563:INFO:superset.utils.column_trace_logger:[COLUMN_TRACE]   first_row: {'District': 'Rwampara District', 'Period': '2020', '105_EP01b_Malaria_Total': 1580}
2025-12-18 15:31:43,624:INFO:werkzeug:127.0.0.1 - - [18/Dec/2025 15:31:43] "POST /api/v1/chart/data HTTP/1.1" 200 -
